<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>D の Java</title>
  
  <subtitle>别怕路长梦远</subtitle>
  <link href="https://pigpigletsgo.github.io/atom.xml" rel="self"/>
  
  <link href="https://pigpigletsgo.github.io/"/>
  <updated>2024-05-29T00:52:35.299Z</updated>
  <id>https://pigpigletsgo.github.io/</id>
  
  <author>
    <name>D</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>获取系统信息(oshi-core)</title>
    <link href="https://pigpigletsgo.github.io/computer-science/java/%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/oshicore/"/>
    <id>https://pigpigletsgo.github.io/computer-science/java/%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/oshicore/</id>
    <published>2024-05-29T00:52:02.647Z</published>
    <updated>2024-05-29T00:52:35.299Z</updated>
    
    <content type="html"><![CDATA[<h1 id="获取系统信息oshi-core"><a class="anchor" href="#获取系统信息oshi-core">#</a> 获取系统信息 (oshi-core)</h1><h2 id="1-maven"><a class="anchor" href="#1-maven">#</a> 1、maven</h2><figure class="highlight xml"><figcaption data-lang="XML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.github.oshi<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>oshi-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="4"></td><td><pre>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>3.5.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><h2 id="2-api"><a class="anchor" href="#2-api">#</a> 2、API</h2><table><thead><tr><th>对象</th><th>方法</th><th>描述</th></tr></thead><tbody><tr><td>SystemInfo</td><td>getOperatingSystem()</td><td>获取操作系统信息，OperatingSystem</td></tr><tr><td></td><td>getHardware()</td><td>获取硬件信息，HardwareAbstractionLayer</td></tr><tr><td>OperatingSystem</td><td>getFamily()</td><td>获取操作系统名称，例如 Windows</td></tr><tr><td></td><td>getManufacturer()</td><td>获取供货商，例如 Microsoft</td></tr><tr><td></td><td>getVersion()</td><td>获取操作系统版本信息</td></tr><tr><td></td><td>getFileSystem()</td><td>获取系统硬盘信息，FileSystem</td></tr><tr><td></td><td>getProcesses(int pId, OperatingSystem.ProcessSort var2)</td><td>通过 进程 id 获取进程信息，并设置排序方式，OSProcess []</td></tr><tr><td></td><td>getProcess(int pId)</td><td>通过 进程 id 获取一个进程信息，OSProcess</td></tr><tr><td></td><td>getProcesses(Collection&lt;Integer&gt; pId)</td><td>获取多个进程信息，List&lt;OSProcess&gt;</td></tr><tr><td></td><td>getChildProcesses(int var1, int var2, OperatingSystem.ProcessSort var3)</td><td>获取子进程，OSProcess []</td></tr><tr><td></td><td>getProcessId()</td><td>获取进程 id</td></tr><tr><td></td><td>getProcessCount()</td><td>获取进程数量</td></tr><tr><td></td><td>getThreadCount()</td><td>获取线程数</td></tr><tr><td></td><td>getNetworkParams()</td><td>获取网络相关参数，NetworkParams</td></tr><tr><td>HardwareAbstractionLayer</td><td>getComputerSystem()</td><td>获取计算机系统信息，ComputerSystem</td></tr><tr><td></td><td>getProcessor()</td><td>获取处理器信息，CentralProcessor</td></tr><tr><td></td><td>getMemory()</td><td>获取内存信息，GlobalMemory</td></tr><tr><td></td><td>getPowerSources()</td><td>获取电源信息，PowerSource</td></tr><tr><td></td><td>getDiskStores()</td><td>获取硬件磁盘信息，HWDiskStore</td></tr><tr><td></td><td>getNetworkIFs()</td><td>获取网络信息，NetworkIF</td></tr><tr><td></td><td>getDisplays()</td><td>获取显示信息，Display</td></tr><tr><td></td><td>getSensors()</td><td>获取传感器信息，Sensors</td></tr><tr><td></td><td>getUsbDevices(boolean var1)</td><td>获取 USB 设备信息，UsbDevice</td></tr><tr><td>OperatingSystemVersion</td><td>getBuildNumber()</td><td>获取内部编号</td></tr><tr><td></td><td>getCodeName()</td><td>代码名称</td></tr><tr><td></td><td>getVersion()</td><td>获取版本</td></tr><tr><td>FileSystem</td><td>getMaxFileDescriptors()</td><td>获取最大文件描述符</td></tr><tr><td></td><td>getOpenFileDescriptors()</td><td>获取打开文件描述符</td></tr><tr><td></td><td>getFileStores()</td><td>获取盘符相关信息</td></tr><tr><td>OSProcess</td><td>getName()</td><td>进程程序名称</td></tr><tr><td></td><td>getPath()</td><td>进程程序所在位置</td></tr><tr><td></td><td>getCommandLine()</td><td>获取命令行</td></tr><tr><td></td><td>getCurrentWorkingDirectory()</td><td>获取当前工作目录</td></tr><tr><td></td><td>getUser()</td><td>获取用户信息</td></tr><tr><td></td><td>getUserID()</td><td>获取用户 id</td></tr><tr><td></td><td>getGroup()</td><td>获取组信息</td></tr><tr><td></td><td>getGroupID()</td><td>获取组 id</td></tr><tr><td></td><td>getState()</td><td>状态</td></tr><tr><td></td><td>getProcessID()</td><td>获取进程 id</td></tr><tr><td></td><td>getParentProcessID()</td><td>获取父进程 id</td></tr><tr><td></td><td>getThreadCount()</td><td>获取线程数</td></tr><tr><td></td><td>getPriority()</td><td>优先级</td></tr><tr><td></td><td>getVirtualSize()</td><td>虚拟大小</td></tr><tr><td></td><td>getResidentSetSize()</td><td>实际使用物理内存</td></tr><tr><td></td><td>getKernelTime()</td><td>内核时间</td></tr><tr><td></td><td>getUserTime()</td><td>用户时间</td></tr><tr><td></td><td>getUpTime()</td><td>正常运行时间</td></tr><tr><td></td><td>getStartTime()</td><td>开始时间</td></tr><tr><td></td><td>getBytesRead()</td><td>读取字节</td></tr><tr><td></td><td>getBytesWritten()</td><td>写入字节</td></tr><tr><td></td><td>getOpenFiles()</td><td>打开文件数量</td></tr><tr><td>NetworkParams</td><td>getDnsServers()</td><td>获取域名地址</td></tr><tr><td></td><td>getHostName()</td><td>获取主机名</td></tr><tr><td></td><td>getDomainName()</td><td>获取域名</td></tr><tr><td></td><td>getIpv4DefaultGateway()</td><td>获取默认 Ipv4</td></tr><tr><td></td><td>getIpv6DefaultGateway()</td><td>获取默认 Ipv6</td></tr><tr><td>OSFileStore</td><td>getName()</td><td>磁盘名称</td></tr><tr><td></td><td>getVolume()</td><td>文件集</td></tr><tr><td></td><td>getLogicalVolume()</td><td>合理的文件集</td></tr><tr><td></td><td>getMount()</td><td>盘符</td></tr><tr><td></td><td>getDescription()</td><td>描述</td></tr><tr><td></td><td>getType()</td><td>类型</td></tr><tr><td></td><td>getUUID()</td><td>磁盘 UUID</td></tr><tr><td></td><td>getUsableSpace()</td><td>可用空间</td></tr><tr><td></td><td>getTotalSpace()</td><td>总空间</td></tr><tr><td>ComputerSystem</td><td>getManufacturer()</td><td>获取制造商</td></tr><tr><td></td><td>getModel()</td><td>获取型号</td></tr><tr><td></td><td>getSerialNumber()</td><td>获取序列号</td></tr><tr><td></td><td>getFirmware()</td><td>获取固件信息，Firmware</td></tr><tr><td></td><td>getBaseboard()</td><td>获取外壳信息，Baseboard</td></tr><tr><td>Firmware</td><td>getManufacturer()</td><td>获取制造商信息</td></tr><tr><td></td><td>getName()</td><td>获取名称</td></tr><tr><td></td><td>getDescription()</td><td>获取描述信息</td></tr><tr><td></td><td>getVersion()</td><td>获取版本</td></tr><tr><td></td><td>getReleaseDate()</td><td>获取发布时间</td></tr><tr><td>Baseboard</td><td>getModel()</td><td>获取型号</td></tr><tr><td></td><td>getVersion()</td><td>获取版本信息</td></tr><tr><td></td><td>getSerialNumber()</td><td>获取序列号</td></tr><tr><td>CentralProcessor</td><td>getVendor()</td><td>获取供应商</td></tr><tr><td></td><td>getName()</td><td>获取 cpu 名称</td></tr><tr><td></td><td>getVendorFreq()</td><td>获取供应商频率</td></tr><tr><td></td><td>getProcessorID()</td><td>获取处理器 id</td></tr><tr><td></td><td>getIdentifier()</td><td>获取标识符</td></tr><tr><td></td><td>isCpu64bit()</td><td>判断 cpu 是否为 64 位的</td></tr><tr><td></td><td>getStepping()</td><td>获取 cpu 步进</td></tr><tr><td></td><td>getModel()</td><td>获取型号</td></tr><tr><td></td><td>getFamily()</td><td>获取家族</td></tr><tr><td></td><td>getSystemCpuLoadBetweenTicks()</td><td>获取 cpu 负载间隔刻度</td></tr><tr><td></td><td>getSystemCpuLoadTicks()</td><td>获取 cpu 负载刻度</td></tr><tr><td></td><td>getSystemCpuLoad()</td><td>获取 cpu 负载</td></tr><tr><td></td><td>getSystemLoadAverage()</td><td>获取 cpu 平均负载</td></tr><tr><td></td><td>getSystemLoadAverage(int var1)</td><td>获取 cpu 平均负载</td></tr><tr><td></td><td>getProcessorCpuLoadBetweenTicks()</td><td>获取处理器 cpu 负载间隔刻度</td></tr><tr><td></td><td>getProcessorCpuLoadTicks()</td><td>获取处理器 cpu 负载刻度</td></tr><tr><td></td><td>getSystemUptime()</td><td>获取正常运行时间</td></tr><tr><td></td><td>getLogicalProcessorCount()</td><td>获取逻辑处理器数量</td></tr><tr><td></td><td>getPhysicalProcessorCount()</td><td>获取物理处理器数量</td></tr><tr><td></td><td>getPhysicalPackageCount()</td><td>获取物理包装数量</td></tr><tr><td></td><td>getContextSwitches()</td><td>获取上下文切换数量</td></tr><tr><td></td><td>getInterrupts()</td><td>获取中断</td></tr><tr><td>GlobalMemory</td><td>getTotal()</td><td>获取总内存</td></tr><tr><td></td><td>getAvailable()</td><td>获取可用系统运行内存</td></tr><tr><td></td><td>getSwapTotal()</td><td>获取可用虚拟总内存</td></tr><tr><td></td><td>getSwapUsed()</td><td>获取已用虚拟总内存</td></tr><tr><td>PowerSource</td><td>getName()</td><td>获取名称</td></tr><tr><td></td><td>getRemainingCapacity()</td><td>获取剩余容量</td></tr><tr><td></td><td>getTimeRemaining()</td><td>获取剩余时间</td></tr><tr><td>HWDiskStore</td><td>getName()</td><td>获取名称</td></tr><tr><td></td><td>getModel()</td><td>获取型号</td></tr><tr><td></td><td>getSerial()</td><td>获取序列号</td></tr><tr><td></td><td>getSize()</td><td>获取大小</td></tr><tr><td></td><td>getReads()</td><td>（读长）是高通量测序中一个反应获得的测序序列</td></tr><tr><td></td><td>getReadBytes()</td><td>读取字节</td></tr><tr><td></td><td>getWrites()</td><td>写长</td></tr><tr><td></td><td>getWriteBytes()</td><td>写入字节</td></tr><tr><td></td><td>getTransferTime()</td><td>获取转移时间</td></tr><tr><td></td><td>getPartitions()</td><td>获取分区，HWPartition</td></tr><tr><td></td><td>getTimeStamp()</td><td>获取时间戳</td></tr><tr><td>NetworkIF</td><td>getName()</td><td>获取名称</td></tr><tr><td></td><td>getDisplayName()</td><td>获取显示名称</td></tr><tr><td></td><td>getMTU()</td><td>获取最大传输单元</td></tr><tr><td></td><td>getMacaddr()</td><td>获取 MAC 地址</td></tr><tr><td></td><td>getIPv4addr()</td><td>获取 IPv4</td></tr><tr><td></td><td>getIPv6addr()</td><td>获取 IPv6</td></tr><tr><td></td><td>getBytesRecv()</td><td>获取接收字节数</td></tr><tr><td></td><td>getBytesSent()</td><td>获取发送字节数</td></tr><tr><td></td><td>getPacketsRecv()</td><td>获取接收数据包</td></tr><tr><td></td><td>getPacketsSent()</td><td>获取发送数据包</td></tr><tr><td></td><td>getInErrors()</td><td>是否可达，正常 0</td></tr><tr><td></td><td>getOutErrors()</td><td>响应错误，无错误 0</td></tr><tr><td></td><td>getSpeed()</td><td>获取速率</td></tr><tr><td></td><td>getTimeStamp()</td><td>获取时间错</td></tr><tr><td>Display</td><td>getEdid()</td><td>中文名称扩展显示器识别数据</td></tr><tr><td>Sensors</td><td>getCpuTemperature()</td><td>获取 CPU 温度</td></tr><tr><td></td><td>getFanSpeeds()</td><td>获取风扇速度</td></tr><tr><td></td><td>getCpuVoltage()</td><td>获取 CPU 电压</td></tr><tr><td>UsbDevice</td><td>getName()</td><td>获取名称</td></tr><tr><td></td><td>getVendor()</td><td>获取供应商</td></tr><tr><td></td><td>getVendorId()</td><td>获取供应商 id</td></tr><tr><td></td><td>getProductId()</td><td>获取商品 id</td></tr><tr><td></td><td>getSerialNumber()</td><td>获取序列号</td></tr><tr><td></td><td>getConnectedDevices()</td><td>获取连接设备</td></tr></tbody></table><p>示例代码</p><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>zp<span class="token punctuation">.</span>utils</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre> </pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span></span><span class="token class-name">JSONArray</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span></span><span class="token class-name">JSONObject</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">oshi<span class="token punctuation">.</span></span><span class="token class-name">SystemInfo</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">oshi<span class="token punctuation">.</span>hardware<span class="token punctuation">.</span></span><span class="token class-name">CentralProcessor</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">oshi<span class="token punctuation">.</span>hardware<span class="token punctuation">.</span></span><span class="token class-name">GlobalMemory</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">oshi<span class="token punctuation">.</span>hardware<span class="token punctuation">.</span></span><span class="token class-name">HardwareAbstractionLayer</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">oshi<span class="token punctuation">.</span>software<span class="token punctuation">.</span>os<span class="token punctuation">.</span></span><span class="token class-name">FileSystem</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">oshi<span class="token punctuation">.</span>software<span class="token punctuation">.</span>os<span class="token punctuation">.</span></span><span class="token class-name">OSFileStore</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">oshi<span class="token punctuation">.</span>software<span class="token punctuation">.</span>os<span class="token punctuation">.</span></span><span class="token class-name">OperatingSystem</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">oshi<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Util</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre> </pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>net<span class="token punctuation">.</span></span><span class="token class-name">InetAddress</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>net<span class="token punctuation">.</span></span><span class="token class-name">UnknownHostException</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>text<span class="token punctuation">.</span></span><span class="token class-name">DecimalFormat</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Properties</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre> </pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token comment">/**</pre></td></tr><tr><td data-num="20"></td><td><pre>* 系统消息工具类</pre></td></tr><tr><td data-num="21"></td><td><pre>*</pre></td></tr><tr><td data-num="22"></td><td><pre>**/</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SystemInfoUtils</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">OSHI_WAIT_SECOND</span> <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">SystemInfo</span> systemInfo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SystemInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">HardwareAbstractionLayer</span> hardware <span class="token operator">=</span> systemInfo<span class="token punctuation">.</span><span class="token function">getHardware</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">OperatingSystem</span> operatingSystem <span class="token operator">=</span> systemInfo<span class="token punctuation">.</span><span class="token function">getOperatingSystem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre> </pre></td></tr><tr><td data-num="29"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">JSONObject</span> <span class="token function">getCpuInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>        <span class="token class-name">JSONObject</span> cpuInfo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JSONObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>        <span class="token class-name">CentralProcessor</span> processor <span class="token operator">=</span> hardware<span class="token punctuation">.</span><span class="token function">getProcessor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>        <span class="token comment">// CPU 信息</span></pre></td></tr><tr><td data-num="33"></td><td><pre>        <span class="token keyword">long</span><span class="token punctuation">[</span><span class="token punctuation">]</span> prevTicks <span class="token operator">=</span> processor<span class="token punctuation">.</span><span class="token function">getSystemCpuLoadTicks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>        <span class="token class-name">Util</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token constant">OSHI_WAIT_SECOND</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>        <span class="token keyword">long</span><span class="token punctuation">[</span><span class="token punctuation">]</span> ticks <span class="token operator">=</span> processor<span class="token punctuation">.</span><span class="token function">getSystemCpuLoadTicks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>        <span class="token keyword">long</span> nice <span class="token operator">=</span> ticks<span class="token punctuation">[</span><span class="token class-name">CentralProcessor<span class="token punctuation">.</span>TickType</span><span class="token punctuation">.</span><span class="token constant">NICE</span><span class="token punctuation">.</span><span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">-</span> prevTicks<span class="token punctuation">[</span><span class="token class-name">CentralProcessor<span class="token punctuation">.</span>TickType</span><span class="token punctuation">.</span><span class="token constant">NICE</span><span class="token punctuation">.</span><span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>        <span class="token keyword">long</span> irq <span class="token operator">=</span> ticks<span class="token punctuation">[</span><span class="token class-name">CentralProcessor<span class="token punctuation">.</span>TickType</span><span class="token punctuation">.</span><span class="token constant">IRQ</span><span class="token punctuation">.</span><span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">-</span> prevTicks<span class="token punctuation">[</span><span class="token class-name">CentralProcessor<span class="token punctuation">.</span>TickType</span><span class="token punctuation">.</span><span class="token constant">IRQ</span><span class="token punctuation">.</span><span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>        <span class="token keyword">long</span> softirq <span class="token operator">=</span> ticks<span class="token punctuation">[</span><span class="token class-name">CentralProcessor<span class="token punctuation">.</span>TickType</span><span class="token punctuation">.</span><span class="token constant">SOFTIRQ</span><span class="token punctuation">.</span><span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">-</span> prevTicks<span class="token punctuation">[</span><span class="token class-name">CentralProcessor<span class="token punctuation">.</span>TickType</span><span class="token punctuation">.</span><span class="token constant">SOFTIRQ</span><span class="token punctuation">.</span><span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="39"></td><td><pre>        <span class="token keyword">long</span> steal <span class="token operator">=</span> ticks<span class="token punctuation">[</span><span class="token class-name">CentralProcessor<span class="token punctuation">.</span>TickType</span><span class="token punctuation">.</span><span class="token constant">STEAL</span><span class="token punctuation">.</span><span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">-</span> prevTicks<span class="token punctuation">[</span><span class="token class-name">CentralProcessor<span class="token punctuation">.</span>TickType</span><span class="token punctuation">.</span><span class="token constant">STEAL</span><span class="token punctuation">.</span><span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="40"></td><td><pre>        <span class="token keyword">long</span> cSys <span class="token operator">=</span> ticks<span class="token punctuation">[</span><span class="token class-name">CentralProcessor<span class="token punctuation">.</span>TickType</span><span class="token punctuation">.</span><span class="token constant">SYSTEM</span><span class="token punctuation">.</span><span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">-</span> prevTicks<span class="token punctuation">[</span><span class="token class-name">CentralProcessor<span class="token punctuation">.</span>TickType</span><span class="token punctuation">.</span><span class="token constant">SYSTEM</span><span class="token punctuation">.</span><span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>        <span class="token keyword">long</span> user <span class="token operator">=</span> ticks<span class="token punctuation">[</span><span class="token class-name">CentralProcessor<span class="token punctuation">.</span>TickType</span><span class="token punctuation">.</span><span class="token constant">USER</span><span class="token punctuation">.</span><span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">-</span> prevTicks<span class="token punctuation">[</span><span class="token class-name">CentralProcessor<span class="token punctuation">.</span>TickType</span><span class="token punctuation">.</span><span class="token constant">USER</span><span class="token punctuation">.</span><span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="42"></td><td><pre>        <span class="token keyword">long</span> iowait <span class="token operator">=</span> ticks<span class="token punctuation">[</span><span class="token class-name">CentralProcessor<span class="token punctuation">.</span>TickType</span><span class="token punctuation">.</span><span class="token constant">IOWAIT</span><span class="token punctuation">.</span><span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">-</span> prevTicks<span class="token punctuation">[</span><span class="token class-name">CentralProcessor<span class="token punctuation">.</span>TickType</span><span class="token punctuation">.</span><span class="token constant">IOWAIT</span><span class="token punctuation">.</span><span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>        <span class="token keyword">long</span> idle <span class="token operator">=</span> ticks<span class="token punctuation">[</span><span class="token class-name">CentralProcessor<span class="token punctuation">.</span>TickType</span><span class="token punctuation">.</span><span class="token constant">IDLE</span><span class="token punctuation">.</span><span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">-</span> prevTicks<span class="token punctuation">[</span><span class="token class-name">CentralProcessor<span class="token punctuation">.</span>TickType</span><span class="token punctuation">.</span><span class="token constant">IDLE</span><span class="token punctuation">.</span><span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="44"></td><td><pre>        <span class="token keyword">long</span> totalCpu <span class="token operator">=</span> user <span class="token operator">+</span> nice <span class="token operator">+</span> cSys <span class="token operator">+</span> idle <span class="token operator">+</span> iowait <span class="token operator">+</span> irq <span class="token operator">+</span> softirq <span class="token operator">+</span> steal<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="45"></td><td><pre>        <span class="token comment">//cpu 核数</span></pre></td></tr><tr><td data-num="46"></td><td><pre>        cpuInfo<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"cpuNum"</span><span class="token punctuation">,</span> processor<span class="token punctuation">.</span><span class="token function">getLogicalProcessorCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="47"></td><td><pre>        <span class="token comment">//cpu 系统使用率</span></pre></td></tr><tr><td data-num="48"></td><td><pre>        cpuInfo<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"cSys"</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">DecimalFormat</span><span class="token punctuation">(</span><span class="token string">"#.##%"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>cSys <span class="token operator">*</span> <span class="token number">1.0</span> <span class="token operator">/</span> totalCpu<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="49"></td><td><pre>        <span class="token comment">//cpu 用户使用率</span></pre></td></tr><tr><td data-num="50"></td><td><pre>        cpuInfo<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">DecimalFormat</span><span class="token punctuation">(</span><span class="token string">"#.##%"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>user <span class="token operator">*</span> <span class="token number">1.0</span> <span class="token operator">/</span> totalCpu<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="51"></td><td><pre>        <span class="token comment">//cpu 当前等待率</span></pre></td></tr><tr><td data-num="52"></td><td><pre>        cpuInfo<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"iowait"</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">DecimalFormat</span><span class="token punctuation">(</span><span class="token string">"#.##%"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>iowait <span class="token operator">*</span> <span class="token number">1.0</span> <span class="token operator">/</span> totalCpu<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="53"></td><td><pre>        <span class="token comment">//cpu 当前使用率</span></pre></td></tr><tr><td data-num="54"></td><td><pre>        cpuInfo<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"idle"</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">DecimalFormat</span><span class="token punctuation">(</span><span class="token string">"#.##%"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">1.0</span> <span class="token operator">-</span> <span class="token punctuation">(</span>idle <span class="token operator">*</span> <span class="token number">1.0</span> <span class="token operator">/</span> totalCpu<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="55"></td><td><pre>        <span class="token keyword">return</span> cpuInfo<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="56"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="57"></td><td><pre> </pre></td></tr><tr><td data-num="58"></td><td><pre>    <span class="token comment">/**</pre></td></tr><tr><td data-num="59"></td><td><pre>     * 系统 jvm 信息</pre></td></tr><tr><td data-num="60"></td><td><pre>     */</span></pre></td></tr><tr><td data-num="61"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">JSONObject</span> <span class="token function">getJvmInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="62"></td><td><pre>        <span class="token class-name">JSONObject</span> cpuInfo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JSONObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="63"></td><td><pre>        <span class="token class-name">Properties</span> props <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="64"></td><td><pre>        <span class="token class-name">Runtime</span> runtime <span class="token operator">=</span> <span class="token class-name">Runtime</span><span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="65"></td><td><pre>        <span class="token keyword">long</span> jvmTotalMemoryByte <span class="token operator">=</span> runtime<span class="token punctuation">.</span><span class="token function">totalMemory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="66"></td><td><pre>        <span class="token keyword">long</span> freeMemoryByte <span class="token operator">=</span> runtime<span class="token punctuation">.</span><span class="token function">freeMemory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="67"></td><td><pre>        <span class="token comment">//jvm 总内存</span></pre></td></tr><tr><td data-num="68"></td><td><pre>        cpuInfo<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"total"</span><span class="token punctuation">,</span> <span class="token function">formatByte</span><span class="token punctuation">(</span>runtime<span class="token punctuation">.</span><span class="token function">totalMemory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="69"></td><td><pre>        <span class="token comment">// 空闲空间</span></pre></td></tr><tr><td data-num="70"></td><td><pre>        cpuInfo<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"free"</span><span class="token punctuation">,</span> <span class="token function">formatByte</span><span class="token punctuation">(</span>runtime<span class="token punctuation">.</span><span class="token function">freeMemory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="71"></td><td><pre>        <span class="token comment">//jvm 最大可申请</span></pre></td></tr><tr><td data-num="72"></td><td><pre>        cpuInfo<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"max"</span><span class="token punctuation">,</span> <span class="token function">formatByte</span><span class="token punctuation">(</span>runtime<span class="token punctuation">.</span><span class="token function">maxMemory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="73"></td><td><pre>        <span class="token comment">//vm 已使用内存</span></pre></td></tr><tr><td data-num="74"></td><td><pre>        cpuInfo<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">,</span> <span class="token function">formatByte</span><span class="token punctuation">(</span>jvmTotalMemoryByte <span class="token operator">-</span> freeMemoryByte<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="75"></td><td><pre>        <span class="token comment">//jvm 内存使用率</span></pre></td></tr><tr><td data-num="76"></td><td><pre>        cpuInfo<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"usageRate"</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">DecimalFormat</span><span class="token punctuation">(</span><span class="token string">"#.##%"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token punctuation">(</span>jvmTotalMemoryByte <span class="token operator">-</span> freeMemoryByte<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1.0</span> <span class="token operator">/</span> jvmTotalMemoryByte<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="77"></td><td><pre>        <span class="token comment">//jdk 版本</span></pre></td></tr><tr><td data-num="78"></td><td><pre>        cpuInfo<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"jdkVersion"</span><span class="token punctuation">,</span> props<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"java.version"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="79"></td><td><pre>        <span class="token comment">//jdk 路径</span></pre></td></tr><tr><td data-num="80"></td><td><pre>        cpuInfo<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"jdkHome"</span><span class="token punctuation">,</span> props<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"java.home"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="81"></td><td><pre>        <span class="token keyword">return</span> cpuInfo<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="82"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="83"></td><td><pre> </pre></td></tr><tr><td data-num="84"></td><td><pre>    <span class="token comment">/**</pre></td></tr><tr><td data-num="85"></td><td><pre>     * 系统内存信息</pre></td></tr><tr><td data-num="86"></td><td><pre>     */</span></pre></td></tr><tr><td data-num="87"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">JSONObject</span> <span class="token function">getMemInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="88"></td><td><pre>        <span class="token class-name">JSONObject</span> cpuInfo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JSONObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="89"></td><td><pre>        <span class="token class-name">GlobalMemory</span> memory <span class="token operator">=</span> systemInfo<span class="token punctuation">.</span><span class="token function">getHardware</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getMemory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="90"></td><td><pre>        <span class="token comment">// 总内存</span></pre></td></tr><tr><td data-num="91"></td><td><pre>        <span class="token keyword">long</span> totalByte <span class="token operator">=</span> memory<span class="token punctuation">.</span><span class="token function">getTotal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="92"></td><td><pre>        <span class="token comment">// 剩余</span></pre></td></tr><tr><td data-num="93"></td><td><pre>        <span class="token keyword">long</span> acaliableByte <span class="token operator">=</span> memory<span class="token punctuation">.</span><span class="token function">getAvailable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="94"></td><td><pre>        <span class="token comment">// 总内存</span></pre></td></tr><tr><td data-num="95"></td><td><pre>        cpuInfo<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"total"</span><span class="token punctuation">,</span> <span class="token function">formatByte</span><span class="token punctuation">(</span>totalByte<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="96"></td><td><pre>        <span class="token comment">// 使用</span></pre></td></tr><tr><td data-num="97"></td><td><pre>        cpuInfo<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"used"</span><span class="token punctuation">,</span> <span class="token function">formatByte</span><span class="token punctuation">(</span>totalByte <span class="token operator">-</span> acaliableByte<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="98"></td><td><pre>        <span class="token comment">// 剩余内存</span></pre></td></tr><tr><td data-num="99"></td><td><pre>        cpuInfo<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"free"</span><span class="token punctuation">,</span> <span class="token function">formatByte</span><span class="token punctuation">(</span>acaliableByte<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="100"></td><td><pre>        <span class="token comment">// 使用率</span></pre></td></tr><tr><td data-num="101"></td><td><pre>        cpuInfo<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"usageRate"</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">DecimalFormat</span><span class="token punctuation">(</span><span class="token string">"#.##%"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token punctuation">(</span>totalByte <span class="token operator">-</span> acaliableByte<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1.0</span> <span class="token operator">/</span> totalByte<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="102"></td><td><pre>        <span class="token keyword">return</span> cpuInfo<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="103"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="104"></td><td><pre> </pre></td></tr><tr><td data-num="105"></td><td><pre>    <span class="token comment">/**</pre></td></tr><tr><td data-num="106"></td><td><pre>     * 系统盘符信息</pre></td></tr><tr><td data-num="107"></td><td><pre>     */</span></pre></td></tr><tr><td data-num="108"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">JSONArray</span> <span class="token function">getSysFileInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="109"></td><td><pre>        <span class="token class-name">JSONObject</span> cpuInfo<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="110"></td><td><pre>        <span class="token class-name">JSONArray</span> sysFiles <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JSONArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="111"></td><td><pre>        <span class="token class-name">FileSystem</span> fileSystem <span class="token operator">=</span> operatingSystem<span class="token punctuation">.</span><span class="token function">getFileSystem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="112"></td><td><pre>        <span class="token class-name">OSFileStore</span><span class="token punctuation">[</span><span class="token punctuation">]</span> fsArray <span class="token operator">=</span> fileSystem<span class="token punctuation">.</span><span class="token function">getFileStores</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="113"></td><td><pre>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">OSFileStore</span> fs <span class="token operator">:</span> fsArray<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="114"></td><td><pre>            cpuInfo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JSONObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="115"></td><td><pre>            <span class="token comment">// 盘符路径</span></pre></td></tr><tr><td data-num="116"></td><td><pre>            cpuInfo<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"dirName"</span><span class="token punctuation">,</span> fs<span class="token punctuation">.</span><span class="token function">getMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="117"></td><td><pre>            <span class="token comment">// 盘符类型</span></pre></td></tr><tr><td data-num="118"></td><td><pre>            cpuInfo<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"sysTypeName"</span><span class="token punctuation">,</span> fs<span class="token punctuation">.</span><span class="token function">getType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="119"></td><td><pre>            <span class="token comment">// 文件类型</span></pre></td></tr><tr><td data-num="120"></td><td><pre>            cpuInfo<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"typeName"</span><span class="token punctuation">,</span> fs<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="121"></td><td><pre>            <span class="token comment">// 总大小</span></pre></td></tr><tr><td data-num="122"></td><td><pre>            cpuInfo<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"total"</span><span class="token punctuation">,</span> <span class="token function">formatByte</span><span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">getTotalSpace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="123"></td><td><pre>            <span class="token comment">// 剩余大小</span></pre></td></tr><tr><td data-num="124"></td><td><pre>            cpuInfo<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"free"</span><span class="token punctuation">,</span> <span class="token function">formatByte</span><span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">getUsableSpace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="125"></td><td><pre>            <span class="token comment">// 已经使用量</span></pre></td></tr><tr><td data-num="126"></td><td><pre>            cpuInfo<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"used"</span><span class="token punctuation">,</span> <span class="token function">formatByte</span><span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">getTotalSpace</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> fs<span class="token punctuation">.</span><span class="token function">getUsableSpace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="127"></td><td><pre>            <span class="token keyword">if</span> <span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">getTotalSpace</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="128"></td><td><pre>                <span class="token comment">// 资源的使用率</span></pre></td></tr><tr><td data-num="129"></td><td><pre>                cpuInfo<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"usage"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="130"></td><td><pre>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="131"></td><td><pre>                cpuInfo<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"usage"</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">DecimalFormat</span><span class="token punctuation">(</span><span class="token string">"#.##%"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">getTotalSpace</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> fs<span class="token punctuation">.</span><span class="token function">getUsableSpace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1.0</span> <span class="token operator">/</span> fs<span class="token punctuation">.</span><span class="token function">getTotalSpace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="132"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="133"></td><td><pre>            sysFiles<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>cpuInfo<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="134"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="135"></td><td><pre>        <span class="token keyword">return</span> sysFiles<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="136"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="137"></td><td><pre> </pre></td></tr><tr><td data-num="138"></td><td><pre>    <span class="token comment">/**</pre></td></tr><tr><td data-num="139"></td><td><pre>     * 系统信息</pre></td></tr><tr><td data-num="140"></td><td><pre>     */</span></pre></td></tr><tr><td data-num="141"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">JSONObject</span> <span class="token function">getSysInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">UnknownHostException</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="142"></td><td><pre>        <span class="token class-name">JSONObject</span> cpuInfo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JSONObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="143"></td><td><pre>        <span class="token class-name">Properties</span> props <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="144"></td><td><pre>        <span class="token comment">// 操作系统名</span></pre></td></tr><tr><td data-num="145"></td><td><pre>        cpuInfo<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"osName"</span><span class="token punctuation">,</span> props<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"os.name"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="146"></td><td><pre>        <span class="token comment">// 系统架构</span></pre></td></tr><tr><td data-num="147"></td><td><pre>        cpuInfo<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"osArch"</span><span class="token punctuation">,</span> props<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"os.arch"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="148"></td><td><pre>        <span class="token comment">// 服务器名称</span></pre></td></tr><tr><td data-num="149"></td><td><pre>        cpuInfo<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"computerName"</span><span class="token punctuation">,</span> <span class="token class-name">InetAddress</span><span class="token punctuation">.</span><span class="token function">getLocalHost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getHostName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="150"></td><td><pre>        <span class="token comment">// 服务器 Ip</span></pre></td></tr><tr><td data-num="151"></td><td><pre>        cpuInfo<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"computerIp"</span><span class="token punctuation">,</span> <span class="token class-name">InetAddress</span><span class="token punctuation">.</span><span class="token function">getLocalHost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getHostAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="152"></td><td><pre>        <span class="token comment">// 项目路径</span></pre></td></tr><tr><td data-num="153"></td><td><pre>        cpuInfo<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"userDir"</span><span class="token punctuation">,</span> props<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"user.dir"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="154"></td><td><pre>        <span class="token keyword">return</span> cpuInfo<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="155"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="156"></td><td><pre> </pre></td></tr><tr><td data-num="157"></td><td><pre>    <span class="token comment">/**</pre></td></tr><tr><td data-num="158"></td><td><pre>     * 所有系统信息</pre></td></tr><tr><td data-num="159"></td><td><pre>     */</span></pre></td></tr><tr><td data-num="160"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">JSONObject</span> <span class="token function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">UnknownHostException</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="161"></td><td><pre>        <span class="token class-name">JSONObject</span> info <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JSONObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="162"></td><td><pre>        info<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"cpuInfo"</span><span class="token punctuation">,</span> <span class="token function">getCpuInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="163"></td><td><pre>        info<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"jvmInfo"</span><span class="token punctuation">,</span> <span class="token function">getJvmInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="164"></td><td><pre>        info<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"memInfo"</span><span class="token punctuation">,</span> <span class="token function">getMemInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="165"></td><td><pre>        info<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"sysInfo"</span><span class="token punctuation">,</span> <span class="token function">getSysInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="166"></td><td><pre>        info<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"sysFileInfo"</span><span class="token punctuation">,</span> <span class="token function">getSysFileInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="167"></td><td><pre>        <span class="token keyword">return</span> info<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="168"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="169"></td><td><pre> </pre></td></tr><tr><td data-num="170"></td><td><pre>    <span class="token comment">/**</pre></td></tr><tr><td data-num="171"></td><td><pre>     * 单位转换</pre></td></tr><tr><td data-num="172"></td><td><pre>     */</span></pre></td></tr><tr><td data-num="173"></td><td><pre>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">formatByte</span><span class="token punctuation">(</span><span class="token keyword">long</span> byteNumber<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="174"></td><td><pre>        <span class="token comment">// 换算单位</span></pre></td></tr><tr><td data-num="175"></td><td><pre>        <span class="token keyword">double</span> <span class="token constant">FORMAT</span> <span class="token operator">=</span> <span class="token number">1024.0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="176"></td><td><pre>        <span class="token keyword">double</span> kbNumber <span class="token operator">=</span> byteNumber <span class="token operator">/</span> <span class="token constant">FORMAT</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="177"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span>kbNumber <span class="token operator">&lt;</span> <span class="token constant">FORMAT</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="178"></td><td><pre>            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">DecimalFormat</span><span class="token punctuation">(</span><span class="token string">"#.##KB"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>kbNumber<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="179"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="180"></td><td><pre>        <span class="token keyword">double</span> mbNumber <span class="token operator">=</span> kbNumber <span class="token operator">/</span> <span class="token constant">FORMAT</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="181"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span>mbNumber <span class="token operator">&lt;</span> <span class="token constant">FORMAT</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="182"></td><td><pre>            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">DecimalFormat</span><span class="token punctuation">(</span><span class="token string">"#.##MB"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>mbNumber<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="183"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="184"></td><td><pre>        <span class="token keyword">double</span> gbNumber <span class="token operator">=</span> mbNumber <span class="token operator">/</span> <span class="token constant">FORMAT</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="185"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span>gbNumber <span class="token operator">&lt;</span> <span class="token constant">FORMAT</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="186"></td><td><pre>            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">DecimalFormat</span><span class="token punctuation">(</span><span class="token string">"#.##GB"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>gbNumber<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="187"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="188"></td><td><pre>        <span class="token keyword">double</span> tbNumber <span class="token operator">=</span> gbNumber <span class="token operator">/</span> <span class="token constant">FORMAT</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="189"></td><td><pre>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">DecimalFormat</span><span class="token punctuation">(</span><span class="token string">"#.##TB"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>tbNumber<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="190"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="191"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;获取系统信息oshi-core&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#获取系统信息oshi-core&quot;&gt;#&lt;/a&gt; 获取系统信息 (oshi-core)&lt;/h1&gt;
&lt;h2 id=&quot;1-maven&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#1</summary>
      
    
    
    
    <category term="计算机学科" scheme="https://pigpigletsgo.github.io/categories/computer-science/"/>
    
    <category term="java" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/"/>
    
    <category term="第三方库" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/"/>
    
    
    <category term="计算机学科" scheme="https://pigpigletsgo.github.io/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%AD%A6%E7%A7%91/"/>
    
    <category term="第三方库" scheme="https://pigpigletsgo.github.io/tags/%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/"/>
    
    <category term="oshicore" scheme="https://pigpigletsgo.github.io/tags/oshicore/"/>
    
  </entry>
  
  <entry>
    <title>解析shp文件</title>
    <link href="https://pigpigletsgo.github.io/computer-science/java/%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/%E8%A7%A3%E6%9E%90shp%E6%96%87%E4%BB%B6/"/>
    <id>https://pigpigletsgo.github.io/computer-science/java/%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/%E8%A7%A3%E6%9E%90shp%E6%96%87%E4%BB%B6/</id>
    <published>2024-05-28T09:32:37.067Z</published>
    <updated>2024-05-29T00:07:17.727Z</updated>
    
    <content type="html"><![CDATA[<h1 id="解析shp文件"><a class="anchor" href="#解析shp文件">#</a> 解析 shp 文件</h1><p><strong>导入依赖</strong></p><figure class="highlight xml"><figcaption data-lang="XML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">&lt;!-- shp 文件解析 --></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.gdal<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="4"></td><td><pre>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>gdal<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>3.5.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="8"></td><td><pre>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>net.postgis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="9"></td><td><pre>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>postgis-jdbc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="10"></td><td><pre>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.5.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token comment">&lt;!-- 解析 shp 文件 --></span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="15"></td><td><pre>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.geotools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="16"></td><td><pre>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>gt-shapefile<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="17"></td><td><pre>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>25.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="19"></td><td><pre></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="21"></td><td><pre>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.geotools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="22"></td><td><pre>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>gt-epsg-wkt<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="23"></td><td><pre>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>25.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="25"></td><td><pre></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="27"></td><td><pre>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.geotools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="28"></td><td><pre>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>gt-geojson<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="29"></td><td><pre>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>25.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><h2 id="controller"><a class="anchor" href="#controller">#</a> controller</h2><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">/**</pre></td></tr><tr><td data-num="2"></td><td><pre>  * 上传 zip 解压 shp 文件信息存入数据库</pre></td></tr><tr><td data-num="3"></td><td><pre>  * @author 窦凯欣</pre></td></tr><tr><td data-num="4"></td><td><pre>  */</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"上传zip解压shp文件信息存入数据库"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token annotation punctuation">@Anonymous</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"/mineLayersController/uploadShp"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">uploadShp</span><span class="token punctuation">(</span><span class="token annotation punctuation">@NotNull</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">"没有上传相关文件"</span><span class="token punctuation">)</span> <span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">MultipartFile</span> file<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>   ksTcService<span class="token punctuation">.</span><span class="token function">uploadShp</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h2 id="serviceimpl"><a class="anchor" href="#serviceimpl">#</a> serviceImpl</h2><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">/**</pre></td></tr><tr><td data-num="2"></td><td><pre>     * 上传 zip 解压 shp 文件信息存入数据库</pre></td></tr><tr><td data-num="3"></td><td><pre>     * @param file</pre></td></tr><tr><td data-num="4"></td><td><pre>     * @throws IOException</pre></td></tr><tr><td data-num="5"></td><td><pre>     * @author 窦凯欣</pre></td></tr><tr><td data-num="6"></td><td><pre>     */</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token annotation punctuation">@Override</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">uploadShp</span><span class="token punctuation">(</span><span class="token class-name">MultipartFile</span> file<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>   <span class="token comment">// 创建临时目录</span></pre></td></tr><tr><td data-num="10"></td><td><pre>   <span class="token class-name">Path</span> tempDir <span class="token operator">=</span> <span class="token class-name">Files</span><span class="token punctuation">.</span><span class="token function">createTempDirectory</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>   <span class="token comment">// 创建临时 ZIP 文件</span></pre></td></tr><tr><td data-num="12"></td><td><pre>   <span class="token class-name">File</span> zipFile <span class="token operator">=</span> <span class="token class-name">Files</span><span class="token punctuation">.</span><span class="token function">createTempFile</span><span class="token punctuation">(</span>tempDir<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">".zip"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>   file<span class="token punctuation">.</span><span class="token function">transferTo</span><span class="token punctuation">(</span>zipFile<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>   <span class="token comment">// 判断是否为 zip 文件</span></pre></td></tr><tr><td data-num="15"></td><td><pre>   <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">ZipUtil</span><span class="token punctuation">.</span><span class="token function">isZipFile</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre>   <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"请上传zip文件"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>   <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>   <span class="token comment">// 解压 ZIP 文件</span></pre></td></tr><tr><td data-num="20"></td><td><pre>   <span class="token class-name">File</span> unzipDir <span class="token operator">=</span> <span class="token class-name">Files</span><span class="token punctuation">.</span><span class="token function">createTempDirectory</span><span class="token punctuation">(</span>tempDir<span class="token punctuation">,</span> <span class="token string">"unzip"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>   <span class="token class-name"><span class="token namespace">cn<span class="token punctuation">.</span>hutool<span class="token punctuation">.</span>core<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span>ZipUtil</span><span class="token punctuation">.</span><span class="token function">unzip</span><span class="token punctuation">(</span>zipFile<span class="token punctuation">,</span> unzipDir<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>   <span class="token comment">// 查找解压后的 SHP 文件</span></pre></td></tr><tr><td data-num="23"></td><td><pre>   <span class="token class-name">File</span> shpFile <span class="token operator">=</span> <span class="token class-name">Files</span><span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span>unzipDir<span class="token punctuation">.</span><span class="token function">toPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre>      <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>path <span class="token operator">-></span> path<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token string">".shp"</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre>      <span class="token punctuation">.</span><span class="token function">findFirst</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="26"></td><td><pre>      <span class="token punctuation">.</span><span class="token function">orElseThrow</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token keyword">new</span> <span class="token class-name">IOException</span><span class="token punctuation">(</span><span class="token string">"Shapefile not found"</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="27"></td><td><pre>      <span class="token punctuation">.</span><span class="token function">toFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>   <span class="token comment">// 读取 SHP 文件</span></pre></td></tr><tr><td data-num="29"></td><td><pre>   <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">></span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>   <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>      map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"url"</span><span class="token punctuation">,</span> shpFile<span class="token punctuation">.</span><span class="token function">toURI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toURL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>      <span class="token comment">// 处理编码问题</span></pre></td></tr><tr><td data-num="33"></td><td><pre>      map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"charset"</span><span class="token punctuation">,</span> <span class="token class-name">Charset</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token function">getShapeFileCharsetName</span><span class="token punctuation">(</span>shpFile<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>   <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IOException</span><span class="token punctuation">(</span><span class="token string">"Invalid shapefile URL"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>   <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>   <span class="token comment">// 创建工厂对象</span></pre></td></tr><tr><td data-num="38"></td><td><pre>   <span class="token class-name">ShapefileDataStoreFactory</span> dataStoreFactory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ShapefileDataStoreFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="39"></td><td><pre>   <span class="token class-name">ShapefileDataStore</span> dataStore <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">ShapefileDataStore</span><span class="token punctuation">)</span> dataStoreFactory<span class="token punctuation">.</span><span class="token function">createDataStore</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="40"></td><td><pre>   <span class="token comment">// 读取要素</span></pre></td></tr><tr><td data-num="41"></td><td><pre>   <span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">SimpleFeatureIterator</span> iterator <span class="token operator">=</span> dataStore<span class="token punctuation">.</span><span class="token function">getFeatureSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getFeatures</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">features</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="42"></td><td><pre>      <span class="token keyword">while</span> <span class="token punctuation">(</span>iterator<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>         <span class="token class-name">SimpleFeature</span> feature <span class="token operator">=</span> iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="44"></td><td><pre>         <span class="token class-name">Iterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Property</span><span class="token punctuation">></span></span> it <span class="token operator">=</span> feature<span class="token punctuation">.</span><span class="token function">getProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="45"></td><td><pre>         <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">></span></span> mapr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="46"></td><td><pre>         <span class="token class-name">KsTc</span> ksTc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">KsTc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="47"></td><td><pre>         <span class="token keyword">while</span><span class="token punctuation">(</span>it<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="48"></td><td><pre>         <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="49"></td><td><pre>            <span class="token class-name">Property</span> next <span class="token operator">=</span> it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="50"></td><td><pre>            <span class="token comment">// 将解析 shp 文件的数据以 Key_Value 形式存储到 map 集合中</span></pre></td></tr><tr><td data-num="51"></td><td><pre>            mapr<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>next<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> next<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="52"></td><td><pre>         <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="53"></td><td><pre>         <span class="token comment">// 添加 ks_tc 数据</span></pre></td></tr><tr><td data-num="54"></td><td><pre>         <span class="token function">setData</span><span class="token punctuation">(</span>mapr<span class="token punctuation">,</span> ksTc<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="55"></td><td><pre>      <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="56"></td><td><pre>   <span class="token punctuation">&#125;</span> <span class="token keyword">finally</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="57"></td><td><pre>      <span class="token comment">// 释放资源</span></pre></td></tr><tr><td data-num="58"></td><td><pre>      dataStore<span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="59"></td><td><pre>   <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="60"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="61"></td><td><pre><span class="token comment">/**</pre></td></tr><tr><td data-num="62"></td><td><pre>     * 添加 ks_tc 数据</pre></td></tr><tr><td data-num="63"></td><td><pre>     * @param mapr</pre></td></tr><tr><td data-num="64"></td><td><pre>     * @param ksTc</pre></td></tr><tr><td data-num="65"></td><td><pre>     * @author 窦凯欣</pre></td></tr><tr><td data-num="66"></td><td><pre>     */</span></pre></td></tr><tr><td data-num="67"></td><td><pre><span class="token annotation punctuation">@SneakyThrows</span></pre></td></tr><tr><td data-num="68"></td><td><pre><span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">setData</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">></span></span> mapr<span class="token punctuation">,</span> <span class="token class-name">KsTc</span> ksTc<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="69"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="70"></td><td><pre>   <span class="token comment">// 将 map 数据转换为 JSON 字符串</span></pre></td></tr><tr><td data-num="71"></td><td><pre>   <span class="token class-name">String</span> jsonString <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>mapr<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="72"></td><td><pre>   <span class="token comment">// 将 json 格式的字符传转换为对象</span></pre></td></tr><tr><td data-num="73"></td><td><pre>   <span class="token class-name">KsTcParam</span> ksTcParam <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parseObject</span><span class="token punctuation">(</span>jsonString<span class="token punctuation">,</span> <span class="token class-name">KsTcParam</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="74"></td><td><pre>   <span class="token class-name">String</span> geom <span class="token operator">=</span> ksTcParam<span class="token punctuation">.</span><span class="token function">getThe_geom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="75"></td><td><pre>   <span class="token class-name">String</span> geomValue <span class="token operator">=</span> <span class="token function">projectionToGeography</span><span class="token punctuation">(</span>geom<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="76"></td><td><pre>   <span class="token comment">// 设置对象属性数据</span></pre></td></tr><tr><td data-num="77"></td><td><pre>   ksTc<span class="token punctuation">.</span><span class="token function">setXkzh</span><span class="token punctuation">(</span>ksTcParam<span class="token punctuation">.</span><span class="token function">getXKZ</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="78"></td><td><pre>   <span class="token class-name">String</span> monthAndYaer <span class="token operator">=</span> ksTcParam<span class="token punctuation">.</span><span class="token function">getYXQZ</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="79"></td><td><pre>   <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> split <span class="token operator">=</span> monthAndYaer<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="80"></td><td><pre>   ksTc<span class="token punctuation">.</span><span class="token function">setMonth</span><span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>split<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="81"></td><td><pre>   ksTc<span class="token punctuation">.</span><span class="token function">setYear</span><span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>split<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="82"></td><td><pre>   ksTc<span class="token punctuation">.</span><span class="token function">setLon</span><span class="token punctuation">(</span>ksTcParam<span class="token punctuation">.</span><span class="token function">getZBX</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="83"></td><td><pre>   ksTc<span class="token punctuation">.</span><span class="token function">setGeom</span><span class="token punctuation">(</span>geomValue<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="84"></td><td><pre>   ksTc<span class="token punctuation">.</span><span class="token function">setLat</span><span class="token punctuation">(</span>ksTcParam<span class="token punctuation">.</span><span class="token function">getZBY</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="85"></td><td><pre>   ksTc<span class="token punctuation">.</span><span class="token function">setWtlx</span><span class="token punctuation">(</span>ksTcParam<span class="token punctuation">.</span><span class="token function">getWTLX</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="86"></td><td><pre>   ksTc<span class="token punctuation">.</span><span class="token function">setZdfs</span><span class="token punctuation">(</span>ksTcParam<span class="token punctuation">.</span><span class="token function">getZDFS</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="87"></td><td><pre>   ksTc<span class="token punctuation">.</span><span class="token function">setKczt</span><span class="token punctuation">(</span>ksTcParam<span class="token punctuation">.</span><span class="token function">getKCZT</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="88"></td><td><pre>   ksTc<span class="token punctuation">.</span><span class="token function">setZdmj</span><span class="token punctuation">(</span>ksTcParam<span class="token punctuation">.</span><span class="token function">getZDMJ</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="89"></td><td><pre>   ksTc<span class="token punctuation">.</span><span class="token function">setDt</span><span class="token punctuation">(</span>ksTcParam<span class="token punctuation">.</span><span class="token function">getDT</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="90"></td><td><pre>   <span class="token comment">// 添加数据</span></pre></td></tr><tr><td data-num="91"></td><td><pre>   ksTcxMapper<span class="token punctuation">.</span><span class="token function">addData</span><span class="token punctuation">(</span>ksTc<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="92"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="93"></td><td><pre></pre></td></tr><tr><td data-num="94"></td><td><pre><span class="token comment">/**</pre></td></tr><tr><td data-num="95"></td><td><pre>  * 投影坐标 --> 地理坐标</pre></td></tr><tr><td data-num="96"></td><td><pre>  * @param geo</pre></td></tr><tr><td data-num="97"></td><td><pre>  * @author 窦凯欣</pre></td></tr><tr><td data-num="98"></td><td><pre>  */</span></pre></td></tr><tr><td data-num="99"></td><td><pre><span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">projectionToGeography</span><span class="token punctuation">(</span><span class="token class-name">String</span> geo<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="100"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="101"></td><td><pre>   <span class="token comment">// 确定 ( 的位置</span></pre></td></tr><tr><td data-num="102"></td><td><pre>   <span class="token keyword">int</span> i <span class="token operator">=</span> geo<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">"("</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="103"></td><td><pre>   <span class="token comment">// 获取经纬度</span></pre></td></tr><tr><td data-num="104"></td><td><pre>   <span class="token class-name">String</span> value <span class="token operator">=</span> geo<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">,</span> geo<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="105"></td><td><pre>   <span class="token comment">// 将经纬度字符串以逗号分隔</span></pre></td></tr><tr><td data-num="106"></td><td><pre>   <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> split <span class="token operator">=</span> value<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="107"></td><td><pre>   <span class="token comment">// 用于存储转换后的几何数据</span></pre></td></tr><tr><td data-num="108"></td><td><pre>   <span class="token class-name">StringBuffer</span> sb <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="109"></td><td><pre>   <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> s <span class="token operator">:</span> split<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="110"></td><td><pre>   <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="111"></td><td><pre>      <span class="token comment">// 构建 WKT 格式的点</span></pre></td></tr><tr><td data-num="112"></td><td><pre>      <span class="token class-name">String</span> wkt <span class="token operator">=</span> <span class="token string">"POINT ("</span> <span class="token operator">+</span> s <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="113"></td><td><pre>      <span class="token comment">// 创建源几何对象</span></pre></td></tr><tr><td data-num="114"></td><td><pre>      <span class="token class-name">Geometry</span> source <span class="token operator">=</span> <span class="token class-name">CoordinateUtil</span><span class="token punctuation">.</span><span class="token function">createGeometry</span><span class="token punctuation">(</span>wkt<span class="token punctuation">,</span> <span class="token number">4524</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="115"></td><td><pre>      <span class="token comment">// 进行坐标转换</span></pre></td></tr><tr><td data-num="116"></td><td><pre>      <span class="token class-name">Geometry</span> res <span class="token operator">=</span> <span class="token class-name">CoordinateUtil</span><span class="token punctuation">.</span><span class="token function">coordinateTransform</span><span class="token punctuation">(</span>source<span class="token punctuation">,</span> <span class="token number">4490</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="117"></td><td><pre>      <span class="token comment">// 将转换后的几何对象转换为字符串</span></pre></td></tr><tr><td data-num="118"></td><td><pre>      <span class="token class-name">String</span> resStr <span class="token operator">=</span> res<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="119"></td><td><pre>      <span class="token comment">// 获取几何数据的坐标部分</span></pre></td></tr><tr><td data-num="120"></td><td><pre>      <span class="token keyword">int</span> index <span class="token operator">=</span> resStr<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">"("</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="121"></td><td><pre>      <span class="token comment">// 将坐标部分添加到 StringBuffer 中</span></pre></td></tr><tr><td data-num="122"></td><td><pre>      sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>resStr<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> resStr<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">", "</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="123"></td><td><pre>   <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="124"></td><td><pre>   <span class="token comment">// 构建 MULTIPOLYGON 格式的字符串，并返回</span></pre></td></tr><tr><td data-num="125"></td><td><pre>   <span class="token keyword">return</span> <span class="token string">"MULTIPOLYGON((("</span> <span class="token operator">+</span> sb<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> sb<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")))"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="126"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="127"></td><td><pre></pre></td></tr><tr><td data-num="128"></td><td><pre><span class="token comment">/**</pre></td></tr><tr><td data-num="129"></td><td><pre>  * 设置字符编码</pre></td></tr><tr><td data-num="130"></td><td><pre>  * @param file</pre></td></tr><tr><td data-num="131"></td><td><pre>  * @throws Exception</pre></td></tr><tr><td data-num="132"></td><td><pre>  * @author 窦凯欣</pre></td></tr><tr><td data-num="133"></td><td><pre>  */</span></pre></td></tr><tr><td data-num="134"></td><td><pre><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">getShapeFileCharsetName</span><span class="token punctuation">(</span><span class="token class-name">File</span> file<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="135"></td><td><pre>   <span class="token keyword">if</span> <span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>file<span class="token punctuation">.</span><span class="token function">isFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="136"></td><td><pre>      <span class="token keyword">return</span> <span class="token string">"GBK"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="137"></td><td><pre>   <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="138"></td><td><pre>   <span class="token class-name">String</span> encode <span class="token operator">=</span> <span class="token string">"GBK"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="139"></td><td><pre>   <span class="token class-name">BufferedReader</span> reader <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="140"></td><td><pre>   <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="141"></td><td><pre>      reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedReader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="142"></td><td><pre>      <span class="token class-name">String</span> tempString <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="143"></td><td><pre>      <span class="token comment">// 一次读入一行，直到读入 null 为文件结束</span></pre></td></tr><tr><td data-num="144"></td><td><pre>      <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>tempString <span class="token operator">=</span> reader<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="145"></td><td><pre>         <span class="token comment">// 显示行号</span></pre></td></tr><tr><td data-num="146"></td><td><pre>         <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">"UTF-8"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>tempString<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="147"></td><td><pre>            encode <span class="token operator">=</span> <span class="token string">"UTF-8"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="148"></td><td><pre>            <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="149"></td><td><pre>         <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="150"></td><td><pre>         <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="151"></td><td><pre>      <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="152"></td><td><pre>      reader<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="153"></td><td><pre>   <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="154"></td><td><pre>      e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="155"></td><td><pre>   <span class="token punctuation">&#125;</span> <span class="token keyword">finally</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="156"></td><td><pre>      <span class="token keyword">if</span> <span class="token punctuation">(</span>reader <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="157"></td><td><pre>         <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="158"></td><td><pre>            reader<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="159"></td><td><pre>         <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="160"></td><td><pre>         <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="161"></td><td><pre>      <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="162"></td><td><pre>   <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="163"></td><td><pre>   <span class="token keyword">return</span> encode<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="164"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h2 id="工具类"><a class="anchor" href="#工具类">#</a> 工具类</h2><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ruoyi<span class="token punctuation">.</span>utils</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">cn<span class="token punctuation">.</span>hutool<span class="token punctuation">.</span>core<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">StrUtil</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>fhs<span class="token punctuation">.</span>common<span class="token punctuation">.</span>utils<span class="token punctuation">.</span></span><span class="token class-name">StringUtil</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>ruoyi<span class="token punctuation">.</span>common<span class="token punctuation">.</span>exception<span class="token punctuation">.</span></span><span class="token class-name">ServiceException</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>ruoyi<span class="token punctuation">.</span>common<span class="token punctuation">.</span>utils<span class="token punctuation">.</span></span><span class="token class-name">StringUtils</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>collections4<span class="token punctuation">.</span>map<span class="token punctuation">.</span></span><span class="token class-name">LinkedMap</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>geotools<span class="token punctuation">.</span>geometry<span class="token punctuation">.</span>jts<span class="token punctuation">.</span></span><span class="token class-name">JTS</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>geotools<span class="token punctuation">.</span>geometry<span class="token punctuation">.</span>jts<span class="token punctuation">.</span></span><span class="token class-name">JTSFactoryFinder</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>geotools<span class="token punctuation">.</span>geometry<span class="token punctuation">.</span>jts<span class="token punctuation">.</span></span><span class="token class-name">WKTReader2</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>geotools<span class="token punctuation">.</span>referencing<span class="token punctuation">.</span></span><span class="token class-name">CRS</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>locationtech<span class="token punctuation">.</span>jts<span class="token punctuation">.</span>geom<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>locationtech<span class="token punctuation">.</span>jts<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">ParseException</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>locationtech<span class="token punctuation">.</span>jts<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">WKTReader</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>opengis<span class="token punctuation">.</span>feature<span class="token punctuation">.</span>simple<span class="token punctuation">.</span></span><span class="token class-name">SimpleFeature</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>opengis<span class="token punctuation">.</span>referencing<span class="token punctuation">.</span></span><span class="token class-name">FactoryException</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>opengis<span class="token punctuation">.</span>referencing<span class="token punctuation">.</span>crs<span class="token punctuation">.</span></span><span class="token class-name">CRSAuthorityFactory</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>opengis<span class="token punctuation">.</span>referencing<span class="token punctuation">.</span>crs<span class="token punctuation">.</span></span><span class="token class-name">CoordinateReferenceSystem</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>opengis<span class="token punctuation">.</span>referencing<span class="token punctuation">.</span>operation<span class="token punctuation">.</span></span><span class="token class-name">MathTransform</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>opengis<span class="token punctuation">.</span>referencing<span class="token punctuation">.</span>operation<span class="token punctuation">.</span></span><span class="token class-name">TransformException</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>stream<span class="token punctuation">.</span></span><span class="token class-name">Collectors</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token comment">/**</pre></td></tr><tr><td data-num="26"></td><td><pre> * 坐标工具</pre></td></tr><tr><td data-num="27"></td><td><pre> *</pre></td></tr><tr><td data-num="28"></td><td><pre> * @liuliya</pre></td></tr><tr><td data-num="29"></td><td><pre> */</span></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CoordinateUtil</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token comment">// WGS84 标准参考椭球中的地球长半径 (单位：米)</span></pre></td></tr><tr><td data-num="32"></td><td><pre>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">double</span> <span class="token constant">EARTH_RADIUS_WGS84</span> <span class="token operator">=</span> <span class="token number">6378137.0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="33"></td><td><pre></pre></td></tr><tr><td data-num="34"></td><td><pre>    <span class="token comment">// 十进制经度</span></pre></td></tr><tr><td data-num="35"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">LNG_PATTERN</span> <span class="token operator">=</span> <span class="token string">"^[\\-\\+]?(0(\\.\\d&#123;1,14&#125;)?|([1-9](\\d)?)(\\.\\d&#123;1,14&#125;)?|1[0-7]\\d&#123;1&#125;(\\.\\d&#123;1,14&#125;)?|180(\\.0&#123;1,14&#125;)?)$"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>    <span class="token comment">// 纬度</span></pre></td></tr><tr><td data-num="37"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">LAT_PATTERN</span> <span class="token operator">=</span> <span class="token string">"^[\\-\\+]?((0|([1-8]\\d?))(\\.\\d&#123;1,14&#125;)?|90(\\.0&#123;1,14&#125;)?)$"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>    <span class="token comment">/*</pre></td></tr><tr><td data-num="39"></td><td><pre>     * 度分秒正则</pre></td></tr><tr><td data-num="40"></td><td><pre>     * 每节的数字不能以 0 开头（比如不能写 08 度，而要写 8 度）；</pre></td></tr><tr><td data-num="41"></td><td><pre>     * 秒的数字可以是小数，小数点后最多有两位数字；</pre></td></tr><tr><td data-num="42"></td><td><pre>     * 分隔三个节的标志符可以是空格、中横线、逗号、分号、°′" 或者度分秒；</pre></td></tr><tr><td data-num="43"></td><td><pre>     * 取值范围，经度为 0 度 0 分 0 秒 至 180 度 0 分 0 秒；纬度为 0 度 0 分 0 秒 至 90 度 0 分 0 秒。</pre></td></tr><tr><td data-num="44"></td><td><pre>     * */</span></pre></td></tr><tr><td data-num="45"></td><td><pre>    <span class="token comment">// 经度</span></pre></td></tr><tr><td data-num="46"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">LNG_PATTERN_D</span> <span class="token operator">=</span> <span class="token string">"^((\\d|[1-9]\\d|1[0-7]\\d)[°](\\d|[0-5]\\d)[′](\\d|[0-5]\\d)(\\.\\d&#123;1,6&#125;)?[\\″]$)|(180[°]0[′]0[\\″]$)"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="47"></td><td><pre>    <span class="token comment">// 纬度</span></pre></td></tr><tr><td data-num="48"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">LAT_PATTERN_D</span> <span class="token operator">=</span> <span class="token string">"^((\\d|[1-8]\\d)[°](\\d|[0-5]\\d)[′](\\d|[0-5]\\d)(\\.\\d&#123;1,6&#125;)?[\\″]$)|(90[°]0[′]0[\\″]$)"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="49"></td><td><pre>    <span class="token comment">/**</pre></td></tr><tr><td data-num="50"></td><td><pre>     * 计算两个坐标的距离 (粗略计算，单位：米)</pre></td></tr><tr><td data-num="51"></td><td><pre>     * 计算公式参照 google map 的距离计算</pre></td></tr><tr><td data-num="52"></td><td><pre>     *</pre></td></tr><tr><td data-num="53"></td><td><pre>     * @param lat1 坐标 1 纬度</pre></td></tr><tr><td data-num="54"></td><td><pre>     * @param lng1 坐标 1 经度</pre></td></tr><tr><td data-num="55"></td><td><pre>     * @param lat2 坐标 2 纬度</pre></td></tr><tr><td data-num="56"></td><td><pre>     * @param lng2 坐标 2 经度</pre></td></tr><tr><td data-num="57"></td><td><pre>     * @return</pre></td></tr><tr><td data-num="58"></td><td><pre>     */</span></pre></td></tr><tr><td data-num="59"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">double</span> <span class="token function">distance</span><span class="token punctuation">(</span><span class="token keyword">double</span> lat1<span class="token punctuation">,</span> <span class="token keyword">double</span> lng1<span class="token punctuation">,</span> <span class="token keyword">double</span> lat2<span class="token punctuation">,</span> <span class="token keyword">double</span> lng2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="60"></td><td><pre>        <span class="token keyword">double</span> radLat1 <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">toRadians</span><span class="token punctuation">(</span>lat1<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="61"></td><td><pre>        <span class="token keyword">double</span> radLat2 <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">toRadians</span><span class="token punctuation">(</span>lat2<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="62"></td><td><pre></pre></td></tr><tr><td data-num="63"></td><td><pre>        <span class="token keyword">double</span> a <span class="token operator">=</span> radLat1 <span class="token operator">-</span> radLat2<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="64"></td><td><pre>        <span class="token keyword">double</span> b <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">toRadians</span><span class="token punctuation">(</span>lng1<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">toRadians</span><span class="token punctuation">(</span>lng2<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="65"></td><td><pre></pre></td></tr><tr><td data-num="66"></td><td><pre>        <span class="token keyword">double</span> s <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">asin</span><span class="token punctuation">(</span><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>a <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span></pre></td></tr><tr><td data-num="67"></td><td><pre>                <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>radLat1<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>radLat2<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>b <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="68"></td><td><pre>        <span class="token keyword">return</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span>s <span class="token operator">*</span> <span class="token constant">EARTH_RADIUS_WGS84</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="69"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="70"></td><td><pre></pre></td></tr><tr><td data-num="71"></td><td><pre>    <span class="token comment">/**</pre></td></tr><tr><td data-num="72"></td><td><pre>     * 度分秒转十进制度</pre></td></tr><tr><td data-num="73"></td><td><pre>     *</pre></td></tr><tr><td data-num="74"></td><td><pre>     * @param jwd</pre></td></tr><tr><td data-num="75"></td><td><pre>     * @return</pre></td></tr><tr><td data-num="76"></td><td><pre>     */</span></pre></td></tr><tr><td data-num="77"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token class-name">Dms2D</span><span class="token punctuation">(</span><span class="token class-name">String</span> jwd<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="78"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StrUtil</span><span class="token punctuation">.</span><span class="token function">isNotEmpty</span><span class="token punctuation">(</span>jwd<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>jwd<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"°"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// 如果不为空并且存在度单位</span></pre></td></tr><tr><td data-num="79"></td><td><pre>            <span class="token comment">// 计算前进行数据处理</span></pre></td></tr><tr><td data-num="80"></td><td><pre>            jwd <span class="token operator">=</span> jwd<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">"E"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">"N"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">"："</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="81"></td><td><pre>            <span class="token keyword">double</span> d <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> m <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> s <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="82"></td><td><pre>            d <span class="token operator">=</span> <span class="token class-name">Double</span><span class="token punctuation">.</span><span class="token function">parseDouble</span><span class="token punctuation">(</span>jwd<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"°"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="83"></td><td><pre>            <span class="token comment">// 不同单位的分，可扩展</span></pre></td></tr><tr><td data-num="84"></td><td><pre>            <span class="token keyword">if</span> <span class="token punctuation">(</span>jwd<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"′"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// 正常的′</span></pre></td></tr><tr><td data-num="85"></td><td><pre>                m <span class="token operator">=</span> <span class="token class-name">Double</span><span class="token punctuation">.</span><span class="token function">parseDouble</span><span class="token punctuation">(</span>jwd<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"°"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"′"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="86"></td><td><pre>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>jwd<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// 特殊的'</span></pre></td></tr><tr><td data-num="87"></td><td><pre>                m <span class="token operator">=</span> <span class="token class-name">Double</span><span class="token punctuation">.</span><span class="token function">parseDouble</span><span class="token punctuation">(</span>jwd<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"°"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="88"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="89"></td><td><pre>            <span class="token comment">// 不同单位的秒，可扩展</span></pre></td></tr><tr><td data-num="90"></td><td><pre>            <span class="token keyword">if</span> <span class="token punctuation">(</span>jwd<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"″"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// 正常的″</span></pre></td></tr><tr><td data-num="91"></td><td><pre>                <span class="token comment">// 有时候没有分 如：112°10.25″</span></pre></td></tr><tr><td data-num="92"></td><td><pre>                s <span class="token operator">=</span> jwd<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"′"</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token class-name">Double</span><span class="token punctuation">.</span><span class="token function">parseDouble</span><span class="token punctuation">(</span>jwd<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"′"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"″"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token class-name">Double</span><span class="token punctuation">.</span><span class="token function">parseDouble</span><span class="token punctuation">(</span>jwd<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"°"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"″"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="93"></td><td><pre>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>jwd<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"''"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// 特殊的 ''</span></pre></td></tr><tr><td data-num="94"></td><td><pre>                <span class="token comment">// 有时候没有分 如：112°10.25''</span></pre></td></tr><tr><td data-num="95"></td><td><pre>                s <span class="token operator">=</span> jwd<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"'"</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token class-name">Double</span><span class="token punctuation">.</span><span class="token function">parseDouble</span><span class="token punctuation">(</span>jwd<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"''"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token class-name">Double</span><span class="token punctuation">.</span><span class="token function">parseDouble</span><span class="token punctuation">(</span>jwd<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"°"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"''"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="96"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="97"></td><td><pre>            jwd <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>d <span class="token operator">+</span> m <span class="token operator">/</span> <span class="token number">60</span> <span class="token operator">+</span> s <span class="token operator">/</span> <span class="token number">60</span> <span class="token operator">/</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 计算并转换为 string</span></pre></td></tr><tr><td data-num="98"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="99"></td><td><pre>        <span class="token keyword">return</span> jwd<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="100"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="101"></td><td><pre></pre></td></tr><tr><td data-num="102"></td><td><pre>    <span class="token comment">/**</pre></td></tr><tr><td data-num="103"></td><td><pre>     * @param sourceGeometry</pre></td></tr><tr><td data-num="104"></td><td><pre>     * @param targetSrid</pre></td></tr><tr><td data-num="105"></td><td><pre>     * @author 窦凯欣</pre></td></tr><tr><td data-num="106"></td><td><pre>     */</span></pre></td></tr><tr><td data-num="107"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Geometry</span> <span class="token function">coordinateTransform</span><span class="token punctuation">(</span><span class="token class-name">Geometry</span> sourceGeometry<span class="token punctuation">,</span><span class="token keyword">int</span> targetSrid<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="108"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span>sourceGeometry <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> sourceGeometry<span class="token punctuation">.</span><span class="token function">getSRID</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> targetSrid <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="109"></td><td><pre>            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="110"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="111"></td><td><pre>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="112"></td><td><pre>            <span class="token class-name">CRSAuthorityFactory</span> factory <span class="token operator">=</span> <span class="token constant">CRS</span><span class="token punctuation">.</span><span class="token function">getAuthorityFactory</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="113"></td><td><pre>            <span class="token class-name">CoordinateReferenceSystem</span> source <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createCoordinateReferenceSystem</span><span class="token punctuation">(</span><span class="token string">"EPSG:"</span> <span class="token operator">+</span> sourceGeometry<span class="token punctuation">.</span><span class="token function">getSRID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="114"></td><td><pre>            <span class="token class-name">CoordinateReferenceSystem</span> target <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createCoordinateReferenceSystem</span><span class="token punctuation">(</span><span class="token string">"EPSG:"</span> <span class="token operator">+</span> targetSrid<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="115"></td><td><pre>            <span class="token class-name">MathTransform</span> transform <span class="token operator">=</span> <span class="token constant">CRS</span><span class="token punctuation">.</span><span class="token function">findMathTransform</span><span class="token punctuation">(</span>source<span class="token punctuation">,</span> target<span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="116"></td><td><pre>            <span class="token class-name">Geometry</span> res <span class="token operator">=</span> <span class="token constant">JTS</span><span class="token punctuation">.</span><span class="token function">transform</span><span class="token punctuation">(</span>sourceGeometry<span class="token punctuation">,</span> transform<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="117"></td><td><pre>            <span class="token keyword">if</span> <span class="token punctuation">(</span>res <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="118"></td><td><pre>                res<span class="token punctuation">.</span><span class="token function">setSRID</span><span class="token punctuation">(</span>targetSrid<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="119"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="120"></td><td><pre>            <span class="token keyword">return</span> res<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="121"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">FactoryException</span> <span class="token operator">|</span> <span class="token class-name">TransformException</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="122"></td><td><pre>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="123"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="124"></td><td><pre>        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="125"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="126"></td><td><pre></pre></td></tr><tr><td data-num="127"></td><td><pre>    <span class="token comment">/**</pre></td></tr><tr><td data-num="128"></td><td><pre>     * @param wkt</pre></td></tr><tr><td data-num="129"></td><td><pre>     * @param srid</pre></td></tr><tr><td data-num="130"></td><td><pre>     * @author 窦凯欣</pre></td></tr><tr><td data-num="131"></td><td><pre>     */</span></pre></td></tr><tr><td data-num="132"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Geometry</span> <span class="token function">createGeometry</span><span class="token punctuation">(</span><span class="token class-name">String</span> wkt<span class="token punctuation">,</span><span class="token keyword">int</span> srid<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="133"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtil</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>wkt<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="134"></td><td><pre>            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="135"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="136"></td><td><pre>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="137"></td><td><pre>            <span class="token class-name">WKTReader</span> reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WKTReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="138"></td><td><pre>            <span class="token class-name">Geometry</span> geometry <span class="token operator">=</span> reader<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>wkt<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="139"></td><td><pre>            geometry<span class="token punctuation">.</span><span class="token function">setSRID</span><span class="token punctuation">(</span>srid<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="140"></td><td><pre>            <span class="token keyword">return</span> geometry<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="141"></td><td><pre>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="142"></td><td><pre>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="143"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="144"></td><td><pre>        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="145"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="146"></td><td><pre></pre></td></tr><tr><td data-num="147"></td><td><pre>    <span class="token comment">/**</pre></td></tr><tr><td data-num="148"></td><td><pre>     * 坐标转换</pre></td></tr><tr><td data-num="149"></td><td><pre>     *</pre></td></tr><tr><td data-num="150"></td><td><pre>     * @param y</pre></td></tr><tr><td data-num="151"></td><td><pre>     * @param x</pre></td></tr><tr><td data-num="152"></td><td><pre>     * @param dh</pre></td></tr><tr><td data-num="153"></td><td><pre>     * @return</pre></td></tr><tr><td data-num="154"></td><td><pre>     * @throws Exception</pre></td></tr><tr><td data-num="155"></td><td><pre>     */</span></pre></td></tr><tr><td data-num="156"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">double</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">transTo4490fromProjectionByEpsg</span><span class="token punctuation">(</span><span class="token keyword">double</span> x<span class="token punctuation">,</span> <span class="token keyword">double</span> y<span class="token punctuation">,</span> <span class="token class-name">String</span> dh<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="157"></td><td><pre>        <span class="token class-name">String</span> epsgSource <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="158"></td><td><pre>        <span class="token keyword">switch</span> <span class="token punctuation">(</span>dh<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="159"></td><td><pre>            <span class="token comment">//6 度分带</span></pre></td></tr><tr><td data-num="160"></td><td><pre>            <span class="token keyword">case</span> <span class="token string">"13"</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="161"></td><td><pre>                epsgSource <span class="token operator">=</span> <span class="token string">"EPSG:4491"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="162"></td><td><pre>                <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="163"></td><td><pre>            <span class="token keyword">case</span> <span class="token string">"14"</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="164"></td><td><pre>                epsgSource <span class="token operator">=</span> <span class="token string">"EPSG:4492"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="165"></td><td><pre>                <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="166"></td><td><pre>            <span class="token keyword">case</span> <span class="token string">"15"</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="167"></td><td><pre>                epsgSource <span class="token operator">=</span> <span class="token string">"EPSG:4493"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="168"></td><td><pre>                <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="169"></td><td><pre>            <span class="token keyword">case</span> <span class="token string">"16"</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="170"></td><td><pre>                epsgSource <span class="token operator">=</span> <span class="token string">"EPSG:4494"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="171"></td><td><pre>                <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="172"></td><td><pre>            <span class="token keyword">case</span> <span class="token string">"17"</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="173"></td><td><pre>                epsgSource <span class="token operator">=</span> <span class="token string">"EPSG:4495"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="174"></td><td><pre>                <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="175"></td><td><pre>            <span class="token keyword">case</span> <span class="token string">"18"</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="176"></td><td><pre>                epsgSource <span class="token operator">=</span> <span class="token string">"EPSG:4496"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="177"></td><td><pre>                <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="178"></td><td><pre>            <span class="token keyword">case</span> <span class="token string">"19"</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="179"></td><td><pre>                epsgSource <span class="token operator">=</span> <span class="token string">"EPSG:4497"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="180"></td><td><pre>                <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="181"></td><td><pre>            <span class="token keyword">case</span> <span class="token string">"20"</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="182"></td><td><pre>                epsgSource <span class="token operator">=</span> <span class="token string">"EPSG:4498"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="183"></td><td><pre>                <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="184"></td><td><pre>            <span class="token keyword">case</span> <span class="token string">"21"</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="185"></td><td><pre>                epsgSource <span class="token operator">=</span> <span class="token string">"EPSG:4499"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="186"></td><td><pre>                <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="187"></td><td><pre>            <span class="token keyword">case</span> <span class="token string">"22"</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="188"></td><td><pre>                epsgSource <span class="token operator">=</span> <span class="token string">"EPSG:4500"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="189"></td><td><pre>                <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="190"></td><td><pre>            <span class="token keyword">case</span> <span class="token string">"23"</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="191"></td><td><pre>                epsgSource <span class="token operator">=</span> <span class="token string">"EPSG:4501"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="192"></td><td><pre>                <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="193"></td><td><pre>            <span class="token comment">//3 度分带</span></pre></td></tr><tr><td data-num="194"></td><td><pre>            <span class="token keyword">case</span> <span class="token string">"25"</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="195"></td><td><pre>                epsgSource <span class="token operator">=</span> <span class="token string">"EPSG:4513"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="196"></td><td><pre>                <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="197"></td><td><pre>            <span class="token keyword">case</span> <span class="token string">"26"</span><span class="token operator">:</span> <span class="token comment">//</span></pre></td></tr><tr><td data-num="198"></td><td><pre>                epsgSource <span class="token operator">=</span> <span class="token string">"EPSG:4514"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="199"></td><td><pre>                <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="200"></td><td><pre>            <span class="token keyword">case</span> <span class="token string">"27"</span><span class="token operator">:</span> <span class="token comment">//</span></pre></td></tr><tr><td data-num="201"></td><td><pre>                epsgSource <span class="token operator">=</span> <span class="token string">"EPSG:4515"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="202"></td><td><pre>                <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="203"></td><td><pre>            <span class="token keyword">case</span> <span class="token string">"28"</span><span class="token operator">:</span>  <span class="token comment">//</span></pre></td></tr><tr><td data-num="204"></td><td><pre>                epsgSource <span class="token operator">=</span> <span class="token string">"EPSG:4516"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="205"></td><td><pre>                <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="206"></td><td><pre>            <span class="token keyword">case</span> <span class="token string">"29"</span><span class="token operator">:</span>  <span class="token comment">//</span></pre></td></tr><tr><td data-num="207"></td><td><pre>                epsgSource <span class="token operator">=</span> <span class="token string">"EPSG:4517"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="208"></td><td><pre>                <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="209"></td><td><pre>            <span class="token keyword">case</span> <span class="token string">"30"</span><span class="token operator">:</span>  <span class="token comment">//</span></pre></td></tr><tr><td data-num="210"></td><td><pre>                epsgSource <span class="token operator">=</span> <span class="token string">"EPSG:4518"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="211"></td><td><pre>                <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="212"></td><td><pre>            <span class="token keyword">case</span> <span class="token string">"31"</span><span class="token operator">:</span>  <span class="token comment">//</span></pre></td></tr><tr><td data-num="213"></td><td><pre>                epsgSource <span class="token operator">=</span> <span class="token string">"EPSG:4519"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="214"></td><td><pre>                <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="215"></td><td><pre>            <span class="token keyword">case</span> <span class="token string">"32"</span><span class="token operator">:</span>  <span class="token comment">//</span></pre></td></tr><tr><td data-num="216"></td><td><pre>                epsgSource <span class="token operator">=</span> <span class="token string">"EPSG:4520"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="217"></td><td><pre>                <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="218"></td><td><pre>            <span class="token keyword">case</span> <span class="token string">"33"</span><span class="token operator">:</span>  <span class="token comment">//</span></pre></td></tr><tr><td data-num="219"></td><td><pre>                epsgSource <span class="token operator">=</span> <span class="token string">"EPSG:4521"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="220"></td><td><pre>                <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="221"></td><td><pre>            <span class="token keyword">case</span> <span class="token string">"34"</span><span class="token operator">:</span>   <span class="token comment">//</span></pre></td></tr><tr><td data-num="222"></td><td><pre>                epsgSource <span class="token operator">=</span> <span class="token string">"EPSG:4522"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="223"></td><td><pre>                <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="224"></td><td><pre>            <span class="token keyword">case</span> <span class="token string">"35"</span><span class="token operator">:</span>   <span class="token comment">//</span></pre></td></tr><tr><td data-num="225"></td><td><pre>                epsgSource <span class="token operator">=</span> <span class="token string">"EPSG:4523"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="226"></td><td><pre>                <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="227"></td><td><pre>            <span class="token keyword">case</span> <span class="token string">"36"</span><span class="token operator">:</span>  <span class="token comment">//</span></pre></td></tr><tr><td data-num="228"></td><td><pre>                epsgSource <span class="token operator">=</span> <span class="token string">"EPSG:4524"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="229"></td><td><pre>                <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="230"></td><td><pre>            <span class="token keyword">case</span> <span class="token string">"37"</span><span class="token operator">:</span>  <span class="token comment">//</span></pre></td></tr><tr><td data-num="231"></td><td><pre>                epsgSource <span class="token operator">=</span> <span class="token string">"EPSG:4525"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="232"></td><td><pre>                <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="233"></td><td><pre>            <span class="token keyword">case</span> <span class="token string">"38"</span><span class="token operator">:</span>   <span class="token comment">//'EPSG:':</span></pre></td></tr><tr><td data-num="234"></td><td><pre>                epsgSource <span class="token operator">=</span> <span class="token string">"EPSG:4526"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="235"></td><td><pre>                <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="236"></td><td><pre>            <span class="token keyword">case</span> <span class="token string">"39"</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token char">'EPSG:'</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="237"></td><td><pre>                epsgSource <span class="token operator">=</span> <span class="token string">"EPSG:4527"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="238"></td><td><pre>                <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="239"></td><td><pre>            <span class="token keyword">case</span> <span class="token string">"40"</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token char">'EPSG:'</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="240"></td><td><pre>                epsgSource <span class="token operator">=</span> <span class="token string">"EPSG:4528"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="241"></td><td><pre>                <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="242"></td><td><pre>            <span class="token keyword">case</span> <span class="token string">"41"</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token char">'EPSG:'</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="243"></td><td><pre>                epsgSource <span class="token operator">=</span> <span class="token string">"EPSG:4529"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="244"></td><td><pre>                <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="245"></td><td><pre>            <span class="token keyword">case</span> <span class="token string">"42"</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token char">'EPSG:'</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="246"></td><td><pre>                epsgSource <span class="token operator">=</span> <span class="token string">"EPSG:4530"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="247"></td><td><pre>                <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="248"></td><td><pre>            <span class="token keyword">case</span> <span class="token string">"43"</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token char">'EPSG:'</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="249"></td><td><pre>                epsgSource <span class="token operator">=</span> <span class="token string">"EPSG:4531"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="250"></td><td><pre>                <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="251"></td><td><pre>            <span class="token keyword">case</span> <span class="token string">"44"</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token char">'EPSG:'</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="252"></td><td><pre>                epsgSource <span class="token operator">=</span> <span class="token string">"EPSG:4532"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="253"></td><td><pre>                <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="254"></td><td><pre>            <span class="token keyword">case</span> <span class="token string">"45"</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token char">'EPSG:'</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="255"></td><td><pre>                epsgSource <span class="token operator">=</span> <span class="token string">"EPSG:4533"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="256"></td><td><pre>                <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="257"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="258"></td><td><pre>        <span class="token keyword">return</span> <span class="token function">transFromByEpsg</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> epsgSource<span class="token punctuation">,</span> <span class="token string">"EPSG:4490"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="259"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="260"></td><td><pre></pre></td></tr><tr><td data-num="261"></td><td><pre>    <span class="token comment">/**</pre></td></tr><tr><td data-num="262"></td><td><pre>     * 坐标投影转换</pre></td></tr><tr><td data-num="263"></td><td><pre>     *</pre></td></tr><tr><td data-num="264"></td><td><pre>     * @param x</pre></td></tr><tr><td data-num="265"></td><td><pre>     * @param y</pre></td></tr><tr><td data-num="266"></td><td><pre>     * @param epsgSource</pre></td></tr><tr><td data-num="267"></td><td><pre>     * @param epsgTarget</pre></td></tr><tr><td data-num="268"></td><td><pre>     * @return</pre></td></tr><tr><td data-num="269"></td><td><pre>     * @throws Exception</pre></td></tr><tr><td data-num="270"></td><td><pre>     */</span></pre></td></tr><tr><td data-num="271"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">double</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">transFromByEpsg</span><span class="token punctuation">(</span><span class="token keyword">double</span> x<span class="token punctuation">,</span> <span class="token keyword">double</span> y<span class="token punctuation">,</span> <span class="token class-name">String</span> epsgSource<span class="token punctuation">,</span> <span class="token class-name">String</span> epsgTarget<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="272"></td><td><pre>        <span class="token class-name">Coordinate</span> sourceCoord <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Coordinate</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="273"></td><td><pre>        <span class="token class-name">Coordinate</span> targetCoord <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Coordinate</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="274"></td><td><pre>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="275"></td><td><pre>            <span class="token class-name">CoordinateReferenceSystem</span> crsSource <span class="token operator">=</span> <span class="token constant">CRS</span><span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>epsgSource<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="276"></td><td><pre>            <span class="token class-name">CoordinateReferenceSystem</span> crsTarget <span class="token operator">=</span> <span class="token constant">CRS</span><span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>epsgTarget<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="277"></td><td><pre>            <span class="token class-name">MathTransform</span> transform <span class="token operator">=</span> <span class="token constant">CRS</span><span class="token punctuation">.</span><span class="token function">findMathTransform</span><span class="token punctuation">(</span>crsSource<span class="token punctuation">,</span> crsTarget<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="278"></td><td><pre>            <span class="token constant">JTS</span><span class="token punctuation">.</span><span class="token function">transform</span><span class="token punctuation">(</span>sourceCoord<span class="token punctuation">,</span> targetCoord<span class="token punctuation">,</span> transform<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="279"></td><td><pre>            <span class="token keyword">double</span><span class="token punctuation">[</span><span class="token punctuation">]</span> targetCoords <span class="token operator">=</span> <span class="token punctuation">&#123;</span>targetCoord<span class="token punctuation">.</span>x<span class="token punctuation">,</span>targetCoord<span class="token punctuation">.</span>y<span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="280"></td><td><pre>            <span class="token keyword">return</span> targetCoords<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="281"></td><td><pre>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">TransformException</span> te<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="282"></td><td><pre>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token string">"坐标系转换错误：TransformException:"</span> <span class="token operator">+</span> te<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="283"></td><td><pre>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">FactoryException</span> fe<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="284"></td><td><pre>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token string">"坐标系转换错误：FactoryException:"</span> <span class="token operator">+</span> fe<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="285"></td><td><pre>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="286"></td><td><pre>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token string">"坐标系转换错误：Exception:"</span> <span class="token operator">+</span> e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="287"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="288"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="289"></td><td><pre></pre></td></tr><tr><td data-num="290"></td><td><pre></pre></td></tr><tr><td data-num="291"></td><td><pre>    <span class="token comment">/**</pre></td></tr><tr><td data-num="292"></td><td><pre>     * 创建点坐标</pre></td></tr><tr><td data-num="293"></td><td><pre>     * @param x 经度</pre></td></tr><tr><td data-num="294"></td><td><pre>     * @param y 纬度</pre></td></tr><tr><td data-num="295"></td><td><pre>     * @return</pre></td></tr><tr><td data-num="296"></td><td><pre>     */</span></pre></td></tr><tr><td data-num="297"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Point</span> <span class="token function">createPoint</span><span class="token punctuation">(</span><span class="token class-name">Double</span> x<span class="token punctuation">,</span> <span class="token class-name">Double</span> y<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="298"></td><td><pre>        <span class="token comment">// 创建几何工厂</span></pre></td></tr><tr><td data-num="299"></td><td><pre>        <span class="token class-name">GeometryFactory</span> geometryFactory <span class="token operator">=</span> <span class="token class-name">JTSFactoryFinder</span><span class="token punctuation">.</span><span class="token function">getGeometryFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="300"></td><td><pre>        <span class="token comment">// 创建一个几何坐标</span></pre></td></tr><tr><td data-num="301"></td><td><pre>        <span class="token class-name">Coordinate</span> coordinate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Coordinate</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="302"></td><td><pre>        <span class="token keyword">return</span> geometryFactory<span class="token punctuation">.</span><span class="token function">createPoint</span><span class="token punctuation">(</span>coordinate<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="303"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="304"></td><td><pre></pre></td></tr><tr><td data-num="305"></td><td><pre>    <span class="token comment">/**</pre></td></tr><tr><td data-num="306"></td><td><pre>     * 将要素的坐标系转为相对应的坐标系</pre></td></tr><tr><td data-num="307"></td><td><pre>     * @param feature 要素类</pre></td></tr><tr><td data-num="308"></td><td><pre>     * @param targetSrid 坐标系 id</pre></td></tr><tr><td data-num="309"></td><td><pre>     * @return</pre></td></tr><tr><td data-num="310"></td><td><pre>     */</span></pre></td></tr><tr><td data-num="311"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Geometry</span> <span class="token function">coordinateTransform</span><span class="token punctuation">(</span><span class="token class-name">SimpleFeature</span> feature<span class="token punctuation">,</span> <span class="token keyword">int</span> targetSrid<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="312"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isNull</span><span class="token punctuation">(</span>feature<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="313"></td><td><pre>            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="314"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="315"></td><td><pre>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="316"></td><td><pre>            <span class="token class-name">CRSAuthorityFactory</span> factory <span class="token operator">=</span> <span class="token constant">CRS</span><span class="token punctuation">.</span><span class="token function">getAuthorityFactory</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="317"></td><td><pre>            <span class="token class-name">CoordinateReferenceSystem</span> target <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createCoordinateReferenceSystem</span><span class="token punctuation">(</span><span class="token string">"EPSG:"</span> <span class="token operator">+</span> targetSrid<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="318"></td><td><pre>            <span class="token class-name">CoordinateReferenceSystem</span> coordinateReferenceSystem <span class="token operator">=</span> feature<span class="token punctuation">.</span><span class="token function">getDefaultGeometryProperty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDescriptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCoordinateReferenceSystem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="319"></td><td><pre>            <span class="token keyword">if</span> <span class="token punctuation">(</span>coordinateReferenceSystem <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="320"></td><td><pre>                <span class="token class-name">Geometry</span> res <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Geometry</span><span class="token punctuation">)</span>feature<span class="token punctuation">.</span><span class="token function">getDefaultGeometry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="321"></td><td><pre>                res<span class="token punctuation">.</span><span class="token function">setSRID</span><span class="token punctuation">(</span>targetSrid<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="322"></td><td><pre>                <span class="token keyword">return</span> res<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="323"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="324"></td><td><pre>            <span class="token class-name">MathTransform</span> transform <span class="token operator">=</span> <span class="token constant">CRS</span><span class="token punctuation">.</span><span class="token function">findMathTransform</span><span class="token punctuation">(</span>coordinateReferenceSystem<span class="token punctuation">,</span> target<span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="325"></td><td><pre>            <span class="token class-name">Geometry</span> res <span class="token operator">=</span> <span class="token constant">JTS</span><span class="token punctuation">.</span><span class="token function">transform</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Geometry</span><span class="token punctuation">)</span>feature<span class="token punctuation">.</span><span class="token function">getDefaultGeometry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> transform<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="326"></td><td><pre>            <span class="token keyword">if</span> <span class="token punctuation">(</span>res <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="327"></td><td><pre>                res<span class="token punctuation">.</span><span class="token function">setSRID</span><span class="token punctuation">(</span>targetSrid<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="328"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="329"></td><td><pre>            <span class="token keyword">return</span> res<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="330"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">FactoryException</span> <span class="token operator">|</span> <span class="token class-name">TransformException</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="331"></td><td><pre>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="332"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="333"></td><td><pre>        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="334"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="335"></td><td><pre></pre></td></tr><tr><td data-num="336"></td><td><pre></pre></td></tr><tr><td data-num="337"></td><td><pre>    <span class="token comment">/**</pre></td></tr><tr><td data-num="338"></td><td><pre>     * 面坐标处理解析成 WKT 格式</pre></td></tr><tr><td data-num="339"></td><td><pre>     * 第一种方式</pre></td></tr><tr><td data-num="340"></td><td><pre>     * @param coordinatesStr 一串坐标</pre></td></tr><tr><td data-num="341"></td><td><pre>     * @return</pre></td></tr><tr><td data-num="342"></td><td><pre>     *</pre></td></tr><tr><td data-num="343"></td><td><pre>     * 4348121.92,38610084.30</pre></td></tr><tr><td data-num="344"></td><td><pre>     * 4348076.60,38611233.20</pre></td></tr><tr><td data-num="345"></td><td><pre>     * 4347543.64,38611157.40</pre></td></tr><tr><td data-num="346"></td><td><pre>     * 4347515.09,38611985.26</pre></td></tr><tr><td data-num="347"></td><td><pre>     * 4346651.97,38612040.25</pre></td></tr><tr><td data-num="348"></td><td><pre>     * 4346493.69,38611280.02</pre></td></tr><tr><td data-num="349"></td><td><pre>     * 4346043.13,38610778.17</pre></td></tr><tr><td data-num="350"></td><td><pre>     * 4345917.48,38609708.95</pre></td></tr><tr><td data-num="351"></td><td><pre>     * 4346602.51,38609067.42</pre></td></tr><tr><td data-num="352"></td><td><pre>     */</span></pre></td></tr><tr><td data-num="353"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token class-name">CoordinateDisposeWKT1</span><span class="token punctuation">(</span><span class="token class-name">String</span> coordinatesStr<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="354"></td><td><pre>        coordinatesStr <span class="token operator">=</span> coordinatesStr<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replaceAll</span><span class="token punctuation">(</span><span class="token string">"\\s+"</span><span class="token punctuation">,</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="355"></td><td><pre>        <span class="token comment">// 分割文本获取所有的点坐标</span></pre></td></tr><tr><td data-num="356"></td><td><pre>        <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> pointCollection <span class="token operator">=</span> coordinatesStr<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"[\t\n\r]"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="357"></td><td><pre>        <span class="token comment">// 一个面最少三个点</span></pre></td></tr><tr><td data-num="358"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span>pointCollection<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="359"></td><td><pre>            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="360"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="361"></td><td><pre>        <span class="token comment">// 判断当前坐标串用那种方式解析 1. 十进制度、2. 度分秒、3. 投影</span></pre></td></tr><tr><td data-num="362"></td><td><pre>        <span class="token class-name">Integer</span> analysisType <span class="token operator">=</span> <span class="token function">polygonAnalysis_type</span><span class="token punctuation">(</span>pointCollection<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="363"></td><td><pre>        <span class="token comment">// 存储创建好的点坐标几何</span></pre></td></tr><tr><td data-num="364"></td><td><pre>        <span class="token class-name">Coordinate</span><span class="token punctuation">[</span><span class="token punctuation">]</span> coordinates <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Coordinate</span><span class="token punctuation">[</span>pointCollection<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="365"></td><td><pre>        <span class="token comment">// 循环每个坐标，验真坐标的正确性</span></pre></td></tr><tr><td data-num="366"></td><td><pre>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> pointCollection<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="367"></td><td><pre>            <span class="token comment">// 根据 "," 分割 x y</span></pre></td></tr><tr><td data-num="368"></td><td><pre>            <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> pointStr <span class="token operator">=</span> pointCollection<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="369"></td><td><pre>            <span class="token keyword">if</span> <span class="token punctuation">(</span>pointStr<span class="token punctuation">.</span>length <span class="token operator">!=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="370"></td><td><pre>                <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="371"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="372"></td><td><pre>            <span class="token class-name">Point</span> point <span class="token operator">=</span> <span class="token function">polygonAnalysis_point</span><span class="token punctuation">(</span>pointStr<span class="token punctuation">,</span> analysisType<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="373"></td><td><pre>            <span class="token comment">// 其中有一个点存在错误该图形不正确</span></pre></td></tr><tr><td data-num="374"></td><td><pre>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isNull</span><span class="token punctuation">(</span>point<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="375"></td><td><pre>                <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="376"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="377"></td><td><pre>            <span class="token comment">// 创建点几何</span></pre></td></tr><tr><td data-num="378"></td><td><pre>            coordinates<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> point<span class="token punctuation">.</span><span class="token function">getCoordinate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="379"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="380"></td><td><pre>        <span class="token class-name">Polygon</span> polygon <span class="token operator">=</span> <span class="token class-name">GeometryUtil</span><span class="token punctuation">.</span><span class="token function">createPolygon</span><span class="token punctuation">(</span>coordinates<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="381"></td><td><pre>        <span class="token comment">// 创建多面类型</span></pre></td></tr><tr><td data-num="382"></td><td><pre>        <span class="token class-name">MultiPolygon</span> multiPolygon <span class="token operator">=</span> <span class="token class-name">GeometryUtil</span><span class="token punctuation">.</span><span class="token function">createMultiPolygon</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Polygon</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span>polygon<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="383"></td><td><pre>        <span class="token comment">// 检查图形的有效性</span></pre></td></tr><tr><td data-num="384"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>multiPolygon<span class="token punctuation">.</span><span class="token function">isValid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="385"></td><td><pre>            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="386"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="387"></td><td><pre>        <span class="token keyword">return</span> multiPolygon<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="388"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="389"></td><td><pre></pre></td></tr><tr><td data-num="390"></td><td><pre>    <span class="token comment">/**</pre></td></tr><tr><td data-num="391"></td><td><pre>     * 面坐标处理解析成 WKT 格式</pre></td></tr><tr><td data-num="392"></td><td><pre>     * 第二种方式</pre></td></tr><tr><td data-num="393"></td><td><pre>     * @param coordinatesStr 一串坐标</pre></td></tr><tr><td data-num="394"></td><td><pre>     * @return</pre></td></tr><tr><td data-num="395"></td><td><pre>     *</pre></td></tr><tr><td data-num="396"></td><td><pre>     * 1,4203487.48,38515918.33, ,</pre></td></tr><tr><td data-num="397"></td><td><pre>     * 2,4203491.25,38516654.34, ,</pre></td></tr><tr><td data-num="398"></td><td><pre>     * 3,4203431.04,38516773.13, ,</pre></td></tr><tr><td data-num="399"></td><td><pre>     * 4,4203336.43,38516829.18, ,</pre></td></tr><tr><td data-num="400"></td><td><pre>     * 5,4203273.42,38516862.76, ,</pre></td></tr><tr><td data-num="401"></td><td><pre>     * 6,4203217.14,38516856.54, ,</pre></td></tr><tr><td data-num="402"></td><td><pre>     * 7,4203189.85,38516751.12, ,</pre></td></tr><tr><td data-num="403"></td><td><pre>     * 8,4203189.85,38516663.19, ,</pre></td></tr><tr><td data-num="404"></td><td><pre>     * 9,4203093.83,38516717.14, ,</pre></td></tr><tr><td data-num="405"></td><td><pre>     * 10,4203050.36,38516838.10, ,</pre></td></tr><tr><td data-num="406"></td><td><pre>     * 11,4202394.67,38516765.61, ,</pre></td></tr><tr><td data-num="407"></td><td><pre>     * 12,4202312.69,38516211.71, ,</pre></td></tr><tr><td data-num="408"></td><td><pre>     * *,632.5,350, ,1</pre></td></tr><tr><td data-num="409"></td><td><pre>     */</span></pre></td></tr><tr><td data-num="410"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token class-name">CoordinateDisposeWKT2</span><span class="token punctuation">(</span><span class="token class-name">String</span> coordinatesStr<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="411"></td><td><pre>        <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> coordinatesArry <span class="token operator">=</span> coordinatesStr<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="412"></td><td><pre>        <span class="token comment">// 判断当前坐标串用那种方式解析 1. 十进制度、2. 度分秒、3. 投影</span></pre></td></tr><tr><td data-num="413"></td><td><pre>        <span class="token class-name">Integer</span> analysisType <span class="token operator">=</span> <span class="token function">polygonAnalysis_type</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span>coordinatesArry<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>coordinatesArry<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="414"></td><td><pre>        <span class="token comment">// 坐标面集合</span></pre></td></tr><tr><td data-num="415"></td><td><pre>        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Coordinate</span><span class="token punctuation">></span><span class="token punctuation">,</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> <span class="token class-name">CoordinateList</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="416"></td><td><pre>        <span class="token comment">// 坐标点集合</span></pre></td></tr><tr><td data-num="417"></td><td><pre>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Coordinate</span><span class="token punctuation">></span></span> pointList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="418"></td><td><pre>        <span class="token comment">// 坐标解析</span></pre></td></tr><tr><td data-num="419"></td><td><pre>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> coordinatesArry<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">+=</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="420"></td><td><pre>            <span class="token class-name">String</span> sign <span class="token operator">=</span> coordinatesArry<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="421"></td><td><pre>            sign <span class="token operator">=</span> sign<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="422"></td><td><pre>            <span class="token comment">// 结束符</span></pre></td></tr><tr><td data-num="423"></td><td><pre>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">"*"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>sign<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="424"></td><td><pre>                <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> end <span class="token operator">=</span> coordinatesArry<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="425"></td><td><pre>                <span class="token class-name">CoordinateList</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>pointList<span class="token punctuation">,</span><span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>end<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="426"></td><td><pre>                pointList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="427"></td><td><pre>                <span class="token keyword">continue</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="428"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="429"></td><td><pre>            <span class="token class-name">String</span> x <span class="token operator">=</span> coordinatesArry<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="430"></td><td><pre>            <span class="token class-name">String</span> y <span class="token operator">=</span> coordinatesArry<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="431"></td><td><pre>            <span class="token class-name">Point</span> point <span class="token operator">=</span> <span class="token function">polygonAnalysis_point</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span>x<span class="token punctuation">,</span>y<span class="token punctuation">&#125;</span><span class="token punctuation">,</span> analysisType<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="432"></td><td><pre>            pointList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>point<span class="token punctuation">.</span><span class="token function">getCoordinate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="433"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="434"></td><td><pre>        <span class="token comment">// 坐标转为面</span></pre></td></tr><tr><td data-num="435"></td><td><pre>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Polygon</span><span class="token punctuation">></span><span class="token punctuation">></span></span> multiPolygonList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="436"></td><td><pre>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Polygon</span><span class="token punctuation">></span></span> polygonList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="437"></td><td><pre>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Coordinate</span><span class="token punctuation">></span></span> k <span class="token operator">:</span> <span class="token class-name">CoordinateList</span><span class="token punctuation">.</span><span class="token function">keySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="438"></td><td><pre>            <span class="token comment">// 获取结束值</span></pre></td></tr><tr><td data-num="439"></td><td><pre>            <span class="token class-name">Integer</span> v <span class="token operator">=</span> <span class="token class-name">CoordinateList</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="440"></td><td><pre>            <span class="token class-name">Coordinate</span><span class="token punctuation">[</span><span class="token punctuation">]</span> coordinates <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Coordinate</span><span class="token punctuation">[</span>k<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="441"></td><td><pre>            <span class="token class-name">Polygon</span> polygon <span class="token operator">=</span> <span class="token class-name">GeometryUtil</span><span class="token punctuation">.</span><span class="token function">createPolygon</span><span class="token punctuation">(</span>k<span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span>coordinates<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="442"></td><td><pre>            <span class="token keyword">if</span> <span class="token punctuation">(</span>v <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="443"></td><td><pre>                multiPolygonList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>polygonList<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="444"></td><td><pre>                polygonList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="445"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="446"></td><td><pre>            polygonList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>polygon<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="447"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="448"></td><td><pre>        multiPolygonList<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="449"></td><td><pre>        multiPolygonList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>polygonList<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="450"></td><td><pre>        <span class="token comment">// 处理多面或面带洞</span></pre></td></tr><tr><td data-num="451"></td><td><pre>        polygonList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="452"></td><td><pre>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Polygon</span><span class="token punctuation">></span></span> list <span class="token operator">:</span> multiPolygonList<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="453"></td><td><pre>            <span class="token keyword">if</span> <span class="token punctuation">(</span>list<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="454"></td><td><pre>                polygonList<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="455"></td><td><pre>                <span class="token keyword">continue</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="456"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="457"></td><td><pre>            <span class="token class-name">LinearRing</span><span class="token punctuation">[</span><span class="token punctuation">]</span> linearRings <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinearRing</span><span class="token punctuation">[</span>list<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="458"></td><td><pre>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> list<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="459"></td><td><pre>                linearRings<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getExteriorRing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="460"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="461"></td><td><pre>            <span class="token class-name">Polygon</span> polygonWithHoles <span class="token operator">=</span> <span class="token class-name">GeometryUtil</span><span class="token punctuation">.</span><span class="token function">createPolygonWithHoles</span><span class="token punctuation">(</span>list<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getExteriorRing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> linearRings<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="462"></td><td><pre>            polygonList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>polygonWithHoles<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="463"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="464"></td><td><pre>        <span class="token comment">// 创建多面</span></pre></td></tr><tr><td data-num="465"></td><td><pre>        <span class="token class-name">Polygon</span><span class="token punctuation">[</span><span class="token punctuation">]</span> polygons <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Polygon</span><span class="token punctuation">[</span>polygonList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="466"></td><td><pre>        <span class="token class-name">MultiPolygon</span> multiPolygon <span class="token operator">=</span> <span class="token class-name">GeometryUtil</span><span class="token punctuation">.</span><span class="token function">createMultiPolygon</span><span class="token punctuation">(</span>polygonList<span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span>polygons<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="467"></td><td><pre>        <span class="token keyword">return</span> multiPolygon<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="468"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="469"></td><td><pre></pre></td></tr><tr><td data-num="470"></td><td><pre>    <span class="token comment">/**</pre></td></tr><tr><td data-num="471"></td><td><pre>     * 面坐标处理解析成 WKT 格式</pre></td></tr><tr><td data-num="472"></td><td><pre>     * 第三种方式</pre></td></tr><tr><td data-num="473"></td><td><pre>     * @param coordinatesStr 一串坐标</pre></td></tr><tr><td data-num="474"></td><td><pre>     * @return</pre></td></tr><tr><td data-num="475"></td><td><pre>     *</pre></td></tr><tr><td data-num="476"></td><td><pre>     * 2,5,1,4421028.05,39571109.36,2,4421062.05,39571064.36,3,4421110.05,39571178.36,4,4421088.05,39571236.36,5,4421024.05,39571217.36,103,47,,1,3,7,4420967.05,39571412.36,8,4420819.05,39571421.36,6,4420876.05,39571372.36,103,47,,1,</pre></td></tr><tr><td data-num="477"></td><td><pre>     */</span></pre></td></tr><tr><td data-num="478"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token class-name">CoordinateDisposeWKT3</span><span class="token punctuation">(</span><span class="token class-name">String</span> coordinatesStr<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="479"></td><td><pre>        <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> coordinatesArry <span class="token operator">=</span> coordinatesStr<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="480"></td><td><pre>        <span class="token comment">// 判断当前坐标串用那种方式解析 1. 十进制度、2. 度分秒、3. 投影</span></pre></td></tr><tr><td data-num="481"></td><td><pre>        <span class="token class-name">Integer</span> analysisType <span class="token operator">=</span> <span class="token function">polygonAnalysis_type</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span>coordinatesArry<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>coordinatesArry<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="482"></td><td><pre>        <span class="token comment">// 面的个数</span></pre></td></tr><tr><td data-num="483"></td><td><pre>        <span class="token class-name">Integer</span> polygonNum <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>coordinatesArry<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="484"></td><td><pre>        <span class="token comment">// 第一个面的点个数</span></pre></td></tr><tr><td data-num="485"></td><td><pre>        <span class="token class-name">Integer</span> pointNum <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>coordinatesArry<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="486"></td><td><pre>        <span class="token comment">// 第一个 X 点</span></pre></td></tr><tr><td data-num="487"></td><td><pre>        <span class="token class-name">Integer</span> x <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="488"></td><td><pre>        <span class="token comment">// 第一个 Y 点</span></pre></td></tr><tr><td data-num="489"></td><td><pre>        <span class="token class-name">Integer</span> y <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="490"></td><td><pre>        <span class="token comment">// 存放多个面</span></pre></td></tr><tr><td data-num="491"></td><td><pre>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Polygon</span><span class="token punctuation">></span></span> multiPolygonList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="492"></td><td><pre>        <span class="token comment">// 存放为洞的面</span></pre></td></tr><tr><td data-num="493"></td><td><pre>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Polygon</span><span class="token punctuation">></span></span> holePolygon <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="494"></td><td><pre>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> polygonNum<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="495"></td><td><pre>            <span class="token class-name">Coordinate</span><span class="token punctuation">[</span><span class="token punctuation">]</span> coordinates <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Coordinate</span><span class="token punctuation">[</span>pointNum<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="496"></td><td><pre>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> pointNum<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">,</span>x<span class="token operator">+=</span><span class="token number">3</span><span class="token punctuation">,</span>y<span class="token operator">+=</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="497"></td><td><pre>                <span class="token comment">//x 点</span></pre></td></tr><tr><td data-num="498"></td><td><pre>                <span class="token class-name">String</span> lon <span class="token operator">=</span> coordinatesArry<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="499"></td><td><pre>                <span class="token comment">//y 点</span></pre></td></tr><tr><td data-num="500"></td><td><pre>                <span class="token class-name">String</span> lat <span class="token operator">=</span> coordinatesArry<span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="501"></td><td><pre>                <span class="token comment">// 转为点</span></pre></td></tr><tr><td data-num="502"></td><td><pre>                <span class="token class-name">Point</span> point <span class="token operator">=</span> <span class="token function">polygonAnalysis_point</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span>lon<span class="token punctuation">,</span>lat<span class="token punctuation">&#125;</span><span class="token punctuation">,</span> analysisType<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="503"></td><td><pre>                coordinates<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> point<span class="token punctuation">.</span><span class="token function">getCoordinate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="504"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="505"></td><td><pre>            <span class="token comment">// 创建面</span></pre></td></tr><tr><td data-num="506"></td><td><pre>            <span class="token class-name">Polygon</span> polygon <span class="token operator">=</span> <span class="token class-name">GeometryUtil</span><span class="token punctuation">.</span><span class="token function">createPolygon</span><span class="token punctuation">(</span>coordinates<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="507"></td><td><pre>            <span class="token comment">// 判断是多面或带洞的面</span></pre></td></tr><tr><td data-num="508"></td><td><pre>            <span class="token class-name">Integer</span> type <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>coordinatesArry<span class="token punctuation">[</span>y<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="509"></td><td><pre>            <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="510"></td><td><pre>                holePolygon<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>polygon<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="511"></td><td><pre>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="512"></td><td><pre>                multiPolygonList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>polygon<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="513"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="514"></td><td><pre>            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> polygonNum<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="515"></td><td><pre>                <span class="token comment">// 第二个或更多面的点数</span></pre></td></tr><tr><td data-num="516"></td><td><pre>                pointNum <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>coordinatesArry<span class="token punctuation">[</span>y<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="517"></td><td><pre>                x<span class="token operator">+=</span><span class="token number">5</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="518"></td><td><pre>                y<span class="token operator">+=</span><span class="token number">5</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="519"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="520"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="521"></td><td><pre></pre></td></tr><tr><td data-num="522"></td><td><pre>        <span class="token class-name">MultiPolygon</span> multiPolygon <span class="token operator">=</span> <span class="token class-name">GeometryUtil</span><span class="token punctuation">.</span><span class="token function">createMultiPolygon</span><span class="token punctuation">(</span>multiPolygonList<span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Polygon</span><span class="token punctuation">[</span>multiPolygonList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="523"></td><td><pre>        <span class="token comment">// 存在带洞的情况</span></pre></td></tr><tr><td data-num="524"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span>holePolygon<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="525"></td><td><pre>            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">LinearRing</span><span class="token punctuation">></span></span> linearRingList <span class="token operator">=</span> holePolygon<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>hole <span class="token operator">-></span> hole<span class="token punctuation">.</span><span class="token function">getExteriorRing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="526"></td><td><pre>            <span class="token comment">// 创建带洞的面</span></pre></td></tr><tr><td data-num="527"></td><td><pre>            <span class="token class-name">Coordinate</span><span class="token punctuation">[</span><span class="token punctuation">]</span> coordinates <span class="token operator">=</span> multiPolygon<span class="token punctuation">.</span><span class="token function">getCoordinates</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="528"></td><td><pre>            <span class="token class-name">GeometryFactory</span> geometryFactory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GeometryFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="529"></td><td><pre>            <span class="token class-name">LinearRing</span> ring <span class="token operator">=</span> geometryFactory<span class="token punctuation">.</span><span class="token function">createLinearRing</span><span class="token punctuation">(</span>coordinates<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="530"></td><td><pre>            <span class="token class-name">Polygon</span> polygonWithHoles <span class="token operator">=</span> <span class="token class-name">GeometryUtil</span><span class="token punctuation">.</span><span class="token function">createPolygonWithHoles</span><span class="token punctuation">(</span>ring<span class="token punctuation">,</span> linearRingList<span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">LinearRing</span><span class="token punctuation">[</span>holePolygon<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="531"></td><td><pre>            multiPolygon <span class="token operator">=</span> <span class="token class-name">GeometryUtil</span><span class="token punctuation">.</span><span class="token function">createMultiPolygon</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Polygon</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span>polygonWithHoles<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="532"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="533"></td><td><pre>        <span class="token comment">// 检查图形的有效性</span></pre></td></tr><tr><td data-num="534"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>multiPolygon<span class="token punctuation">.</span><span class="token function">isValid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="535"></td><td><pre>            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="536"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="537"></td><td><pre>        <span class="token keyword">return</span> multiPolygon<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="538"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="539"></td><td><pre></pre></td></tr><tr><td data-num="540"></td><td><pre>    <span class="token comment">/**</pre></td></tr><tr><td data-num="541"></td><td><pre>     * 面坐标处理解析成 WKT 格式</pre></td></tr><tr><td data-num="542"></td><td><pre>     * 第四种方式</pre></td></tr><tr><td data-num="543"></td><td><pre>     * @param coordinatesStr 一串坐标</pre></td></tr><tr><td data-num="544"></td><td><pre>     * @return</pre></td></tr><tr><td data-num="545"></td><td><pre>     *</pre></td></tr><tr><td data-num="546"></td><td><pre>     * 2,4,114.0643000,41.0300000,114.0820000,41.0300000,114.0820000,41.0200000,114.0643000,41.0200000,0,0,0,4,114.0721000,41.0219000,114.0725000,41.0214000,114.0707000,41.0203000,114.0703000,41.0207000,-1,0,0,</pre></td></tr><tr><td data-num="547"></td><td><pre>     */</span></pre></td></tr><tr><td data-num="548"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token class-name">CoordinateDisposeWKT4</span><span class="token punctuation">(</span><span class="token class-name">String</span> coordinatesStr<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="549"></td><td><pre>        <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> coordinatesArry <span class="token operator">=</span> coordinatesStr<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="550"></td><td><pre>        <span class="token comment">// 判断当前坐标串用那种方式解析 1. 十进制度、2. 度分秒、3. 投影</span></pre></td></tr><tr><td data-num="551"></td><td><pre>        <span class="token class-name">Integer</span> analysisType <span class="token operator">=</span> <span class="token function">polygonAnalysis_type</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span>coordinatesArry<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>coordinatesArry<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="552"></td><td><pre>        <span class="token comment">// 面的个数</span></pre></td></tr><tr><td data-num="553"></td><td><pre>        <span class="token class-name">Integer</span> polygonNum <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>coordinatesArry<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="554"></td><td><pre>        <span class="token comment">// 第一个面的点个数</span></pre></td></tr><tr><td data-num="555"></td><td><pre>        <span class="token class-name">Integer</span> pointNum <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>coordinatesArry<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="556"></td><td><pre>        <span class="token comment">// 第一个 X 点</span></pre></td></tr><tr><td data-num="557"></td><td><pre>        <span class="token class-name">Integer</span> x <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="558"></td><td><pre>        <span class="token comment">// 第一个 Y 点</span></pre></td></tr><tr><td data-num="559"></td><td><pre>        <span class="token class-name">Integer</span> y <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="560"></td><td><pre>        <span class="token comment">// 存放多个面</span></pre></td></tr><tr><td data-num="561"></td><td><pre>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Polygon</span><span class="token punctuation">></span></span> multiPolygonList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="562"></td><td><pre>        <span class="token comment">// 存放为洞的面</span></pre></td></tr><tr><td data-num="563"></td><td><pre>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Polygon</span><span class="token punctuation">></span></span> holePolygon <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="564"></td><td><pre>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> polygonNum<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="565"></td><td><pre>            <span class="token class-name">Coordinate</span><span class="token punctuation">[</span><span class="token punctuation">]</span> coordinates <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Coordinate</span><span class="token punctuation">[</span>pointNum<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="566"></td><td><pre>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> pointNum<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">,</span>x<span class="token operator">+=</span><span class="token number">2</span><span class="token punctuation">,</span>y<span class="token operator">+=</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="567"></td><td><pre>                <span class="token comment">//x 点</span></pre></td></tr><tr><td data-num="568"></td><td><pre>                <span class="token class-name">String</span> lon <span class="token operator">=</span> coordinatesArry<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="569"></td><td><pre>                <span class="token comment">//y 点</span></pre></td></tr><tr><td data-num="570"></td><td><pre>                <span class="token class-name">String</span> lat <span class="token operator">=</span> coordinatesArry<span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="571"></td><td><pre>                <span class="token comment">// 转为点</span></pre></td></tr><tr><td data-num="572"></td><td><pre>                <span class="token class-name">Point</span> point <span class="token operator">=</span> <span class="token function">polygonAnalysis_point</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span>lon<span class="token punctuation">,</span>lat<span class="token punctuation">&#125;</span><span class="token punctuation">,</span> analysisType<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="573"></td><td><pre>                coordinates<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> point<span class="token punctuation">.</span><span class="token function">getCoordinate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="574"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="575"></td><td><pre>            <span class="token comment">// 创建面</span></pre></td></tr><tr><td data-num="576"></td><td><pre>            <span class="token class-name">Polygon</span> polygon <span class="token operator">=</span> <span class="token class-name">GeometryUtil</span><span class="token punctuation">.</span><span class="token function">createPolygon</span><span class="token punctuation">(</span>coordinates<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="577"></td><td><pre>            <span class="token comment">// 判断是多面或带洞的面</span></pre></td></tr><tr><td data-num="578"></td><td><pre>            <span class="token class-name">Integer</span> type <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>coordinatesArry<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="579"></td><td><pre>            <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="580"></td><td><pre>                holePolygon<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>polygon<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="581"></td><td><pre>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="582"></td><td><pre>                multiPolygonList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>polygon<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="583"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="584"></td><td><pre>            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> polygonNum<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="585"></td><td><pre>                <span class="token comment">// 第二个或更多面的点数</span></pre></td></tr><tr><td data-num="586"></td><td><pre>                pointNum <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>coordinatesArry<span class="token punctuation">[</span>y<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="587"></td><td><pre>                x<span class="token operator">+=</span><span class="token number">4</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="588"></td><td><pre>                y<span class="token operator">+=</span><span class="token number">4</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="589"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="590"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="591"></td><td><pre></pre></td></tr><tr><td data-num="592"></td><td><pre>        <span class="token class-name">MultiPolygon</span> multiPolygon <span class="token operator">=</span> <span class="token class-name">GeometryUtil</span><span class="token punctuation">.</span><span class="token function">createMultiPolygon</span><span class="token punctuation">(</span>multiPolygonList<span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Polygon</span><span class="token punctuation">[</span>multiPolygonList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="593"></td><td><pre>        <span class="token comment">// 存在带洞的情况</span></pre></td></tr><tr><td data-num="594"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span>holePolygon<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="595"></td><td><pre>            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">LinearRing</span><span class="token punctuation">></span></span> linearRingList <span class="token operator">=</span> holePolygon<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>hole <span class="token operator">-></span> hole<span class="token punctuation">.</span><span class="token function">getExteriorRing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="596"></td><td><pre>            <span class="token comment">// 创建带洞的面</span></pre></td></tr><tr><td data-num="597"></td><td><pre>            <span class="token class-name">Coordinate</span><span class="token punctuation">[</span><span class="token punctuation">]</span> coordinates <span class="token operator">=</span> multiPolygon<span class="token punctuation">.</span><span class="token function">getCoordinates</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="598"></td><td><pre>            <span class="token class-name">GeometryFactory</span> geometryFactory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GeometryFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="599"></td><td><pre>            <span class="token class-name">LinearRing</span> ring <span class="token operator">=</span> geometryFactory<span class="token punctuation">.</span><span class="token function">createLinearRing</span><span class="token punctuation">(</span>coordinates<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="600"></td><td><pre>            <span class="token class-name">Polygon</span> polygonWithHoles <span class="token operator">=</span> <span class="token class-name">GeometryUtil</span><span class="token punctuation">.</span><span class="token function">createPolygonWithHoles</span><span class="token punctuation">(</span>ring<span class="token punctuation">,</span> linearRingList<span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">LinearRing</span><span class="token punctuation">[</span>holePolygon<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="601"></td><td><pre>            multiPolygon <span class="token operator">=</span> <span class="token class-name">GeometryUtil</span><span class="token punctuation">.</span><span class="token function">createMultiPolygon</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Polygon</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span>polygonWithHoles<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="602"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="603"></td><td><pre>        <span class="token comment">// 检查图形的有效性</span></pre></td></tr><tr><td data-num="604"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>multiPolygon<span class="token punctuation">.</span><span class="token function">isValid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="605"></td><td><pre>            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="606"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="607"></td><td><pre>        <span class="token keyword">return</span> multiPolygon<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="608"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="609"></td><td><pre></pre></td></tr><tr><td data-num="610"></td><td><pre>    <span class="token comment">/**</pre></td></tr><tr><td data-num="611"></td><td><pre>     * 根据解析类型创建点 (面解析方法中使用)</pre></td></tr><tr><td data-num="612"></td><td><pre>     *</pre></td></tr><tr><td data-num="613"></td><td><pre>     * @param pointStr     坐标点 x y 数组</pre></td></tr><tr><td data-num="614"></td><td><pre>     * @param analysisType 解析类型 1. 十进制度、2. 度分秒、3. 投影</pre></td></tr><tr><td data-num="615"></td><td><pre>     * @return</pre></td></tr><tr><td data-num="616"></td><td><pre>     */</span></pre></td></tr><tr><td data-num="617"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Point</span> <span class="token function">polygonAnalysis_point</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> pointStr<span class="token punctuation">,</span> <span class="token class-name">Integer</span> analysisType<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="618"></td><td><pre>        <span class="token comment">// 根据得到的类型解析每个点</span></pre></td></tr><tr><td data-num="619"></td><td><pre>        <span class="token keyword">switch</span> <span class="token punctuation">(</span>analysisType<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="620"></td><td><pre>            <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="621"></td><td><pre>                <span class="token keyword">return</span> <span class="token function">pointDecimalism</span><span class="token punctuation">(</span>pointStr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> pointStr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="622"></td><td><pre>            <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="623"></td><td><pre>                <span class="token keyword">return</span> <span class="token function">pointDFM</span><span class="token punctuation">(</span>pointStr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> pointStr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="624"></td><td><pre>            <span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="625"></td><td><pre>                <span class="token keyword">return</span> <span class="token function">pointEPSG4490</span><span class="token punctuation">(</span>pointStr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> pointStr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="626"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="627"></td><td><pre>        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="628"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="629"></td><td><pre></pre></td></tr><tr><td data-num="630"></td><td><pre>    <span class="token comment">/**</pre></td></tr><tr><td data-num="631"></td><td><pre>     * 获取坐标解析类型 1. 十进制度、2. 度分秒、3. 投影 0. 错误类型</pre></td></tr><tr><td data-num="632"></td><td><pre>     *</pre></td></tr><tr><td data-num="633"></td><td><pre>     * @param pointIndex1 坐标 x y 数组</pre></td></tr><tr><td data-num="634"></td><td><pre>     * @return</pre></td></tr><tr><td data-num="635"></td><td><pre>     */</span></pre></td></tr><tr><td data-num="636"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Integer</span> <span class="token function">polygonAnalysis_type</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> pointIndex1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="637"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span>pointIndex1<span class="token punctuation">.</span>length <span class="token operator">!=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="638"></td><td><pre>            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="639"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="640"></td><td><pre>        <span class="token class-name">Point</span> pointDecimalism <span class="token operator">=</span> <span class="token function">pointDecimalism</span><span class="token punctuation">(</span>pointIndex1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> pointIndex1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="641"></td><td><pre>        <span class="token class-name">Point</span> pointDFM <span class="token operator">=</span> <span class="token function">pointDFM</span><span class="token punctuation">(</span>pointIndex1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> pointIndex1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="642"></td><td><pre>        <span class="token class-name">Point</span> pointEPSG4490 <span class="token operator">=</span> <span class="token function">pointEPSG4490</span><span class="token punctuation">(</span>pointIndex1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> pointIndex1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="643"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isNotNull</span><span class="token punctuation">(</span>pointDecimalism<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="644"></td><td><pre>            <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="645"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="646"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isNotNull</span><span class="token punctuation">(</span>pointDFM<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="647"></td><td><pre>            <span class="token keyword">return</span> <span class="token number">2</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="648"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="649"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isNotNull</span><span class="token punctuation">(</span>pointEPSG4490<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="650"></td><td><pre>            <span class="token keyword">return</span> <span class="token number">3</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="651"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="652"></td><td><pre>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="653"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="654"></td><td><pre></pre></td></tr><tr><td data-num="655"></td><td><pre>    <span class="token comment">/**</pre></td></tr><tr><td data-num="656"></td><td><pre>     * 检查输入的十进制度点坐标</pre></td></tr><tr><td data-num="657"></td><td><pre>     *</pre></td></tr><tr><td data-num="658"></td><td><pre>     * @param x 经度</pre></td></tr><tr><td data-num="659"></td><td><pre>     * @param y 纬度</pre></td></tr><tr><td data-num="660"></td><td><pre>     */</span></pre></td></tr><tr><td data-num="661"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Point</span> <span class="token function">pointDecimalism</span><span class="token punctuation">(</span><span class="token class-name">String</span> x<span class="token punctuation">,</span> <span class="token class-name">String</span> y<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="662"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token class-name">BasicUtil</span><span class="token punctuation">.</span><span class="token function">isDouble</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token class-name">CoordinateUtil</span><span class="token punctuation">.</span><span class="token constant">LNG_PATTERN</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token class-name">BasicUtil</span><span class="token punctuation">.</span><span class="token function">isDouble</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span> <span class="token class-name">CoordinateUtil</span><span class="token punctuation">.</span><span class="token constant">LAT_PATTERN</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="663"></td><td><pre>            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="664"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="665"></td><td><pre>        <span class="token keyword">return</span> <span class="token class-name">CoordinateUtil</span><span class="token punctuation">.</span><span class="token function">createPoint</span><span class="token punctuation">(</span><span class="token class-name">Double</span><span class="token punctuation">.</span><span class="token function">parseDouble</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Double</span><span class="token punctuation">.</span><span class="token function">parseDouble</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="666"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="667"></td><td><pre></pre></td></tr><tr><td data-num="668"></td><td><pre>    <span class="token comment">/**</pre></td></tr><tr><td data-num="669"></td><td><pre>     * 检查输入的度分秒点坐标</pre></td></tr><tr><td data-num="670"></td><td><pre>     *</pre></td></tr><tr><td data-num="671"></td><td><pre>     * @param x 经度</pre></td></tr><tr><td data-num="672"></td><td><pre>     * @param y 纬度</pre></td></tr><tr><td data-num="673"></td><td><pre>     */</span></pre></td></tr><tr><td data-num="674"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Point</span> <span class="token function">pointDFM</span><span class="token punctuation">(</span><span class="token class-name">String</span> x<span class="token punctuation">,</span> <span class="token class-name">String</span> y<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="675"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token class-name">BasicUtil</span><span class="token punctuation">.</span><span class="token function">isPattern</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token class-name">CoordinateUtil</span><span class="token punctuation">.</span><span class="token constant">LNG_PATTERN_D</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token class-name">BasicUtil</span><span class="token punctuation">.</span><span class="token function">isPattern</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span> <span class="token class-name">CoordinateUtil</span><span class="token punctuation">.</span><span class="token constant">LAT_PATTERN_D</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="676"></td><td><pre>            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="677"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="678"></td><td><pre>        <span class="token comment">// 转为十进制度</span></pre></td></tr><tr><td data-num="679"></td><td><pre>        <span class="token keyword">double</span> lon <span class="token operator">=</span> <span class="token class-name">Double</span><span class="token punctuation">.</span><span class="token function">parseDouble</span><span class="token punctuation">(</span><span class="token class-name">CoordinateUtil<span class="token punctuation">.</span>Dms2D</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="680"></td><td><pre>        <span class="token keyword">double</span> lat <span class="token operator">=</span> <span class="token class-name">Double</span><span class="token punctuation">.</span><span class="token function">parseDouble</span><span class="token punctuation">(</span><span class="token class-name">CoordinateUtil<span class="token punctuation">.</span>Dms2D</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="681"></td><td><pre>        <span class="token keyword">return</span> <span class="token class-name">CoordinateUtil</span><span class="token punctuation">.</span><span class="token function">createPoint</span><span class="token punctuation">(</span>lon<span class="token punctuation">,</span> lat<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="682"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="683"></td><td><pre></pre></td></tr><tr><td data-num="684"></td><td><pre>    <span class="token comment">/**</pre></td></tr><tr><td data-num="685"></td><td><pre>     * 检查输入的 2000 大地点坐标</pre></td></tr><tr><td data-num="686"></td><td><pre>     *</pre></td></tr><tr><td data-num="687"></td><td><pre>     * @param x 经度</pre></td></tr><tr><td data-num="688"></td><td><pre>     * @param y 纬度</pre></td></tr><tr><td data-num="689"></td><td><pre>     */</span></pre></td></tr><tr><td data-num="690"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Point</span> <span class="token function">pointEPSG4490</span><span class="token punctuation">(</span><span class="token class-name">String</span> x<span class="token punctuation">,</span> <span class="token class-name">String</span> y<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="691"></td><td><pre>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="692"></td><td><pre>            <span class="token keyword">double</span><span class="token punctuation">[</span><span class="token punctuation">]</span> doubles <span class="token operator">=</span> <span class="token class-name">CoordinateUtil</span></pre></td></tr><tr><td data-num="693"></td><td><pre>                    <span class="token punctuation">.</span><span class="token function">transTo4490fromProjectionByEpsg</span><span class="token punctuation">(</span><span class="token class-name">Double</span><span class="token punctuation">.</span><span class="token function">parseDouble</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Double</span><span class="token punctuation">.</span><span class="token function">parseDouble</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">,</span> y<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="694"></td><td><pre>            <span class="token keyword">return</span> <span class="token class-name">CoordinateUtil</span><span class="token punctuation">.</span><span class="token function">createPoint</span><span class="token punctuation">(</span>doubles<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> doubles<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="695"></td><td><pre>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="696"></td><td><pre>            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="697"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="698"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="699"></td><td><pre></pre></td></tr><tr><td data-num="700"></td><td><pre></pre></td></tr><tr><td data-num="701"></td><td><pre>    <span class="token comment">/**</pre></td></tr><tr><td data-num="702"></td><td><pre>     * 读取 WKT 格式数据</pre></td></tr><tr><td data-num="703"></td><td><pre>     * @param WKT</pre></td></tr><tr><td data-num="704"></td><td><pre>     * @return</pre></td></tr><tr><td data-num="705"></td><td><pre>     */</span></pre></td></tr><tr><td data-num="706"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Geometry</span> <span class="token function">readWKT</span><span class="token punctuation">(</span><span class="token class-name">String</span> <span class="token constant">WKT</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="707"></td><td><pre>        <span class="token comment">// 读取坐标</span></pre></td></tr><tr><td data-num="708"></td><td><pre>        <span class="token class-name">WKTReader2</span> wktReader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WKTReader2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="709"></td><td><pre>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="710"></td><td><pre>            <span class="token keyword">return</span> wktReader<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token constant">WKT</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="711"></td><td><pre>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ParseException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="712"></td><td><pre>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="713"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="714"></td><td><pre>        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="715"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="716"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;解析shp文件&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#解析shp文件&quot;&gt;#&lt;/a&gt; 解析 shp 文件&lt;/h1&gt;
&lt;p&gt;&lt;strong&gt;导入依赖&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight xml&quot;&gt;&lt;figcapti</summary>
      
    
    
    
    <category term="计算机学科" scheme="https://pigpigletsgo.github.io/categories/computer-science/"/>
    
    <category term="java" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/"/>
    
    <category term="第三方库" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/"/>
    
    
    <category term="计算机学科" scheme="https://pigpigletsgo.github.io/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%AD%A6%E7%A7%91/"/>
    
    <category term="第三方库" scheme="https://pigpigletsgo.github.io/tags/%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/"/>
    
    <category term="geotools" scheme="https://pigpigletsgo.github.io/tags/geotools/"/>
    
  </entry>
  
  <entry>
    <title>java基于geotools实现的几何图形坐标系转换通用工具类geotools几何坐标转换java几何坐标转换</title>
    <link href="https://pigpigletsgo.github.io/computer-science/java/%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/java%E5%9F%BA%E4%BA%8Egeotools%E5%AE%9E%E7%8E%B0%E7%9A%84%E5%87%A0%E4%BD%95%E5%9B%BE%E5%BD%A2%E5%9D%90%E6%A0%87%E7%B3%BB%E8%BD%AC%E6%8D%A2%E9%80%9A%E7%94%A8%E5%B7%A5%E5%85%B7%E7%B1%BBgeotools%E5%87%A0%E4%BD%95%E5%9D%90%E6%A0%87%E8%BD%AC%E6%8D%A2java%E5%87%A0%E4%BD%95%E5%9D%90%E6%A0%87%E8%BD%AC%E6%8D%A2/"/>
    <id>https://pigpigletsgo.github.io/computer-science/java/%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/java%E5%9F%BA%E4%BA%8Egeotools%E5%AE%9E%E7%8E%B0%E7%9A%84%E5%87%A0%E4%BD%95%E5%9B%BE%E5%BD%A2%E5%9D%90%E6%A0%87%E7%B3%BB%E8%BD%AC%E6%8D%A2%E9%80%9A%E7%94%A8%E5%B7%A5%E5%85%B7%E7%B1%BBgeotools%E5%87%A0%E4%BD%95%E5%9D%90%E6%A0%87%E8%BD%AC%E6%8D%A2java%E5%87%A0%E4%BD%95%E5%9D%90%E6%A0%87%E8%BD%AC%E6%8D%A2/</id>
    <published>2024-05-28T09:23:40.387Z</published>
    <updated>2024-05-29T00:06:45.214Z</updated>
    
    <content type="html"><![CDATA[<h1 id="java基于geotools实现的几何图形坐标系转换通用工具类geotools几何坐标转换java几何坐标转换"><a class="anchor" href="#java基于geotools实现的几何图形坐标系转换通用工具类geotools几何坐标转换java几何坐标转换">#</a> java 基于 geotools 实现的几何图形坐标系转换通用工具类 geotools 几何坐标转换 java 几何坐标转换</h1><p><strong>导入依赖</strong></p><figure class="highlight xml"><figcaption data-lang="XML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">&lt;!-- shp 文件解析 --></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.gdal<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="4"></td><td><pre>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>gdal<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>3.5.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="8"></td><td><pre>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>net.postgis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="9"></td><td><pre>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>postgis-jdbc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="10"></td><td><pre>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.5.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token comment">&lt;!-- 解析 shp 文件 --></span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="15"></td><td><pre>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.geotools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="16"></td><td><pre>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>gt-shapefile<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="17"></td><td><pre>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>25.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="19"></td><td><pre></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="21"></td><td><pre>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.geotools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="22"></td><td><pre>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>gt-epsg-wkt<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="23"></td><td><pre>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>25.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="25"></td><td><pre></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="27"></td><td><pre>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.geotools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="28"></td><td><pre>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>gt-geojson<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="29"></td><td><pre>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>25.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><p>在 gis 开发中，前端地图通常使用地理坐标，而后端在计算几何面积等操作时，需要使用投影坐标。这个过程中需要进行坐标转换。下面带来了一个 java 基于 geotools 开发的坐标转换工具类，支持点，线，面等几何图形进行地理坐标与投影坐标间互相转换</p><h2 id="一-转换效果"><a class="anchor" href="#一-转换效果">#</a> 一、转换效果</h2><p>下图是使用工具类进行地理坐标转投影坐标，投影坐标转地理坐标，带号投影坐标与无带号投影坐标间转换的示例效果</p><p>如下是 转换效果图</p><p><img data-src="https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20240528171256811.png" alt="image-20240528171256811" /></p><h2 id="二-实现过程"><a class="anchor" href="#二-实现过程">#</a> 二、实现过程</h2><p>为便于使用，定义了通用的几何坐标转换方法 coordinateTransform (Geometry sourceGeometry,int targetSrid)，传入源几何对象和目标坐标 gis 即可</p><h3 id="1-固定坐标系轴方向"><a class="anchor" href="#1-固定坐标系轴方向">#</a> 1、固定坐标系轴方向</h3><p>通过下面代码固定坐标系轴方向，如果不对坐标系轴方向进行固定，则会使不同运行环境的坐标系 x，y 方向不同，进而可能出现本地开发时坐标转换正常，但是部署到服务器后坐标转换结果异常的迷之 bug</p><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token class-name">CRSAuthorityFactory</span> factory <span class="token operator">=</span> <span class="token constant">CRS</span><span class="token punctuation">.</span><span class="token function">getAuthorityFactory</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="2-创建转换坐标系"><a class="anchor" href="#2-创建转换坐标系">#</a> 2、创建转换坐标系</h3><p>通过下面代码创建源坐标系和目标坐标系，这里从传递进来的源几何参数 (Geometry sourceGeometry) 中获取源坐标系 srid (srid 指空间参照标识符，每个坐标系定义均有一个唯一的标识，通常为 4 位整数值)</p><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token class-name">CoordinateReferenceSystem</span> source <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createCoordinateReferenceSystem</span><span class="token punctuation">(</span><span class="token string">"EPSG:"</span> <span class="token operator">+</span> sourceGeometry<span class="token punctuation">.</span><span class="token function">getSRID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token class-name">CoordinateReferenceSystem</span> target <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createCoordinateReferenceSystem</span><span class="token punctuation">(</span><span class="token string">"EPSG:"</span> <span class="token operator">+</span> targetSrid<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="3-建立坐标转换"><a class="anchor" href="#3-建立坐标转换">#</a> 3、建立坐标转换</h3><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token class-name">MathTransform</span> transform <span class="token operator">=</span> <span class="token constant">CRS</span><span class="token punctuation">.</span><span class="token function">findMathTransform</span><span class="token punctuation">(</span>source<span class="token punctuation">,</span> target<span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="4-进行坐标转换"><a class="anchor" href="#4-进行坐标转换">#</a> 4、进行坐标转换</h3><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token class-name">Geometry</span> res <span class="token operator">=</span> <span class="token constant">JTS</span><span class="token punctuation">.</span><span class="token function">transform</span><span class="token punctuation">(</span>sourceGeometry<span class="token punctuation">,</span> transform<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="5-完整坐标转换方法代码"><a class="anchor" href="#5-完整坐标转换方法代码">#</a> 5、完整坐标转换方法代码</h3><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Geometry</span> <span class="token function">coordinateTransform</span><span class="token punctuation">(</span><span class="token class-name">Geometry</span> sourceGeometry<span class="token punctuation">,</span><span class="token keyword">int</span> targetSrid<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>   <span class="token keyword">if</span> <span class="token punctuation">(</span>sourceGeometry <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> sourceGeometry<span class="token punctuation">.</span><span class="token function">getSRID</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> targetSrid <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>      <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>   <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>   <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>      <span class="token class-name">CRSAuthorityFactory</span> factory <span class="token operator">=</span> <span class="token constant">CRS</span><span class="token punctuation">.</span><span class="token function">getAuthorityFactory</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>      <span class="token class-name">CoordinateReferenceSystem</span> source <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createCoordinateReferenceSystem</span><span class="token punctuation">(</span><span class="token string">"EPSG:"</span> <span class="token operator">+</span> sourceGeometry<span class="token punctuation">.</span><span class="token function">getSRID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="8"></td><td><pre>      <span class="token class-name">CoordinateReferenceSystem</span> target <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createCoordinateReferenceSystem</span><span class="token punctuation">(</span><span class="token string">"EPSG:"</span> <span class="token operator">+</span> targetSrid<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>      <span class="token class-name">MathTransform</span> transform <span class="token operator">=</span> <span class="token constant">CRS</span><span class="token punctuation">.</span><span class="token function">findMathTransform</span><span class="token punctuation">(</span>source<span class="token punctuation">,</span> target<span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="10"></td><td><pre>      <span class="token class-name">Geometry</span> res <span class="token operator">=</span> <span class="token constant">JTS</span><span class="token punctuation">.</span><span class="token function">transform</span><span class="token punctuation">(</span>sourceGeometry<span class="token punctuation">,</span> transform<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>      <span class="token keyword">if</span> <span class="token punctuation">(</span>res <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>         res<span class="token punctuation">.</span><span class="token function">setSRID</span><span class="token punctuation">(</span>targetSrid<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>      <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>      <span class="token keyword">return</span> res<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>   <span class="token punctuation">&#125;</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">FactoryException</span> <span class="token operator">|</span> <span class="token class-name">TransformException</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>      e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>   <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>   <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h2 id="三-工具类使用"><a class="anchor" href="#三-工具类使用">#</a> 三、工具类使用</h2><h3 id="1-创建几何对象"><a class="anchor" href="#1-创建几何对象">#</a> 1、创建几何对象</h3><p>这里使用 wkt 格式几何坐标串进行实例演示坐标转换，这里写一个 wkt 转几何对象的通用方法 createGeometry (String wkt,int srid)，传入 wkt 和坐标系 srid 即可，实现代码如下：</p><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Geometry</span> <span class="token function">createGeometry</span><span class="token punctuation">(</span><span class="token class-name">String</span> wkt<span class="token punctuation">,</span><span class="token keyword">int</span> srid<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>   <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtil</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>wkt<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>      <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>   <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>   <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>      <span class="token class-name">WKTReader</span> reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WKTReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>      <span class="token class-name">Geometry</span> geometry <span class="token operator">=</span> reader<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>wkt<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>      geometry<span class="token punctuation">.</span><span class="token function">setSRID</span><span class="token punctuation">(</span>srid<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>      <span class="token keyword">return</span> geometry<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>   <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>      e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>   <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>   <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h3 id="2-坐标转换示例"><a class="anchor" href="#2-坐标转换示例">#</a> 2、坐标转换示例</h3><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>   <span class="token class-name">String</span> wkt <span class="token operator">=</span> <span class="token string">"POINT (106.61 25.32)"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>   <span class="token class-name">Geometry</span> source <span class="token operator">=</span> <span class="token function">createGeometry</span><span class="token punctuation">(</span>wkt<span class="token punctuation">,</span><span class="token number">4490</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>   <span class="token class-name">Geometry</span> res <span class="token operator">=</span> <span class="token function">coordinateTransform</span><span class="token punctuation">(</span>source<span class="token punctuation">,</span> <span class="token number">4524</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>   <span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>使用示例代码结果图</p><p><img data-src="https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20240528172022861.png" alt="image-20240528172022861" /></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;java基于geotools实现的几何图形坐标系转换通用工具类geotools几何坐标转换java几何坐标转换&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#java基于geotools实现的几何图形坐标系转换通用工具类geotools几何坐标转换java几</summary>
      
    
    
    
    <category term="计算机学科" scheme="https://pigpigletsgo.github.io/categories/computer-science/"/>
    
    <category term="java" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/"/>
    
    <category term="第三方库" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/"/>
    
    
    <category term="计算机学科" scheme="https://pigpigletsgo.github.io/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%AD%A6%E7%A7%91/"/>
    
    <category term="第三方库" scheme="https://pigpigletsgo.github.io/tags/%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/"/>
    
    <category term="geotools" scheme="https://pigpigletsgo.github.io/tags/geotools/"/>
    
  </entry>
  
  <entry>
    <title>NpcapLoopbackAdapter没有有效的IP配置</title>
    <link href="https://pigpigletsgo.github.io/bug/windows/NpcapLoopbackAdapter%E6%B2%A1%E6%9C%89%E6%9C%89%E6%95%88%E7%9A%84IP%E9%85%8D%E7%BD%AE/"/>
    <id>https://pigpigletsgo.github.io/bug/windows/NpcapLoopbackAdapter%E6%B2%A1%E6%9C%89%E6%9C%89%E6%95%88%E7%9A%84IP%E9%85%8D%E7%BD%AE/</id>
    <published>2024-05-27T00:24:21.870Z</published>
    <updated>2024-05-27T06:01:54.331Z</updated>
    
    <content type="html"><![CDATA[<h1 id="npcap-loopback-adapter没有有效的-ip-配置"><a class="anchor" href="#npcap-loopback-adapter没有有效的-ip-配置">#</a> &quot;Npcap Loopback Adapter&quot; 没有有效的 IP 配置</h1><p>电脑能连上 wifi，但是不能使用有线，疑难解答显示如下</p><p><img data-src="https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20240527082239396.png" alt="image-20240527082239396" /></p><h4 id="解决方法"><a class="anchor" href="#解决方法">#</a> 解决方法：</h4><p><strong>1、查看相关服务是否被禁用：</strong></p><p>打开【运行】（Win+R 组合键），输入 services.msc 点击确定，打开服务界面。</p><p>在服务界面中找到【Wired AutoConfig】和【WLan AutoConfig】两个服务。如果未运行，首先右击选择【属性】，将 “启动类型” 修改为 “自动”，点击【应用】，然后点击【启动】—【确定】即可。</p><p><strong>2、重新启用网络：</strong></p><p>在开始菜单上单击鼠标右键，在弹出的菜单中点击 “网络连接”。</p><p>在 “以太网” 点击右键，选择【禁用】，然后双击重新启用。</p><p><strong>3、重置 Winsock 目录</strong></p><p>在开始菜单上点击鼠标右键，在弹出的菜单中点击 “命令提示符 (管理员)”。</p><p>在命令提示符框中输入：netsh winsock reset 按下回车键，会提示：成功地重置 Winsock 目录（电脑中安装了杀毒软件的可能会弹出阻止窗口，选择【允许操作】即可）。</p><p>重启电脑后一般可以解决问题。</p><p>总结：方法 1，如果被禁用的话根本搜不到 Wi-Fi 也无法连接，方法 2 主要用于解决网络不稳定产生的问题，还可以利用 “疑难解答”，快速解决网络问题，在方法 2 的 “以太网” 右击，选择【疑难解答】，系统会自动检测问题，并进行修复。我是使用方法 3 之后解决的。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;npcap-loopback-adapter没有有效的-ip-配置&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#npcap-loopback-adapter没有有效的-ip-配置&quot;&gt;#&lt;/a&gt; &amp;quot;Npcap Loopback Adapter&amp;qu</summary>
      
    
    
    
    <category term="问题总汇" scheme="https://pigpigletsgo.github.io/categories/bug/"/>
    
    <category term="windows" scheme="https://pigpigletsgo.github.io/categories/bug/windows/"/>
    
    
    <category term="问题总汇" scheme="https://pigpigletsgo.github.io/tags/%E9%97%AE%E9%A2%98%E6%80%BB%E6%B1%87/"/>
    
    <category term="windows" scheme="https://pigpigletsgo.github.io/tags/windows/"/>
    
  </entry>
  
  <entry>
    <title>sql-blog-day2024-05-26(查询列表性能代码问题)</title>
    <link href="https://pigpigletsgo.github.io/computer-science/blog/sql-blog-day2024-05-26/"/>
    <id>https://pigpigletsgo.github.io/computer-science/blog/sql-blog-day2024-05-26/</id>
    <published>2024-05-26T12:35:46.950Z</published>
    <updated>2024-05-26T14:23:36.578Z</updated>
    
    <content type="html"><![CDATA[<h1 id="sql-blog-day2024-05-26"><a class="anchor" href="#sql-blog-day2024-05-26">#</a> sql-blog-day2024-05-26</h1><h2 id="场景"><a class="anchor" href="#场景">#</a> 场景：</h2><p>今天写了一个数据量大的列表查询业务代码，需求是 查询一个 3 千多数据的表还要根据这个表的字段去查询另一个表对应的总数量。一对多关系的，然后在数据查询出来处理数据的时候使用 map 去处理数据结果是每条数据都要进行查询计算总数极大的影响都了性能问题，下面记录解决方式</p><h2 id="代码"><a class="anchor" href="#代码">#</a> 代码：</h2><h3 id="coontroller"><a class="anchor" href="#coontroller">#</a> coontroller</h3><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">/**</pre></td></tr><tr><td data-num="2"></td><td><pre>  * 分页查询矿山图层管理数据</pre></td></tr><tr><td data-num="3"></td><td><pre>  * @param mineLayerDataDto</pre></td></tr><tr><td data-num="4"></td><td><pre>  * @return</pre></td></tr><tr><td data-num="5"></td><td><pre>  */</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token annotation punctuation">@Anonymous</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"/getAll"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">public</span> <span class="token class-name">TableDataInfo</span> <span class="token function">dataAll</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">MineLayerDataDto</span> mineLayerDataDto<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>   <span class="token keyword">return</span> ksJbxxhzService<span class="token punctuation">.</span><span class="token function">dataAll</span><span class="token punctuation">(</span>mineLayerDataDto<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h3 id="dto类"><a class="anchor" href="#dto类">#</a> dto 类</h3><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token annotation punctuation">@Data</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token annotation punctuation">@NoArgsConstructor</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">KsTcCountDto</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">private</span> <span class="token class-name">String</span> xkzh<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">private</span> <span class="token class-name">Long</span> count<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h3 id="mapper"><a class="anchor" href="#mapper">#</a> mapper</h3><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">/**</pre></td></tr><tr><td data-num="2"></td><td><pre>     * 查询挂载数量</pre></td></tr><tr><td data-num="3"></td><td><pre>     * @param xkzhList</pre></td></tr><tr><td data-num="4"></td><td><pre>     * @return</pre></td></tr><tr><td data-num="5"></td><td><pre>     */</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token annotation punctuation">@Select</span><span class="token punctuation">(</span><span class="token string">"&lt;script>"</span> <span class="token operator">+</span></pre></td></tr><tr><td data-num="7"></td><td><pre>        <span class="token string">"SELECT xkzh, COUNT(*) as count FROM ks_tc "</span> <span class="token operator">+</span></pre></td></tr><tr><td data-num="8"></td><td><pre>        <span class="token string">"WHERE xkzh IN "</span> <span class="token operator">+</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        <span class="token string">"&lt;foreach item='item' index='index' collection='list' open='(' separator=',' close=')'>"</span> <span class="token operator">+</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        <span class="token string">"#&#123;item&#125;"</span> <span class="token operator">+</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        <span class="token string">"&lt;/foreach> "</span> <span class="token operator">+</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        <span class="token string">"GROUP BY xkzh"</span> <span class="token operator">+</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        <span class="token string">"&lt;/script>"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">KsTcCountDto</span><span class="token punctuation">></span></span> <span class="token function">selectCountByXkzhBatch</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">"list"</span><span class="token punctuation">)</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> xkzhList<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="service"><a class="anchor" href="#service">#</a> service</h3><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">/**</pre></td></tr><tr><td data-num="2"></td><td><pre> * 分页查询矿山图层管理数据</pre></td></tr><tr><td data-num="3"></td><td><pre> * @param mineLayerDataDto</pre></td></tr><tr><td data-num="4"></td><td><pre> * @return</pre></td></tr><tr><td data-num="5"></td><td><pre> */</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token class-name">TableDataInfo</span> <span class="token function">dataAll</span><span class="token punctuation">(</span><span class="token class-name">MineLayerDataDto</span> mineLayerDataDto<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="serviceimpl"><a class="anchor" href="#serviceimpl">#</a> serviceImpl</h3><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">/**</pre></td></tr><tr><td data-num="2"></td><td><pre> * 分页查询矿山图层管理数据</pre></td></tr><tr><td data-num="3"></td><td><pre> * @param mineLayerDataDto</pre></td></tr><tr><td data-num="4"></td><td><pre> * @return</pre></td></tr><tr><td data-num="5"></td><td><pre> */</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token annotation punctuation">@Override</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">public</span> <span class="token class-name">TableDataInfo</span> <span class="token function">dataAll</span><span class="token punctuation">(</span><span class="token class-name">MineLayerDataDto</span> mineLayerDataDto<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>   <span class="token class-name">TableDataInfo</span> tableDataInfo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TableDataInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>   <span class="token class-name">Page</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">KsJbxxhz</span><span class="token punctuation">></span></span> page <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Page</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span>mineLayerDataDto<span class="token punctuation">.</span><span class="token function">getPageNo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> mineLayerDataDto<span class="token punctuation">.</span><span class="token function">getPageSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>   <span class="token class-name">Page</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">KsJbxxhz</span><span class="token punctuation">></span></span> result <span class="token operator">=</span> baseMapper<span class="token punctuation">.</span><span class="token function">selectPage</span><span class="token punctuation">(</span>page<span class="token punctuation">,</span> <span class="token class-name">Wrappers</span><span class="token punctuation">.</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">KsJbxxhz</span><span class="token punctuation">></span></span><span class="token function">lambdaQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>                                                 <span class="token punctuation">.</span><span class="token function">like</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">StringUtil</span><span class="token punctuation">.</span><span class="token function">isNullOrEmpty</span><span class="token punctuation">(</span>mineLayerDataDto<span class="token punctuation">.</span><span class="token function">getKsmc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">KsJbxxhz</span><span class="token operator">::</span><span class="token function">getKsmc</span><span class="token punctuation">,</span> mineLayerDataDto<span class="token punctuation">.</span><span class="token function">getKsmc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre>                                                 <span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span>mineLayerDataDto<span class="token punctuation">.</span><span class="token function">getKsfl</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token class-name">KsJbxxhz</span><span class="token operator">::</span><span class="token function">getKsfl</span><span class="token punctuation">,</span> mineLayerDataDto<span class="token punctuation">.</span><span class="token function">getKsfl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>                                                 <span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span>mineLayerDataDto<span class="token punctuation">.</span><span class="token function">getKqlx</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token class-name">KsJbxxhz</span><span class="token operator">::</span><span class="token function">getKqlx</span><span class="token punctuation">,</span> mineLayerDataDto<span class="token punctuation">.</span><span class="token function">getKqlx</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>                                                 <span class="token punctuation">.</span><span class="token function">like</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">StringUtil</span><span class="token punctuation">.</span><span class="token function">isNullOrEmpty</span><span class="token punctuation">(</span>mineLayerDataDto<span class="token punctuation">.</span><span class="token function">getSzxzqmc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">KsJbxxhz</span><span class="token operator">::</span><span class="token function">getSzxzqmc</span><span class="token punctuation">,</span> mineLayerDataDto<span class="token punctuation">.</span><span class="token function">getSzxzqmc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre>                                                 <span class="token punctuation">.</span><span class="token function">like</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">StringUtil</span><span class="token punctuation">.</span><span class="token function">isNullOrEmpty</span><span class="token punctuation">(</span>mineLayerDataDto<span class="token punctuation">.</span><span class="token function">getXkzh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">KsJbxxhz</span><span class="token operator">::</span><span class="token function">getXkzh</span><span class="token punctuation">,</span> mineLayerDataDto<span class="token punctuation">.</span><span class="token function">getXkzh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre>                                                 <span class="token punctuation">.</span><span class="token function">ge</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">StringUtil</span><span class="token punctuation">.</span><span class="token function">isNullOrEmpty</span><span class="token punctuation">(</span>mineLayerDataDto<span class="token punctuation">.</span><span class="token function">getYxqq</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">KsJbxxhz</span><span class="token operator">::</span><span class="token function">getYxqq</span><span class="token punctuation">,</span> <span class="token class-name">DateUtil</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>mineLayerDataDto<span class="token punctuation">.</span><span class="token function">getYxqq</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre>                                                 <span class="token punctuation">.</span><span class="token function">le</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">StringUtil</span><span class="token punctuation">.</span><span class="token function">isNullOrEmpty</span><span class="token punctuation">(</span>mineLayerDataDto<span class="token punctuation">.</span><span class="token function">getYxqz</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">KsJbxxhz</span><span class="token operator">::</span><span class="token function">getYxqz</span><span class="token punctuation">,</span> <span class="token class-name">DateUtil</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>mineLayerDataDto<span class="token punctuation">.</span><span class="token function">getYxqz</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>   <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">KsJbxxhz</span><span class="token punctuation">></span></span> records <span class="token operator">=</span> result<span class="token punctuation">.</span><span class="token function">getRecords</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>   <span class="token comment">// 判断是否查询已挂载数据</span></pre></td></tr><tr><td data-num="21"></td><td><pre>   <span class="token keyword">if</span> <span class="token punctuation">(</span>mineLayerDataDto<span class="token punctuation">.</span><span class="token function">getGstate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> mineLayerDataDto<span class="token punctuation">.</span><span class="token function">getGstate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">KsflEnum</span><span class="token punctuation">.</span><span class="token constant">MOUNTED</span><span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre>   <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>      <span class="token class-name">String</span> data <span class="token operator">=</span> ksTcService<span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>r <span class="token operator">-></span> r<span class="token punctuation">.</span><span class="token function">getXkzh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">joining</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>      records <span class="token operator">=</span> records<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>r <span class="token operator">-></span> data<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span><span class="token function">getXkzh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>   <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>   <span class="token comment">//todo 优化代码，增加请求速度 (finish)</span></pre></td></tr><tr><td data-num="27"></td><td><pre>   <span class="token comment">// Step 1: 从记录中提取所有不同的 Xkzh 值</span></pre></td></tr><tr><td data-num="28"></td><td><pre>   <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> xkzhList <span class="token operator">=</span> records<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="29"></td><td><pre>      <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">KsJbxxhz</span><span class="token operator">::</span><span class="token function">getXkzh</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre>      <span class="token punctuation">.</span><span class="token function">distinct</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="31"></td><td><pre>      <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>   <span class="token comment">// Step 2: 执行批处理查询以获取计数</span></pre></td></tr><tr><td data-num="33"></td><td><pre>   <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Long</span><span class="token punctuation">></span></span> xkzhCountMap <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">countByXkzhBatch</span><span class="token punctuation">(</span>xkzhList<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>   <span class="token comment">// Step 3: 设置每条记录的 Qishu 值</span></pre></td></tr><tr><td data-num="35"></td><td><pre>   records<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>v <span class="token operator">-></span> v<span class="token punctuation">.</span><span class="token function">setQishu</span><span class="token punctuation">(</span>xkzhCountMap<span class="token punctuation">.</span><span class="token function">getOrDefault</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span><span class="token function">getXkzh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0L</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>   <span class="token keyword">int</span> total <span class="token operator">=</span> records<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>   tableDataInfo<span class="token punctuation">.</span><span class="token function">setCode</span><span class="token punctuation">(</span><span class="token class-name">HttpStatus</span><span class="token punctuation">.</span><span class="token constant">SUCCESS</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>   tableDataInfo<span class="token punctuation">.</span><span class="token function">setMsg</span><span class="token punctuation">(</span><span class="token string">"success"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="39"></td><td><pre>   tableDataInfo<span class="token punctuation">.</span><span class="token function">setRows</span><span class="token punctuation">(</span>records<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="40"></td><td><pre>   tableDataInfo<span class="token punctuation">.</span><span class="token function">setTotal</span><span class="token punctuation">(</span>total<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>   <span class="token keyword">return</span> tableDataInfo<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="42"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="43"></td><td><pre></pre></td></tr><tr><td data-num="44"></td><td><pre><span class="token comment">/**</pre></td></tr><tr><td data-num="45"></td><td><pre>  * 根据许可证号集合查询总数并返回</pre></td></tr><tr><td data-num="46"></td><td><pre>  * @param xkzhList</pre></td></tr><tr><td data-num="47"></td><td><pre>  * @return</pre></td></tr><tr><td data-num="48"></td><td><pre>  */</span></pre></td></tr><tr><td data-num="49"></td><td><pre><span class="token keyword">public</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Long</span><span class="token punctuation">></span></span> <span class="token function">countByXkzhBatch</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> xkzhList<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="50"></td><td><pre>   <span class="token keyword">return</span> baseMapper<span class="token punctuation">.</span><span class="token function">selectCountByXkzhBatch</span><span class="token punctuation">(</span>xkzhList<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="51"></td><td><pre>      <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toMap</span><span class="token punctuation">(</span><span class="token class-name">KsTcCountDto</span><span class="token operator">::</span><span class="token function">getXkzh</span><span class="token punctuation">,</span> <span class="token class-name">KsTcCountDto</span><span class="token operator">::</span><span class="token function">getCount</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="52"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>之前写的代码如下 (OUT)：性能极差</p><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token annotation punctuation">@Override</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">public</span> <span class="token class-name">TableDataInfo</span> <span class="token function">dataAll</span><span class="token punctuation">(</span><span class="token class-name">MineLayerDataDto</span> mineLayerDataDto<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>   <span class="token class-name">TableDataInfo</span> tableDataInfo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TableDataInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>   <span class="token class-name">Page</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">KsJbxxhz</span><span class="token punctuation">></span></span> page <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Page</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span>mineLayerDataDto<span class="token punctuation">.</span><span class="token function">getPageNo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> mineLayerDataDto<span class="token punctuation">.</span><span class="token function">getPageSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>   <span class="token class-name">Page</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">KsJbxxhz</span><span class="token punctuation">></span></span> result <span class="token operator">=</span> baseMapper<span class="token punctuation">.</span><span class="token function">selectPage</span><span class="token punctuation">(</span>page<span class="token punctuation">,</span> <span class="token class-name">Wrappers</span><span class="token punctuation">.</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">KsJbxxhz</span><span class="token punctuation">></span></span><span class="token function">lambdaQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>                                                 <span class="token punctuation">.</span><span class="token function">like</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">StringUtil</span><span class="token punctuation">.</span><span class="token function">isNullOrEmpty</span><span class="token punctuation">(</span>mineLayerDataDto<span class="token punctuation">.</span><span class="token function">getKsmc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">KsJbxxhz</span><span class="token operator">::</span><span class="token function">getKsmc</span><span class="token punctuation">,</span> mineLayerDataDto<span class="token punctuation">.</span><span class="token function">getKsmc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>                                                 <span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span>mineLayerDataDto<span class="token punctuation">.</span><span class="token function">getKsfl</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token class-name">KsJbxxhz</span><span class="token operator">::</span><span class="token function">getKsfl</span><span class="token punctuation">,</span> mineLayerDataDto<span class="token punctuation">.</span><span class="token function">getKsfl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>                                                 <span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span>mineLayerDataDto<span class="token punctuation">.</span><span class="token function">getKqlx</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token class-name">KsJbxxhz</span><span class="token operator">::</span><span class="token function">getKqlx</span><span class="token punctuation">,</span> mineLayerDataDto<span class="token punctuation">.</span><span class="token function">getKqlx</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>                                                 <span class="token punctuation">.</span><span class="token function">like</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">StringUtil</span><span class="token punctuation">.</span><span class="token function">isNullOrEmpty</span><span class="token punctuation">(</span>mineLayerDataDto<span class="token punctuation">.</span><span class="token function">getSzxzqmc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">KsJbxxhz</span><span class="token operator">::</span><span class="token function">getSzxzqmc</span><span class="token punctuation">,</span> mineLayerDataDto<span class="token punctuation">.</span><span class="token function">getSzxzqmc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>                                                 <span class="token punctuation">.</span><span class="token function">like</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">StringUtil</span><span class="token punctuation">.</span><span class="token function">isNullOrEmpty</span><span class="token punctuation">(</span>mineLayerDataDto<span class="token punctuation">.</span><span class="token function">getXkzh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">KsJbxxhz</span><span class="token operator">::</span><span class="token function">getXkzh</span><span class="token punctuation">,</span> mineLayerDataDto<span class="token punctuation">.</span><span class="token function">getXkzh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>                                                 <span class="token punctuation">.</span><span class="token function">ge</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">StringUtil</span><span class="token punctuation">.</span><span class="token function">isNullOrEmpty</span><span class="token punctuation">(</span>mineLayerDataDto<span class="token punctuation">.</span><span class="token function">getYxqq</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">KsJbxxhz</span><span class="token operator">::</span><span class="token function">getYxqq</span><span class="token punctuation">,</span> <span class="token class-name">DateUtil</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>mineLayerDataDto<span class="token punctuation">.</span><span class="token function">getYxqq</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre>                                                 <span class="token punctuation">.</span><span class="token function">le</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">StringUtil</span><span class="token punctuation">.</span><span class="token function">isNullOrEmpty</span><span class="token punctuation">(</span>mineLayerDataDto<span class="token punctuation">.</span><span class="token function">getYxqz</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">KsJbxxhz</span><span class="token operator">::</span><span class="token function">getYxqz</span><span class="token punctuation">,</span> <span class="token class-name">DateUtil</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>mineLayerDataDto<span class="token punctuation">.</span><span class="token function">getYxqz</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>   <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">KsJbxxhz</span><span class="token punctuation">></span></span> records <span class="token operator">=</span> result<span class="token punctuation">.</span><span class="token function">getRecords</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>   <span class="token comment">// 判断是否查询已挂载数据</span></pre></td></tr><tr><td data-num="16"></td><td><pre>   <span class="token keyword">if</span> <span class="token punctuation">(</span>mineLayerDataDto<span class="token punctuation">.</span><span class="token function">getGstate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> mineLayerDataDto<span class="token punctuation">.</span><span class="token function">getGstate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">KsflEnum</span><span class="token punctuation">.</span><span class="token constant">MOUNTED</span><span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre>   <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>      <span class="token class-name">String</span> data <span class="token operator">=</span> ksTcService<span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>r <span class="token operator">-></span> r<span class="token punctuation">.</span><span class="token function">getXkzh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">joining</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>      records <span class="token operator">=</span> records<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>r <span class="token operator">-></span> data<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span><span class="token function">getXkzh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>v <span class="token operator">-></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>         v<span class="token punctuation">.</span><span class="token function">setQishu</span><span class="token punctuation">(</span>ksTcService<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token class-name">Wrappers</span><span class="token punctuation">.</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">KsTc</span><span class="token punctuation">></span></span><span class="token function">lambdaQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">KsTc</span><span class="token operator">::</span><span class="token function">getXkzh</span><span class="token punctuation">,</span> v<span class="token punctuation">.</span><span class="token function">getXkzh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>         <span class="token keyword">return</span> v<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>   <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>   <span class="token keyword">int</span> total <span class="token operator">=</span> records<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>   tableDataInfo<span class="token punctuation">.</span><span class="token function">setCode</span><span class="token punctuation">(</span><span class="token class-name">HttpStatus</span><span class="token punctuation">.</span><span class="token constant">SUCCESS</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>   tableDataInfo<span class="token punctuation">.</span><span class="token function">setMsg</span><span class="token punctuation">(</span><span class="token string">"success"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>   tableDataInfo<span class="token punctuation">.</span><span class="token function">setRows</span><span class="token punctuation">(</span>records<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>   tableDataInfo<span class="token punctuation">.</span><span class="token function">setTotal</span><span class="token punctuation">(</span>total<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>   <span class="token keyword">return</span> tableDataInfo<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;sql-blog-day2024-05-26&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#sql-blog-day2024-05-26&quot;&gt;#&lt;/a&gt; sql-blog-day2024-05-26&lt;/h1&gt;
&lt;h2 id=&quot;场景&quot;&gt;&lt;a class=&quot;anc</summary>
      
    
    
    
    <category term="计算机学科" scheme="https://pigpigletsgo.github.io/categories/computer-science/"/>
    
    <category term="blog" scheme="https://pigpigletsgo.github.io/categories/computer-science/blog/"/>
    
    
    <category term="计算机学科" scheme="https://pigpigletsgo.github.io/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%AD%A6%E7%A7%91/"/>
    
    <category term="blog - sql" scheme="https://pigpigletsgo.github.io/tags/blog-sql/"/>
    
  </entry>
  
  <entry>
    <title>maven仓库找不到jar包情况</title>
    <link href="https://pigpigletsgo.github.io/computer-science/java/maven/%E9%97%AE%E9%A2%98/maven%E4%BB%93%E5%BA%93%E6%89%BE%E4%B8%8D%E5%88%B0jar%E5%8C%85%E6%83%85%E5%86%B5/"/>
    <id>https://pigpigletsgo.github.io/computer-science/java/maven/%E9%97%AE%E9%A2%98/maven%E4%BB%93%E5%BA%93%E6%89%BE%E4%B8%8D%E5%88%B0jar%E5%8C%85%E6%83%85%E5%86%B5/</id>
    <published>2024-05-26T06:55:16.074Z</published>
    <updated>2024-05-26T06:57:09.525Z</updated>
    
    <content type="html"><![CDATA[<h1 id="maven仓库找不到jar包情况"><a class="anchor" href="#maven仓库找不到jar包情况">#</a> maven 仓库找不到 jar 包情况</h1><p>如果是下载的 jar 包，在 maven 仓库中找不到的话也会出现这种错误</p><p>假如你要是用如下 jar 包</p><figure class="highlight xml"><figcaption data-lang="XML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.gdal<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>gdal<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="4"></td><td><pre>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>3.5.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="7"></td><td><pre>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>net.postgis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="8"></td><td><pre>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>postgis-jdbc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="9"></td><td><pre>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.5.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><p>此时可以使用如下方式解决问题：</p><figure class="highlight xml"><figcaption data-lang="XML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>repositories</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>repository</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">></span></span>osgeo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="4"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">></span></span>OSGeo Release Repository<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url</span><span class="token punctuation">></span></span>https://repo.osgeo.org/repository/release/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="6"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>snapshots</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="7"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>enabled</span><span class="token punctuation">></span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>enabled</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="8"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>snapshots</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="9"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>releases</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="10"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>enabled</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>enabled</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="11"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>releases</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="12"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>repository</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>repositories</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><p>或者去 maven 的配置文件里面修改 settings.conf 文件的 mirror 配置</p><pre><code>   &lt;mirror&gt;       &lt;id&gt;alimaven&lt;/id&gt;       &lt;name&gt;aliyun maven&lt;/name&gt;       &lt;url&gt;http://maven.aliyun.com/nexus/content/groups/public/&lt;/url&gt;       &lt;mirrorOf&gt;*,!osgeo,!maven2-repository.dev.java.net,!boundless&lt;/mirrorOf&gt;     &lt;/mirror&gt;</code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;maven仓库找不到jar包情况&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#maven仓库找不到jar包情况&quot;&gt;#&lt;/a&gt; maven 仓库找不到 jar 包情况&lt;/h1&gt;
&lt;p&gt;如果是下载的 jar 包，在 maven 仓库中找不到的话也会出现这种错误</summary>
      
    
    
    
    <category term="计算机学科" scheme="https://pigpigletsgo.github.io/categories/computer-science/"/>
    
    <category term="java" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/"/>
    
    <category term="maven" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/maven/"/>
    
    <category term="问题" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/maven/%E9%97%AE%E9%A2%98/"/>
    
    
    <category term="问题总汇" scheme="https://pigpigletsgo.github.io/tags/%E9%97%AE%E9%A2%98%E6%80%BB%E6%B1%87/"/>
    
    <category term="maven" scheme="https://pigpigletsgo.github.io/tags/maven/"/>
    
  </entry>
  
  <entry>
    <title>解决解决mavenNopluginfoundforprefixhelpinthecurrentprojectandintheplugin</title>
    <link href="https://pigpigletsgo.github.io/computer-science/java/maven/%E9%97%AE%E9%A2%98/%E8%A7%A3%E5%86%B3%E8%A7%A3%E5%86%B3mavenNopluginfoundforprefixhelpinthecurrentprojectandintheplugin/"/>
    <id>https://pigpigletsgo.github.io/computer-science/java/maven/%E9%97%AE%E9%A2%98/%E8%A7%A3%E5%86%B3%E8%A7%A3%E5%86%B3mavenNopluginfoundforprefixhelpinthecurrentprojectandintheplugin/</id>
    <published>2024-05-26T06:32:46.021Z</published>
    <updated>2024-05-26T06:39:38.838Z</updated>
    
    <content type="html"><![CDATA[<p>更换阿里仓库源</p><p>在父工程创建子工程时报错</p><pre><code>&lt;mirror&gt;  &lt;id&gt;aliyunmaven&lt;/id&gt;  &lt;mirrorOf&gt;*&lt;/mirrorOf&gt;  &lt;name&gt;阿里云公共仓库&lt;/name&gt;  &lt;url&gt;https://maven.aliyun.com/repository/public&lt;/url&gt;&lt;/mirror&gt;</code></pre><p>如果上面不可用建议去网上找</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;更换阿里仓库源&lt;/p&gt;
&lt;p&gt;在父工程创建子工程时报错&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;mirror&amp;gt;
  &amp;lt;id&amp;gt;aliyunmaven&amp;lt;/id&amp;gt;
  &amp;lt;mirrorOf&amp;gt;*&amp;lt;/mirrorOf&amp;gt;
  &amp;lt;n</summary>
      
    
    
    
    <category term="计算机学科" scheme="https://pigpigletsgo.github.io/categories/computer-science/"/>
    
    <category term="java" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/"/>
    
    <category term="maven" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/maven/"/>
    
    <category term="问题" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/maven/%E9%97%AE%E9%A2%98/"/>
    
    
    <category term="问题总汇" scheme="https://pigpigletsgo.github.io/tags/%E9%97%AE%E9%A2%98%E6%80%BB%E6%B1%87/"/>
    
    <category term="maven" scheme="https://pigpigletsgo.github.io/tags/maven/"/>
    
  </entry>
  
  <entry>
    <title>解决不支持发行版5</title>
    <link href="https://pigpigletsgo.github.io/computer-science/java/maven/%E9%97%AE%E9%A2%98/%E8%A7%A3%E5%86%B3%E4%B8%8D%E6%94%AF%E6%8C%81%E5%8F%91%E8%A1%8C%E7%89%885/"/>
    <id>https://pigpigletsgo.github.io/computer-science/java/maven/%E9%97%AE%E9%A2%98/%E8%A7%A3%E5%86%B3%E4%B8%8D%E6%94%AF%E6%8C%81%E5%8F%91%E8%A1%8C%E7%89%885/</id>
    <published>2024-05-26T06:32:45.995Z</published>
    <updated>2024-05-26T06:39:17.137Z</updated>
    
    <content type="html"><![CDATA[<p>点击 <code>File --&gt; ProjectStructure</code></p><p>选择 8</p><p><img data-src="https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image_2023-01-13-11-13-02_20230225095537.png" alt="image_2023-01-13-11-13-02" /></p><p>再将全部的项目都设置为 8</p><p><img data-src="https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image_2023-01-13-11-13-59_20230225095549.png" alt="image_2023-01-13-11-13-59" /></p><p>打开 <code>File --&gt; setttings</code>  搜索 java 选择 <code>java Compiler</code>  , 将其选为 8</p><p><img data-src="https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image_2023-01-13-11-15-59_20230225095601.png" alt="image_2023-01-13-11-15-59" /></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;点击 &lt;code&gt;File --&amp;gt; ProjectStructure&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;选择 8&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&quot;https://raw.githubusercontent.com/PigPigLetsGo/imeages/mas</summary>
      
    
    
    
    <category term="计算机学科" scheme="https://pigpigletsgo.github.io/categories/computer-science/"/>
    
    <category term="java" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/"/>
    
    <category term="maven" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/maven/"/>
    
    <category term="问题" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/maven/%E9%97%AE%E9%A2%98/"/>
    
    
    <category term="问题总汇" scheme="https://pigpigletsgo.github.io/tags/%E9%97%AE%E9%A2%98%E6%80%BB%E6%B1%87/"/>
    
    <category term="maven" scheme="https://pigpigletsgo.github.io/tags/maven/"/>
    
  </entry>
  
  <entry>
    <title>解决报错Maven打包项目为war报错</title>
    <link href="https://pigpigletsgo.github.io/computer-science/java/maven/%E9%97%AE%E9%A2%98/%E8%A7%A3%E5%86%B3%E6%8A%A5%E9%94%99Maven%E6%89%93%E5%8C%85%E9%A1%B9%E7%9B%AE%E4%B8%BAwar%E6%8A%A5%E9%94%99/"/>
    <id>https://pigpigletsgo.github.io/computer-science/java/maven/%E9%97%AE%E9%A2%98/%E8%A7%A3%E5%86%B3%E6%8A%A5%E9%94%99Maven%E6%89%93%E5%8C%85%E9%A1%B9%E7%9B%AE%E4%B8%BAwar%E6%8A%A5%E9%94%99/</id>
    <published>2024-05-26T06:32:45.972Z</published>
    <updated>2024-05-26T06:39:27.858Z</updated>
    
    <content type="html"><![CDATA[<p>描述:</p><pre><code>在项目web-demo上执行目标org.apache.maven.plugins:maven-war:2.2:war失败:无法加载插件org.apache.maven.plugins:maven-war:2.2中的mojo 'war'，因为API不兼容:org.codehaus.plexus.component.repository. exception.com componentlookupexception:无法访问属性的默认字段</code></pre><p>解决办法:</p><p>在 pom.xml 文件的中添加如下插件:</p><figure class="highlight xml"><figcaption data-lang="XML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>build</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre>        <span class="token comment">&lt;!-- To define the plugin version in your parent POM --></span></pre></td></tr><tr><td data-num="3"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pluginManagement</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="4"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="6"></td><td><pre>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.maven.plugins<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="7"></td><td><pre>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>maven-war-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="8"></td><td><pre>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>3.3.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="9"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="10"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="11"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pluginManagement</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="12"></td><td><pre>        <span class="token comment">&lt;!-- To use the plugin goals in your POM or parent POM --></span></pre></td></tr><tr><td data-num="13"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="14"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="15"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.maven.plugins<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="16"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>maven-war-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="17"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>3.3.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="18"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="19"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>build</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><p>可以查找在目录位置</p><p>maven Repository: org.apache.maven.plugins.maven-war-plugin</p><p><img data-src="%E8%A7%A3%E5%86%B3%E6%8A%A5%E9%94%99Maven%E6%89%93%E5%8C%85%E9%A1%B9%E7%9B%AE%E4%B8%BAwar%E6%8A%A5%E9%94%99_md_files/image-20230307142148554_20230307151758.png?v=1&amp;type=image&amp;token=V1:cjzE3l6D9VnYPuj3vI1NNkOb1g-FeAfOGu9ZKWvv90U" alt="image-20230307142148554" /></p><p>按照导入 Build 的常规操作将其导入到报错项目的 pom 中</p><p>格式:</p><figure class="highlight xml"><figcaption data-lang="XML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.maven.plugins<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="4"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>maven-war-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>3.3.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="6"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><ul><li>配置忽略 web.xml 文件</li></ul><figure class="highlight xml"><figcaption data-lang="XML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.maven.plugins<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="4"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>maven-war-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>3.3.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="6"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment">&lt;!--              忽略 web.xml 的检查 --></span></pre></td></tr><tr><td data-num="8"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>failOnMissingWebXml</span><span class="token punctuation">></span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>failOnMissingWebXml</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="9"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="10"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">></span></span></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;描述:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;在项目web-demo上执行目标org.apache.maven.plugins:maven-war:2.2:war失败:无法加载插件org.apache.maven.plugins:maven-war:2.2中的mojo &#39;war&#39;，</summary>
      
    
    
    
    <category term="计算机学科" scheme="https://pigpigletsgo.github.io/categories/computer-science/"/>
    
    <category term="java" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/"/>
    
    <category term="maven" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/maven/"/>
    
    <category term="问题" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/maven/%E9%97%AE%E9%A2%98/"/>
    
    
    <category term="问题总汇" scheme="https://pigpigletsgo.github.io/tags/%E9%97%AE%E9%A2%98%E6%80%BB%E6%B1%87/"/>
    
    <category term="maven" scheme="https://pigpigletsgo.github.io/tags/maven/"/>
    
  </entry>
  
  <entry>
    <title>解决GeneratingprojectinInteractivemode</title>
    <link href="https://pigpigletsgo.github.io/computer-science/java/maven/%E9%97%AE%E9%A2%98/%E8%A7%A3%E5%86%B3GeneratingprojectinInteractivemode/"/>
    <id>https://pigpigletsgo.github.io/computer-science/java/maven/%E9%97%AE%E9%A2%98/%E8%A7%A3%E5%86%B3GeneratingprojectinInteractivemode/</id>
    <published>2024-05-26T06:32:45.951Z</published>
    <updated>2024-05-26T06:39:04.880Z</updated>
    
    <content type="html"><![CDATA[<h2 id="解决创建maven项目时出现generating-project-in-interactive-mode一直卡住"><a class="anchor" href="#解决创建maven项目时出现generating-project-in-interactive-mode一直卡住">#</a> 解决创建 maven 项目时出现 Generating project in Interactive mode 一直卡住</h2><p>执行命令创建项目:</p><pre><code>mvn archetype:generate -DarchetypeCatalog=internal</code></pre><p>让其不从远程服务器上取 catalog</p><p>一般情况下就可以创建成功</p><p>最终命令: <code>mvn archetype:generate -DgroupId=com.cyf -DartifactId=cms -DarchetypeArtifactId=maven-archetype-webapp -DarchetypeCatalog=internal</code></p><p>如果参考网上的其它方案，可能出现如下问题</p><p><code>Generating project in Batch mode</code></p><p>这个问题是在命令后面加了: <code>-DinteractiveMode=false</code></p><p>如果不想一直卡住，同样在命令中添加: <code> -DarchetypeCatalog=internal</code></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;解决创建maven项目时出现generating-project-in-interactive-mode一直卡住&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#解决创建maven项目时出现generating-project-in-interactive-m</summary>
      
    
    
    
    <category term="计算机学科" scheme="https://pigpigletsgo.github.io/categories/computer-science/"/>
    
    <category term="java" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/"/>
    
    <category term="maven" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/maven/"/>
    
    <category term="问题" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/maven/%E9%97%AE%E9%A2%98/"/>
    
    
    <category term="问题总汇" scheme="https://pigpigletsgo.github.io/tags/%E9%97%AE%E9%A2%98%E6%80%BB%E6%B1%87/"/>
    
    <category term="maven" scheme="https://pigpigletsgo.github.io/tags/maven/"/>
    
  </entry>
  
  <entry>
    <title>解决Failed-to-execute-goal-org-apache-maven-plugins-maven-surefire-plugin</title>
    <link href="https://pigpigletsgo.github.io/computer-science/java/maven/%E9%97%AE%E9%A2%98/%E8%A7%A3%E5%86%B3Failed-to-execute-goal-org-apache-maven-plugins-maven-surefire-plugin/"/>
    <id>https://pigpigletsgo.github.io/computer-science/java/maven/%E9%97%AE%E9%A2%98/%E8%A7%A3%E5%86%B3Failed-to-execute-goal-org-apache-maven-plugins-maven-surefire-plugin/</id>
    <published>2024-05-26T06:32:45.928Z</published>
    <updated>2024-05-26T06:38:46.725Z</updated>
    
    <content type="html"><![CDATA[<p>报错描述:</p><pre><code>Failed to execute goal org.apache.maven.plugins:maven-surefire-plugin:2.12.4</code></pre><p><img data-src="https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image_2023-01-17-16-31-11_20230225095430.png" alt="image_2023-01-17-16-31-11" /></p><p>解决方案:</p><p>在 pom.xml 中加入插件:</p><figure class="highlight xml"><figcaption data-lang="XML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">></span></span>  </pre></td></tr><tr><td data-num="2"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.maven.plugins<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>  </pre></td></tr><tr><td data-num="3"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>maven-surefire-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>  </pre></td></tr><tr><td data-num="4"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.4.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>  </pre></td></tr><tr><td data-num="5"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">></span></span>  </pre></td></tr><tr><td data-num="6"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>skipTests</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>skipTests</span><span class="token punctuation">></span></span>  </pre></td></tr><tr><td data-num="7"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span>  </pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><p><img data-src="https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image_2023-01-17-16-32-19_20230225095501.png" alt="image_2023-01-17-16-32-19" /></p><p>完成！！</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;报错描述:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Failed to execute goal org.apache.maven.plugins:maven-surefire-plugin:2.12.4
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img data-src=&quot;https:/</summary>
      
    
    
    
    <category term="计算机学科" scheme="https://pigpigletsgo.github.io/categories/computer-science/"/>
    
    <category term="java" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/"/>
    
    <category term="maven" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/maven/"/>
    
    <category term="问题" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/maven/%E9%97%AE%E9%A2%98/"/>
    
    
    <category term="问题总汇" scheme="https://pigpigletsgo.github.io/tags/%E9%97%AE%E9%A2%98%E6%80%BB%E6%B1%87/"/>
    
    <category term="maven" scheme="https://pigpigletsgo.github.io/tags/maven/"/>
    
  </entry>
  
  <entry>
    <title>编码</title>
    <link href="https://pigpigletsgo.github.io/computer-science/java/maven/%E9%97%AE%E9%A2%98/%E7%BC%96%E7%A0%81/"/>
    <id>https://pigpigletsgo.github.io/computer-science/java/maven/%E9%97%AE%E9%A2%98/%E7%BC%96%E7%A0%81/</id>
    <published>2024-05-26T06:32:45.907Z</published>
    <updated>2024-05-26T06:38:28.560Z</updated>
    
    <content type="html"><![CDATA[<p>问题描述:</p><pre><code>Using platform encoding (UTF-8 actually) to copy filtered resources, i.e. build is platform depend</code></pre><ul><li>项目在编译时报错:</li></ul><p><img data-src="https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image_2023-01-31-14-32-51_20230225095405.png" alt="image_2023-01-31-14-32-51" /></p><p>在项目 pom.xml 文件中配置如下:</p><pre><code>&lt;properties&gt;    &lt;!--编译编码--&gt;    &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;&lt;/properties&gt;</code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;问题描述:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Using platform encoding (UTF-8 actually) to copy filtered resources, i.e. build is platform depend
&lt;/code&gt;&lt;/pre&gt;
&lt;ul</summary>
      
    
    
    
    <category term="计算机学科" scheme="https://pigpigletsgo.github.io/categories/computer-science/"/>
    
    <category term="java" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/"/>
    
    <category term="maven" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/maven/"/>
    
    <category term="问题" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/maven/%E9%97%AE%E9%A2%98/"/>
    
    
    <category term="问题总汇" scheme="https://pigpigletsgo.github.io/tags/%E9%97%AE%E9%A2%98%E6%80%BB%E6%B1%87/"/>
    
    <category term="maven" scheme="https://pigpigletsgo.github.io/tags/maven/"/>
    
  </entry>
  
  <entry>
    <title>边框maven不见或者不存在</title>
    <link href="https://pigpigletsgo.github.io/computer-science/java/maven/%E9%97%AE%E9%A2%98/%E8%BE%B9%E6%A1%86maven%E4%B8%8D%E8%A7%81%E6%88%96%E8%80%85%E4%B8%8D%E5%AD%98%E5%9C%A8/"/>
    <id>https://pigpigletsgo.github.io/computer-science/java/maven/%E9%97%AE%E9%A2%98/%E8%BE%B9%E6%A1%86maven%E4%B8%8D%E8%A7%81%E6%88%96%E8%80%85%E4%B8%8D%E5%AD%98%E5%9C%A8/</id>
    <published>2024-05-26T06:32:45.881Z</published>
    <updated>2024-05-26T06:39:49.757Z</updated>
    
    <content type="html"><![CDATA[<p>右键 pom.xml 文件点击 <code>Add maven project</code></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;右键 pom.xml 文件点击 &lt;code&gt;Add maven project&lt;/code&gt;&lt;/p&gt;
</summary>
      
    
    
    
    <category term="计算机学科" scheme="https://pigpigletsgo.github.io/categories/computer-science/"/>
    
    <category term="java" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/"/>
    
    <category term="maven" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/maven/"/>
    
    <category term="问题" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/maven/%E9%97%AE%E9%A2%98/"/>
    
    
    <category term="问题总汇" scheme="https://pigpigletsgo.github.io/tags/%E9%97%AE%E9%A2%98%E6%80%BB%E6%B1%87/"/>
    
    <category term="maven" scheme="https://pigpigletsgo.github.io/tags/maven/"/>
    
  </entry>
  
  <entry>
    <title>Tomcat启动报错</title>
    <link href="https://pigpigletsgo.github.io/computer-science/java/maven/%E9%97%AE%E9%A2%98/Tomcat%E5%90%AF%E5%8A%A8%E6%8A%A5%E9%94%99/"/>
    <id>https://pigpigletsgo.github.io/computer-science/java/maven/%E9%97%AE%E9%A2%98/Tomcat%E5%90%AF%E5%8A%A8%E6%8A%A5%E9%94%99/</id>
    <published>2024-05-26T06:32:45.856Z</published>
    <updated>2024-05-26T06:38:04.060Z</updated>
    
    <content type="html"><![CDATA[<h1 id="a-child-container-failed-during-start"><a class="anchor" href="#a-child-container-failed-during-start">#</a> A child container failed during start</h1><blockquote><p>排查方案，把.xml 内无关的所有注释掉，启动程序，如果成功了，就一点点代码还原 + 重启，直至找到致命的那行代码！（比如 web.xml、pom.xml）</p></blockquote><p>可能引发错误的问题，如果导入了 tomcat7 的坐标又导入了 servlet-api 坐标那么可能就会发生错误</p><p>1.servlet-api 包冲突</p><ul><li>出现这个问题的原因是导入了 servlet-api 包，与 tomcat7 的依赖包 servlet-api 冲突</li><li>检查 pom.xml 是否导入 servlet-api</li><li>加上 &lt;scope&gt;provided&lt;/scope &gt; 之后再次运行成功</li></ul><p>问题引出：在 SpringMVC 项目中如果我们直接删除了 Servlet-api 这个坐标后可能会引发启动时的报错如下</p><pre><code>无法访问javax.servlet.ServletException</code></pre><p>此时我们需要加上 Servlet-api 这个一样然后将其在打包时排除即在下面再添加一项 &lt;scope&gt;provided&lt;/scope&gt;</p><p>具体如下:</p><figure class="highlight xml"><figcaption data-lang="XML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">&lt;!--servlet-api--></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>javax.servlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="4"></td><td><pre>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>servlet-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="6"></td><td><pre>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">></span></span>provided<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;a-child-container-failed-during-start&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#a-child-container-failed-during-start&quot;&gt;#&lt;/a&gt; A child container faile</summary>
      
    
    
    
    <category term="计算机学科" scheme="https://pigpigletsgo.github.io/categories/computer-science/"/>
    
    <category term="java" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/"/>
    
    <category term="maven" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/maven/"/>
    
    <category term="问题" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/maven/%E9%97%AE%E9%A2%98/"/>
    
    
    <category term="问题总汇" scheme="https://pigpigletsgo.github.io/tags/%E9%97%AE%E9%A2%98%E6%80%BB%E6%B1%87/"/>
    
    <category term="maven" scheme="https://pigpigletsgo.github.io/tags/maven/"/>
    
  </entry>
  
  <entry>
    <title>tomcat-mave启动自动关闭</title>
    <link href="https://pigpigletsgo.github.io/computer-science/java/maven/%E9%97%AE%E9%A2%98/tomcat-mave%E5%90%AF%E5%8A%A8%E8%87%AA%E5%8A%A8%E5%85%B3%E9%97%AD/"/>
    <id>https://pigpigletsgo.github.io/computer-science/java/maven/%E9%97%AE%E9%A2%98/tomcat-mave%E5%90%AF%E5%8A%A8%E8%87%AA%E5%8A%A8%E5%85%B3%E9%97%AD/</id>
    <published>2024-05-26T06:32:45.832Z</published>
    <updated>2024-05-26T06:37:50.870Z</updated>
    
    <content type="html"><![CDATA[<p>查看打包方式是否为 war 包，否则会出现启动 tomcat7:run 后自动就关闭了，访问不到项目因为 tomcat 关闭了</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;查看打包方式是否为 war 包，否则会出现启动 tomcat7:run 后自动就关闭了，访问不到项目因为 tomcat 关闭了&lt;/p&gt;
</summary>
      
    
    
    
    <category term="计算机学科" scheme="https://pigpigletsgo.github.io/categories/computer-science/"/>
    
    <category term="java" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/"/>
    
    <category term="maven" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/maven/"/>
    
    <category term="问题" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/maven/%E9%97%AE%E9%A2%98/"/>
    
    
    <category term="问题总汇" scheme="https://pigpigletsgo.github.io/tags/%E9%97%AE%E9%A2%98%E6%80%BB%E6%B1%87/"/>
    
    <category term="maven" scheme="https://pigpigletsgo.github.io/tags/maven/"/>
    
  </entry>
  
  <entry>
    <title>The desired archetype does not exist</title>
    <link href="https://pigpigletsgo.github.io/computer-science/java/maven/%E9%97%AE%E9%A2%98/The%20desired%20archetype%20does%20not%20exist/"/>
    <id>https://pigpigletsgo.github.io/computer-science/java/maven/%E9%97%AE%E9%A2%98/The%20desired%20archetype%20does%20not%20exist/</id>
    <published>2024-05-26T06:32:45.807Z</published>
    <updated>2024-05-26T06:37:37.338Z</updated>
    
    <content type="html"><![CDATA[<h1 id="the-desired-archetype-does-not-exist"><a class="anchor" href="#the-desired-archetype-does-not-exist">#</a> The desired archetype does not exist</h1><p>可能出现该问题的原因：</p><ul><li>maven 中配置了 nexus</li><li>nexus 配合在了 maven 中而且 nexus 没有开启</li></ul><p>解决办法：</p><ul><li>打开 nexusji'ke</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;the-desired-archetype-does-not-exist&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#the-desired-archetype-does-not-exist&quot;&gt;#&lt;/a&gt; The desired archetype doe</summary>
      
    
    
    
    <category term="计算机学科" scheme="https://pigpigletsgo.github.io/categories/computer-science/"/>
    
    <category term="java" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/"/>
    
    <category term="maven" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/maven/"/>
    
    <category term="问题" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/maven/%E9%97%AE%E9%A2%98/"/>
    
    
    <category term="问题总汇" scheme="https://pigpigletsgo.github.io/tags/%E9%97%AE%E9%A2%98%E6%80%BB%E6%B1%87/"/>
    
    <category term="maven" scheme="https://pigpigletsgo.github.io/tags/maven/"/>
    
  </entry>
  
  <entry>
    <title>Maven在Idea中运行Tomcat报错</title>
    <link href="https://pigpigletsgo.github.io/computer-science/java/maven/%E9%97%AE%E9%A2%98/Maven%E5%9C%A8Idea%E4%B8%AD%E8%BF%90%E8%A1%8CTomcat%E6%8A%A5%E9%94%99/"/>
    <id>https://pigpigletsgo.github.io/computer-science/java/maven/%E9%97%AE%E9%A2%98/Maven%E5%9C%A8Idea%E4%B8%AD%E8%BF%90%E8%A1%8CTomcat%E6%8A%A5%E9%94%99/</id>
    <published>2024-05-26T06:32:45.786Z</published>
    <updated>2024-05-26T06:36:50.442Z</updated>
    
    <content type="html"><![CDATA[<p>问题描述:</p><pre><code>Maven打包报错Unknown lifecycle phase “mvn“. You must specify a valid lifecycleUnknown lifecycle phase &quot;mvn&quot;. You must specify a valid lifecycle phase or a </code></pre><p>原因:</p><p>在 idea 中 command line 已经有一个 mvn 命令，然后再输入 mvn, 其实就相当于: <code>mvn mvn tomcat:run</code>  , 这么写就会报错</p><p>解决方案：将前面的 mvn 去掉如下:</p><p><code>tomcat:run</code></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;问题描述:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Maven打包报错Unknown lifecycle phase “mvn“. You must specify a valid lifecycle
Unknown lifecycle phase &amp;quot;mvn&amp;quot;. </summary>
      
    
    
    
    <category term="计算机学科" scheme="https://pigpigletsgo.github.io/categories/computer-science/"/>
    
    <category term="java" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/"/>
    
    <category term="maven" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/maven/"/>
    
    <category term="问题" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/maven/%E9%97%AE%E9%A2%98/"/>
    
    
    <category term="问题总汇" scheme="https://pigpigletsgo.github.io/tags/%E9%97%AE%E9%A2%98%E6%80%BB%E6%B1%87/"/>
    
    <category term="maven" scheme="https://pigpigletsgo.github.io/tags/maven/"/>
    
  </entry>
  
  <entry>
    <title>Maven项目中pom.xml全部报红，依赖导入不成功，jar包不下载或者出现.lastUpdated文件 等类似问题，迄今为止所有解决方案</title>
    <link href="https://pigpigletsgo.github.io/computer-science/java/maven/%E9%97%AE%E9%A2%98/Maven%E9%A1%B9%E7%9B%AE%E4%B8%ADpom.xml%E5%85%A8%E9%83%A8%E6%8A%A5%E7%BA%A2%EF%BC%8C%E4%BE%9D%E8%B5%96%E5%AF%BC%E5%85%A5%E4%B8%8D%E6%88%90%E5%8A%9F%EF%BC%8Cjar%E5%8C%85%E4%B8%8D%E4%B8%8B%E8%BD%BD%E6%88%96%E8%80%85%E5%87%BA%E7%8E%B0.lastUpdated%E6%96%87%E4%BB%B6%20%E7%AD%89%E7%B1%BB%E4%BC%BC%E9%97%AE%E9%A2%98%EF%BC%8C%E8%BF%84%E4%BB%8A%E4%B8%BA%E6%AD%A2%E6%89%80%E6%9C%89%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/"/>
    <id>https://pigpigletsgo.github.io/computer-science/java/maven/%E9%97%AE%E9%A2%98/Maven%E9%A1%B9%E7%9B%AE%E4%B8%ADpom.xml%E5%85%A8%E9%83%A8%E6%8A%A5%E7%BA%A2%EF%BC%8C%E4%BE%9D%E8%B5%96%E5%AF%BC%E5%85%A5%E4%B8%8D%E6%88%90%E5%8A%9F%EF%BC%8Cjar%E5%8C%85%E4%B8%8D%E4%B8%8B%E8%BD%BD%E6%88%96%E8%80%85%E5%87%BA%E7%8E%B0.lastUpdated%E6%96%87%E4%BB%B6%20%E7%AD%89%E7%B1%BB%E4%BC%BC%E9%97%AE%E9%A2%98%EF%BC%8C%E8%BF%84%E4%BB%8A%E4%B8%BA%E6%AD%A2%E6%89%80%E6%9C%89%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/</id>
    <published>2024-05-26T06:32:45.762Z</published>
    <updated>2024-05-26T06:37:16.722Z</updated>
    
    <content type="html"><![CDATA[<p>相信大家在导入新的项目时候会遇到 pom 文件报红，或者右侧依赖报红等类似情况，博主将这种错误的所有解决方案都陈列了出来，希望对你有帮助</p><p><img data-src="https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310121408496.png" alt="image-20231012140814363" /></p><h4 id="第一种"><a class="anchor" href="#第一种">#</a> 第一种</h4><p>将 pom 文件中的中文删掉，注释的也全部删掉，亲测有效</p><h4 id="第二种"><a class="anchor" href="#第二种">#</a> 第二种</h4><p>将 pom 文件中或者右侧 MavenProject 报红的地方所对应的依赖全部删除掉然后再撤回，亲测有效</p><h4 id="第三种"><a class="anchor" href="#第三种">#</a> 第三种</h4><p>直接换掉 Maven 仓库，新创建一个 Maven 仓库，记着改配置文件以及更换 IDEA 的配置</p><figure class="highlight xml"><figcaption data-lang="XML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>localRepository</span><span class="token punctuation">></span></span>G:\javatools\repository3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>localRepository</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><p><img data-src="https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310121408599.png" alt="image-20231012140851699" /></p><h4 id="第四种"><a class="anchor" href="#第四种">#</a> 第四种</h4><p>添加阿里云镜像，可以解决外网上不去下载依赖不成功，或者下载慢问题，也会导致全部报红<br />在 Maven 文件夹下，conf 文件夹内的 setting.xml 的标签内添加如下配置</p><p><img data-src="https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310121409937.png" alt="image-20231012140905990" /></p><figure class="highlight xml"><figcaption data-lang="XML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">&lt;!-- 阿里镜像仓库 --></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mirrors</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mirror</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="4"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">></span></span>alimaven<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">></span></span>aliyun maven<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="6"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="7"></td><td><pre>         http://maven.aliyun.com/nexus/content/groups/public/</pre></td></tr><tr><td data-num="8"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="9"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mirrorOf</span><span class="token punctuation">></span></span>central<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mirrorOf</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="10"></td><td><pre>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mirror</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mirrors</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><p>第五种<br />去掉国内镜像<br />对每个人情况可能有所不同（至少我试了所有办法后这样又成功了）<br />去掉镜像直接把 setting 文件中的 mirror 标签内容全部去掉就可以了<br />（这一点我要做特别说明）<br />博主最近遇到的错误就是，更换 Maven 仓库改了几次，把上面的方法都试了一遍，全部不行，<br />新 maven 仓库内一直出现.lastUpdated 这种文件或者这一个文件（百度搜索到的解答全在说加上镜像就好了，但是我本身就有镜像，所以原本没在意）<br />随后我尝试把镜像删除了<br />然后就成功了，这个方法是我新发现的，我百度了各大论坛都没有这种情况，被我遇上了，然后成功改了出来</p><p>第六种<br />查看 pom 文件，中报红的位置，可能是不同电脑配置不同，版本不同出现的错误，需要从新改正，这也是一种情况，博主也遇到过，比如 JDK 版本导入项目为 1.7，而自身是 JDK1.8</p><p>上述六种方法每次尝试后，需要右键 maven-&gt;Reimport</p><p><img data-src="https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310121409411.png" alt="image-20231012140938560" /></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;相信大家在导入新的项目时候会遇到 pom 文件报红，或者右侧依赖报红等类似情况，博主将这种错误的所有解决方案都陈列了出来，希望对你有帮助&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&quot;https://raw.githubusercontent.com/PigPigLetsGo</summary>
      
    
    
    
    <category term="计算机学科" scheme="https://pigpigletsgo.github.io/categories/computer-science/"/>
    
    <category term="java" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/"/>
    
    <category term="maven" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/maven/"/>
    
    <category term="问题" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/maven/%E9%97%AE%E9%A2%98/"/>
    
    
    <category term="问题总汇" scheme="https://pigpigletsgo.github.io/tags/%E9%97%AE%E9%A2%98%E6%80%BB%E6%B1%87/"/>
    
    <category term="maven" scheme="https://pigpigletsgo.github.io/tags/maven/"/>
    
  </entry>
  
  <entry>
    <title>Maven编译可通过但是IDEA报程序包不存在解决方法</title>
    <link href="https://pigpigletsgo.github.io/computer-science/java/maven/%E9%97%AE%E9%A2%98/Maven%E7%BC%96%E8%AF%91%E5%8F%AF%E9%80%9A%E8%BF%87%E4%BD%86%E6%98%AFIDEA%E6%8A%A5%E7%A8%8B%E5%BA%8F%E5%8C%85%E4%B8%8D%E5%AD%98%E5%9C%A8%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/"/>
    <id>https://pigpigletsgo.github.io/computer-science/java/maven/%E9%97%AE%E9%A2%98/Maven%E7%BC%96%E8%AF%91%E5%8F%AF%E9%80%9A%E8%BF%87%E4%BD%86%E6%98%AFIDEA%E6%8A%A5%E7%A8%8B%E5%BA%8F%E5%8C%85%E4%B8%8D%E5%AD%98%E5%9C%A8%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/</id>
    <published>2024-05-26T06:32:45.745Z</published>
    <updated>2024-05-26T06:37:03.556Z</updated>
    
    <content type="html"><![CDATA[<p>情况说明:</p><pre><code>1.代码编辑器中无编译错误2.确信包依赖无冲突且成功依赖3.maven 进行clean 、compile、package等操作都没问题4.启动项目报错，错误如下：</code></pre><p><img data-src="https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image_2023-01-14-12-11-04_20230225095223.png" alt="image_2023-01-14-12-11-04" /></p><p><strong>解决方案一</strong></p><p>在项目根目录执行: <code>mvn idea:idea</code>  (生成 idea 项目) 此时会生成两个.ipr 与.iws 后缀的两个文件</p><p><img data-src="https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image_2023-01-14-12-12-25_20230225095235.png" alt="image_2023-01-14-12-12-25" /></p><p><img data-src="https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image_2023-01-14-12-12-47_20230225095248.png" alt="image_2023-01-14-12-12-47" /></p><p>idea 情况缓存重启</p><p><img data-src="https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image_2023-01-14-12-13-34_20230225095300.png" alt="image_2023-01-14-12-13-34" /></p><p><strong>解决方案二</strong></p><p>因为 idea 的 build 编译操作是其自身自带的环境，与 Maven 的 compile 编译不是同的环境</p><p>所以设置 idea 构建 / 运行操作委托给 maven</p><p><img data-src="https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image_2023-01-14-12-14-57_20230225095314.png" alt="image_2023-01-14-12-14-57" /></p><p><strong>解决方案三</strong></p><p>升级 idea 版本或更换 idea 版本</p><p>在一次 pull 项目后进行重新启动时，又遇到这个问题，maven 一般操作均无效，最初便怀疑是 idea 原因，果断升级，重启项目成功！！！</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;情况说明:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;1.代码编辑器中无编译错误
2.确信包依赖无冲突且成功依赖
3.maven 进行clean 、compile、package等操作都没问题
4.启动项目报错，错误如下：
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img data-src=</summary>
      
    
    
    
    <category term="计算机学科" scheme="https://pigpigletsgo.github.io/categories/computer-science/"/>
    
    <category term="java" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/"/>
    
    <category term="maven" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/maven/"/>
    
    <category term="问题" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/maven/%E9%97%AE%E9%A2%98/"/>
    
    
    <category term="问题总汇" scheme="https://pigpigletsgo.github.io/tags/%E9%97%AE%E9%A2%98%E6%80%BB%E6%B1%87/"/>
    
    <category term="maven" scheme="https://pigpigletsgo.github.io/tags/maven/"/>
    
  </entry>
  
  <entry>
    <title>Dependencies报红但是里面的jar包并没有报错</title>
    <link href="https://pigpigletsgo.github.io/computer-science/java/maven/%E9%97%AE%E9%A2%98/Dependencies%E6%8A%A5%E7%BA%A2%E4%BD%86%E6%98%AF%E9%87%8C%E9%9D%A2%E7%9A%84jar%E5%8C%85%E5%B9%B6%E6%B2%A1%E6%9C%89%E6%8A%A5%E9%94%99/"/>
    <id>https://pigpigletsgo.github.io/computer-science/java/maven/%E9%97%AE%E9%A2%98/Dependencies%E6%8A%A5%E7%BA%A2%E4%BD%86%E6%98%AF%E9%87%8C%E9%9D%A2%E7%9A%84jar%E5%8C%85%E5%B9%B6%E6%B2%A1%E6%9C%89%E6%8A%A5%E9%94%99/</id>
    <published>2024-05-26T06:32:45.728Z</published>
    <updated>2024-05-26T06:36:32.504Z</updated>
    
    <content type="html"><![CDATA[<p>问题描述:</p><p><img data-src="https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image_2023-02-22-16-15-48_20230225095146.png" alt="image_2023-02-22-16-15-48" /></p><p>查看本地仓库:jar 包已经存在</p><p><img data-src="https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image_2023-02-22-16-16-11_20230225095158.png" alt="image_2023-02-22-16-16-11" /></p><p>解决方式:</p><p>把对应项目的 pom.xml 中相关依赖剪切，刷新 pom 后在将相关依赖复制回去再刷新 pom</p><p>总结:</p><p>当不是由于引入 jar 包不存在的情况的时候，就要考虑到这种情况问题 (IDEA 的 BUG), 先删除 pom.xml 文件的依赖，然后执行 Maven 的 clean 方法，最后撤回删除的 pom.xml 文件的依赖，即可成功</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;问题描述:&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&quot;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image_2023-02-22-16-15-48_20230225095146.png&quot; a</summary>
      
    
    
    
    <category term="计算机学科" scheme="https://pigpigletsgo.github.io/categories/computer-science/"/>
    
    <category term="java" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/"/>
    
    <category term="maven" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/maven/"/>
    
    <category term="问题" scheme="https://pigpigletsgo.github.io/categories/computer-science/java/maven/%E9%97%AE%E9%A2%98/"/>
    
    
    <category term="问题总汇" scheme="https://pigpigletsgo.github.io/tags/%E9%97%AE%E9%A2%98%E6%80%BB%E6%B1%87/"/>
    
    <category term="maven" scheme="https://pigpigletsgo.github.io/tags/maven/"/>
    
  </entry>
  
</feed>

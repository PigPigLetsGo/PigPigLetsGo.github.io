{
    "version": "https://jsonfeed.org/version/1",
    "title": "D ã® Java",
    "subtitle": "åˆ«æ€•è·¯é•¿æ¢¦è¿œ",
    "icon": "https://pigpigletsgo.github.io/images/favicon.ico",
    "description": "æ¬¢è¿æ¥æˆ‘çš„åšå®¢ç©ºé—´",
    "home_page_url": "https://pigpigletsgo.github.io",
    "items": [
        {
            "id": "https://pigpigletsgo.github.io/computer-science/blog/sql/PostgreSQL%E7%9A%84SQL%E8%AF%AD%E5%8F%A5%E5%8F%82%E6%95%B0%E4%B8%8A%E9%99%90/",
            "url": "https://pigpigletsgo.github.io/computer-science/blog/sql/PostgreSQL%E7%9A%84SQL%E8%AF%AD%E5%8F%A5%E5%8F%82%E6%95%B0%E4%B8%8A%E9%99%90/",
            "title": "PostgreSQLçš„SQLè¯­å¥å‚æ•°ä¸Šé™",
            "date_published": "2024-08-21T02:48:06.170Z",
            "content_html": "<h1 id=\"postgresqlçš„sqlè¯­å¥å‚æ•°ä¸Šé™\"><a class=\"anchor\" href=\"#postgresqlçš„sqlè¯­å¥å‚æ•°ä¸Šé™\">#</a> PostgreSQL çš„ SQL è¯­å¥å‚æ•°ä¸Šé™</h1>\n<p>æè¿°ï¼š</p>\n<blockquote>\n<p>PostgreSQL çš„ SQL è¯­å¥å‚æ•°ä¸Šé™ An I/O error occurred while sending to the backend</p>\n</blockquote>\n<p>äº‹æ•…ç°åœºï¼š</p>\n<blockquote>\n<p>æ•°æ®åº“æˆ‘ç”¨ postgreSQLï¼ŒæŒä¹…å±‚æ¡†æ¶ mybatis</p>\n<p>ç°åœ¨æœ‰ä¸€ä¸ªæ“ä½œï¼Œéœ€è¦å°†ä¸€ä¸ªå¤§æ‰¹æ•°æ® (3000+) æ’å…¥æ•°æ®åº“ï¼Œåå°ç›´æ¥æŠ¥é”™ï¼ŒæŠ¥é”™åŸå› å¦‚ä¸‹ï¼š</p>\n</blockquote>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>org.postgresql.util.PSQLException: An I/O error occurred <span class=\"token keyword\">while</span> sending to the backend.</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>Caused by: java.io.IOException: Tried to send an out-of-range integer as a <span class=\"token number\">2</span>-byte value: <span class=\"token number\">50805</span></pre></td></tr></table></figure><p>åŸå› ï¼š</p>\n<blockquote>\n<p>æ‰¹é‡æ’å…¥çš„é¡¶å³°åœ¨ JDBC-Driver å‡ºç°å¤©èŠ±æ¿</p>\n<p>ç®€å•æ¥è¯´å°±æ˜¯ SQL è¯­å¥å‚æ•°ä¸Šé™</p>\n</blockquote>\n<p>è§£å†³æ€è·¯ï¼š</p>\n<blockquote>\n<p>æˆ‘ä»¬å¯ä»¥å°† (3000+) å¤§æ‰¹æ•°æ®é›†åˆåˆ†æ‰¹æ¥è¿›è¡Œæ’å…¥æ•°æ®åº“</p>\n</blockquote>\n<p>è§£å†³æ–¹å¼å¦‚ä¸‹ï¼š</p>\n<p>ä½¿ç”¨ Guava åº“ä¸­çš„å·¥å…·ç±» Lists.partition</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// å®šä¹‰å­˜æ”¾å¤§æ‰¹é‡æ•°æ®é›†åˆçš„é›†åˆ</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">></span></span> lists <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token comment\">// å¤„ç†å¤§æ‰¹é‡æ•°æ®å¹¶æ·»åŠ åˆ° å¤§æ‰¹é‡æ•°æ®çš„é›†åˆä¸­</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    lists<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\">// å°† lists å¤§æ‰¹æ•°æ®é›†åˆçš„æ•°æ® æ¯ 500 æ¡æ•°æ®åˆ†ä¸€ç»„</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">List</span><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">></span><span class=\"token punctuation\">></span></span> partition <span class=\"token operator\">=</span> <span class=\"token class-name\">Lists</span><span class=\"token punctuation\">.</span><span class=\"token function\">partition</span><span class=\"token punctuation\">(</span>lists<span class=\"token punctuation\">,</span> <span class=\"token number\">500</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">></span></span> item <span class=\"token operator\">:</span> partition<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token comment\">// æ¯æ¬¡æ‰¹é‡æ’å…¥ 500 æ¡</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    mapper<span class=\"token punctuation\">.</span><span class=\"token function\">insertBath</span><span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure>",
            "tags": [
                "è®¡ç®—æœºå­¦ç§‘",
                "blog",
                "sql",
                "è®¡ç®—æœºå­¦ç§‘ - blog - sql"
            ]
        },
        {
            "id": "https://pigpigletsgo.github.io/essay/%E5%AF%B9%E6%AF%94MemCached%E5%92%8CRedis%E5%8C%BA%E5%88%AB/",
            "url": "https://pigpigletsgo.github.io/essay/%E5%AF%B9%E6%AF%94MemCached%E5%92%8CRedis%E5%8C%BA%E5%88%AB/",
            "title": "å¯¹æ¯”MemCachedå’ŒRedisåŒºåˆ«",
            "date_published": "2024-08-19T13:20:47.065Z",
            "content_html": "<h1 id=\"å¯¹æ¯”memcachedå’ŒredisåŒºåˆ«\"><a class=\"anchor\" href=\"#å¯¹æ¯”memcachedå’ŒredisåŒºåˆ«\">#</a> å¯¹æ¯” MemCached å’Œ Redis åŒºåˆ«</h1>\n<h2 id=\"memcached-vs-redis\"><a class=\"anchor\" href=\"#memcached-vs-redis\">#</a> MemCached vs Redis</h2>\n<ol>\n<li>\n<p>MemCahced ä¸ Redis</p>\n<p>é€šå¸¸ï¼Œæˆ‘ä»¬ä¼šè€ƒè™‘åœ¨å¤„ç†å¤§é‡æ•°æ®æ—¶ä½¿ç”¨ <strong>ç¼“å­˜æé«˜æ€§èƒ½</strong></p>\n<p>MemCached æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼å†…å­˜ç¼“å­˜ç³»ç»Ÿï¼Œè®¾è®¡ç®€å•æ˜“ç”¨ï¼Œéå¸¸é€‚åˆç”¨ä½œç¼“å­˜æˆ–ä¼šè¯å­˜å‚¨ã€‚Redis æ˜¯ä¸€ä¸ªå†…å­˜ä¸­çš„ <strong>æ•°æ®ç»“æ„</strong> å­˜å‚¨ï¼Œå®ƒæä¾›äº†ä¸€ç³»åˆ—ä¸°å¯Œçš„ç‰¹æ€§ã€‚å®ƒä½œä¸ºç¼“å­˜ï¼Œæ•°æ®åº“ï¼Œæ¶ˆæ¯ä»£ç†å’Œé˜Ÿåˆ—éå¸¸æœ‰ç”¨</p>\n</li>\n</ol>\n<h2 id=\"2å®‰è£…\"><a class=\"anchor\" href=\"#2å®‰è£…\">#</a> 2ï¼Œå®‰è£…</h2>\n<h3 id=\"21-å®‰è£…memcached\"><a class=\"anchor\" href=\"#21-å®‰è£…memcached\">#</a> 2.1 å®‰è£… MemCached</h3>\n<p>ä¸‹è½½æœ€æ–°ç‰ˆçš„ MemCached åŒ…å¹¶æ‰§è¡Œ make è¿›è¡Œå®‰è£…</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ <span class=\"token function\">wget</span> http://memcached.org/latest</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>$ <span class=\"token function\">tar</span> <span class=\"token parameter variable\">-zxvf</span> memcached-1.6.3.tar.gz</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>$ <span class=\"token builtin class-name\">cd</span> memcached-1.6.3</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>$ ./configure <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">make</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">make</span> <span class=\"token builtin class-name\">test</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">sudo</span> <span class=\"token function\">make</span> <span class=\"token function\">install</span></pre></td></tr></table></figure><h3 id=\"22-å®‰è£…redis\"><a class=\"anchor\" href=\"#22-å®‰è£…redis\">#</a> 2.2 å®‰è£… Redis</h3>\n<p>ç›¸ä¼¼çš„ï¼Œå®‰è£…æœ€æ–°ç‰ˆçš„ Redis Server</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ <span class=\"token function\">wget</span> http://download.redis.io/releases/redis-5.0.8.tar.gz</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>$ <span class=\"token function\">tar</span> xzf redis-5.0.8.tar.gz</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>$ <span class=\"token builtin class-name\">cd</span> redis-5.0.8</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>$ <span class=\"token function\">make</span></pre></td></tr></table></figure><h2 id=\"3æ±‚åŒ\"><a class=\"anchor\" href=\"#3æ±‚åŒ\">#</a> 3ï¼Œæ±‚åŒ</h2>\n<h3 id=\"31-äºšæ¯«ç§’å»¶è¿Ÿ\"><a class=\"anchor\" href=\"#31-äºšæ¯«ç§’å»¶è¿Ÿ\">#</a> 3.1 äºšæ¯«ç§’å»¶è¿Ÿ</h3>\n<p>MemCached å’Œ Redis éƒ½é€šè¿‡å°†æ•°æ®ä¿å­˜åœ¨å†…å­˜ä¸­æ¥æä¾› <strong>äºšæ¯«ç§’çº§</strong> çš„å“åº”æ—¶é—´</p>\n<h3 id=\"32-æ•°æ®åˆ†åŒº\"><a class=\"anchor\" href=\"#32-æ•°æ®åˆ†åŒº\">#</a> 3.2 æ•°æ®åˆ†åŒº</h3>\n<p>ç±»ä¼¼çš„ï¼Œä¸¤ä¸ªå†…å­˜æ•°æ®åº“éƒ½å…è®¸è·¨å¤šä¸ªèŠ‚ç‚¹åˆ†å‘æ•°æ®</p>\n<h3 id=\"33-ç¼–ç¨‹è¯­è¨€æ”¯æŒ\"><a class=\"anchor\" href=\"#33-ç¼–ç¨‹è¯­è¨€æ”¯æŒ\">#</a> 3.3 ç¼–ç¨‹è¯­è¨€æ”¯æŒ</h3>\n<p>åŒæ ·ï¼Œä¸¤è€…éƒ½æ”¯æŒæ‰€æœ‰ä¸»è¦çš„ç¼–ç¨‹è¯­è¨€ï¼ŒåŒ…æ‹¬ javaï¼Œpythonï¼Œjavascriptï¼Œc å’Œ rubyã€‚å¦å¤–ï¼Œå†…å­˜ä¸­çš„ä¸¤ä¸ªæ•°æ®åº“éƒ½æœ‰ä¸€äº› java å®¢æˆ·æœºã€‚ä¾‹å¦‚ï¼šMemCached æœ‰ Xmemcached å’Œ Memcached-java-clientï¼ŒRedis æœ‰ Jedis, Lettuce, å’Œ Redissonã€‚</p>\n<h3 id=\"34-ç¼“å­˜æ¸…é™¤\"><a class=\"anchor\" href=\"#34-ç¼“å­˜æ¸…é™¤\">#</a> 3.4 ç¼“å­˜æ¸…é™¤</h3>\n<p>MemCached å…è®¸ä½¿ç”¨ flush_all å‘½ä»¤æ¸…ç†ç¼“å­˜ï¼Œç›¸ä¼¼çš„ Redis å…è®¸æˆ‘ä»¬ä»ç¼“å­˜ä¸­åˆ é™¤æ‰€æœ‰å†…å®¹é€šè¿‡ä½¿ç”¨å‘½ä»¤ï¼šFLUSHDB and FLUSHALL</p>\n<h3 id=\"35-å¯ä¼¸ç¼©æ€§\"><a class=\"anchor\" href=\"#35-å¯ä¼¸ç¼©æ€§\">#</a> 3.5 å¯ä¼¸ç¼©æ€§</h3>\n<p>è¿™ä¸¤ç§ç¼“å­˜è§£å†³æ–¹æ¡ˆéƒ½æä¾›äº†åœ¨éœ€æ±‚å‘ˆæŒ‡æ•°å¢é•¿æ—¶å¤„ç†  å¤§æ•°æ® çš„é«˜å¯ä¼¸ç¼©æ€§</p>\n<h2 id=\"4å­˜å¼‚\"><a class=\"anchor\" href=\"#4å­˜å¼‚\">#</a> 4ï¼Œå­˜å¼‚</h2>\n<h3 id=\"41-å‘½ä»¤è¡Œæ¨¡å¼\"><a class=\"anchor\" href=\"#41-å‘½ä»¤è¡Œæ¨¡å¼\">#</a> 4.1 å‘½ä»¤è¡Œæ¨¡å¼</h3>\n<p>MemCached å¯ä»¥é€šè¿‡ Telnet è¿æ¥åˆ°æœåŠ¡å™¨å¹¶æ‰§è¡Œå‘½ä»¤ï¼š</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ telnet <span class=\"token number\">192.168</span>.8.123 <span class=\"token number\">6605</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>Trying <span class=\"token number\">192.168</span>.8.123</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>Connected to <span class=\"token number\">192.168</span>.8.123</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>$ stats</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>STAT pid <span class=\"token number\">14868</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>STAT <span class=\"token function\">uptime</span> <span class=\"token number\">175931</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>STAT <span class=\"token function\">time</span> <span class=\"token number\">1220540125</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>// <span class=\"token punctuation\">..</span>.</pre></td></tr></table></figure><p>ä¸ MemCached ä¸åŒï¼ŒRedis æœ‰ä¸€ä¸ªä¸“ç”¨çš„å‘½ä»¤è¡Œç•Œé¢ï¼ŒRedis cliï¼Œå…è®¸æˆ‘ä»¬æ‰§è¡Œå‘½ä»¤ï¼š</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ redis-cli COMMAND</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"save\"</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>     <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>     <span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"admin\"</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"noscript\"</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>     // <span class=\"token punctuation\">..</span>.</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"multi\"</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>   <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>   <span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"noscript\"</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>      <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"fast\"</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>   // <span class=\"token punctuation\">..</span>.</pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"geodist\"</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>   <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token parameter variable\">-4</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>   <span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"readonly\"</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>   // <span class=\"token punctuation\">..</span>.</pre></td></tr><tr><td data-num=\"16\"></td><td><pre> </pre></td></tr><tr><td data-num=\"17\"></td><td><pre>// <span class=\"token punctuation\">..</span>.</pre></td></tr></table></figure><p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬æ‰§è¡Œäº† COMMAND å‘½ä»¤ï¼Œåˆ—å‡º Redis æä¾›çš„æ‰€æœ‰å‘½ä»¤ã€‚</p>\n<h3 id=\"42-ç£ç›˜ioè½¬å‚¨\"><a class=\"anchor\" href=\"#42-ç£ç›˜ioè½¬å‚¨\">#</a> 4.2 ç£ç›˜ i/o è½¬å‚¨</h3>\n<p>MemCached ä½¿ç”¨ç¬¬ä¸‰æ–¹å·¥å…·å¤„ç†ç£ç›˜è½¬å‚¨ï¼Œå¦‚ libmemcached tools æˆ–è€…åƒ memcached dd.</p>\n<p>ä½†æ˜¯ï¼ŒRedis ä¸ºç£ç›˜è½¬å‚¨æä¾›äº†é«˜åº¦å¯é…ç½®çš„é»˜è®¤æœºåˆ¶ï¼Œå¦‚ RDB (Redis æ•°æ®åº“ æ–‡ä»¶) æˆ– AOF (ä»…é™„åŠ æ–‡ä»¶)ã€‚è¿™å¯¹äºå­˜æ¡£å’Œæ¢å¤éå¸¸æœ‰ç”¨</p>\n<p>ä½¿ç”¨ redis cliï¼Œæˆ‘ä»¬å¯ä»¥æ‰§è¡ŒåŒæ­¥çš„ SAVE è·å–å†…å­˜ä¸­æ•°æ®åº“å¿«ç…§çš„å‘½ä»¤ï¼š</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ redis-cli SAVE OK</pre></td></tr></table></figure><p>åœ¨è¿™é‡Œï¼Œå‘½ä»¤å°†å¿«ç…§å­˜å‚¨åœ¨ è½¬å‚¨.rdb äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå®Œæˆåè¿”å›çŠ¶æ€ç¡®å®š</p>\n<p>ä½†æ˜¯ï¼Œå¼‚æ­¥ BGSAVE çš„æ‰§è¡Œå°†å¯åŠ¨äº§ç”Ÿå¿«ç…§çš„åå°è¿‡ç¨‹ï¼š</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ redis-cli BGSAVE</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>OK</pre></td></tr></table></figure><p>æ­¤å¤–ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ LASTSAVE å‘½ä»¤æ£€æŸ¥ä¸Šæ¬¡æˆåŠŸçš„æ•°æ®åº“å¿«ç…§çš„ Unix æ—¶é—´</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ redis-cli LASTSAVE</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1410853592</span></pre></td></tr></table></figure><h3 id=\"43-æ•°æ®ç»“æ„\"><a class=\"anchor\" href=\"#43-æ•°æ®ç»“æ„\">#</a> 4.3 æ•°æ®ç»“æ„</h3>\n<p>MemCached å°† é”® - å€¼ å¯¹ å­˜å‚¨ä¸ºå­—ç¬¦ä¸²ï¼Œæ¯ä¸ªå€¼çš„å¤§å°é™åˆ¶ä¸º 1MBã€‚ä¸è¿‡ [Redis ä¹Ÿæ”¯æŒå…¶ä»–æ•°æ®ç»“æ„ï¼Œåƒ list, set å’Œ hash ä¸€æ ·ï¼Œå¯ä»¥å­˜å‚¨é«˜è¾¾ 512MB çš„å¤§å°]</p>\n<h3 id=\"44-å¤åˆ¶\"><a class=\"anchor\" href=\"#44-å¤åˆ¶\">#</a> 4.4 å¤åˆ¶</h3>\n<p>MemCached æ”¯æŒä½¿ç”¨ç¬¬ä¸‰æ–¹ å¦‚ repcached è¿›è¡Œå¤åˆ¶</p>\n<p>ä¸ MemCached ä¸åŒï¼Œredis é€šè¿‡å¤åˆ¶ä¸»å­˜å‚¨ä¸ºæˆ‘ä»¬æä¾›äº†æˆå€å¢åŠ é›†ç¾¤çš„åŠŸèƒ½ï¼Œä»¥è·å¾—æ›´å¥½çš„å¯ä¼¸ç¼©æ€§å’Œé«˜å¯ç”¨æ€§ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ REPLICAOF åˆ›å»º Redis ä¸»æœåŠ¡å™¨çš„å‰¯æœ¬ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åœ¨å¤åˆ¶ä¸Šæ‰§è¡Œ PSYNC å‘½ä»¤ä»¥ä¸»æœºå¯åŠ¨å¤åˆ¶ã€‚</p>\n<h3 id=\"45-äº‹åŠ¡\"><a class=\"anchor\" href=\"#45-äº‹åŠ¡\">#</a> 4.5 äº‹åŠ¡</h3>\n<p>MemCached ä¸æ”¯æŒäº‹åŠ¡ï¼Œå°½ç®¡å…¶æ“ä½œæ˜¯åŸå­çš„ã€‚</p>\n<p>Redis ä¸ºæ‰§è¡Œå‘½ä»¤æä¾›äº†å¼€ç®±å³ç”¨çš„äº‹åŠ¡æ”¯æŒã€‚</p>\n<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ MULTI å‘½ä»¤å¯åŠ¨äº‹åŠ¡ã€‚ç„¶åä½¿ç”¨ EXEC ç”¨äºæ‰§è¡Œåç»­çš„å‘½ä»¤ï¼Œæœ€åï¼ŒRedis æä¾›äº† WATCH å‘½ä»¤ç”¨äºæœ‰æ¡ä»¶åœ°æ‰§è¡Œäº‹åŠ¡ã€‚</p>\n<h3 id=\"46-å‘å¸ƒå’Œè®¢é˜…æ¶ˆæ¯\"><a class=\"anchor\" href=\"#46-å‘å¸ƒå’Œè®¢é˜…æ¶ˆæ¯\">#</a> 4.6 å‘å¸ƒå’Œè®¢é˜…æ¶ˆæ¯</h3>\n<p>MemCached ä¸æä¾›å¼€ç®±å³ç”¨çš„  å‘å¸ƒ / è®¢é˜…  æœºåˆ¶ã€‚</p>\n<p>å¦ä¸€æ–¹é¢ Redisï¼Œä½¿ç”¨ pub/sub  æ¶ˆæ¯é˜Ÿåˆ—æä¾›è®¢é˜…æ¶ˆæ¯çš„åŠŸèƒ½ã€‚</p>\n<p>è¿™åœ¨è®¾è®¡éœ€è¦å®æ—¶é€šä¿¡çš„åº”ç”¨ç¨‹åº (å¦‚èŠå¤©å®¤ï¼Œç¤¾äº¤åª’ä½“è®¢é˜…æºå’ŒæœåŠ¡å™¨å†…éƒ¨é€šä¿¡) æ—¶éå¸¸æœ‰ç”¨ã€‚</p>\n<p>Redis é™„å¸¦äº†è¯¸å¦‚ [PUBLISH]ï¼Œ[SUBSCRIBE] å’Œ [UNSUBSCRIBE] è¿™æ ·çš„ä¸“ç”¨çš„å‘½ä»¤ï¼Œåˆ†åˆ«ç”¨äºå°†æ¶ˆæ¯å‘å¸ƒåˆ°é¢‘é“ï¼Œè®¢é˜…å’Œå–æ¶ˆè®¢é˜…å®¢æˆ·ç«¯åˆ°æŒ‡å®šé¢‘é“ã€‚</p>\n<h3 id=\"47-åœ°ç†ç©ºé—´æ”¯æŒ\"><a class=\"anchor\" href=\"#47-åœ°ç†ç©ºé—´æ”¯æŒ\">#</a> 4.7 åœ°ç†ç©ºé—´æ”¯æŒ</h3>\n<p>åœ°ç†ç©ºé—´æ”¯æŒå¯¹äºå®ç°åº”ç”¨ç¨‹åºçš„åŸºäºä½ç½®çš„åŠŸèƒ½éå¸¸æœ‰ç”¨ã€‚ä¸ç”¨äº MemCachedï¼ŒRedis å¸¦æœ‰ç‰¹æ®Šçš„ [ç”¨äºç®¡ç†å®æ–½åœ°ç†ç©ºç®€æ•°æ®çš„å‘½ä»¤]</p>\n<p>ä¸¾ä¸ªä¾‹å­ï¼ŒGEODIST å‘½ä»¤è®¡ç®—ä¸¤ä¸ªåœ°ç†ç©ºé—´æ¡ç›®ä¹‹é—´çš„è·ç¦»ã€‚åŒæ ·çš„ï¼ŒGEORADIUS å‘½ä»¤è¿”å›æä¾›åŠå¾„å†…çš„æ‰€æœ‰æ¡ç›®ï¼Œå¦å¤–ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Spring Data Redis åœ¨ Java åº”ç”¨ç¨‹åºä¸­å¯ç”¨ Redis åœ°ç†ç©ºé—´æ”¯æŒ</p>\n<h3 id=\"48-æ¶æ„\"><a class=\"anchor\" href=\"#48-æ¶æ„\">#</a> 4.8 æ¶æ„</h3>\n<p>Redis ä½¿ç”¨å•æ ¸ï¼Œåœ¨å­˜å‚¨å°æ•°æ®é›†æ–¹é¢è¡¨ç°å‡ºæ¯” MemCached æ›´å¥½çš„æ€§èƒ½ã€‚</p>\n<p>[MemCached é€šè¿‡ä½¿ç”¨å¤šä¸ªå†…æ ¸] å®ç°å¤šçº¿ç¨‹ä½“ç³»ç»“æ„ã€‚å› æ­¤ï¼Œå¯¹äºå­˜å‚¨æ›´å¤§çš„æ•°æ®é›†ï¼ŒMemCached çš„æ€§èƒ½æ›´ä¼˜äº Redisã€‚</p>\n<p>MemCached çš„å¤šçº¿ç¨‹ä½“ç³»ç»“æ„çš„å¦ä¸€ä¸ªå¥½å¤„æ˜¯å®ƒé€šè¿‡åˆ©ç”¨å¤šä¸ªè®¡ç®—èµ„æºå®ç°çš„é«˜å¯ä¼¸ç¼©æ€§ã€‚</p>\n<p>Redis å¯ä»¥é€šè¿‡é›†ç¾¤è¿›è¡Œæ¨ªå‘æ‰©å±•ï¼Œè®¾ç½®å’Œæ“ä½œç›¸å¯¹å¤æ‚ã€‚å½“ç„¶äº†ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Java åº”ç”¨ç¨‹åºé€šè¿‡ Jedis æˆ–è€… Lettuce å¯ç”¨ Redis é›†ç¾¤ã€‚</p>\n<h3 id=\"49-lua-scripting\"><a class=\"anchor\" href=\"#49-lua-scripting\">#</a> 4.9 LUA Scripting</h3>\n<p>ä¸ MemCached ä¸åŒï¼Œæˆ‘ä»¬å¯ä»¥å¯¹ Redis æ‰§è¡Œ [LUA Scripts]ã€‚å®ƒæä¾›äº†ç±»ä¼¼äº [EVAL] å’Œ [SCRIPT LOAD] çš„å‘½ä»¤ï¼Œè¿™äº›å‘½ä»¤å¯¹äº LUA è„šæœ¬çš„æ‰§è¡Œéå¸¸æœ‰ç”¨ã€‚</p>\n<p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥æ‰§è¡Œ EVAL å‘½ä»¤æ¥è®¡ç®—è„šæœ¬ï¼š</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ redis-cli <span class=\"token builtin class-name\">eval</span> <span class=\"token string\">\"return redis.call('set',KEYS[1],'welldone')\"</span> <span class=\"token number\">1</span> website</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>OK</pre></td></tr></table></figure><p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ EVAL è®¾ç½® key = website çš„å€¼ä¸º welldone</p>\n<h3 id=\"410-å†…å­˜åˆ©ç”¨ç‡\"><a class=\"anchor\" href=\"#410-å†…å­˜åˆ©ç”¨ç‡\">#</a> 4.10 å†…å­˜åˆ©ç”¨ç‡</h3>\n<p>æ¯”è¾ƒå­—ç¬¦ä¸²æ•°æ®ç»“æ„æ—¶ï¼ŒMemCached çš„å†…å­˜åˆ©ç”¨ç‡é«˜äº Redis</p>\n<p>å°½ç®¡å¦‚æ­¤ï¼Œå½“ Redis ä½¿ç”¨æ•£åˆ—ç»“æ„æ—¶ï¼Œå®ƒæä¾›äº†æ¯” MemCached æ›´é«˜çš„å†…å­˜åˆ©ç”¨ç‡</p>\n<h2 id=\"5å†™åœ¨æœ€å\"><a class=\"anchor\" href=\"#5å†™åœ¨æœ€å\">#</a> 5ï¼Œå†™åœ¨æœ€å</h2>\n<p>åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬æ¢è®¨äº† MemCached å’Œ Redisã€‚é¦–å…ˆï¼Œæˆ‘ä»¬ç ”ç©¶äº†ä¸¤ä¸ªå†…å­˜æ•°æ®åº“çš„ç›¸ä¼¼æ€§ï¼Œç„¶åï¼Œæˆ‘ä»¬ç ”ç©¶äº†è¿™ä¸¤ç§ç¼“å­˜è§£å†³æ–¹æ¡ˆæ‰€æä¾›åŠŸèƒ½çš„å·®å¼‚ã€‚</p>\n<p>ç›®å‰æœ‰è®¸å¤šå†…å­˜ç¼“å­˜è§£å†³æ–¹æ¡ˆå¯ç”¨ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åº”è¯¥è€ƒè™‘ç¼“å­˜å¼•æ“çš„ç‰¹æ€§ï¼Œå¹¶å°†å®ƒä»¬ä¸æˆ‘ä»¬å®é™…çš„ç”¨ä¾‹ç›¸åŒ¹é…ã€‚</p>\n<p>æˆ‘ä»¬å¯ä»¥è‚¯å®šçš„å¾—å‡ºç»“è®ºï¼ŒMemCached æ˜¯è§£å†³ç®€å•ç¼“å­˜é—®é¢˜çš„å¯é é€‰æ‹©ã€‚ç„¶è€Œï¼Œä¸€èˆ¬æ¥è¯´ï¼Œ[Redis é€šè¿‡æä¾›æ›´ä¸°å¯Œçš„åŠŸèƒ½å’Œå„ç§å„æ ·çš„ç‰¹æ€§è€Œä¼˜äº MemCachedï¼Œè¿™äº›ç‰¹æ€§å¯¹äºè§£å†³å¤æ‚çš„åœºæ™¯æ›´æœ‰ä¼˜åŠ¿]</p>\n",
            "tags": [
                "essay",
                "æ–‡ç« "
            ]
        },
        {
            "id": "https://pigpigletsgo.github.io/tools/windows/%E9%85%8D%E7%BD%AE%E5%BA%94%E7%94%A8%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/",
            "url": "https://pigpigletsgo.github.io/tools/windows/%E9%85%8D%E7%BD%AE%E5%BA%94%E7%94%A8%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/",
            "title": "é…ç½®åº”ç”¨ç¯å¢ƒå˜é‡",
            "date_published": "2024-08-12T07:44:24.560Z",
            "content_html": "<p>win+i æ‰“å¼€è®¾ç½®</p>\n<p>æ‰“å¼€ç³»ç»Ÿç¯å¢ƒé«˜çº§è®¾ç½®ï¼Œé€‰æ‹©ç³»ç»Ÿå˜é‡ä¸­çš„ path, åœ¨ç”¨æˆ·å˜é‡ ç®¡ç†ä¸­é…ç½®æ— æ•ˆ</p>\n<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20230416181011196_20230416181535.png\" alt=\"image-20230416181011196\" /></p>\n<p>æ‰¾åˆ°åº”ç”¨çš„ exe æ–‡ä»¶çš„ä½ç½®ï¼Œå¤åˆ¶è·¯å¾„</p>\n<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20230416181135830_20230416181550.png\" alt=\"image-20230416181135830\" /></p>\n<p>ç‚¹å‡» New è¾“å…¥è·¯å¾„å çœ‹ä¸‹è·¯å¾„æœ€åé¢æ²¡æœ‰ \\ è¡¥ä¸Š \\ å³å¯ï¼Œä¸€è·¯ OK</p>\n<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20230416181216628_20230416181601.png\" alt=\"image-20230416181216628\" /></p>\n<p>å°† Terminal å…³é—­åé‡æ–°æ‰“å¼€è¾“å…¥ exe ç¨‹åºçš„åç§°å³å¯æ‰“å¼€</p>\n<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20230416181408711_20230416181613.png\" alt=\"image-20230416181408711\" /></p>\n<p>æ‰“å¼€æˆåŠŸï¼ï¼ï¼</p>\n<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20230416181443892_20230416181624.png\" alt=\"image-20230416181443892\" /></p>\n",
            "tags": [
                "tools",
                "windows",
                "tools"
            ]
        },
        {
            "id": "https://pigpigletsgo.github.io/tools/typora/%E5%AE%9A%E4%B9%89%E9%AB%98%E4%BA%AE%E5%BF%AB%E6%8D%B7%E9%94%AE/",
            "url": "https://pigpigletsgo.github.io/tools/typora/%E5%AE%9A%E4%B9%89%E9%AB%98%E4%BA%AE%E5%BF%AB%E6%8D%B7%E9%94%AE/",
            "title": "typoraè‡ªå®šä¹‰é«˜äº®å¿«æ·é”®",
            "date_published": "2024-08-12T07:40:45.445Z",
            "content_html": "<p><mark>æ‰“å¼€é…ç½®æ–‡ä»¶ä¿®æ”¹é…ç½®</mark> ã€‚</p>\n<p>ä½ç½®ï¼šæ‰“å¼€ typora -&gt; æ–‡ä»¶ -&gt; åå¥½è®¾ç½® -&gt; é€šç”¨ -&gt; æ‰“å¼€é«˜çº§è®¾ç½®ã€‚</p>\n<p>æ‰“å¼€ conf.user.json æ–‡ä»¶è¿›è¡Œç¼–è¾‘åœ¨ keybinding ä¸­è¾“å…¥å¦‚ä¸‹ json æ•°æ®ã€‚</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token property\">\"keyBinding\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>   <span class=\"token comment\">// for example:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>   <span class=\"token comment\">// \"Always on Top\": \"Ctrl+Shift+P\"</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>   <span class=\"token comment\">// All other options are the menu items 'text label' displayed from each typora menu</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>   <span class=\"token property\">\"Highlight\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Ctrl + q\"</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>ä¿å­˜åé‡å¯ Typora å°±å¯ä»¥ä½¿ç”¨äº†ã€‚</p>\n",
            "tags": [
                "tools",
                "typora",
                "tools"
            ]
        },
        {
            "id": "https://pigpigletsgo.github.io/tools/typora/%E7%94%BB%E5%9B%BE/",
            "url": "https://pigpigletsgo.github.io/tools/typora/%E7%94%BB%E5%9B%BE/",
            "title": "Typora-Markdown ç”»å›¾",
            "date_published": "2024-08-12T07:40:45.424Z",
            "content_html": "<h1 id=\"typora-markdown-ç”»å›¾\"><a class=\"anchor\" href=\"#typora-markdown-ç”»å›¾\">#</a> Typora-Markdown ç”»å›¾ğŸ„</h1>\n<p>ğŸ’ </p>\n<p>markdown ç”»å›¾ä¹Ÿæ˜¯è½»é‡çº§çš„</p>\n<p>mermaid æ˜¯ä¸€ä¸ªç”¨äºç”»æµç¨‹å›¾ï¼ŒçŠ¶æ€å›¾ï¼Œæ—¶åºå›¾ï¼Œç”˜ç‰¹å›¾çš„åº“ï¼Œä½¿ç”¨ JS è¿›è¡Œæœ¬åœ°æ¸²æŸ“ï¼Œå¹¿æ³›é›†æˆäºè®¸å¤š Markdown ç¼–è¾‘å™¨ä¸­ï¼Œmermaid ä½œä¸ºä¸€ä¸ªä½¿ç”¨ JS æ¸²æŸ“çš„åº“ï¼Œç”Ÿæˆçš„ä¸æ˜¯ä¸€ä¸ª â€œå›¾ç‰‡â€ï¼Œè€Œæ˜¯ä¸€æ®µ HTML ä»£ç </p>\n<p>ğŸ“‹</p>\n<p>åœ¨ Typora ä¸­è¾“å…¥ &quot;```mermaid &quot; å›è½¦å°±ä¼šå‡ºç°ä¸€ä¸ªä»£ç å—ï¼Œåœ¨é‡Œé¢è¿›è¡Œä»£ç ç”»å›¾æ“ä½œ</p>\n<h1 id=\"1æµç¨‹å›¾\"><a class=\"anchor\" href=\"#1æµç¨‹å›¾\">#</a> 1. æµç¨‹å›¾ğŸ„</h1>\n<p><strong>è¯­æ³•</strong>:ğŸ²</p>\n<pre><code>graph æ–¹å‘æè¿°\n å›¾è¡¨ä¸­å…¶å®ƒçš„è¯­å¥...\n</code></pre>\n<p>å…³é”®å­— graph è¡¨ç¤ºä¸€ä¸ªæµç¨‹å›¾çš„å¼€å§‹ï¼ŒåŒæ—¶éœ€è¦æŒ‡å®šè¯¥å›¾çš„æ–¹å‘ã€‚</p>\n<p>å…¶ä¸­ â€œæ–¹å‘æè¿°â€ ä¸ºï¼šğŸŒ </p>\n<table>\n<thead>\n<tr>\n<th>è¯­æ³•</th>\n<th>å«ä¹‰</th>\n<th>è¯¦ç»†å«ä¹‰</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>TB</td>\n<td>ä»ä¸Šåˆ°ä¸‹</td>\n<td>top + bottom</td>\n</tr>\n<tr>\n<td>BT</td>\n<td>ä»ä¸‹åˆ°ä¸Š</td>\n<td>bottom + top</td>\n</tr>\n<tr>\n<td>RL</td>\n<td>ä»å³åˆ°å·¦</td>\n<td>right + left</td>\n</tr>\n<tr>\n<td>LR</td>\n<td>ä»å·¦åˆ°å³</td>\n<td>left + right</td>\n</tr>\n<tr>\n<td>TD</td>\n<td>ä»ä¸Šåˆ°ä¸‹</td>\n<td>top + down</td>\n</tr>\n<tr>\n<td>DT</td>\n<td>ä»ä¸‹åˆ°ä¸Š</td>\n<td>down + top</td>\n</tr>\n</tbody>\n</table>\n<blockquote>\n<p>T = TOP , B = BOTTOM , L = LEFT  , R = RIGHT , D = DOWN</p>\n</blockquote>\n<p>ç®€å•æ¼”ç¤º:</p>\n<pre><code>graph TB\n A--&gt;B\n B--&gt;C\n C--&gt;A\n</code></pre>\n<ul>\n<li>æµç¨‹å›¾æ¼”ç¤ºğŸŒ </li>\n</ul>\n<figure class=\"highlight mermaid\"><figcaption data-lang=\"mermaid\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">graph</span> TB</pre></td></tr><tr><td data-num=\"2\"></td><td><pre> A<span class=\"token arrow operator\">--></span>B</pre></td></tr><tr><td data-num=\"3\"></td><td><pre> B<span class=\"token arrow operator\">--></span>C</pre></td></tr><tr><td data-num=\"4\"></td><td><pre> C<span class=\"token arrow operator\">--></span>A</pre></td></tr></table></figure><figure class=\"highlight mermaid\"><figcaption data-lang=\"mermaid\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">graph</span> LR</pre></td></tr><tr><td data-num=\"2\"></td><td><pre> A<span class=\"token arrow operator\">--></span>B</pre></td></tr><tr><td data-num=\"3\"></td><td><pre> B<span class=\"token arrow operator\">--></span>C</pre></td></tr><tr><td data-num=\"4\"></td><td><pre> C<span class=\"token arrow operator\">--></span>A</pre></td></tr></table></figure><h2 id=\"2æµç¨‹å›¾å¸¸ç”¨ç¬¦å·ä»¥åŠå«ä¹‰\"><a class=\"anchor\" href=\"#2æµç¨‹å›¾å¸¸ç”¨ç¬¦å·ä»¥åŠå«ä¹‰\">#</a> 2. æµç¨‹å›¾å¸¸ç”¨ç¬¦å·ä»¥åŠå«ä¹‰ï¼ğŸŒ´</h2>\n<p><strong>èŠ‚ç‚¹å½¢çŠ¶</strong> â­ï¸</p>\n<table>\n<thead>\n<tr>\n<th>è¡¨è¿°</th>\n<th>è¯´æ˜</th>\n<th>å«ä¹‰</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>id [æ–‡å­—]</td>\n<td>çŸ©å½¢èŠ‚ç‚¹</td>\n<td>è¡¨ç¤ºè¿‡ç¨‹ï¼Œä¹Ÿå°±æ˜¯æ•´ä¸ªæµç¨‹ä¸­çš„ä¸€ä¸ªç¯èŠ‚</td>\n</tr>\n<tr>\n<td>id (æ–‡å­—)</td>\n<td>åœ†è§’çŸ©å½¢èŠ‚ç‚¹</td>\n<td>è¡¨ç¤ºå¼€å§‹å’Œç»“æŸ</td>\n</tr>\n<tr>\n<td>id ((æ–‡å­—))</td>\n<td>åœ†å½¢èŠ‚ç‚¹</td>\n<td>è¡¨ç¤ºè¿æ¥ï¼Œä¸ºé¿å…æµç¨‹è¿‡é•¿æˆ–æœ‰äº¤å‰ï¼Œå¯å°†æµç¨‹åˆ‡å¼€ï¼Œæˆå¯¹</td>\n</tr>\n<tr>\n<td æ–‡å­—=\"\">id</td>\n<td>è±å½¢èŠ‚ç‚¹</td>\n<td>è¡¨ç¤ºåˆ¤æ–­ï¼Œå†³ç­–</td>\n</tr>\n<tr>\n<td>id &gt; æ–‡å­—]</td>\n<td>å³å‘æ——å¸œçŠ¶èŠ‚ç‚¹</td>\n<td>ä¸æ˜...</td>\n</tr>\n</tbody>\n</table>\n<p>ç®€å•æ¼”ç¤º:</p>\n<pre><code>graph TB\n  A\n  B(åœ†è§’çŸ©å½¢èŠ‚ç‚¹)\n  C[çŸ©å½¢èŠ‚ç‚¹]\n  D((åœ†å½¢èŠ‚ç‚¹))\n  E&#123;è±å½¢èŠ‚ç‚¹&#125;\n  F&gt;å³å‘æ——å¸œçŠ¶èŠ‚ç‚¹] \n  G&#123;&#123;å…­è¾¹å½¢&#125;&#125;\n  H[/å¹³è¡Œå››è¾¹å½¢/]\n  I[\\åå‘å¹³è¡Œå››è¾¹å½¢\\]\n  J(((åŒå±‚åœ†å½¢)))\n  K[[å­ç¨‹åºå‹]]\n</code></pre>\n<ul>\n<li>å›¾å½¢æ¼”ç¤ºğŸŒ </li>\n</ul>\n<figure class=\"highlight mermaid\"><figcaption data-lang=\"mermaid\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">graph</span> TB</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  A</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  B<span class=\"token text string\">(åœ†è§’çŸ©å½¢èŠ‚ç‚¹)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  C<span class=\"token text string\">[çŸ©å½¢èŠ‚ç‚¹]</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  D<span class=\"token text string\">((åœ†å½¢èŠ‚ç‚¹))</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  E<span class=\"token text string\">&#123;è±å½¢èŠ‚ç‚¹&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  F<span class=\"token text string\">>å³å‘æ——å¸œçŠ¶èŠ‚ç‚¹]</span> </pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  G&lt;!<span class=\"token inter-arrow-label\"><span class=\"token arrow-head arrow operator\">--</span><span class=\"token label property\">swigï¿¼1</span><span class=\"token arrow operator\">--></span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  H<span class=\"token text string\">[/å¹³è¡Œå››è¾¹å½¢/]</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  I<span class=\"token text string\">[\\åå‘å¹³è¡Œå››è¾¹å½¢\\]</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>  J<span class=\"token text string\">(((åŒå±‚åœ†å½¢)))</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>  K<span class=\"token text string\">[[å­ç¨‹åºå‹]]</span></pre></td></tr></table></figure><h1 id=\"è¿çº¿\"><a class=\"anchor\" href=\"#è¿çº¿\">#</a> è¿çº¿ğŸ„</h1>\n<p>ğŸ’ </p>\n<p>ä¸åŒçš„çº¿çš„å½¢çŠ¶</p>\n<pre><code>graph TB\n  A1--&gt;B1\n  A2---B2\n  A3--text---B3\n  A4--text--&gt;B4\n  A5-.-B5\n  A6-.-&gt;B6\n  A7-.text.-B7\n  A8-.text.-&gt;B8\n  A9===B9\n  A10==&gt;B10\n  A11==text===B11\n  A12==text==&gt;B12\n  A13o--oB13\n  A14&lt;--&gt;B14\n  A15x--xB15\n</code></pre>\n<ul>\n<li>çº¿çš„æ¼”ç¤ºğŸŒ </li>\n</ul>\n<figure class=\"highlight mermaid\"><figcaption data-lang=\"mermaid\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">graph</span> TB</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  A1<span class=\"token arrow operator\">--></span>B1</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  A2<span class=\"token arrow operator\">---</span>B2</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  A3<span class=\"token inter-arrow-label\"><span class=\"token arrow-head arrow operator\">--</span><span class=\"token label property\">text</span><span class=\"token arrow operator\">---</span></span>B3</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  A4<span class=\"token inter-arrow-label\"><span class=\"token arrow-head arrow operator\">--</span><span class=\"token label property\">text</span><span class=\"token arrow operator\">--></span></span>B4</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  A5<span class=\"token arrow operator\">-.-</span>B5</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  A6<span class=\"token arrow operator\">-.-></span>B6</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  A7<span class=\"token inter-arrow-label\"><span class=\"token arrow-head arrow operator\">-.</span><span class=\"token label property\">text</span><span class=\"token arrow operator\">.-</span></span>B7</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  A8<span class=\"token inter-arrow-label\"><span class=\"token arrow-head arrow operator\">-.</span><span class=\"token label property\">text</span><span class=\"token arrow operator\">.-></span></span>B8</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  A9<span class=\"token arrow operator\">===</span>B9</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>  A10<span class=\"token arrow operator\">==></span>B10</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>  A11<span class=\"token inter-arrow-label\"><span class=\"token arrow-head arrow operator\">==</span><span class=\"token label property\">text</span><span class=\"token arrow operator\">===</span></span>B11</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>  A12<span class=\"token inter-arrow-label\"><span class=\"token arrow-head arrow operator\">==</span><span class=\"token label property\">text</span><span class=\"token arrow operator\">==></span></span>B12</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>  A13<span class=\"token arrow operator\">o--o</span>B13</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>  A14<span class=\"token arrow operator\">&lt;--></span>B14</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>  A15<span class=\"token arrow operator\">x--x</span>B15</pre></td></tr></table></figure><h1 id=\"å­å›¾è¡¨\"><a class=\"anchor\" href=\"#å­å›¾è¡¨\">#</a> å­å›¾è¡¨ğŸ„</h1>\n<p>ğŸ’ </p>\n<p>ä½¿ç”¨ &lt;font style=&quot;color:red&quot;&gt;<strong>subgraph</strong>&lt;/font&gt; å…³é”®å­— æ¥å®šä¹‰å­å›¾è¡¨ï¼Œå½“ç„¶æœ‰å­å›¾è¡¨å‰å¿…é¡»å…ˆå®šä¹‰<strong> graph</strong>.</p>\n<pre><code>subgraph å­å›¾è¡¨åç§°\n    å­å›¾è¡¨ä¸­çš„æè¿°è¯­å¥...\nend\n</code></pre>\n<ul>\n<li>æ•ˆæœ:ğŸŒ </li>\n</ul>\n<figure class=\"highlight mermaid\"><figcaption data-lang=\"mermaid\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">graph</span> TB</pre></td></tr><tr><td data-num=\"2\"></td><td><pre> <span class=\"token keyword\">subgraph</span> å­å›¾è¡¨</pre></td></tr><tr><td data-num=\"3\"></td><td><pre> \tdb<span class=\"token text string\">[(MySQL)]</span><span class=\"token arrow operator\">--></span>depicted<span class=\"token text string\">(æŒä¹…åŒ–,å…³ç³»å‹æ•°æ®åº“)</span><span class=\"token arrow operator\">--></span>contact<span class=\"token text string\">((è”ç³»))</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre> <span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre> contact<span class=\"token arrow operator\">-.-></span>db1<span class=\"token text string\">[(Redis)]</span><span class=\"token arrow operator\">--></span>contact1<span class=\"token text string\">(å­˜å‚¨ç¼“å­˜,éå…³ç³»å‹æ•°æ®åº“)</span></pre></td></tr></table></figure><h1 id=\"åºåˆ—å›¾\"><a class=\"anchor\" href=\"#åºåˆ—å›¾\">#</a> åºåˆ—å›¾ğŸ„</h1>\n<p>ğŸ’ </p>\n<p>ä½¿ç”¨ &lt;font style=&quot;color:red&quot;&gt;<strong>sequenceDiagram</strong>&lt;/font&gt; å…³é”®å­—ï¼Œé‡Œé¢çš„å‚ä¸è€…ä½¿ç”¨ <strong>participant</strong>ã€‚</p>\n<pre><code>sequenceDiagram\n\tTitle: æ ‡é¢˜å\n\t[participant1][å…³ç³»çº¿][participant2]: æ¶ˆæ¯ä½“\n\t...\n</code></pre>\n<blockquote>\n<p><mark>sequenceDiagram</mark> ä¸ºæ¯å¹…æ—¶åºå›¾çš„å›ºå®šå¼€å¤´</p>\n<ul>\n<li>æ•ˆæœ:ğŸŒ </li>\n</ul>\n</blockquote>\n<figure class=\"highlight mermaid\"><figcaption data-lang=\"mermaid\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">sequenceDiagram</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\tTitle<span class=\"token operator\">:</span> åˆ˜æ¡‘ä¸å°æ˜</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\t<span class=\"token keyword\">participant</span> liu as åˆ˜æ¡‘</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t<span class=\"token keyword\">note left of</span> liu<span class=\"token operator\">:</span> ç”·</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t<span class=\"token keyword\">participant</span> xiao as å°æ˜</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t<span class=\"token keyword\">note right of</span> xiao<span class=\"token operator\">:</span>å¥³</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t<span class=\"token keyword\">note over</span> liu,xiao<span class=\"token operator\">:</span> èŠå¤©</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\tliu<span class=\"token arrow operator\">->></span>+xiao<span class=\"token operator\">:</span> åœ¨å—</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\txiao<span class=\"token arrow operator\">--></span>-liu<span class=\"token operator\">:</span> ä¸åœ¨</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\tliu-->>xiao<span class=\"token operator\">:</span> å¥½çš„</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\txiao<span class=\"token arrow operator\">-></span>liu<span class=\"token operator\">:</span> åœ¨å—</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\tliu<span class=\"token arrow operator\">--x</span>+xiao<span class=\"token operator\">:</span> ä¸åœ¨</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\txiao<span class=\"token arrow operator\">-x</span>-liu<span class=\"token operator\">:</span> å¥½çš„</pre></td></tr></table></figure><p>â™¦ï¸</p>\n<p><strong>å¤„ç†ä¸­ - æ¿€æ´»æ¡†</strong>.</p>\n<p>ä»æ¶ˆæ¯æ¥æ”¶æ–¹çš„æ—¶é—´çº¿ä¸Šæ ‡è®°ä¸€å°æ®µæ—¶é—´ï¼Œè¡¨ç¤ºå¯¹æ¶ˆæ¯è¿›è¡Œå¤„ç†çš„æ—¶é—´é—´éš”ã€‚</p>\n<p>åœ¨æ¶ˆæ¯çº¿æœ«å°¾å¢åŠ   <code>+</code>  ï¼Œåˆ™æ¶ˆæ¯æ¥æ”¶è€…è¿›å…¥å½“å‰æ¶ˆæ¯çš„ â€œå¤„ç†ä¸­â€ çŠ¶æ€ï¼›<br />\nåœ¨æ¶ˆæ¯çº¿æœ«å°¾å¢åŠ   <code>-</code>  ï¼Œåˆ™æ¶ˆæ¯æ¥æ”¶è€…ç¦»å¼€å½“å‰æ¶ˆæ¯çš„ â€œå¤„ç†ä¸­â€ çŠ¶æ€ã€‚</p>\n<p>ğŸ’«</p>\n<p><strong>æ³¨è§£</strong>ï¼š(note)</p>\n<p>è¯­æ³•:</p>\n<pre><code>note ä½ç½®è¡¨è¿° å‚ä¸è€…:æ ‡æ³¨æ–‡å­—\n</code></pre>\n<p>å…¶ä¸­ä½ç½®è¡¨è¿°å¯ä»¥ä¸º:</p>\n<table>\n<thead>\n<tr>\n<th>è¡¨è¿°</th>\n<th>å«ä¹‰</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>right of [participant as id] : depicted</td>\n<td>å³ä¾§</td>\n</tr>\n<tr>\n<td>left of [participant as id] : depicted</td>\n<td>å·¦ä¾§</td>\n</tr>\n<tr>\n<td>over [participant as id,participant as id,...] : depicted</td>\n<td>åœ¨å½“ä¸­ï¼Œå¯ä»¥æ¨ªè·¨å¤šä¸ªå‚ä¸è€…</td>\n</tr>\n</tbody>\n</table>\n<h1 id=\"å¾ªç¯loop\"><a class=\"anchor\" href=\"#å¾ªç¯loop\">#</a> å¾ªç¯ (loop)ğŸ„</h1>\n<p>ğŸ’ </p>\n<p>åœ¨æ¡ä»¶æ»¡è¶³æ—¶ï¼Œé‡å¤å‘å‡ºæ¶ˆæ¯åºåˆ—</p>\n<pre><code>sequenceDiagram\n\tTitle: loop\n\tparticipant liu as åˆ˜æ¡‘\n\tparticipant xiao as å°æ˜\n\tliu -&gt;&gt; xiao: åœ¨å—\n\txiao -&gt;&gt; liu: æ€ä¹ˆäº†\n\tloop è¿‡äº†ä¸‰åˆ†é’Ÿ...\n\t\txiao -&gt;&gt; liu: è¿˜æ´»ç€å—\n\t\tliu -&gt;&gt; xiao: åœ¨å‘¢åœ¨å‘¢\n\tend\n\txiao --&gt;&gt; liu: æˆ‘ä»¥ä¸ºä½ æ²¡äº†å‘¢\n</code></pre>\n<ul>\n<li>æ•ˆæœ:ğŸŒ </li>\n</ul>\n<figure class=\"highlight mermaid\"><figcaption data-lang=\"mermaid\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">sequenceDiagram</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\tTitle<span class=\"token operator\">:</span> loop</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\t<span class=\"token keyword\">participant</span> liu as åˆ˜æ¡‘</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t<span class=\"token keyword\">participant</span> xiao as å°æ˜</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\tliu <span class=\"token arrow operator\">->></span> xiao<span class=\"token operator\">:</span> åœ¨å—</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\txiao <span class=\"token arrow operator\">->></span> liu<span class=\"token operator\">:</span> æ€ä¹ˆäº†</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t<span class=\"token keyword\">loop</span> è¿‡äº†ä¸‰åˆ†é’Ÿ...</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t\txiao <span class=\"token arrow operator\">->></span> liu<span class=\"token operator\">:</span> è¿˜æ´»ç€å—</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t\tliu <span class=\"token arrow operator\">->></span> xiao<span class=\"token operator\">:</span> åœ¨å‘¢åœ¨å‘¢</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t<span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\txiao <span class=\"token arrow operator\">-->></span> liu<span class=\"token operator\">:</span> æˆ‘ä»¥ä¸ºä½ æ²¡äº†å‘¢</pre></td></tr></table></figure><h1 id=\"é€‰æ‹©alt\"><a class=\"anchor\" href=\"#é€‰æ‹©alt\">#</a> é€‰æ‹© (alt)ğŸ„</h1>\n<p>ğŸ’ </p>\n<p>åœ¨å¤šä¸ªæ¡ä»¶ä¸­ä½œå‡ºåˆ¤æ–­ï¼Œæ¯ä¸ªæ¡ä»¶å°†å¯¹åº”ä¸åŒçš„æ¶ˆæ¯åºåˆ—</p>\n<pre><code>sequenceDiagram\n\tTitle: alt\n\tparticipant liu as åˆ˜æ¡‘\n\tparticipant xiao as å°æ˜\n\tliu --&gt;&gt; +xiao: åœ¨å—\n\txiao --&gt;&gt; -liu: åœ¨å‘¢\n\talt å¯å¯¹è¯æ¬¡æ•° &gt; 3\n\t\tliu --&gt;&gt; xiao: ä½ æ˜å¤©æœ‰ç©ºå—\n\telse 1 &lt; å¯å¯¹è¯æ¬¡æ•° &lt; 3\n\t\txiao --&gt;&gt; liu: æœ‰å•Šæ€ä¹ˆäº†\n\telse å¯å¯¹è¯æ¬¡æ•° &lt; 1\n\t\tliu --&gt;&gt; xiao: æˆ‘ä»¬ä¸€èµ·å»çˆ¬å±±æŠŠ\n\tend\n\txiao -&gt;&gt; liu: å¥½å•Š\n</code></pre>\n<ul>\n<li>æ•ˆæœğŸŒ </li>\n</ul>\n<figure class=\"highlight mermaid\"><figcaption data-lang=\"mermaid\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">sequenceDiagram</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\tTitle<span class=\"token operator\">:</span> alt</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\t<span class=\"token keyword\">participant</span> liu as åˆ˜æ¡‘</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t<span class=\"token keyword\">participant</span> xiao as å°æ˜</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\tliu <span class=\"token arrow operator\">-->></span> +xiao<span class=\"token operator\">:</span> åœ¨å—</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\txiao <span class=\"token arrow operator\">-->></span> -liu<span class=\"token operator\">:</span> åœ¨å‘¢</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t<span class=\"token keyword\">alt</span> å¯å¯¹è¯æ¬¡æ•° > 3</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t\tliu <span class=\"token arrow operator\">-->></span> xiao<span class=\"token operator\">:</span> ä½ æ˜å¤©æœ‰ç©ºå—</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t<span class=\"token keyword\">else</span> 1 &lt; å¯å¯¹è¯æ¬¡æ•° &lt; 3</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t\txiao <span class=\"token arrow operator\">-->></span> liu<span class=\"token operator\">:</span> æœ‰å•Šæ€ä¹ˆäº†</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t<span class=\"token keyword\">else</span> å¯å¯¹è¯æ¬¡æ•° &lt; 1</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t\tliu <span class=\"token arrow operator\">-->></span> xiao<span class=\"token operator\">:</span> æˆ‘ä»¬ä¸€èµ·å»çˆ¬å±±æŠŠ</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\t<span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\txiao <span class=\"token arrow operator\">->></span> liu<span class=\"token operator\">:</span> å¥½å•Š</pre></td></tr></table></figure><h1 id=\"å¯é€‰opt\"><a class=\"anchor\" href=\"#å¯é€‰opt\">#</a> å¯é€‰ (opt)ğŸ„</h1>\n<p>ğŸ’ </p>\n<p>åœ¨æŸæ¡ä»¶æ»¡è¶³æ—¶æ‰§è¡Œæ¶ˆæ¯åºåˆ—ï¼Œå¦åˆ™ä¸æ‰§è¡Œã€‚ç›¸å½“äºå•ä¸ªåˆ†æ”¯çš„ if è¯­å¥ã€‚</p>\n<pre><code>sequenceDiagram\n\tTitle: opt\n\tparticipant liu as åˆ˜æ¡‘\n\tparticipant xiao as å°æ˜\n\tliu --&gt;&gt; xiao:åœ¨å—\n\topt å¯¹æ–¹æ­£å¿™,è¯·å‹¿æ‰“æ‰°\n\t\txiao --&gt;&gt; liu: ä¸‹æ¬¡å†æ¥å§\n\tend\n</code></pre>\n<ul>\n<li>æ•ˆæœğŸŒ </li>\n</ul>\n<figure class=\"highlight mermaid\"><figcaption data-lang=\"mermaid\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">sequenceDiagram</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\tTitle<span class=\"token operator\">:</span> opt</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\t<span class=\"token keyword\">participant</span> liu as åˆ˜æ¡‘</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t<span class=\"token keyword\">participant</span> xiao as å°æ˜</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\tliu <span class=\"token arrow operator\">-->></span> xiao<span class=\"token operator\">:</span>åœ¨å—</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t<span class=\"token keyword\">opt</span> å¯¹æ–¹æ­£å¿™,è¯·å‹¿æ‰“æ‰°</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t\txiao <span class=\"token arrow operator\">-->></span> liu<span class=\"token operator\">:</span> ä¸‹æ¬¡å†æ¥å§</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t<span class=\"token keyword\">end</span></pre></td></tr></table></figure><h1 id=\"å¹¶è¡Œpar\"><a class=\"anchor\" href=\"#å¹¶è¡Œpar\">#</a> å¹¶è¡Œ (Par)ğŸ„</h1>\n<p>ğŸ’ </p>\n<p>å°†æ¶ˆæ¯åºåˆ—åˆ†æˆå¤šä¸ªç‰‡æ®µï¼Œè¿™äº›ç‰‡æ®µå¹¶è¡Œæ‰§è¡Œã€‚</p>\n<pre><code>sequenceDiagram\n\tTitle: Par\n\tparticipant liu as åˆ˜æ¡‘\n\tparticipant xiao as å°æ˜\n\tliu -&gt;&gt; xiao: åœ¨å—\n\tpar å¹¶è¡Œæ‰§è¡Œ\n\t\txiao -&gt;&gt; xiao: åƒé¥­\n\tand\n\t\txiao -&gt;&gt; xiao: åƒå®Œ\n\tend\n\txiao -&gt;&gt; liu: åœ¨\n</code></pre>\n<ul>\n<li>æ•ˆæœ:ğŸŒ </li>\n</ul>\n<figure class=\"highlight mermaid\"><figcaption data-lang=\"mermaid\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">sequenceDiagram</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\tTitle<span class=\"token operator\">:</span> Par</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\t<span class=\"token keyword\">participant</span> liu as åˆ˜æ¡‘</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t<span class=\"token keyword\">participant</span> xiao as å°æ˜</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\tliu <span class=\"token arrow operator\">->></span> xiao<span class=\"token operator\">:</span> åœ¨å—</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t<span class=\"token keyword\">par</span> å¹¶è¡Œæ‰§è¡Œ</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t\txiao <span class=\"token arrow operator\">->></span> xiao<span class=\"token operator\">:</span> åƒé¥­</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t<span class=\"token keyword\">and</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t\txiao <span class=\"token arrow operator\">->></span> xiao<span class=\"token operator\">:</span> åƒå®Œ</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t<span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\txiao <span class=\"token arrow operator\">->></span> liu<span class=\"token operator\">:</span> åœ¨</pre></td></tr></table></figure><h1 id=\"é¥¼å›¾pie\"><a class=\"anchor\" href=\"#é¥¼å›¾pie\">#</a> é¥¼å›¾ (pie)ğŸ„</h1>\n<p>ğŸ’ </p>\n<pre><code>pie\n title Pie Chart\n &quot;Dogs&quot;:386\n &quot;Cats&quot;:85\n &quot;Rats&quot;:150\n</code></pre>\n<ul>\n<li>æ•ˆæœğŸŒ </li>\n</ul>\n<figure class=\"highlight mermaid\"><figcaption data-lang=\"mermaid\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">pie</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre> title Pie Chart</pre></td></tr><tr><td data-num=\"3\"></td><td><pre> <span class=\"token string\">\"Dogs\"</span><span class=\"token operator\">:</span>386</pre></td></tr><tr><td data-num=\"4\"></td><td><pre> <span class=\"token string\">\"Cats\"</span><span class=\"token operator\">:</span>85</pre></td></tr><tr><td data-num=\"5\"></td><td><pre> <span class=\"token string\">\"Rats\"</span><span class=\"token operator\">:</span>150</pre></td></tr></table></figure><h1 id=\"ç”˜ç‰¹å›¾gantt\"><a class=\"anchor\" href=\"#ç”˜ç‰¹å›¾gantt\">#</a> ç”˜ç‰¹å›¾ (gantt)ğŸ„</h1>\n<p>ğŸ’ </p>\n<pre><code>title æ ‡é¢˜\ndateFormat æ—¥æœŸæ ¼å¼åŒ–\nsection éƒ¨åˆ†å\nä»»åŠ¡å :å‚æ•°ä¸€ï¼Œå‚æ•°äºŒï¼Œå‚æ•°ä¸‰ï¼Œå‚æ•°å››ï¼Œå‚æ•°äº”\nå‚æ•°ä¸€ï¼šcrit (æ˜¯å¦é‡è¦ï¼Œçº¢æ¡†) æˆ–è€… ä¸å¡«\nå‚æ•°äºŒï¼šdone(å·²å®Œæˆ),active(æ­£åœ¨è¿›è¡Œ)æˆ–è€… ä¸å¡«(è¡¨ç¤ºä¸ºå¾…å®ŒæˆçŠ¶æ€)\nå‚æ•°ä¸‰ï¼šdesï¼Œä¸è¦å†™é‡å¤ç”¨äºafterå“ªä¸ªdesä»»åŠ¡åå¼€å§‹æ‰§è¡Œçš„\nå‚æ•°å››ï¼šä»»åŠ¡å¼€å§‹æ—¶é—´\nå‚æ•°äº”ï¼šä»»åŠ¡ç»“æŸæ—¶é—´\n</code></pre>\n<ul>\n<li>æ¼”ç¤ºğŸ’«</li>\n</ul>\n<pre><code>gantt\n\ttitle æ¯æ—¥ä»»åŠ¡æ€»ç»“\n\tdateFormat yyyy-MM-dd\n\tsection A çª¦å‡¯æ¬£\n\tCompleted task :done,des1,2023-04-24,1d\n\tActive task :active,des2,2023-04-25,3d\n\tFuture task :des3,after des2,1d\n\tFuture task1 :after des3,2d\n\tFuture task2 :2023-04-28,4d\n\t\n\tsection B åˆ˜æ¡‘\n\tCompleted task :crit,done,des,2023-04-24,12h\n\tFuture task :crit,3d\n\tFuture task1 :crit,active,des1,2023-04-27,3d\n\tFuture task2 :1d\n\tFuture task3 :2d\n</code></pre>\n<ul>\n<li>æ•ˆæœğŸŒ </li>\n</ul>\n<figure class=\"highlight mermaid\"><figcaption data-lang=\"mermaid\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">gantt</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\ttitle æ¯æ—¥ä»»åŠ¡æ€»ç»“</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\tdateFormat yyyy-MM-dd</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\tsection A çª¦å‡¯æ¬£</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\tCompleted task <span class=\"token operator\">:</span>done,des1,2023-04-24,1d</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\tActive task <span class=\"token operator\">:</span>active,des2,2023-04-25,3d</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\tFuture task <span class=\"token operator\">:</span>des3,after des2,1d</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\tFuture task1 <span class=\"token operator\">:</span>after des3,2d</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\tFuture task2 <span class=\"token operator\">:</span>2023-04-28,4d</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\tsection B åˆ˜æ¡‘</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\tCompleted task <span class=\"token operator\">:</span>crit,done,des,2023-04-24,12h</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\tFuture task <span class=\"token operator\">:</span>crit,3d</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\tFuture task1 <span class=\"token operator\">:</span>crit,active,des1,2023-04-27,3d</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\tFuture task2 <span class=\"token operator\">:</span>1d</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\tFuture task3 <span class=\"token operator\">:</span>2d</pre></td></tr></table></figure><h1 id=\"clickäº‹ä»¶å’Œé—´éš”ç¬¦\"><a class=\"anchor\" href=\"#clickäº‹ä»¶å’Œé—´éš”ç¬¦\">#</a> click äº‹ä»¶å’Œ &amp; é—´éš”ç¬¦ğŸ„</h1>\n<p>ğŸ’ </p>\n<p>&amp; æ ‡è®°ï¼Œç”¨æ¥é—´éš”å¤šä¸ªèŠ‚ç‚¹ï¼Œç®€åŒ–æè¿°</p>\n<pre><code>graph\n a--&gt;b &amp; c--&gt;d\n A[&lt;u&gt;ç™¾åº¦&lt;/u&gt;] %% è·³è½¬åˆ°ç™¾åº¦\n click A &quot;http://www.baidu.com&quot;\n</code></pre>\n<ul>\n<li>æ•ˆæœğŸŒ </li>\n</ul>\n<figure class=\"highlight mermaid\"><figcaption data-lang=\"mermaid\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">graph</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre> a<span class=\"token arrow operator\">--></span>b <span class=\"token operator\">&amp;</span> c<span class=\"token arrow operator\">--></span>d</pre></td></tr><tr><td data-num=\"3\"></td><td><pre> A<span class=\"token text string\">[&lt;u>ç™¾åº¦&lt;/u>]</span> <span class=\"token comment\">%% è·³è½¬åˆ°ç™¾åº¦</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre> <span class=\"token keyword\">click</span> A <span class=\"token string\">\"http://www.baidu.com\"</span></pre></td></tr></table></figure><h1 id=\"çŠ¶æ€å›¾\"><a class=\"anchor\" href=\"#çŠ¶æ€å›¾\">#</a> çŠ¶æ€å›¾ğŸ„</h1>\n<p>ğŸ’ </p>\n<p><strong>è¯­æ³•è§£é‡Š</strong>ï¼š <code>[*]</code>  è¡¨ç¤ºå¼€å§‹æˆ–è€…ç»“æŸï¼Œå¦‚æœåœ¨ç®­å¤´å³è¾¹åˆ™è¡¨ç¤ºç»“æŸã€‚</p>\n<pre><code>stateDiagram\n    [*] --&gt; s1\n    s1 --&gt; [*]\n</code></pre>\n<ul>\n<li>æ•ˆæœğŸŒ </li>\n</ul>\n<figure class=\"highlight mermaid\"><figcaption data-lang=\"mermaid\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">stateDiagram</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\t<span class=\"token text string\">[*]</span><span class=\"token arrow operator\">--></span> A</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\tA <span class=\"token arrow operator\">--></span> <span class=\"token text string\">[*]</span></pre></td></tr></table></figure><h1 id=\"ç±»å›¾\"><a class=\"anchor\" href=\"#ç±»å›¾\">#</a> ç±»å›¾ğŸ„</h1>\n<p>ğŸ’ </p>\n<p><strong>è¯­æ³•è§£é‡Š</strong>ï¼š <code>&lt;|--</code>  è¡¨ç¤ºç»§æ‰¿ï¼Œ <code>+</code>  è¡¨ç¤º  <code>public</code> ï¼Œ <code>-</code>  è¡¨ç¤º  <code>private</code> ï¼Œå­¦è¿‡ Java çš„åº”è¯¥éƒ½çŸ¥é“ã€‚</p>\n<pre><code>classDiagram\n\tPerson &lt;|-- Dog\n\tPerson &lt;|-- Cat\n\tPerson : +String name\n\tPerson : +int age\n\tPerson : +Person(String name,int age)\n\tclass Dog &#123;\n\t\t+String name\n\t\t+eat()\n\t\t+play()\n\t&#125;\n\tclass Cat &#123;\n\t\t+String name\n\t\t-eat()\n\t\t-play()\n\t&#125;\n</code></pre>\n<ul>\n<li>æ•ˆæœğŸŒ </li>\n</ul>\n<figure class=\"highlight mermaid\"><figcaption data-lang=\"mermaid\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">classDiagram</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\tPerson <span class=\"token arrow operator\">&lt;|--</span> Dog</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\tPerson <span class=\"token arrow operator\">&lt;|--</span> Cat</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\tPerson <span class=\"token operator\">:</span> +String name</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\tPerson <span class=\"token operator\">:</span> +int age</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\tPerson <span class=\"token operator\">:</span> +Person<span class=\"token text string\">(String name,int age)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t<span class=\"token keyword\">class</span> Dog <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t\t+String name</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t\t+eat<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t\t+play<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t<span class=\"token keyword\">class</span> Cat <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\t\t+String name</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\t\t-eat<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\t\t-play<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure>",
            "tags": [
                "tools",
                "typora",
                "tools"
            ]
        },
        {
            "id": "https://pigpigletsgo.github.io/computer-science/C/blog/excel/C%E8%AF%AD%E8%A8%80%E6%93%8D%E4%BD%9CEXCEL%E6%96%87%E4%BB%B6(%E8%AF%BB%E5%86%99)/",
            "url": "https://pigpigletsgo.github.io/computer-science/C/blog/excel/C%E8%AF%AD%E8%A8%80%E6%93%8D%E4%BD%9CEXCEL%E6%96%87%E4%BB%B6(%E8%AF%BB%E5%86%99)/",
            "title": "Cè¯­è¨€æ“ä½œEXCELæ–‡ä»¶(è¯»å†™)",
            "date_published": "2024-08-11T14:09:15.943Z",
            "content_html": "<h1 id=\"cè¯­è¨€æ“ä½œexcelæ–‡ä»¶è¯»å†™\"><a class=\"anchor\" href=\"#cè¯­è¨€æ“ä½œexcelæ–‡ä»¶è¯»å†™\">#</a> C è¯­è¨€æ“ä½œ EXCEL æ–‡ä»¶ (è¯»å†™)</h1>\n<h2 id=\"ä¸€å†™æ“ä½œ\"><a class=\"anchor\" href=\"#ä¸€å†™æ“ä½œ\">#</a> ä¸€ï¼Œå†™æ“ä½œ</h2>\n<p>ç¬¬ä¸€æ­¥ï¼šå¯¹è¡¨æ ¼çš„å¤„ç†ï¼Œä½¿ç”¨ C è¯­è¨€æ‰“å¼€è¡¨æ ¼åï¼Œæ–‡ä»¶æŒ‡é’ˆæŒ‡å‘æ•´ä¸ªè¡¨æ ¼çš„ç¬¬ 1 è¡Œ ç¬¬ 1 åˆ—ã€‚</p>\n<p>å¦‚æœè¦ç»™å®ƒçš„ä¸‹ä¸€ä¸ªåŒè¡Œå•å…ƒæ ¼ (ç¬¬ 1 è¡Œ ç¬¬ 2 åˆ—) å†™æ•°æ®ï¼Œä½¿ç”¨ &quot;\\t&quot;  åˆ†éš”ç¬¦</p>\n<p>å¦‚æœè¦ç»™å®ƒçš„ä¸‹ä¸€ä¸ªåŒåˆ—å•å…ƒæ ¼ (ç¬¬ 2 è¡Œ ç¬¬ 1 åˆ—) å†™æ•°æ®ï¼Œä½¿ç”¨ &quot;\\n&quot; æ¢è¡Œç¬¦</p>\n<p>å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>\n<p>éœ€è¦å¼•å…¥çš„å¤´æ–‡ä»¶ï¼š</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">_CRT_SECURE_NO_WARNINGS</span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdlib.h></span></span></pre></td></tr></table></figure><figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">writeExcel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">char</span> chy<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token char\">'x'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'a'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'h'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'w'</span> <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">int</span> data<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token number\">3.15F</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span> <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">int</span> data1<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span> <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">int</span> data2<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span> <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">int</span> data3<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span> <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">int</span> data4<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span> <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">int</span> data5<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span> <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">int</span> data6<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span> <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token keyword\">int</span> i<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    FILE<span class=\"token operator\">*</span> fp <span class=\"token operator\">=</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    fp <span class=\"token operator\">=</span> <span class=\"token function\">fopen</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"D:\\\\cExcelTest.xls\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"w\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>fp <span class=\"token operator\">==</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token function\">perror</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Failed to open file\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span>EXIT_FAILURE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token function\">fprintf</span><span class=\"token punctuation\">(</span>fp<span class=\"token punctuation\">,</span> <span class=\"token string\">\"%d\\t%d\\t%d\\t%d\\t%d\\t%d\\t%d\\n\"</span><span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> data1<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> data2<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> data3<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> data4<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> data5<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> data6<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token function\">fclose</span><span class=\"token punctuation\">(</span>fp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼š</p>\n<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20240811220148093.png\" alt=\"image-20240811220148093\" /></p>\n<h2 id=\"äºŒè¯»æ“ä½œ\"><a class=\"anchor\" href=\"#äºŒè¯»æ“ä½œ\">#</a> äºŒï¼Œè¯»æ“ä½œ</h2>\n<p>è¯»å–æ–‡ä»¶ï¼Œå¯¹äºè¯»å– Excel æ–‡ä»¶çš„æ“ä½œï¼Œä½¿ç”¨äº†æ–‡ä»¶éšæœºå®šä½å‡½æ•° fseek ()ï¼Œå®ƒçš„ä¸€èˆ¬è°ƒç”¨æ ¼å¼å¦‚ä¸‹ï¼š</p>\n<p>fseek (æ–‡ä»¶æŒ‡é’ˆï¼Œä½ç§»é‡ï¼Œèµ·å§‹ä½ç½®)</p>\n<p>fseek () å‚æ•°è¯´æ˜ï¼š</p>\n<p>ä½ç§»é‡ï¼šæŒ‡é‡æ–°å®šä½æ—¶çš„å­—èŠ‚åç§»æ•°ï¼Œè¡¨ç¤ºç›¸å¯¹äºåŸºåœ°å€çš„å­—ç¬¦æ•°ï¼Œé€šå¸¸æ˜¯ä¸€ä¸ªé•¿æ•´å‹æ•°ï¼Œå¯ä»¥æ˜¯æ•´å‹å¸¸é‡ï¼Œæ•´å‹è¡¨è¾¾å¼ç­‰ã€‚å¦‚æœç”¨æ•´å‹å¸¸é‡ï¼Œéœ€è¦å†åé¢åŠ ä¸Šå­—æ¯ &quot;L&quot;ï¼Œå¦‚æœä½¿ç”¨æ•´å‹è¡¨è¾¾å¼éœ€è¦ç”¨ (long) è¡¨è¾¾å¼ å¼ºåˆ¶è½¬æ¢æˆé•¿æ•´å‹</p>\n<p>èµ·å§‹ä½ç½®ï¼šæŒ‡é‡æ–°å®šä½æ—¶çš„åŸºå‡†ç‚¹ï¼Œä¹Ÿå°±æ˜¯åŸºåœ°å€ï¼Œç”¨æ•´æ•°æˆ–å­—ç¬¦å¸¸é‡è¡¨ç¤ºã€‚å¦‚ä¸‹è¡¨ï¼š</p>\n<table>\n<thead>\n<tr>\n<th>æ•´æ•°</th>\n<th>ç¬¦å·å¸¸é‡</th>\n<th>å¯¹åº”çš„èµ·å§‹ä½ç½®</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>0</td>\n<td>SEEK_SET</td>\n<td>æ–‡ä»¶å¼€å¤´</td>\n</tr>\n<tr>\n<td>1</td>\n<td>SEEK_CUR</td>\n<td>æ–‡ä»¶æŒ‡é’ˆçš„å½“å‰ä½ç½®</td>\n</tr>\n<tr>\n<td>2</td>\n<td>SEEK_END</td>\n<td>æ–‡ä»¶æœ«å°¾</td>\n</tr>\n</tbody>\n</table>\n<p>ä¾‹å¦‚ï¼šfseek (fp, 10L, 0)</p>\n<p>å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">readExcel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    FILE<span class=\"token operator\">*</span> fp<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">char</span> filename<span class=\"token punctuation\">[</span><span class=\"token number\">40</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">int</span> i<span class=\"token punctuation\">,</span> j<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">float</span> da<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token number\">0</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"è¾“å…¥æ–‡ä»¶åç§°ï¼š\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token function\">gets</span><span class=\"token punctuation\">(</span>filename<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    fp <span class=\"token operator\">=</span> <span class=\"token function\">fopen</span><span class=\"token punctuation\">(</span>filename<span class=\"token punctuation\">,</span> <span class=\"token string\">\"r\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">6</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>j <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> j <span class=\"token operator\">&lt;</span> <span class=\"token number\">5</span><span class=\"token punctuation\">;</span> j<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>            <span class=\"token function\">fscanf</span><span class=\"token punctuation\">(</span>fp<span class=\"token punctuation\">,</span> <span class=\"token string\">\"%f\"</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>da<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            <span class=\"token function\">fseek</span><span class=\"token punctuation\">(</span>fp<span class=\"token punctuation\">,</span> <span class=\"token number\">5L</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">SEEK_CUR</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">6</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%f\\t%f\\t%f\\t%f\\t%f\\t\\n\"</span><span class=\"token punctuation\">,</span> da<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>            da<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> da<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> da<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> da<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼š</p>\n<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20240811220806019.png\" alt=\"image-20240811220806019\" /></p>\n",
            "tags": [
                "è®¡ç®—æœºå­¦ç§‘",
                "C",
                "blog",
                "excel",
                "è®¡ç®—æœºå­¦ç§‘",
                "C",
                "blog",
                "excel"
            ]
        },
        {
            "id": "https://pigpigletsgo.github.io/computer-science/java/%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/poi%E4%BB%8B%E7%BB%8D%E5%92%8C%E4%BD%BF%E7%94%A8/",
            "url": "https://pigpigletsgo.github.io/computer-science/java/%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/poi%E4%BB%8B%E7%BB%8D%E5%92%8C%E4%BD%BF%E7%94%A8/",
            "title": "poiçš„ä»‹ç»å’Œä½¿ç”¨",
            "date_published": "2024-08-11T11:21:15.689Z",
            "content_html": "<h1 id=\"poiçš„ä»‹ç»å’Œä½¿ç”¨\"><a class=\"anchor\" href=\"#poiçš„ä»‹ç»å’Œä½¿ç”¨\">#</a> poi çš„ä»‹ç»å’Œä½¿ç”¨</h1>\n<h2 id=\"poiä¸åŒç‰ˆæœ¬çš„ä»‹ç»\"><a class=\"anchor\" href=\"#poiä¸åŒç‰ˆæœ¬çš„ä»‹ç»\">#</a> poi ä¸åŒç‰ˆæœ¬çš„ä»‹ç»</h2>\n<p><code>poi-tl</code> ï¼Œ <code>poi</code>  å’Œ <code>poi-ooxml</code>  æ˜¯ Apache POI çš„ä¸åŒå­åº“ï¼Œå®ƒä»¬å„è‡ªç”¨äºä¸åŒçš„åŠŸèƒ½å’Œæ–‡ä»¶æ ¼å¼</p>\n<ol>\n<li>Apache POI( <code>poi</code> )ï¼š\n<ul>\n<li>åŠŸèƒ½ï¼šæä¾›å¯¹ <code>Microsoft Office 97-2003</code>  æ ¼å¼ (å¦‚ <code>.xls</code> ) æ–‡ä»¶çš„è¯»å†™æ”¯æŒ</li>\n<li>æ–‡ä»¶æ ¼å¼ï¼šä¸»è¦ç”¨äºå¤„ç† <code>.xls</code>  æ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶æ˜¯åŸºäº HSSF ( <code>Horrible SpreadSheet Format</code> ) çš„</li>\n</ul>\n</li>\n<li>Apache POI-OOXML( <code>poi-ooxml</code> )\n<ul>\n<li>åŠŸèƒ½ï¼šæä¾›å¯¹ <code> Microsoft Office 2007</code>  åŠä»¥åç‰ˆæœ¬çš„æ–‡ä»¶æ ¼å¼ (å¦‚ <code>.xlsx</code> ) çš„è¯»å†™æ”¯æŒ</li>\n<li>æ–‡ä»¶æ ¼å¼ï¼šä¸»è¦ç”¨äºå¤„ç† <code>.xlsx</code>  æ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶æ˜¯åŸºäº XSSF ( <code>XML Spreadsheet Format</code> ) çš„</li>\n<li>ä¾èµ–ï¼šè¿™ä¸ªåº“ä¾èµ–äº <code>poi</code>  åº“ï¼Œå› ä¸ºå®ƒéœ€è¦å¤„ç† <code>.xls</code>  æ–‡ä»¶ä¸­çš„ä¸€äº›è€æ—§æ ¼å¼</li>\n</ul>\n</li>\n<li>poi-tlï¼š\n<ul>\n<li>åŠŸèƒ½ï¼šä¸»è¦ç”¨äºå¤„ç†å’Œç”Ÿæˆ <code> Microsoft Word</code>  æ–‡ä»¶ ( <code>.docx</code> )ï¼Œå¹¶ä¸”æ˜¯ Apache POI çš„æ‰©å±•åº“ï¼Œç®€åŒ–äº†æ¨¡ç‰ˆæ–‡æ¡£çš„å¤„ç†</li>\n<li>æ–‡ä»¶æ ¼å¼ï¼šä¸»è¦ç”¨äºå¤„ç† <code>.docx</code>  æ–‡ä»¶ï¼Œå¯ä»¥é€šè¿‡æ¨¡ç‰ˆç”Ÿæˆæ–‡æ¡£ï¼Œä½¿å¾—ç”Ÿæˆæ–‡æ¡£æ›´åŠ ç®€æ´å’Œé«˜æ•ˆ</li>\n<li>å¯æŸ¥é˜…å®˜æ–¹æ–‡æ¡£ï¼š<span class=\"exturl\" data-url=\"aHR0cHM6Ly9kZWVwb292ZS5jb20vcG9pLXRsLyNfd2h5X3BvaV90bA==\">https://deepoove.com/poi-tl/#_why_poi_tl</span></li>\n</ul>\n</li>\n</ol>\n<p><strong>æ€»ç»“</strong>ï¼š</p>\n<ul>\n<li><code>poi</code>  ä¸»è¦ç”¨äºå¤„ç†æ—§ç‰ˆ Excel æ–‡ä»¶ ( <code>.xls</code> )</li>\n<li><code>poi-ooxml</code>  ä¸»è¦ç”¨äºå¤„ç†æ–°ç‰ˆ Excel æ–‡ä»¶ ( <code>.xlsx</code> )</li>\n<li><code>poi-tl</code>  ä¸»è¦ç”¨äºå¤„ç† Word æ–‡æ¡£ ( <code>.docx</code> )ï¼Œç‰¹åˆ«æ˜¯å½“ä½ éœ€è¦æ¨¡ç‰ˆæ”¯æŒ</li>\n</ul>\n<h2 id=\"poiçš„ä½¿ç”¨\"><a class=\"anchor\" href=\"#poiçš„ä½¿ç”¨\">#</a> poi çš„ä½¿ç”¨</h2>\n<h3 id=\"åˆ›å»ºexcel\"><a class=\"anchor\" href=\"#åˆ›å»ºexcel\">#</a> åˆ›å»º excel</h3>\n<ol>\n<li>\n<p>åˆ›å»º excel æ–‡æ¡£</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// åˆ›å»º name.xlsx æ–‡ä»¶</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">Workbook</span> workbook <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">XSSFWorkbook</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">// åˆ›å»º name.xls æ–‡ä»¶</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token class-name\">Workbook</span> wb <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HSSFWorkbook</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure></li>\n<li>\n<p>åˆ›å»º sheet é¡µ</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// åˆ›å»ºå®‰å…¨è¡¨åç§°</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">String</span> safeName <span class=\"token operator\">=</span> <span class=\"token class-name\">WorkbookUtil</span><span class=\"token punctuation\">.</span><span class=\"token function\">createSafeSheetName</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"[O'Brien's sales*?]\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token class-name\">Sheet</span> sheet <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span><span class=\"token function\">createSheet</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"sheeté¡µåç§°\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure></li>\n<li>\n<p>å¯¹ sheet é¡µçš„æŸç´¢å¼•å¤„åˆ›å»ºè¡Œå¯¹è±¡</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">Row</span> header <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span><span class=\"token function\">createRow</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure></li>\n<li>\n<p>åœ¨æ”¹è¡Œçš„æŸç´¢å¼•å¤„åˆ›å»ºå•å…ƒæ ¼å¹¶è®¾ç½®åç§°</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>header<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setCellValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"åç§°\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure></li>\n<li>\n<p>è·å–æŸè¡Œçš„å…¨éƒ¨å•å…ƒæ ¼æ•°é‡</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">int</span> rowTotal <span class=\"token operator\">=</span> header<span class=\"token punctuation\">.</span><span class=\"token function\">getPhysicalNumberOfCells</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure></li>\n</ol>\n<h3 id=\"åˆ›å»ºç‰¹æ®Šæ•°æ®ç±»å‹å¯¹è±¡\"><a class=\"anchor\" href=\"#åˆ›å»ºç‰¹æ®Šæ•°æ®ç±»å‹å¯¹è±¡\">#</a> åˆ›å»ºç‰¹æ®Šæ•°æ®ç±»å‹å¯¹è±¡</h3>\n<ol>\n<li>\n<p>åˆ›å»ºå¸¦æœ‰å¯Œæ–‡æœ¬æ ¼å¼çš„å­—ç¬¦ä¸² (å¯ä»¥å¯¹å…¶æŸä¸ªå­—ä½“è®¾ç½®ä¸åŒçš„æ ·å¼)</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">XSSFCreationHelper</span> creationHelper <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span><span class=\"token function\">getCreationHelper</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">XSSFRow</span> row <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span><span class=\"token function\">createRow</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token class-name\">XSSFRichTextString</span> hyperlinkString <span class=\"token operator\">=</span> creationHelper<span class=\"token punctuation\">.</span><span class=\"token function\">createRichTextString</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"abcdefghijk\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">// åˆ›å»ºå­—ä½“å¯¹è±¡</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token class-name\">XSSFFont</span> font <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span><span class=\"token function\">createFont</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>font<span class=\"token punctuation\">.</span><span class=\"token function\">setBold</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// è®¾ç½®ç²—ä½“</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>font<span class=\"token punctuation\">.</span><span class=\"token function\">setColor</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">IndexedColors</span><span class=\"token punctuation\">.</span><span class=\"token constant\">RED</span><span class=\"token punctuation\">.</span><span class=\"token function\">getIndex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// è®¾ç½®é¢œè‰²</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>hyperlinkString<span class=\"token punctuation\">.</span><span class=\"token function\">applyFont</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> font<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token class-name\">XSSFFont</span> fontTwo <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span><span class=\"token function\">createFont</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>fontTwo<span class=\"token punctuation\">.</span><span class=\"token function\">setItalic</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>fontTwo<span class=\"token punctuation\">.</span><span class=\"token function\">setColor</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">IndexedColors</span><span class=\"token punctuation\">.</span><span class=\"token constant\">BLUE</span><span class=\"token punctuation\">.</span><span class=\"token function\">getIndex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>hyperlinkString<span class=\"token punctuation\">.</span><span class=\"token function\">applyFont</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> fontTwo<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token class-name\">XSSFCell</span> cell <span class=\"token operator\">=</span> row<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>cell<span class=\"token punctuation\">.</span><span class=\"token function\">setCellValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click to url\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// å¦‚æœå•å…ƒæ ¼çš„å€¼ éƒ½è®¾ç½®åœ¨åŒä¸€ä¸ªçš„è¯ä¼šè¢« æœ€åä¸€ä¸ªè¦†ç›–</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>cell<span class=\"token punctuation\">.</span><span class=\"token function\">setCellValue</span><span class=\"token punctuation\">(</span>hyperlinkString<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>æ•ˆæœï¼š</p>\n<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20240810172109727.png\" alt=\"image-20240810172109727\" /></p>\n</li>\n<li>\n<p>åˆ›å»ºè¶…é“¾æ¥</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">XSSFCreationHelper</span> creationHelper <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span><span class=\"token function\">getCreationHelper</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">XSSFRow</span> row <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span><span class=\"token function\">createRow</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token class-name\">XSSFHyperlink</span> hyperlinkURL <span class=\"token operator\">=</span> creationHelper<span class=\"token punctuation\">.</span><span class=\"token function\">createHyperlink</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HyperlinkType</span><span class=\"token punctuation\">.</span><span class=\"token constant\">URL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>hyperlinkURL<span class=\"token punctuation\">.</span><span class=\"token function\">setAddress</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"http://www.baidu.com\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// è®¾ç½®è·³è½¬çš„è·¯å¾„</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token class-name\">XSSFCell</span> cell <span class=\"token operator\">=</span> row<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>cell<span class=\"token punctuation\">.</span><span class=\"token function\">setCellValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click to url\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// å°†å•å…ƒæ ¼çš„å€¼ å’Œ è¶…é“¾æ¥æ·»åŠ åˆ° å½“å‰è¡Œä¸­</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>cell<span class=\"token punctuation\">.</span><span class=\"token function\">setHyperlink</span><span class=\"token punctuation\">(</span>hyperlinkURL<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>æ•ˆæœï¼š<br />\n<img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/PixPin_2024-08-10_17-25-35.gif\" alt=\"PixPin_2024-08-10_17-25-35\" /></p>\n</li>\n<li>\n<p>åˆ›å»ºæ—¶é—´ç±»å‹</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">XSSFCreationHelper</span> creationHelper <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span><span class=\"token function\">getCreationHelper</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">XSSFRow</span> row <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span><span class=\"token function\">createRow</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token class-name\">XSSFCellStyle</span> style <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span><span class=\"token function\">createCellStyle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// åˆ›å»ºæ ·å¼å¯¹è±¡</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>style<span class=\"token punctuation\">.</span><span class=\"token function\">setDataFormat</span><span class=\"token punctuation\">(</span>creationHelper<span class=\"token punctuation\">.</span><span class=\"token function\">createDataFormat</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getFormat</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"m/d/y h:mm\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// æ ¼å¼åŒ–å¼æ ·æ ·å¼</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token class-name\">XSSFCell</span> cell <span class=\"token operator\">=</span> row<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// æ·»åŠ æ—¶é—´å€¼</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>cell<span class=\"token punctuation\">.</span><span class=\"token function\">setCellValue</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>cell<span class=\"token punctuation\">.</span><span class=\"token function\">setCellStyle</span><span class=\"token punctuation\">(</span>style<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token class-name\">XSSFCell</span> cellTwo <span class=\"token operator\">=</span> row<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>cellTwo<span class=\"token punctuation\">.</span><span class=\"token function\">setCellValue</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Calendar</span><span class=\"token punctuation\">.</span><span class=\"token function\">getInstance</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>cellTwo<span class=\"token punctuation\">.</span><span class=\"token function\">setCellStyle</span><span class=\"token punctuation\">(</span>style<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>æ•ˆæœï¼š</p>\n<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20240810173752112.png\" alt=\"image-20240810173752112\" /></p>\n</li>\n<li>\n<p>åˆ›å»ºå¤šç§æ ¼å¼çš„å•å…ƒæ ¼</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">XSSFWorkbook</span> workbook <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">XSSFWorkbook</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">String</span> safeSheetName <span class=\"token operator\">=</span> <span class=\"token class-name\">WorkbookUtil</span><span class=\"token punctuation\">.</span><span class=\"token function\">createSafeSheetName</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"[O'Brien's sales*?]\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token class-name\">XSSFSheet</span> sheet <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span><span class=\"token function\">createSheet</span><span class=\"token punctuation\">(</span>safeSheetName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token class-name\">XSSFRow</span> row <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span><span class=\"token function\">createRow</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">// ç±»å‹ï¼šæ•°å­— (double)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>row<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setCellValue</span><span class=\"token punctuation\">(</span><span class=\"token number\">1.1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\">// ç±»å‹ï¼šæ—¥æœŸ (Date)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>row<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setCellValue</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\">// ç±»å‹ï¼šæ—¥æœŸ (Calendar)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>row<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setCellValue</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Calendar</span><span class=\"token punctuation\">.</span><span class=\"token function\">getInstance</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\">// ç±»å‹ï¼šå­—ç¬¦ä¸² (string)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>row<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setCellValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"a string\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token comment\">// ç±»å‹ï¼šå¸ƒå°” (boolean)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>row<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setCellValue</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\">// ç±»å‹ï¼šé”™è¯¯ (error)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>row<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setCellType</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">CellType</span><span class=\"token punctuation\">.</span><span class=\"token constant\">ERROR</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>æ•ˆæœï¼š</p>\n<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20240810174113454.png\" alt=\"image-20240810174113454\" /></p>\n</li>\n</ol>\n<h3 id=\"è®¾ç½®æ ·å¼\"><a class=\"anchor\" href=\"#è®¾ç½®æ ·å¼\">#</a> è®¾ç½®æ ·å¼</h3>\n<ol>\n<li>\n<p>é€šè¿‡ excel æ–‡æ¡£å¯¹è±¡åˆ›å»ºæ ·å¼å¯¹è±¡</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">CellStyle</span> cellStyle <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span><span class=\"token function\">createCellStyle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure></li>\n<li>\n<p>è®¾ç½®å­—ä½“æ ·å¼</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">Font</span> font <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span><span class=\"token function\">createFont</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                        <span class=\"token comment\">// åˆ›å»ºå­—ä½“å¯¹è±¡</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>font<span class=\"token punctuation\">.</span><span class=\"token function\">setBold</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                                       <span class=\"token comment\">// åŠ ç²—</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>font<span class=\"token punctuation\">.</span><span class=\"token function\">setFontHeightInPoints</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">short</span><span class=\"token punctuation\">)</span> <span class=\"token number\">12</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                   <span class=\"token comment\">// è®¾ç½®å­—ä½“å¤§å°</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>font<span class=\"token punctuation\">.</span><span class=\"token function\">setFontName</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"å¾®è½¯é›…é»‘\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                              <span class=\"token comment\">// è®¾ç½®å­—ä½“</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>cellStyle<span class=\"token punctuation\">.</span><span class=\"token function\">setFont</span><span class=\"token punctuation\">(</span>font<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                                  <span class=\"token comment\">// å‘æ ·å¼é‡Œæ·»åŠ å­—ä½“è®¾ç½®</span></pre></td></tr></table></figure><h2 id=\"fileså’Œinputstream-excelæ–‡ä»¶è¯»å–æ“ä½œ\"><a class=\"anchor\" href=\"#fileså’Œinputstream-excelæ–‡ä»¶è¯»å–æ“ä½œ\">#</a> Files å’Œ InputStream  (excel æ–‡ä»¶è¯»å–æ“ä½œ)</h2>\n<p>å½“æ‰“å¼€ WorkBook (.xls  HSSFWorkbook æˆ–.xlsx  XSSFWorkbook) æ—¶ï¼Œå¯ä»¥ä» File æˆ– InputStream åŠ è½½å·¥ä½œç°¿</p>\n<p>ä½¿ç”¨ File å¯¹è±¡å¯ä»¥å‡å°‘å†…å­˜æ¶ˆè€—ï¼Œè€Œ InputStream éœ€è¦æ›´å¤šå†…å­˜ï¼Œå› ä¸ºå®ƒå¿…é¡»ç¼“å†²æ•´ä¸ªæ–‡ä»¶</p>\n<p>å¦‚æœä½¿ç”¨ WorkbookFactoryï¼Œåˆ™ä½¿ç”¨å…¶ä¸­ä¸€ä¸ªéå¸¸å®¹æ˜“ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// Use a file</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">Workbook</span> wb <span class=\"token operator\">=</span> <span class=\"token class-name\">WorkbookFactory</span><span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"MyExcel.xls\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">// Use an InputStream, needs more memory</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token class-name\">Workbook</span> wb <span class=\"token operator\">=</span> <span class=\"token class-name\">WorkbookFactory</span><span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">FileInputStream</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"MyExcel.xlsx\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>ä»£ç æ¡ˆä¾‹ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">try</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Workbook</span> workbook <span class=\"token operator\">=</span> <span class=\"token class-name\">WorkbookFactory</span><span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"C:\\\\Users\\\\dkx\\\\Downloads\\\\test.xlsx\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>     <span class=\"token class-name\">Workbook</span> workbookTwo <span class=\"token operator\">=</span> <span class=\"token class-name\">WorkbookFactory</span><span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Files</span><span class=\"token punctuation\">.</span><span class=\"token function\">newInputStream</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Paths</span><span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"C:\\\\Users\\\\dkx\\\\Downloads\\\\test.xlsx\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token comment\">// è·å–ç¬¬ä¸€ä¸ªå·¥ä½œè¡¨</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token class-name\">Sheet</span> sheet <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span><span class=\"token function\">getSheetAt</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token comment\">// è¯»å–ç¬¬ 1 è¡Œï¼Œç¬¬ 1 ä¸ªå•å…ƒæ ¼çš„å†…å®¹</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token class-name\">Row</span> row <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span><span class=\"token function\">getRow</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token class-name\">Cell</span> cell <span class=\"token operator\">=</span> row<span class=\"token punctuation\">.</span><span class=\"token function\">getCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token class-name\">String</span> stringCellValue <span class=\"token operator\">=</span> cell<span class=\"token punctuation\">.</span><span class=\"token function\">getStringCellValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token class-name\">Cell</span> cellTwo <span class=\"token operator\">=</span> row<span class=\"token punctuation\">.</span><span class=\"token function\">getCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">double</span> numericCellValue <span class=\"token operator\">=</span> cellTwo<span class=\"token punctuation\">.</span><span class=\"token function\">getNumericCellValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token class-name\">Cell</span> cellThree <span class=\"token operator\">=</span> row<span class=\"token punctuation\">.</span><span class=\"token function\">getCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token keyword\">boolean</span> booleanCellValue <span class=\"token operator\">=</span> cellThree<span class=\"token punctuation\">.</span><span class=\"token function\">getBooleanCellValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ç¬¬1è¡Œï¼Œç¬¬1ä¸ªå•å…ƒæ ¼çš„å†…å®¹æ˜¯ = \"</span> <span class=\"token operator\">+</span> stringCellValue<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ç¬¬1è¡Œï¼Œç¬¬1ä¸ªå•å…ƒæ ¼çš„å†…å®¹æ˜¯ = \"</span> <span class=\"token operator\">+</span> numericCellValue<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ç¬¬1è¡Œï¼Œç¬¬1ä¸ªå•å…ƒæ ¼çš„å†…å®¹æ˜¯ = \"</span> <span class=\"token operator\">+</span> booleanCellValue<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token comment\">// å¯ä»¥è·å–åˆ° Content Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"workbook=\"</span> <span class=\"token operator\">+</span> workbook<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token comment\">// å¯ä»¥è·å–åˆ° Content Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"workbookTwo=\"</span> <span class=\"token operator\">+</span> workbookTwo<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">IOException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>æ•ˆæœï¼š</p>\n<p>ä¸‹é¢æ˜¯æˆ‘ä»¬è¦è¯»å–çš„ excel è¡¨æ ¼å†…å®¹</p>\n<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20240810203902511.png\" alt=\"image-20240810203902511\" /></p>\n<p>è¯»å–çš„ç»“æœï¼š</p>\n<pre><code>ç¬¬1è¡Œï¼Œç¬¬1ä¸ªå•å…ƒæ ¼çš„å†…å®¹æ˜¯ = a string text\nç¬¬1è¡Œï¼Œç¬¬1ä¸ªå•å…ƒæ ¼çš„å†…å®¹æ˜¯ = 1.1\nç¬¬1è¡Œï¼Œç¬¬1ä¸ªå•å…ƒæ ¼çš„å†…å®¹æ˜¯ = true\nworkbook=Name: /xl/workbook.xml - Content Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\nworkbookTwo=Name: /xl/workbook.xml - Content Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\n</code></pre>\n<p>å¦‚æœç›´æ¥ä½¿ç”¨ HSSFWorkbook æˆ– XSSFWorkbookï¼Œé€šå¸¸åº”éå† POIFSileSystem æˆ– OPCPackageï¼Œä»¥å®Œå…¨æ§åˆ¶ç”Ÿå‘½å‘¨æœŸ (åŒ…æ‹¬å®Œæˆåå…³é—­æ–‡ä»¶)</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token comment\">// HSSFWorkbook, File</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token class-name\">POIFSFileSystem</span> fs <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">POIFSFileSystem</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"C:\\\\Users\\\\dkx\\\\Downloads\\\\test.xls\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token class-name\">HSSFWorkbook</span> wb <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HSSFWorkbook</span><span class=\"token punctuation\">(</span>fs<span class=\"token punctuation\">.</span><span class=\"token function\">getRoot</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"wb = \"</span> <span class=\"token operator\">+</span> wb<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    fs<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token comment\">// HSSFWorkbook, InputStream, needs more memory</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token class-name\">POIFSFileSystem</span> fs1 <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">POIFSFileSystem</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"C:\\\\Users\\\\dkx\\\\Downloads\\\\test.xls\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token class-name\">HSSFWorkbook</span> wb1 <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HSSFWorkbook</span><span class=\"token punctuation\">(</span>fs<span class=\"token punctuation\">.</span><span class=\"token function\">getRoot</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    fs1<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token comment\">// XSSFWorkbook, File</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token class-name\">OPCPackage</span> pkg <span class=\"token operator\">=</span> <span class=\"token class-name\">OPCPackage</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">open</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"C:\\\\Users\\\\dkx\\\\Downloads\\\\test.xlsx\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token class-name\">XSSFWorkbook</span> wb2 <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">XSSFWorkbook</span><span class=\"token punctuation\">(</span>pkg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> wb2<span class=\"token punctuation\">.</span><span class=\"token function\">getNumberOfSheets</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token class-name\">XSSFSheet</span> sheet <span class=\"token operator\">=</span> wb2<span class=\"token punctuation\">.</span><span class=\"token function\">getSheetAt</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"sheetName = \"</span> <span class=\"token operator\">+</span> sheet<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Row</span> row <span class=\"token operator\">:</span> sheet<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Cell</span> cell <span class=\"token operator\">:</span> row<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>                   <span class=\"token keyword\">switch</span><span class=\"token punctuation\">(</span>cell<span class=\"token punctuation\">.</span><span class=\"token function\">getCellType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>                       <span class=\"token keyword\">case</span> <span class=\"token constant\">STRING</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>                           <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"string = \"</span> <span class=\"token operator\">+</span> cell<span class=\"token punctuation\">.</span><span class=\"token function\">getStringCellValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>                           <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>                       <span class=\"token keyword\">case</span> <span class=\"token constant\">NUMERIC</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>                           <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"numeric = \"</span> <span class=\"token operator\">+</span> cell<span class=\"token punctuation\">.</span><span class=\"token function\">getNumericCellValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>                           <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>                       <span class=\"token keyword\">case</span>  <span class=\"token constant\">BOOLEAN</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>                           <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"boolean = \"</span> <span class=\"token operator\">+</span> cell<span class=\"token punctuation\">.</span><span class=\"token function\">getBooleanCellValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>                           <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>                       <span class=\"token keyword\">case</span> <span class=\"token constant\">FORMULA</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>                           <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"formula = \"</span> <span class=\"token operator\">+</span> cell<span class=\"token punctuation\">.</span><span class=\"token function\">getCellFormula</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>                           <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>                       <span class=\"token keyword\">default</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>                           <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"æ²¡æœ‰ä»»ä½•æ•°æ®\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>                   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    pkg<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    <span class=\"token comment\">// XSSFWorkbook, InputStream, needs more memory</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    <span class=\"token class-name\">OPCPackage</span> pkg1 <span class=\"token operator\">=</span> <span class=\"token class-name\">OPCPackage</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">open</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"C:\\\\Users\\\\dkx\\\\Downloads\\\\test.xlsx\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    <span class=\"token class-name\">XSSFWorkbook</span> wb3 <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">XSSFWorkbook</span><span class=\"token punctuation\">(</span>pkg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    pkg1<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre><span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>æˆ‘ä»¬è¿˜æ˜¯è¯»å–ä¸Šæ¬¡è¯»å–çš„ excel æ–‡ä»¶å†…å®¹ç»“æœå¦‚ä¸‹ï¼š</p>\n<pre><code>sheetName = Name: /xl/worksheets/sheet1.xml - Content Type: application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\nstring = a string text\nnumeric = 1.1\nboolean = true\n</code></pre>\n<h2 id=\"ä¸åŒçš„å¯¹é½æ–¹å¼\"><a class=\"anchor\" href=\"#ä¸åŒçš„å¯¹é½æ–¹å¼\">#</a> ä¸åŒçš„å¯¹é½æ–¹å¼</h2>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">padding</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpServletResponse</span> response<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>        <span class=\"token keyword\">try</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>                <span class=\"token class-name\">Workbook</span> wb <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">XSSFWorkbook</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">//or new HSSFWorkbook();</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            <span class=\"token class-name\">Sheet</span> sheet <span class=\"token operator\">=</span> wb<span class=\"token punctuation\">.</span><span class=\"token function\">createSheet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>            <span class=\"token class-name\">Row</span> row <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span><span class=\"token function\">createRow</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            <span class=\"token comment\">// è®¾ç½®è¡Œçš„é«˜åº¦ä¸º 30 æ¦œ</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            row<span class=\"token punctuation\">.</span><span class=\"token function\">setHeightInPoints</span><span class=\"token punctuation\">(</span><span class=\"token number\">30</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            <span class=\"token comment\">// è®¾ç½®å­—ä½“  å·¦å³ (å±…ä¸­) ä¸Šä¸‹ (åº•éƒ¨)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>            <span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span>wb<span class=\"token punctuation\">,</span> row<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">HorizontalAlignment</span><span class=\"token punctuation\">.</span><span class=\"token constant\">CENTER</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">VerticalAlignment</span><span class=\"token punctuation\">.</span><span class=\"token constant\">BOTTOM</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>            <span class=\"token comment\">// è®¾ç½®å­—ä½“ å·¦å³ (ä¸­å¿ƒé€‰å®šå¯¹é½)  ä¸Šä¸‹ (åº•éƒ¨)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            <span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span>wb<span class=\"token punctuation\">,</span> row<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">HorizontalAlignment</span><span class=\"token punctuation\">.</span><span class=\"token constant\">CENTER_SELECTION</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">VerticalAlignment</span><span class=\"token punctuation\">.</span><span class=\"token constant\">BOTTOM</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>            <span class=\"token comment\">// è®¾ç½®å­—ä½“ å·¦å³ (å¡«å……å¯¹é½)  ä¸Šä¸‹ (å±…ä¸­)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>            <span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span>wb<span class=\"token punctuation\">,</span> row<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">HorizontalAlignment</span><span class=\"token punctuation\">.</span><span class=\"token constant\">FILL</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">VerticalAlignment</span><span class=\"token punctuation\">.</span><span class=\"token constant\">CENTER</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            <span class=\"token comment\">// è®¾ç½®å­—ä½“  å·¦å³ (é»˜è®¤å¯¹é½)  ä¸Šä¸‹ (å±…ä¸­)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>            <span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span>wb<span class=\"token punctuation\">,</span> row<span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">HorizontalAlignment</span><span class=\"token punctuation\">.</span><span class=\"token constant\">GENERAL</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">VerticalAlignment</span><span class=\"token punctuation\">.</span><span class=\"token constant\">CENTER</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            <span class=\"token comment\">// è®¾ç½®å­—ä½“  å·¦å³ (æ‹‰ä¼¸å¯¹é½)  ä¸Šä¸‹ (æ‹‰ä¼¸å¯¹é½)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            <span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span>wb<span class=\"token punctuation\">,</span> row<span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">HorizontalAlignment</span><span class=\"token punctuation\">.</span><span class=\"token constant\">JUSTIFY</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">VerticalAlignment</span><span class=\"token punctuation\">.</span><span class=\"token constant\">JUSTIFY</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>            <span class=\"token comment\">// è®¾ç½®å­—ä½“  å·¦å³ (å·¦å¯¹é½)  ä¸Šä¸‹ (é¡¶éƒ¨)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>            <span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span>wb<span class=\"token punctuation\">,</span> row<span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">HorizontalAlignment</span><span class=\"token punctuation\">.</span><span class=\"token constant\">LEFT</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">VerticalAlignment</span><span class=\"token punctuation\">.</span><span class=\"token constant\">TOP</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>            <span class=\"token comment\">// è®¾ç½®å­—ä½“  å·¦å³ (å³å¯¹é½)  ä¸Šä¸‹ (é¡¶éƒ¨)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>            <span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span>wb<span class=\"token punctuation\">,</span> row<span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">HorizontalAlignment</span><span class=\"token punctuation\">.</span><span class=\"token constant\">RIGHT</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">VerticalAlignment</span><span class=\"token punctuation\">.</span><span class=\"token constant\">TOP</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>            response<span class=\"token punctuation\">.</span><span class=\"token function\">setContentType</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>            response<span class=\"token punctuation\">.</span><span class=\"token function\">setHeader</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Content-Disposition\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"attachment;filename=test1.xlsx\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>            wb<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">.</span><span class=\"token function\">getOutputStream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>            response<span class=\"token punctuation\">.</span><span class=\"token function\">getOutputStream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">flush</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Workbook</span> wb<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Row</span> row<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> column<span class=\"token punctuation\">,</span> <span class=\"token class-name\">HorizontalAlignment</span> halign<span class=\"token punctuation\">,</span> <span class=\"token class-name\">VerticalAlignment</span> valign<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token class-name\">Cell</span> cell <span class=\"token operator\">=</span> row<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span>column<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    cell<span class=\"token punctuation\">.</span><span class=\"token function\">setCellValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Align It\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    <span class=\"token class-name\">CellStyle</span> cellStyle <span class=\"token operator\">=</span> wb<span class=\"token punctuation\">.</span><span class=\"token function\">createCellStyle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token comment\">// è®¾ç½®å·¦å³å¯¹é½æ–¹å¼</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    cellStyle<span class=\"token punctuation\">.</span><span class=\"token function\">setAlignment</span><span class=\"token punctuation\">(</span>halign<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    <span class=\"token comment\">// è®¾ç½®ä¸Šä¸‹å¯¹é½æ–¹å¼</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    cellStyle<span class=\"token punctuation\">.</span><span class=\"token function\">setVerticalAlignment</span><span class=\"token punctuation\">(</span>valign<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    cell<span class=\"token punctuation\">.</span><span class=\"token function\">setCellStyle</span><span class=\"token punctuation\">(</span>cellStyle<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>æ•ˆæœï¼š</p>\n<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20240810210433997.png\" alt=\"image-20240810210433997\" /></p>\n<h2 id=\"è®¾ç½®è¾¹æ¡†\"><a class=\"anchor\" href=\"#è®¾ç½®è¾¹æ¡†\">#</a> è®¾ç½®è¾¹æ¡†</h2>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">border</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpServletResponse</span> response<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">try</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Workbook</span> wb <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HSSFWorkbook</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token class-name\">Sheet</span> sheet <span class=\"token operator\">=</span> wb<span class=\"token punctuation\">.</span><span class=\"token function\">createSheet</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"new sheet\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token comment\">// Create a row and put some cells in it. Rows are 0 based.</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token class-name\">Row</span> row <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span><span class=\"token function\">createRow</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token comment\">// Create a cell and put a value in it.</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token class-name\">Cell</span> cell <span class=\"token operator\">=</span> row<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        cell<span class=\"token punctuation\">.</span><span class=\"token function\">setCellValue</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token comment\">// Style the cell with borders all around.</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token class-name\">CellStyle</span> style <span class=\"token operator\">=</span> wb<span class=\"token punctuation\">.</span><span class=\"token function\">createCellStyle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token comment\">// è®¾ç½®åº•éƒ¨çš„çº¿ å’Œ æ ·å¼ ä¸º ç»†çº¿</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        style<span class=\"token punctuation\">.</span><span class=\"token function\">setBorderBottom</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">BorderStyle</span><span class=\"token punctuation\">.</span><span class=\"token constant\">THIN</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token comment\">// è®¾ç½®åº•éƒ¨çš„çº¿çš„é¢œè‰²ä¸ºè“è‰²</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        style<span class=\"token punctuation\">.</span><span class=\"token function\">setBottomBorderColor</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">IndexedColors</span><span class=\"token punctuation\">.</span><span class=\"token constant\">BLACK</span><span class=\"token punctuation\">.</span><span class=\"token function\">getIndex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token comment\">// è®¾ç½®å·¦ä¾§çš„çº¿ å’Œ æ ·å¼ ä¸º ç»†çº¿</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        style<span class=\"token punctuation\">.</span><span class=\"token function\">setBorderLeft</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">BorderStyle</span><span class=\"token punctuation\">.</span><span class=\"token constant\">THIN</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token comment\">// è®¾ç½®å·¦ä¾§çš„çº¿çš„é¢œè‰²ä¸ºç»¿è‰²</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        style<span class=\"token punctuation\">.</span><span class=\"token function\">setLeftBorderColor</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">IndexedColors</span><span class=\"token punctuation\">.</span><span class=\"token constant\">GREEN</span><span class=\"token punctuation\">.</span><span class=\"token function\">getIndex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token comment\">// è®¾ç½®å³ä¾§çš„çº¿ å’Œ æ ·å¼ä¸º ç»†çº¿</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        style<span class=\"token punctuation\">.</span><span class=\"token function\">setBorderRight</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">BorderStyle</span><span class=\"token punctuation\">.</span><span class=\"token constant\">THIN</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token comment\">// è®¾ç½®å³ä¾§çš„çº¿çš„é¢œè‰²ä¸º è“è‰²</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        style<span class=\"token punctuation\">.</span><span class=\"token function\">setRightBorderColor</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">IndexedColors</span><span class=\"token punctuation\">.</span><span class=\"token constant\">BLUE</span><span class=\"token punctuation\">.</span><span class=\"token function\">getIndex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token comment\">// è®¾ç½®é¡¶éƒ¨çš„çº¿ å’Œ æ ·å¼ä¸º ä¸­ç­‰ç²—ç»†çš„è™šçº¿è¾¹æ¡†</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        style<span class=\"token punctuation\">.</span><span class=\"token function\">setBorderTop</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">BorderStyle</span><span class=\"token punctuation\">.</span><span class=\"token constant\">MEDIUM_DASHED</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        <span class=\"token comment\">// è®¾ç½®é¡¶éƒ¨çš„çº¿çš„é¢œè‰²ä¸ºé»‘è‰²</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        style<span class=\"token punctuation\">.</span><span class=\"token function\">setTopBorderColor</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">IndexedColors</span><span class=\"token punctuation\">.</span><span class=\"token constant\">BLACK</span><span class=\"token punctuation\">.</span><span class=\"token function\">getIndex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token comment\">// åº”ç”¨åˆ° å•å…ƒæ ¼ä¸­</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        cell<span class=\"token punctuation\">.</span><span class=\"token function\">setCellStyle</span><span class=\"token punctuation\">(</span>style<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        response<span class=\"token punctuation\">.</span><span class=\"token function\">setContentType</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        response<span class=\"token punctuation\">.</span><span class=\"token function\">setHeader</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Content-Disposition\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"attachment;filename=test2.xlsx\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>        wb<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">.</span><span class=\"token function\">getOutputStream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>        response<span class=\"token punctuation\">.</span><span class=\"token function\">getOutputStream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">flush</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>æ•ˆæœï¼š</p>\n<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20240810211419981.png\" alt=\"image-20240810211419981\" /></p>\n<h2 id=\"éå†è¡Œå’Œå•å…ƒæ ¼\"><a class=\"anchor\" href=\"#éå†è¡Œå’Œå•å…ƒæ ¼\">#</a> éå†è¡Œå’Œå•å…ƒæ ¼</h2>\n<p>æœ‰æ—¶ï¼Œå¯èƒ½åªæƒ³éå†å·¥ä½œç°¿ä¸­çš„æ‰€æœ‰å·¥ä½œè¡¨ä¸­çš„æ‰€æœ‰è¡Œæˆ–è¡Œä¸­çš„æ‰€æœ‰å•å…ƒæ ¼ã€‚è¿™å¯ä»¥é€šè¿‡ç®€å•çš„ for å¾ªç¯æ¥å®ç°ã€‚</p>\n<p>é€šè¿‡è°ƒç”¨ workbook.sheetIterator ()ï¼Œsheet.rowIterator () å’Œ row.cellIterator () æˆ–éšå¼ä½¿ç”¨ for-each å¾ªç¯ï¼Œå¯ä»¥ä½¿ç”¨è¿™äº›è¿­ä»£å™¨ã€‚è¯·æ³¨æ„ï¼ŒrowIterator å’Œ cellIterator éå†å·²åˆ›å»ºçš„è¡Œæˆ–å•å…ƒæ ¼ï¼Œä¼šè·³è¿‡ç©ºçš„è¡Œå’Œå•å…ƒæ ¼</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Sheet</span> sheet <span class=\"token operator\">:</span> wb <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Row</span> row <span class=\"token operator\">:</span> sheet<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Cell</span> cell <span class=\"token operator\">:</span> row<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>            <span class=\"token comment\">// Do something here</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"éå†å•å…ƒæ ¼æ§åˆ¶ä¸¢å¤±ç©ºç™½çš„å•å…ƒæ ¼\"><a class=\"anchor\" href=\"#éå†å•å…ƒæ ¼æ§åˆ¶ä¸¢å¤±ç©ºç™½çš„å•å…ƒæ ¼\">#</a> éå†å•å…ƒæ ¼ï¼Œæ§åˆ¶ä¸¢å¤± / ç©ºç™½çš„å•å…ƒæ ¼</h2>\n<p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œè¿›è¡Œè¿­ä»£æ—¶ï¼Œæ‚¨éœ€è¦å®Œå…¨æ§åˆ¶å¦‚ä½•å¤„ç†ä¸¢å¤±æˆ–ç©ºç™½çš„è¡Œå’Œå•å…ƒæ ¼ï¼Œå¹¶ä¸”éœ€è¦ç¡®ä¿è®¿é—®æ¯ä¸ªå•å…ƒæ ¼ï¼Œè€Œä¸ä»…ä»…æ˜¯è®¿é—®æ–‡ä»¶ä¸­å®šä¹‰çš„é‚£äº›å•å…ƒæ ¼ã€‚(CellIterator å°†ä»…è¿”å›æ–‡ä»¶ä¸­å®šä¹‰çš„å•å…ƒæ ¼ï¼Œè¿™åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šæ˜¯å…·æœ‰å€¼æˆ–æ ·å¼çš„å•å…ƒæ ¼ï¼Œä½†å–å†³äº Excel)</p>\n<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåº”è·å–ä¸€è¡Œçš„ç¬¬ä¸€åˆ—å’Œæœ€åä¸€åˆ—ä¿¡æ¯ï¼Œç„¶åè°ƒç”¨ getCell (int ,MissingCellPolicy) æ¥è·å–å•å…ƒæ ¼ã€‚ä½¿ç”¨ MissingCellPolicy æ§åˆ¶ç©ºç™½æˆ–å•å…ƒæ ¼çš„å¤„ç†æ–¹å¼</p>\n<p>MissingCellPolicy ç­–ç•¥å¦‚ä¸‹ï¼š</p>\n<p><code>Row.MissingCellPolicy</code>  æ˜¯ä¸€ä¸ªæšä¸¾ï¼Œå®šä¹‰äº†å¤„ç†ç¼ºå¤±å•å…ƒæ ¼çš„ä¸åŒç­–ç•¥ã€‚å¸¸ç”¨çš„æšä¸¾å€¼åŒ…æ‹¬ï¼š</p>\n<ol>\n<li><strong> <code>RETURN_NULL_AND_BLANK</code> </strong>:\n<ul>\n<li>è¿”å›çš„å•å…ƒæ ¼å¯èƒ½æ˜¯  <code>null</code> ï¼Œä¹Ÿå¯èƒ½æ˜¯  <code>BLANK</code>  ç±»å‹ã€‚ <code>null</code>  è¡¨ç¤ºå•å…ƒæ ¼ä¸å­˜åœ¨ï¼Œè€Œ  <code>BLANK</code>  è¡¨ç¤ºå•å…ƒæ ¼å­˜åœ¨ä½†ä¸ºç©ºç™½ã€‚</li>\n</ul>\n</li>\n<li><strong> <code>CREATE_NULL_AS_BLANK</code> </strong>:\n<ul>\n<li>å¦‚æœå•å…ƒæ ¼ä¸å­˜åœ¨ï¼Œä¼šåˆ›å»ºä¸€ä¸ª  <code>BLANK</code>  ç±»å‹çš„å•å…ƒæ ¼å¹¶è¿”å›ã€‚</li>\n</ul>\n</li>\n<li><strong> <code>RETURN_BLANK_AS_NULL</code> </strong>:\n<ul>\n<li>å¦‚æœå•å…ƒæ ¼ä¸å­˜åœ¨æˆ–ä¸ºç©ºç™½ï¼ˆå³  <code>BLANK</code>  ç±»å‹ï¼‰ï¼Œåˆ™è¿”å›  <code>null</code> ã€‚</li>\n</ul>\n</li>\n<li><strong> <code>RETURN_MISSING_AS_BLANK</code> </strong>:\n<ul>\n<li>å¦‚æœå•å…ƒæ ¼ä¸å­˜åœ¨ï¼Œä¼šè¿”å›ä¸€ä¸ª  <code>BLANK</code>  ç±»å‹çš„å•å…ƒæ ¼ï¼Œä½†ä¸ä¼šåˆ›å»ºå®ƒã€‚</li>\n</ul>\n</li>\n</ol>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">int</span> <span class=\"token constant\">MY_MINIMUM_COLUMN_COUNT</span> <span class=\"token operator\">=</span> <span class=\"token number\">5</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">processExcel</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpServletResponse</span> response<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Workbook</span> workbook <span class=\"token operator\">=</span> <span class=\"token class-name\">WorkbookFactory</span><span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Files</span><span class=\"token punctuation\">.</span><span class=\"token function\">newInputStream</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Paths</span><span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"C:\\\\Users\\\\dkx\\\\Downloads\\\\test2.xlsx\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token class-name\">Sheet</span> sheet <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span><span class=\"token function\">getSheetAt</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token keyword\">int</span> rowStart <span class=\"token operator\">=</span> <span class=\"token class-name\">Math</span><span class=\"token punctuation\">.</span><span class=\"token function\">min</span><span class=\"token punctuation\">(</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span> sheet<span class=\"token punctuation\">.</span><span class=\"token function\">getFirstRowNum</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">int</span> rowEnd <span class=\"token operator\">=</span> <span class=\"token class-name\">Math</span><span class=\"token punctuation\">.</span><span class=\"token function\">max</span><span class=\"token punctuation\">(</span><span class=\"token number\">1400</span><span class=\"token punctuation\">,</span> sheet<span class=\"token punctuation\">.</span><span class=\"token function\">getLastRowNum</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> rowNum <span class=\"token operator\">=</span> rowStart<span class=\"token punctuation\">;</span> rowNum <span class=\"token operator\">&lt;</span> rowEnd<span class=\"token punctuation\">;</span> rowNum<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            <span class=\"token class-name\">Row</span> r <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span><span class=\"token function\">getRow</span><span class=\"token punctuation\">(</span>rowNum<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>r <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>                <span class=\"token comment\">// å¤„ç†ç©ºè¡Œï¼Œä¾‹å¦‚è®°å½•æ—¥å¿—æˆ–è·³è¿‡</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>                <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>rowNum <span class=\"token operator\">+</span> <span class=\"token string\">\" å¤„ä¸ºç©ºè¡Œ = \"</span> <span class=\"token operator\">+</span> r<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>                <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>            <span class=\"token keyword\">int</span> lastColumn <span class=\"token operator\">=</span> <span class=\"token class-name\">Math</span><span class=\"token punctuation\">.</span><span class=\"token function\">max</span><span class=\"token punctuation\">(</span>r<span class=\"token punctuation\">.</span><span class=\"token function\">getLastCellNum</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">MY_MINIMUM_COLUMN_COUNT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> cn <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> cn <span class=\"token operator\">&lt;</span> lastColumn<span class=\"token punctuation\">;</span> cn<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>            <span class=\"token comment\">// å¦‚æœå•å…ƒæ ¼ä¸å­˜åœ¨åˆ™è¿”å› ä»æšä¸¾ä¸­è·å–çš„ç­–ç•¥å¦‚æœä¸å­˜åœ¨ä¸æ˜¯è¿”å›ç©ºç™½ (å³ BLANK ç±»å‹) è€Œæ˜¯è¿”å› NULL</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>                <span class=\"token class-name\">Cell</span> c <span class=\"token operator\">=</span> r<span class=\"token punctuation\">.</span><span class=\"token function\">getCell</span><span class=\"token punctuation\">(</span>cn<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Row<span class=\"token punctuation\">.</span>MissingCellPolicy</span><span class=\"token punctuation\">.</span><span class=\"token constant\">RETURN_BLANK_AS_NULL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>c <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>                    <span class=\"token comment\">// å¤„ç†ç©ºå•å…ƒæ ¼ï¼Œä¾‹å¦‚å¡«å……é»˜è®¤å€¼æˆ–è·³è¿‡</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>                    <span class=\"token class-name\">Cell</span> cell <span class=\"token operator\">=</span> r<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span>cn<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>                    cell<span class=\"token punctuation\">.</span><span class=\"token function\">setCellValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ohhhhhhhhhhhh\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>                    <span class=\"token comment\">// å¯¹å•å…ƒæ ¼å†…å®¹è¿›è¡Œæ“ä½œï¼Œä¾‹å¦‚æ‰“å°å†…å®¹æˆ–ä¿®æ”¹æ•°æ®</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>                    <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Cell Value: \"</span> <span class=\"token operator\">+</span> <span class=\"token class-name\">Convert</span><span class=\"token punctuation\">.</span><span class=\"token function\">toStr</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        response<span class=\"token punctuation\">.</span><span class=\"token function\">setContentType</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        response<span class=\"token punctuation\">.</span><span class=\"token function\">setHeader</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Content-Disposition\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"attachment;filename=test3.xlsx\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        workbook<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">.</span><span class=\"token function\">getOutputStream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>        response<span class=\"token punctuation\">.</span><span class=\"token function\">getOutputStream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">flush</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>æ•ˆæœï¼š</p>\n<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20240811103737832.png\" alt=\"image-20240811103737832\" /></p>\n<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20240811103835302.png\" alt=\"image-20240811103835302\" /></p>\n<h2 id=\"è·å–å•å…ƒæ ¼å†…å®¹\"><a class=\"anchor\" href=\"#è·å–å•å…ƒæ ¼å†…å®¹\">#</a> è·å–å•å…ƒæ ¼å†…å®¹</h2>\n<p>è¦è·å–å•å…ƒæ ¼çš„å†…å®¹ï¼Œæ‚¨é¦–å…ˆéœ€è¦çŸ¥é“å®ƒæ˜¯å“ªç§å•å…ƒæ ¼ (ä¾‹å¦‚ï¼šå°†å­—ç¬¦ä¸²å•å…ƒæ ¼ä½œä¸ºå…¶æ•°å­—å†…å®¹å°†è·å¾— NumberFormatException)ã€‚å› æ­¤ï¼Œæ‚¨å°†éœ€è¦æ‰“å¼€å•å…ƒæ ¼çš„ç±»å‹ï¼Œç„¶åä¸ºè¯¥å•å…ƒæ ¼è°ƒç”¨é€‚å½“çš„ getter</p>\n<p>åœ¨ä¸‹é¢ä»£ç ä¸­ï¼Œæˆ‘ä»¬éå†ä¸€å¼ çº¸ä¸­çš„æ¯ä¸ªå•å…ƒæ ¼ï¼Œæ‰“å°å‡ºè¯¥å•å…ƒæ ¼çš„å¼•ç”¨ (ä¾‹å¦‚ A3)ï¼Œç„¶åæ‰“å°å‡ºè¯¥å•å…ƒæ ¼çš„å†…å®¹</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token class-name\">CellContents</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">try</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Workbook</span> wb <span class=\"token operator\">=</span> <span class=\"token class-name\">WorkbookFactory</span><span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Files</span><span class=\"token punctuation\">.</span><span class=\"token function\">newInputStream</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Paths</span><span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"C:\\\\Users\\\\dkx\\\\Downloads\\\\test.xlsx\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token comment\">// import org.apache.poi.ss.usermodel.*;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token class-name\">DataFormatter</span> formatter <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">DataFormatter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token class-name\">Sheet</span> sheet1 <span class=\"token operator\">=</span> wb<span class=\"token punctuation\">.</span><span class=\"token function\">getSheetAt</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Row</span> row <span class=\"token operator\">:</span> sheet1<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Cell</span> cell <span class=\"token operator\">:</span> row<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>                <span class=\"token comment\">// æ ¹æ® è¡Œ åˆ— åæ ‡è·å–å½“å‰ å•å…ƒæ ¼çš„ä½ç½® æ¯”å¦‚ A1, B1, A2, B2 ç­‰</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>                <span class=\"token class-name\">CellReference</span> cellRef <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">CellReference</span><span class=\"token punctuation\">(</span>row<span class=\"token punctuation\">.</span><span class=\"token function\">getRowNum</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> cell<span class=\"token punctuation\">.</span><span class=\"token function\">getColumnIndex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>                <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">print</span><span class=\"token punctuation\">(</span>cellRef<span class=\"token punctuation\">.</span><span class=\"token function\">formatAsString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>                <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\" - \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>                <span class=\"token comment\">// get the text that appears in the cell by getting the cell value and applying any data formats (Date, 0.00, 1.23e9, $1.23, etc)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                <span class=\"token class-name\">String</span> text <span class=\"token operator\">=</span> formatter<span class=\"token punctuation\">.</span><span class=\"token function\">formatCellValue</span><span class=\"token punctuation\">(</span>cell<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>                <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>                <span class=\"token comment\">// Alternatively, get the value and format it yourself</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>                <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>cell<span class=\"token punctuation\">.</span><span class=\"token function\">getCellType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>                    <span class=\"token keyword\">case</span> <span class=\"token constant\">STRING</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>                        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>cell<span class=\"token punctuation\">.</span><span class=\"token function\">getRichStringCellValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>                        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>                    <span class=\"token keyword\">case</span> <span class=\"token constant\">NUMERIC</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>                        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">DateUtil</span><span class=\"token punctuation\">.</span><span class=\"token function\">isCellDateFormatted</span><span class=\"token punctuation\">(</span>cell<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>                            <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>cell<span class=\"token punctuation\">.</span><span class=\"token function\">getDateCellValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>                        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>                            <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>cell<span class=\"token punctuation\">.</span><span class=\"token function\">getNumericCellValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>                        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>                        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>                    <span class=\"token keyword\">case</span> <span class=\"token constant\">BOOLEAN</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>                        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>cell<span class=\"token punctuation\">.</span><span class=\"token function\">getBooleanCellValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>                        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>                    <span class=\"token keyword\">case</span> <span class=\"token constant\">FORMULA</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>                        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>cell<span class=\"token punctuation\">.</span><span class=\"token function\">getCellFormula</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>                        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>                    <span class=\"token keyword\">case</span> <span class=\"token constant\">BLANK</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>                        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>                        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>                    <span class=\"token keyword\">default</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>                        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>        <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>æ•ˆæœï¼š</p>\n<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20240811110405815.png\" alt=\"image-20240811110405815\" /></p>\n<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20240811110416854.png\" alt=\"image-20240811110416854\" /></p>\n<h2 id=\"æ–‡å­—æå–\"><a class=\"anchor\" href=\"#æ–‡å­—æå–\">#</a> æ–‡å­—æå–</h2>\n<p>å¯¹äºå¤§å¤šæ•°æ–‡æœ¬æå–è¦æ±‚ï¼Œæ ‡å‡† ExcelExtractor ç±»åº”æä¾›æ‚¨æ‰€éœ€è¦çš„å…¨éƒ¨</p>\n<h3 id=\"ä»‹ç»\"><a class=\"anchor\" href=\"#ä»‹ç»\">#</a> ä»‹ç»ï¼š</h3>\n<p>ExcelExtractorï¼šæ˜¯ç”¨æ¥ä» Excel æ–‡ä»¶ä¸­æå–æ–‡æœ¬å†…å®¹çš„ã€‚ä»¥ä¸‹æ˜¯è¿™ä¸¤è¡Œä»£ç çš„è¯¦ç»†è§£é‡Š</p>\n<p>setFormulasNotResultsï¼šè¯¥è®¾ç½®å†³å®šäº†åœ¨æå–æ–‡æœ¬æ—¶ï¼ŒExcel æ–‡ä»¶ä¸­çš„å…¬å¼åº”è¯¥è¢«æå–ä¸ºå…¬å¼æœ¬èº«ï¼Œè¿˜æ˜¯è¢«æå–ä¸ºå…¬å¼è®¡ç®—çš„ç»“æœ</p>\n<ul>\n<li>\n<p><strong> <code>true</code> </strong>: æå–å…¬å¼æœ¬èº«ã€‚ä¾‹å¦‚ï¼Œå¦‚æœå•å…ƒæ ¼åŒ…å«å…¬å¼  <code>=SUM(A1:B1)</code> ï¼Œæå–çš„å†…å®¹å°†æ˜¯  <code>=SUM(A1:B1)</code> ã€‚</p>\n</li>\n<li>\n<p><strong> <code>false</code> </strong>: æå–å…¬å¼è®¡ç®—çš„ç»“æœã€‚ä¾‹å¦‚ï¼Œå¦‚æœå•å…ƒæ ¼åŒ…å«å…¬å¼  <code>=SUM(A1:B1)</code> ï¼Œå¹¶ä¸”è®¡ç®—ç»“æœä¸º  <code>10</code> ï¼Œæå–çš„å†…å®¹å°†æ˜¯  <code>10</code> ã€‚</p>\n</li>\n</ul>\n<p>setIncludeSheetNamesï¼šè¯¥è®¾ç½®å†³å®šäº†åœ¨æå–æ–‡æœ¬æ—¶ï¼Œæ˜¯å¦åŒ…æ‹¬å·¥ä½œè¡¨çš„åç§°</p>\n<ul>\n<li><code>true</code> ï¼šåœ¨æå–çš„æ–‡æœ¬ä¸­åŒ…æ‹¬å·¥ä½œè¡¨çš„åç§°</li>\n<li><code>false</code> ï¼šä¸åŒ…æ‹¬å·¥ä½œè¡¨çš„åç§°ï¼Œæå–çš„æ–‡æœ¬å°†åªåŒ…å«å•å…ƒæ ¼å†…å®¹</li>\n</ul>\n<p>æå– xls æ–‡ä»¶ä»£ç æ¡ˆä¾‹å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token class-name\">HSSExtractTheText</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">try</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>            <span class=\"token class-name\">POIFSFileSystem</span> poifsFileSystem <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">POIFSFileSystem</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"C:\\\\Users\\\\dkx\\\\Downloads\\\\testx.xls\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>            <span class=\"token class-name\">HSSFWorkbook</span> workbook <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HSSFWorkbook</span><span class=\"token punctuation\">(</span>poifsFileSystem<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token class-name\">ExcelExtractor</span> excelExtractor <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ExcelExtractor</span><span class=\"token punctuation\">(</span>workbook<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        excelExtractor<span class=\"token punctuation\">.</span><span class=\"token function\">setFormulasNotResults</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        excelExtractor<span class=\"token punctuation\">.</span><span class=\"token function\">setIncludeSheetNames</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token class-name\">String</span> text <span class=\"token operator\">=</span> excelExtractor<span class=\"token punctuation\">.</span><span class=\"token function\">getText</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"HSSF content = \"</span> <span class=\"token operator\">+</span> text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>æ•ˆæœï¼š</p>\n<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20240811145254670.png\" alt=\"image-20240811145254670\" /></p>\n<p>æå– xlsx æ–‡ä»¶ä»£ç æ¡ˆä¾‹å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token class-name\">XSSExtractTheText</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token class-name\">OPCPackage</span> <span class=\"token keyword\">open</span> <span class=\"token operator\">=</span> <span class=\"token class-name\">OPCPackage</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">open</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"C:\\\\Users\\\\dkx\\\\Downloads\\\\test.xlsx\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">XSSFWorkbook</span> wb <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">XSSFWorkbook</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">open</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            <span class=\"token class-name\">XSSFExcelExtractor</span> extractor <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">XSSFExcelExtractor</span><span class=\"token punctuation\">(</span>wb<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>            extractor<span class=\"token punctuation\">.</span><span class=\"token function\">setFormulasNotResults</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            extractor<span class=\"token punctuation\">.</span><span class=\"token function\">setIncludeSheetNames</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            <span class=\"token class-name\">String</span> text <span class=\"token operator\">=</span> extractor<span class=\"token punctuation\">.</span><span class=\"token function\">getText</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"XSSF content = \"</span> <span class=\"token operator\">+</span> text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>æ•ˆæœï¼š</p>\n<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20240811145827037.png\" alt=\"image-20240811145827037\" /></p>\n<blockquote>\n<p>å¯¹äºéå¸¸ç²¾ç¾çš„æ–‡æœ¬æå–ï¼ŒXLS åˆ° CSV ç­‰ï¼Œè¯·æŸ¥çœ‹</p>\n<p>/src/examples/src/org/apache/poi/examples/hssf/eventusermodel/XLS2CSVmra.java</p>\n</blockquote>\n<h2 id=\"å¡«å……å’Œé¢œè‰²\"><a class=\"anchor\" href=\"#å¡«å……å’Œé¢œè‰²\">#</a> å¡«å……å’Œé¢œè‰²</h2>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">paddingTwo</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpServletResponse</span> response<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">try</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Workbook</span> wb <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">XSSFWorkbook</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token class-name\">Sheet</span> sheet <span class=\"token operator\">=</span> wb<span class=\"token punctuation\">.</span><span class=\"token function\">createSheet</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"new sheet\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token comment\">// Create a row and put some cells in it. Rows are 0 based.</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token class-name\">Row</span> row <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span><span class=\"token function\">createRow</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token comment\">// Aqua background</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token class-name\">CellStyle</span> style <span class=\"token operator\">=</span> wb<span class=\"token punctuation\">.</span><span class=\"token function\">createCellStyle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        style<span class=\"token punctuation\">.</span><span class=\"token function\">setFillBackgroundColor</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">IndexedColors</span><span class=\"token punctuation\">.</span><span class=\"token constant\">AQUA</span><span class=\"token punctuation\">.</span><span class=\"token function\">getIndex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        style<span class=\"token punctuation\">.</span><span class=\"token function\">setFillPattern</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">FillPatternType</span><span class=\"token punctuation\">.</span><span class=\"token constant\">BIG_SPOTS</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token class-name\">Cell</span> cell <span class=\"token operator\">=</span> row<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        cell<span class=\"token punctuation\">.</span><span class=\"token function\">setCellValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"X\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        cell<span class=\"token punctuation\">.</span><span class=\"token function\">setCellStyle</span><span class=\"token punctuation\">(</span>style<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token comment\">// Orange \"foreground\", foreground being the fill foreground not the font color.</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        style <span class=\"token operator\">=</span> wb<span class=\"token punctuation\">.</span><span class=\"token function\">createCellStyle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        style<span class=\"token punctuation\">.</span><span class=\"token function\">setFillForegroundColor</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">IndexedColors</span><span class=\"token punctuation\">.</span><span class=\"token constant\">ORANGE</span><span class=\"token punctuation\">.</span><span class=\"token function\">getIndex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        style<span class=\"token punctuation\">.</span><span class=\"token function\">setFillPattern</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">FillPatternType</span><span class=\"token punctuation\">.</span><span class=\"token constant\">SOLID_FOREGROUND</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        cell <span class=\"token operator\">=</span> row<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        cell<span class=\"token punctuation\">.</span><span class=\"token function\">setCellValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"X\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        cell<span class=\"token punctuation\">.</span><span class=\"token function\">setCellStyle</span><span class=\"token punctuation\">(</span>style<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token comment\">// Write the output to a file</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        response<span class=\"token punctuation\">.</span><span class=\"token function\">setContentType</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        response<span class=\"token punctuation\">.</span><span class=\"token function\">setHeader</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Content-disposition\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"attachment;filename=test123.xlsx\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        wb<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">.</span><span class=\"token function\">getOutputStream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        response<span class=\"token punctuation\">.</span><span class=\"token function\">getOutputStream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">flush</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>æ•ˆæœï¼š</p>\n<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20240811151115986.png\" alt=\"image-20240811151115986\" /></p>\n<h2 id=\"åˆå¹¶å•å…ƒæ ¼\"><a class=\"anchor\" href=\"#åˆå¹¶å•å…ƒæ ¼\">#</a> åˆå¹¶å•å…ƒæ ¼</h2>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">merge</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpServletResponse</span> response<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">try</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Workbook</span> wb <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HSSFWorkbook</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token class-name\">Sheet</span> sheet <span class=\"token operator\">=</span> wb<span class=\"token punctuation\">.</span><span class=\"token function\">createSheet</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"new sheet\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token class-name\">Row</span> row <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span><span class=\"token function\">createRow</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token class-name\">Cell</span> cell <span class=\"token operator\">=</span> row<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        cell<span class=\"token punctuation\">.</span><span class=\"token function\">setCellValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"This is a test of merging\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token comment\">// é€šè¿‡åæ ‡ä½ç½®æ¥è¿›è¡ŒåŒºåŸŸçš„å•å…ƒæ ¼åˆå¹¶ä»èµ·å§‹ åˆ° ç»“æŸ è¿›è¡Œåˆå¹¶ ä¸èƒ½å°†åæ ‡éƒ½è®¾ç½®ä¸€æ ·ï¼Œå› ä¸ºè¿™æ ·ä¸èƒ½åˆå¹¶ä¼šæŠ¥é”™</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        sheet<span class=\"token punctuation\">.</span><span class=\"token function\">addMergedRegion</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">CellRangeAddress</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>                <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">//first row (0-based)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>                <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">//last row  (0-based)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>                <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">//first column (0-based)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>                <span class=\"token number\">4</span>  <span class=\"token comment\">//last column  (0-based)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token comment\">// Write the output to a file</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        response<span class=\"token punctuation\">.</span><span class=\"token function\">setContentType</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        response<span class=\"token punctuation\">.</span><span class=\"token function\">setHeader</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Content-Disposition\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"attachment;filename=test321.xlsx\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        wb<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">.</span><span class=\"token function\">getOutputStream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        response<span class=\"token punctuation\">.</span><span class=\"token function\">getOutputStream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">flush</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>æ•ˆæœï¼š</p>\n<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20240811152253234.png\" alt=\"image-20240811152253234\" /></p>\n<h2 id=\"è®¾ç½®å­—ä½“\"><a class=\"anchor\" href=\"#è®¾ç½®å­—ä½“\">#</a> è®¾ç½®å­—ä½“</h2>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">setFont</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpServletResponse</span> response<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">try</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Workbook</span> wb <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HSSFWorkbook</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token class-name\">Sheet</span> sheet <span class=\"token operator\">=</span> wb<span class=\"token punctuation\">.</span><span class=\"token function\">createSheet</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"new sheet\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token comment\">// Create a row and put some cells in it. Rows are 0 based.</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token class-name\">Row</span> row <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span><span class=\"token function\">createRow</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token comment\">// Create a new font and alter it.</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token class-name\">Font</span> font <span class=\"token operator\">=</span> wb<span class=\"token punctuation\">.</span><span class=\"token function\">createFont</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token comment\">// å­—ä½“å¤§å°</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        font<span class=\"token punctuation\">.</span><span class=\"token function\">setFontHeightInPoints</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">short</span><span class=\"token punctuation\">)</span><span class=\"token number\">24</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token comment\">// è®¾ç½®å­—ä½“</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        font<span class=\"token punctuation\">.</span><span class=\"token function\">setFontName</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"å¾®è½¯é›…é»‘\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        font<span class=\"token punctuation\">.</span><span class=\"token function\">setItalic</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token comment\">// åˆ é™¤çº¿</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        font<span class=\"token punctuation\">.</span><span class=\"token function\">setStrikeout</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token comment\">// åŠ ç²—</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        font<span class=\"token punctuation\">.</span><span class=\"token function\">setBold</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token comment\">// é¢œè‰²</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        font<span class=\"token punctuation\">.</span><span class=\"token function\">setColor</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HSSFColor<span class=\"token punctuation\">.</span>HSSFColorPredefined</span><span class=\"token punctuation\">.</span><span class=\"token constant\">RED</span><span class=\"token punctuation\">.</span><span class=\"token function\">getIndex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token comment\">// Fonts are set into a style so create a new one to use.</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token class-name\">CellStyle</span> style <span class=\"token operator\">=</span> wb<span class=\"token punctuation\">.</span><span class=\"token function\">createCellStyle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token comment\">// å‘æ ·å¼é‡Œæ·»åŠ å­—ä½“è®¾ç½®</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        style<span class=\"token punctuation\">.</span><span class=\"token function\">setFont</span><span class=\"token punctuation\">(</span>font<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token comment\">// Create a cell and put a value in it.</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token class-name\">Cell</span> cell <span class=\"token operator\">=</span> row<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        cell<span class=\"token punctuation\">.</span><span class=\"token function\">setCellValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"This is a test of fonts\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        cell<span class=\"token punctuation\">.</span><span class=\"token function\">setCellStyle</span><span class=\"token punctuation\">(</span>style<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token comment\">// Write the output to a file</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        response<span class=\"token punctuation\">.</span><span class=\"token function\">setContentType</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        response<span class=\"token punctuation\">.</span><span class=\"token function\">setHeader</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Content-Disposition\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"attachment;filename=ttt.xlsx\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        wb<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">.</span><span class=\"token function\">getOutputStream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>        response<span class=\"token punctuation\">.</span><span class=\"token function\">getOutputStream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">flush</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>æ•ˆæœï¼š</p>\n<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20240811153535715.png\" alt=\"image-20240811153535715\" /></p>\n<blockquote>\n<p>è¯·æ³¨æ„ï¼Œå·¥ä½œç°¿ä¸­å”¯ä¸€å­—ä½“çš„æœ€å¤§æ•°é™åˆ¶ä¸º 32767ã€‚æ‚¨åº”è¯¥åœ¨åº”ç”¨ç¨‹åºä¸­é‡æ–°ä½¿ç”¨å­—ä½“ï¼Œè€Œä¸æ˜¯ä¸ºæ¯ä¸ªå•å…ƒæ ¼åˆ›å»ºå­—ä½“</p>\n</blockquote>\n<p>ä¾‹å­ï¼š</p>\n<p>é”™è¯¯çš„å†™æ³•ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">10000</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token class-name\">Row</span> row <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span><span class=\"token function\">createRow</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token class-name\">Cell</span> cell <span class=\"token operator\">=</span> row<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token class-name\">CellStyle</span> style <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span><span class=\"token function\">createCellStyle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token class-name\">Font</span> font <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span><span class=\"token function\">createFont</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    font<span class=\"token punctuation\">.</span><span class=\"token function\">setBoldweight</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Font</span><span class=\"token punctuation\">.</span><span class=\"token constant\">BOLDWEIGHT_BOLD</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    style<span class=\"token punctuation\">.</span><span class=\"token function\">setFont</span><span class=\"token punctuation\">(</span>font<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    cell<span class=\"token punctuation\">.</span><span class=\"token function\">setCellStyle</span><span class=\"token punctuation\">(</span>style<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>æ­£ç¡®çš„å†™æ³•ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">CellStyle</span> style <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span><span class=\"token function\">createCellStyle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">Font</span> font <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span><span class=\"token function\">createFont</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>font<span class=\"token punctuation\">.</span><span class=\"token function\">setBoldweight</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Font</span><span class=\"token punctuation\">.</span><span class=\"token constant\">BOLDWEIGHT_BOLD</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>style<span class=\"token punctuation\">.</span><span class=\"token function\">setFont</span><span class=\"token punctuation\">(</span>font<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">10000</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token class-name\">Row</span> row <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span><span class=\"token function\">createRow</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token class-name\">Cell</span> cell <span class=\"token operator\">=</span> row<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    cell<span class=\"token punctuation\">.</span><span class=\"token function\">setCellStyle</span><span class=\"token punctuation\">(</span>style<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"è‡ªå®šä¹‰é¢œè‰²\"><a class=\"anchor\" href=\"#è‡ªå®šä¹‰é¢œè‰²\">#</a> è‡ªå®šä¹‰é¢œè‰²</h2>\n<p>HSSF (.xls æ–‡ä»¶)</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">diyColor</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpServletResponse</span> response<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">try</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HSSFWorkbook</span> wb <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HSSFWorkbook</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token class-name\">HSSFSheet</span> sheet <span class=\"token operator\">=</span> wb<span class=\"token punctuation\">.</span><span class=\"token function\">createSheet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token class-name\">HSSFRow</span> row <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span><span class=\"token function\">createRow</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token class-name\">HSSFCell</span> cell <span class=\"token operator\">=</span> row<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token class-name\">HSSFPalette</span> palette <span class=\"token operator\">=</span> wb<span class=\"token punctuation\">.</span><span class=\"token function\">getCustomPalette</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token comment\">// é€šè¿‡ Excel ä¸­çš„ è°ƒè‰²æ¿ æ¥è®¾ç½® æŒ‡å®š RED é¢œè‰² çš„ RGB æ–¹æ¡ˆ</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        palette<span class=\"token punctuation\">.</span><span class=\"token function\">setColorAtIndex</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HSSFColor<span class=\"token punctuation\">.</span>HSSFColorPredefined</span><span class=\"token punctuation\">.</span><span class=\"token constant\">RED</span><span class=\"token punctuation\">.</span><span class=\"token function\">getIndex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>                <span class=\"token punctuation\">(</span><span class=\"token keyword\">byte</span><span class=\"token punctuation\">)</span> <span class=\"token number\">153</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\">//RGB red (0-255)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>                <span class=\"token punctuation\">(</span><span class=\"token keyword\">byte</span><span class=\"token punctuation\">)</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>    <span class=\"token comment\">//RGB green</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>                <span class=\"token punctuation\">(</span><span class=\"token keyword\">byte</span><span class=\"token punctuation\">)</span> <span class=\"token number\">0</span>     <span class=\"token comment\">//RGB blue</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token comment\">// é€šè¿‡ Excel ä¸­çš„ è°ƒè‰²æ¿ æ¥è®¾ç½® æŒ‡å®š LIME é¢œè‰² çš„ RGB æ–¹æ¡ˆ</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        palette<span class=\"token punctuation\">.</span><span class=\"token function\">setColorAtIndex</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HSSFColor<span class=\"token punctuation\">.</span>HSSFColorPredefined</span><span class=\"token punctuation\">.</span><span class=\"token constant\">LIME</span><span class=\"token punctuation\">.</span><span class=\"token function\">getIndex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">byte</span><span class=\"token punctuation\">)</span> <span class=\"token number\">255</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">byte</span><span class=\"token punctuation\">)</span> <span class=\"token number\">204</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">byte</span><span class=\"token punctuation\">)</span> <span class=\"token number\">102</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token comment\">// å°† è°ƒæ•´çš„ æŒ‡å®šé¢œè‰²è®¾ç½®åˆ°å­—ä½“ä¸­</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token class-name\">HSSFFont</span> font <span class=\"token operator\">=</span> wb<span class=\"token punctuation\">.</span><span class=\"token function\">createFont</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        font<span class=\"token punctuation\">.</span><span class=\"token function\">setColor</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HSSFColor<span class=\"token punctuation\">.</span>HSSFColorPredefined</span><span class=\"token punctuation\">.</span><span class=\"token constant\">RED</span><span class=\"token punctuation\">.</span><span class=\"token function\">getIndex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token class-name\">HSSFCellStyle</span> style <span class=\"token operator\">=</span> wb<span class=\"token punctuation\">.</span><span class=\"token function\">createCellStyle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token comment\">// è®¾ç½®å¡«å……è‰²å‰æ™¯</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        style<span class=\"token punctuation\">.</span><span class=\"token function\">setFillForegroundColor</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HSSFColor<span class=\"token punctuation\">.</span>HSSFColorPredefined</span><span class=\"token punctuation\">.</span><span class=\"token constant\">LIME</span><span class=\"token punctuation\">.</span><span class=\"token function\">getIndex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token comment\">// è®¾ç½®å¡«å……æ–¹æ¡ˆä¸ºå®å¿ƒå‰æ™¯</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        style<span class=\"token punctuation\">.</span><span class=\"token function\">setFillPattern</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">FillPatternType</span><span class=\"token punctuation\">.</span><span class=\"token constant\">SOLID_FOREGROUND</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        style<span class=\"token punctuation\">.</span><span class=\"token function\">setFont</span><span class=\"token punctuation\">(</span>font<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        cell<span class=\"token punctuation\">.</span><span class=\"token function\">setCellStyle</span><span class=\"token punctuation\">(</span>style<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        cell<span class=\"token punctuation\">.</span><span class=\"token function\">setCellValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Modified Palette\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        response<span class=\"token punctuation\">.</span><span class=\"token function\">setContentType</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        response<span class=\"token punctuation\">.</span><span class=\"token function\">setHeader</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Content-Disposition\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"attachment;filename=qwe.xls\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        wb<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">.</span><span class=\"token function\">getOutputStream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        response<span class=\"token punctuation\">.</span><span class=\"token function\">getOutputStream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">flush</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>        <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>æ•ˆæœï¼š</p>\n<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20240811183303747.png\" alt=\"image-20240811183303747\" /></p>\n<p>XSSF (.xlsx æ–‡ä»¶)</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">diyColorX</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpServletResponse</span> response<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">try</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">XSSFWorkbook</span> wb <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">XSSFWorkbook</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token class-name\">XSSFSheet</span> sheet <span class=\"token operator\">=</span> wb<span class=\"token punctuation\">.</span><span class=\"token function\">createSheet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token class-name\">XSSFRow</span> row <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span><span class=\"token function\">createRow</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token class-name\">XSSFCell</span> cell <span class=\"token operator\">=</span> row<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token class-name\">XSSFCellStyle</span> style <span class=\"token operator\">=</span> wb<span class=\"token punctuation\">.</span><span class=\"token function\">createCellStyle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token comment\">// è®¾ç½®å¡«å……å‰æ™¯é¢œè‰²</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        style<span class=\"token punctuation\">.</span><span class=\"token function\">setFillForegroundColor</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">XSSFColor</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>awt<span class=\"token punctuation\">.</span></span>Color</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">DefaultIndexedColorMap</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token comment\">// è®¾ç½®å¡«å……æ–¹æ¡ˆä¸ºå®å¿ƒå‰æ™¯</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        style<span class=\"token punctuation\">.</span><span class=\"token function\">setFillPattern</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">FillPatternType</span><span class=\"token punctuation\">.</span><span class=\"token constant\">SOLID_FOREGROUND</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        cell<span class=\"token punctuation\">.</span><span class=\"token function\">setCellStyle</span><span class=\"token punctuation\">(</span>style<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        cell<span class=\"token punctuation\">.</span><span class=\"token function\">setCellValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"custom XSSF colors\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        response<span class=\"token punctuation\">.</span><span class=\"token function\">setContentType</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        response<span class=\"token punctuation\">.</span><span class=\"token function\">setHeader</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Content-Disposition\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"attachment;filename=qwe.xlsx\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        wb<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">.</span><span class=\"token function\">getOutputStream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        response<span class=\"token punctuation\">.</span><span class=\"token function\">getOutputStream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">flush</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>æ•ˆæœï¼š</p>\n<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20240811184204629.png\" alt=\"image-20240811184204629\" /></p>\n<h2 id=\"è¯»å’Œå†™workbooks\"><a class=\"anchor\" href=\"#è¯»å’Œå†™workbooks\">#</a> è¯»å’Œå†™ WorkBooks</h2>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">try</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">InputStream</span> inp <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FileInputStream</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"workbook.xls\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">//InputStream inp = new FileInputStream(\"workbook.xlsx\");</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token class-name\">Workbook</span> wb <span class=\"token operator\">=</span> <span class=\"token class-name\">WorkbookFactory</span><span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span>inp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token class-name\">Sheet</span> sheet <span class=\"token operator\">=</span> wb<span class=\"token punctuation\">.</span><span class=\"token function\">getSheetAt</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token class-name\">Row</span> row <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span><span class=\"token function\">getRow</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token class-name\">Cell</span> cell <span class=\"token operator\">=</span> row<span class=\"token punctuation\">.</span><span class=\"token function\">getCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>cell <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        cell <span class=\"token operator\">=</span> row<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    cell<span class=\"token punctuation\">.</span><span class=\"token function\">setCellType</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">CellType</span><span class=\"token punctuation\">.</span><span class=\"token constant\">STRING</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    cell<span class=\"token punctuation\">.</span><span class=\"token function\">setCellValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"a test\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token comment\">// Write the output to a file</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">OutputStream</span> fileOut <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FileOutputStream</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"workbook.xls\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        wb<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span>fileOut<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"åœ¨å•å…ƒæ ¼ä¸­ä½¿ç”¨æ¢è¡Œç¬¦\"><a class=\"anchor\" href=\"#åœ¨å•å…ƒæ ¼ä¸­ä½¿ç”¨æ¢è¡Œç¬¦\">#</a> åœ¨å•å…ƒæ ¼ä¸­ä½¿ç”¨æ¢è¡Œç¬¦</h2>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">lineBreaks</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpServletResponse</span> response<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">try</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Workbook</span> wb <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">XSSFWorkbook</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>    <span class=\"token comment\">//or new HSSFWorkbook();</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token class-name\">Sheet</span> sheet <span class=\"token operator\">=</span> wb<span class=\"token punctuation\">.</span><span class=\"token function\">createSheet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token class-name\">Row</span> row <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span><span class=\"token function\">createRow</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token class-name\">Cell</span> cell <span class=\"token operator\">=</span> row<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        cell<span class=\"token punctuation\">.</span><span class=\"token function\">setCellValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Use \\n with word wrap on to create a new line\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token comment\">//to enable newlines you need set a cell styles with wrap=true</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token class-name\">CellStyle</span> cs <span class=\"token operator\">=</span> wb<span class=\"token punctuation\">.</span><span class=\"token function\">createCellStyle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token comment\">// è¿è¡Œæ¢è¡Œå±•ç¤º</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        cs<span class=\"token punctuation\">.</span><span class=\"token function\">setWrapText</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        cell<span class=\"token punctuation\">.</span><span class=\"token function\">setCellStyle</span><span class=\"token punctuation\">(</span>cs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token comment\">// è®¾ç½®è¡Œé«˜</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        row<span class=\"token punctuation\">.</span><span class=\"token function\">setHeightInPoints</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span> <span class=\"token operator\">*</span> sheet<span class=\"token punctuation\">.</span><span class=\"token function\">getDefaultRowHeightInPoints</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token comment\">// è‡ªåŠ¨è°ƒæ•´åˆ—å®½ï¼Œä» ç´¢å¼• 2 å¼€å§‹</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        sheet<span class=\"token punctuation\">.</span><span class=\"token function\">autoSizeColumn</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        response<span class=\"token punctuation\">.</span><span class=\"token function\">setContentType</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        response<span class=\"token punctuation\">.</span><span class=\"token function\">setHeader</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Content-Disposition\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"attachment;filename=qwe.xlsx\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        wb<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">.</span><span class=\"token function\">getOutputStream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        response<span class=\"token punctuation\">.</span><span class=\"token function\">getOutputStream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">flush</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>æ•ˆæœï¼š</p>\n<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20240811190225813.png\" alt=\"image-20240811190225813\" /></p>\n<h2 id=\"æ•°æ®æ ¼å¼åŒ–\"><a class=\"anchor\" href=\"#æ•°æ®æ ¼å¼åŒ–\">#</a> æ•°æ®æ ¼å¼åŒ–</h2>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">dataFormat</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpServletResponse</span> response<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">try</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Workbook</span> wb <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HSSFWorkbook</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token class-name\">Sheet</span> sheet <span class=\"token operator\">=</span> wb<span class=\"token punctuation\">.</span><span class=\"token function\">createSheet</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"format sheet\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token class-name\">CellStyle</span> style<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token class-name\">DataFormat</span> format <span class=\"token operator\">=</span> wb<span class=\"token punctuation\">.</span><span class=\"token function\">createDataFormat</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token class-name\">Row</span> row<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token class-name\">Cell</span> cell<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token keyword\">int</span> rowNum <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token keyword\">int</span> colNum <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        row <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span><span class=\"token function\">createRow</span><span class=\"token punctuation\">(</span>rowNum<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        cell <span class=\"token operator\">=</span> row<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span>colNum<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        cell<span class=\"token punctuation\">.</span><span class=\"token function\">setCellValue</span><span class=\"token punctuation\">(</span><span class=\"token number\">11111.25</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        style <span class=\"token operator\">=</span> wb<span class=\"token punctuation\">.</span><span class=\"token function\">createCellStyle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token comment\">// ä¿ç•™ä¸€ä½å°æ•°</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        style<span class=\"token punctuation\">.</span><span class=\"token function\">setDataFormat</span><span class=\"token punctuation\">(</span>format<span class=\"token punctuation\">.</span><span class=\"token function\">getFormat</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"0.0\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        cell<span class=\"token punctuation\">.</span><span class=\"token function\">setCellStyle</span><span class=\"token punctuation\">(</span>style<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        row <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span><span class=\"token function\">createRow</span><span class=\"token punctuation\">(</span>rowNum<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        cell <span class=\"token operator\">=</span> row<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span>colNum<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        cell<span class=\"token punctuation\">.</span><span class=\"token function\">setCellValue</span><span class=\"token punctuation\">(</span><span class=\"token number\">11111.25</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        style <span class=\"token operator\">=</span> wb<span class=\"token punctuation\">.</span><span class=\"token function\">createCellStyle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token comment\">// #,## æ•°å­—éƒ¨åˆ†ä»¥ï¼Œåˆ†éš”ã€‚ä¿ç•™å››ä½å°æ•°</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        style<span class=\"token punctuation\">.</span><span class=\"token function\">setDataFormat</span><span class=\"token punctuation\">(</span>format<span class=\"token punctuation\">.</span><span class=\"token function\">getFormat</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#,##0.0000\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        cell<span class=\"token punctuation\">.</span><span class=\"token function\">setCellStyle</span><span class=\"token punctuation\">(</span>style<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        response<span class=\"token punctuation\">.</span><span class=\"token function\">setContentType</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        response<span class=\"token punctuation\">.</span><span class=\"token function\">setHeader</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Content-Disposition\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"attachment;filename=qwe.xls\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        wb<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">.</span><span class=\"token function\">getOutputStream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        response<span class=\"token punctuation\">.</span><span class=\"token function\">getOutputStream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">flush</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>æ•ˆæœï¼š</p>\n<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20240811190840875.png\" alt=\"image-20240811190840875\" /></p>\n<h2 id=\"å°†å·¥ä½œè¡¨è°ƒæ•´ä¸ºä¸€é¡µæ‰“å°ç›¸å…³é…ç½®\"><a class=\"anchor\" href=\"#å°†å·¥ä½œè¡¨è°ƒæ•´ä¸ºä¸€é¡µæ‰“å°ç›¸å…³é…ç½®\">#</a> å°†å·¥ä½œè¡¨è°ƒæ•´ä¸ºä¸€é¡µ (æ‰“å°ç›¸å…³é…ç½®)</h2>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">try</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Workbook</span> wb <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HSSFWorkbook</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token comment\">// åˆ›å»ºä¸€ä¸ªæ–°çš„ Excel å·¥ä½œç°¿ï¼ˆ.xls æ ¼å¼ï¼‰</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token class-name\">Sheet</span> sheet <span class=\"token operator\">=</span> wb<span class=\"token punctuation\">.</span><span class=\"token function\">createSheet</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"format sheet\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token comment\">// è·å–å½“å‰å·¥ä½œè¡¨çš„æ‰“å°è®¾ç½®</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token class-name\">PrintSetup</span> ps <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span><span class=\"token function\">getPrintSetup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token comment\">// è‡ªåŠ¨åˆ†é¡µ</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    sheet<span class=\"token punctuation\">.</span><span class=\"token function\">setAutobreaks</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token comment\">// è®¾ç½®æ‰“å°é¡µé¢çš„é«˜åº¦å’Œå®½åº¦ä¸º 1 é¡µ</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    ps<span class=\"token punctuation\">.</span><span class=\"token function\">setFitHeight</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">short</span><span class=\"token punctuation\">)</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    ps<span class=\"token punctuation\">.</span><span class=\"token function\">setFitWidth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">short</span><span class=\"token punctuation\">)</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token comment\">// è®¾ç½® HTTP å“åº”çš„å†…å®¹ç±»å‹ä¸º Excel 2003 æ ¼å¼</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    response<span class=\"token punctuation\">.</span><span class=\"token function\">setContentType</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token comment\">// è®¾ç½®æ–‡ä»¶ä¸‹è½½æ—¶çš„åç§°</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    response<span class=\"token punctuation\">.</span><span class=\"token function\">setHeader</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Content-Disposition\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"attachment;filename=qwe.xls\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token comment\">// å°†å·¥ä½œç°¿å†™å…¥ HTTP å“åº”è¾“å‡ºæµ</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    wb<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">.</span><span class=\"token function\">getOutputStream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"è®¾ç½®æ‰“å°åŒºåŸŸ\"><a class=\"anchor\" href=\"#è®¾ç½®æ‰“å°åŒºåŸŸ\">#</a> è®¾ç½®æ‰“å°åŒºåŸŸ</h2>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">Workbook</span> wb <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HSSFWorkbook</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">Sheet</span> sheet <span class=\"token operator\">=</span> wb<span class=\"token punctuation\">.</span><span class=\"token function\">createSheet</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Sheet1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">//sets the print area for the first sheet</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>wb<span class=\"token punctuation\">.</span><span class=\"token function\">setPrintArea</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"$A$1:$C$2\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">//Alternatively:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>wb<span class=\"token punctuation\">.</span><span class=\"token function\">setPrintArea</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">//sheet index</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">//start column</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">//end column</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">//start row</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token number\">0</span>  <span class=\"token comment\">//end row</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">try</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">OutputStream</span> fileOut <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FileOutputStream</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"workbook.xls\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    wb<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span>fileOut<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>wb<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h2 id=\"è®¾ç½®é¡µè„šé¡µæ•°\"><a class=\"anchor\" href=\"#è®¾ç½®é¡µè„šé¡µæ•°\">#</a> è®¾ç½®é¡µè„šé¡µæ•°</h2>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">Workbook</span> wb <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HSSFWorkbook</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// or new XSSFWorkbook();</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">Sheet</span> sheet <span class=\"token operator\">=</span> wb<span class=\"token punctuation\">.</span><span class=\"token function\">createSheet</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"format sheet\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token class-name\">Footer</span> footer <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span><span class=\"token function\">getFooter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>footer<span class=\"token punctuation\">.</span><span class=\"token function\">setRight</span><span class=\"token punctuation\">(</span> <span class=\"token string\">\"Page \"</span> <span class=\"token operator\">+</span> <span class=\"token class-name\">HeaderFooter</span><span class=\"token punctuation\">.</span><span class=\"token function\">page</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\" of \"</span> <span class=\"token operator\">+</span> <span class=\"token class-name\">HeaderFooter</span><span class=\"token punctuation\">.</span><span class=\"token function\">numPages</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">// Create various cells and rows for spreadsheet.</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">try</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">OutputStream</span> fileOut <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FileOutputStream</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"workbook.xls\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    wb<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span>fileOut<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>wb<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure></li>\n</ol>\n<h3 id=\"poiå¯¼å‡ºexcelçš„åŸºæœ¬ä½¿ç”¨\"><a class=\"anchor\" href=\"#poiå¯¼å‡ºexcelçš„åŸºæœ¬ä½¿ç”¨\">#</a> poi å¯¼å‡º excel çš„åŸºæœ¬ä½¿ç”¨</h3>\n<p>ä½¿ç”¨æ­¥éª¤ï¼š</p>\n<ol>\n<li>æŸ¥è¯¢éœ€è¦å¯¼å‡ºçš„æ•°æ®</li>\n<li>åˆ›å»º excel æ–‡æ¡£  (new XSSFWorkbook ()  è¿”å›  Workbook å¯¹è±¡)</li>\n<li>åˆ›å»ºå­˜æ”¾æ•°æ®çš„ sheet é¡µ  (workbook.createSheet (&quot;ç®¡æ®µä¿¡æ¯&quot;)  è¿”å›  Sheet  å¯¹è±¡)</li>\n<li>åˆ›å»ºè¡Œå¯¹è±¡ï¼Œæä¾›åˆ›å»ºè¿™ä¸ªè¡Œæ‰€å¤„çš„ç´¢å¼•ä½ç½®  (sheet.createRow (0)  è¿”å›  Row  å¯¹è±¡)</li>\n<li>å¯¹è¡Œè¿›è¡Œæ·»åŠ æ ‡é¢˜æ•°æ®  (row.createCell (0).setCellValue (&quot;ç®¡çº¿åç§°&quot;) åˆ›å»ºå•å…ƒæ ¼  è®¾ç½® row è¡Œçš„ç´¢å¼•ä¸º 0 å¤„çš„æ•°æ®)</li>\n<li>å¯¹è¡Œè¿›è¡Œæ·»åŠ å®é™…æ•°æ®  (å¯ä»¥éå†å¯¹è±¡æ¥é€šè¿‡å¾ªç¯å€¼å½“ä½œåˆ›å»ºè¡Œçš„ç´¢å¼•ä½ç½® ç„¶åå¯¹è¿™ä¸ªè¡Œè¿›è¡Œæ·»åŠ æ•°æ®)</li>\n<li>å¯¹æ ‡é¢˜è¿›è¡Œè®¾ç½®æ ·å¼ (é€šè¿‡ workbook å¯¹è±¡åˆ›å»º workbook.createCellStyle () è¿”å› CellStyle å¯¹è±¡)</li>\n<li>å¯¹å­—ä½“è¿›è¡Œè®¾ç½®</li>\n<li>éå†æŸè¡Œçš„æ‰€æœ‰å•å…ƒæ ¼ (header.getPhysicalNumberOfCells ()   for å¾ªç¯) å¹¶å°†å­—ä½“çš„è®¾ç½®åº”ç”¨ä¸Š (row.getCell (i).setCellStyle (cellStyle))</li>\n</ol>\n<p>ä»£ç å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">exportSection</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> layoutId<span class=\"token punctuation\">,</span> <span class=\"token class-name\">HttpServletResponse</span> response<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token comment\">// æŸ¥è¯¢æ•°æ®</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">FacGasPipeSection</span><span class=\"token punctuation\">></span></span> facGasPipeSections <span class=\"token operator\">=</span> facGasPipeSectionMapper<span class=\"token punctuation\">.</span><span class=\"token function\">selectList</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">FacGasStationYard</span><span class=\"token punctuation\">></span></span> facGasStationYards <span class=\"token operator\">=</span> facGasStationYardMapper<span class=\"token punctuation\">.</span><span class=\"token function\">selectList</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token comment\">// åˆ›å»º Excel æ–‡æ¡£</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token class-name\">Workbook</span> workbook <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">XSSFWorkbook</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token comment\">// åˆ›å»ºä¸¤ä¸ª Sheet åˆ†åˆ«å­˜æ”¾ä¸åŒçš„æ•°æ®</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token function\">createPipeSectionSheet</span><span class=\"token punctuation\">(</span>workbook<span class=\"token punctuation\">,</span> facGasPipeSections<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token function\">createStationYardSheet</span><span class=\"token punctuation\">(</span>workbook<span class=\"token punctuation\">,</span> facGasStationYards<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token comment\">// è®¾ç½® Content-Type ä¸º Excel</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    response<span class=\"token punctuation\">.</span><span class=\"token function\">setContentType</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    response<span class=\"token punctuation\">.</span><span class=\"token function\">setHeader</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Content-Disposition\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"attachment;filename=export.xlsx\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token comment\">// å°† Excel å†™å…¥å“åº”è¾“å‡ºæµ</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        workbook<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">.</span><span class=\"token function\">getOutputStream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        workbook<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">IOException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">createPipeSectionSheet</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Workbook</span> workbook<span class=\"token punctuation\">,</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">FacGasPipeSection</span><span class=\"token punctuation\">></span></span> facGasPipeSections<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token class-name\">Sheet</span> sheet <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span><span class=\"token function\">createSheet</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ç®¡æ®µä¿¡æ¯\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token class-name\">Row</span> header <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span><span class=\"token function\">createRow</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token comment\">// åˆ›å»ºæ ‡é¢˜è¡Œ</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    header<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setCellValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ç®¡çº¿åç§°\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    header<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setCellValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ç®¡çº¿ç¼–ç \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    header<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setCellValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ç®¡æ®µåç§°\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    header<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setCellValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ç®¡æ®µç¼–ç \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    header<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setCellValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ç®¡æ®µé•¿åº¦\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    header<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setCellValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"å»ºè®¾çŠ¶æ€\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    <span class=\"token function\">fontStyle</span><span class=\"token punctuation\">(</span>workbook<span class=\"token punctuation\">,</span> header<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    <span class=\"token comment\">// å¡«å……æ•°æ®</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> facGasPipeSections<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>        <span class=\"token class-name\">Row</span> row <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span><span class=\"token function\">createRow</span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>        <span class=\"token class-name\">FacGasPipeSection</span> section <span class=\"token operator\">=</span> facGasPipeSections<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>        row<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setCellValue</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Optional</span><span class=\"token punctuation\">.</span><span class=\"token function\">ofNullable</span><span class=\"token punctuation\">(</span>section<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">FacGasPipeSection</span><span class=\"token operator\">::</span><span class=\"token function\">getPipelineName</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">orElse</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>        row<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setCellValue</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Optional</span><span class=\"token punctuation\">.</span><span class=\"token function\">ofNullable</span><span class=\"token punctuation\">(</span>section<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">FacGasPipeSection</span><span class=\"token operator\">::</span><span class=\"token function\">getPipelineCode</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">orElse</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>        row<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setCellValue</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Optional</span><span class=\"token punctuation\">.</span><span class=\"token function\">ofNullable</span><span class=\"token punctuation\">(</span>section<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">FacGasPipeSection</span><span class=\"token operator\">::</span><span class=\"token function\">getPipeSectionName</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">orElse</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>        row<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setCellValue</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Optional</span><span class=\"token punctuation\">.</span><span class=\"token function\">ofNullable</span><span class=\"token punctuation\">(</span>section<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">FacGasPipeSection</span><span class=\"token operator\">::</span><span class=\"token function\">getPipeSectionCode</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">orElse</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>        row<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setCellValue</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Optional</span><span class=\"token punctuation\">.</span><span class=\"token function\">ofNullable</span><span class=\"token punctuation\">(</span>section<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">FacGasPipeSection</span><span class=\"token operator\">::</span><span class=\"token function\">getPipeSectionLength</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">orElse</span><span class=\"token punctuation\">(</span><span class=\"token number\">0D</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>        row<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setCellValue</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Optional</span><span class=\"token punctuation\">.</span><span class=\"token function\">ofNullable</span><span class=\"token punctuation\">(</span>section<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">FacGasPipeSection</span><span class=\"token operator\">::</span><span class=\"token function\">getBuildStatus</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">orElse</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre></pre></td></tr><tr><td data-num=\"53\"></td><td><pre><span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">createStationYardSheet</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Workbook</span> workbook<span class=\"token punctuation\">,</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">FacGasStationYard</span><span class=\"token punctuation\">></span></span> facGasStationYards<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>    <span class=\"token class-name\">Sheet</span> sheet <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span><span class=\"token function\">createSheet</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ç«™åœºä¿¡æ¯\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>    <span class=\"token class-name\">Row</span> header <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span><span class=\"token function\">createRow</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>    <span class=\"token comment\">// åˆ›å»ºæ ‡é¢˜è¡Œ</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>    header<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setCellValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ç«™åœºåç§°\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>    header<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setCellValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ç«™åœºç¼–ç \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>    header<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setCellValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ç«™åœºç±»å‹\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>    header<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setCellValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ç«™åœºåŠŸèƒ½\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>    header<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setCellValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ç­‰çº§\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>    header<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setCellValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"å»ºè®¾çŠ¶æ€\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>    <span class=\"token function\">fontStyle</span><span class=\"token punctuation\">(</span>workbook<span class=\"token punctuation\">,</span> header<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>    <span class=\"token comment\">// å¡«å……æ•°æ®</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> facGasStationYards<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>        <span class=\"token class-name\">Row</span> row <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span><span class=\"token function\">createRow</span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>        <span class=\"token class-name\">FacGasStationYard</span> yard <span class=\"token operator\">=</span> facGasStationYards<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>        row<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setCellValue</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Optional</span><span class=\"token punctuation\">.</span><span class=\"token function\">ofNullable</span><span class=\"token punctuation\">(</span>yard<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">FacGasStationYard</span><span class=\"token operator\">::</span><span class=\"token function\">getStationName</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">orElse</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>        row<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setCellValue</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Optional</span><span class=\"token punctuation\">.</span><span class=\"token function\">ofNullable</span><span class=\"token punctuation\">(</span>yard<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">FacGasStationYard</span><span class=\"token operator\">::</span><span class=\"token function\">getStationCode</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">orElse</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>        row<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setCellValue</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Optional</span><span class=\"token punctuation\">.</span><span class=\"token function\">ofNullable</span><span class=\"token punctuation\">(</span>yard<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">FacGasStationYard</span><span class=\"token operator\">::</span><span class=\"token function\">getStationType</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">orElse</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>        row<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setCellValue</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Optional</span><span class=\"token punctuation\">.</span><span class=\"token function\">ofNullable</span><span class=\"token punctuation\">(</span>yard<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">FacGasStationYard</span><span class=\"token operator\">::</span><span class=\"token function\">getStationFun</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">orElse</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>        row<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setCellValue</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Optional</span><span class=\"token punctuation\">.</span><span class=\"token function\">ofNullable</span><span class=\"token punctuation\">(</span>yard<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">FacGasStationYard</span><span class=\"token operator\">::</span><span class=\"token function\">getGrade</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">orElse</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>        row<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setCellValue</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Optional</span><span class=\"token punctuation\">.</span><span class=\"token function\">ofNullable</span><span class=\"token punctuation\">(</span>yard<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">FacGasStationYard</span><span class=\"token operator\">::</span><span class=\"token function\">getBuildStatus</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">orElse</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre></pre></td></tr><tr><td data-num=\"80\"></td><td><pre><span class=\"token comment\">// è®¾ç½® excel å­—ä½“æ ·å¼</span></pre></td></tr><tr><td data-num=\"81\"></td><td><pre><span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">fontStyle</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Workbook</span> workbook<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Row</span> header<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre>    <span class=\"token class-name\">CellStyle</span> cellStyle <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span><span class=\"token function\">createCellStyle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre>    <span class=\"token class-name\">Font</span> font <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span><span class=\"token function\">createFont</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>    font<span class=\"token punctuation\">.</span><span class=\"token function\">setBold</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                                       <span class=\"token comment\">// åŠ ç²—</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>    font<span class=\"token punctuation\">.</span><span class=\"token function\">setFontHeightInPoints</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">short</span><span class=\"token punctuation\">)</span> <span class=\"token number\">12</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                   <span class=\"token comment\">// è®¾ç½®å­—ä½“å¤§å°</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre>    font<span class=\"token punctuation\">.</span><span class=\"token function\">setFontName</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"å¾®è½¯é›…é»‘\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                              <span class=\"token comment\">// è®¾ç½®å­—ä½“</span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre>    cellStyle<span class=\"token punctuation\">.</span><span class=\"token function\">setFont</span><span class=\"token punctuation\">(</span>font<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                                  <span class=\"token comment\">// å‘æ ·å¼é‡Œæ·»åŠ å­—ä½“è®¾ç½®</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre></pre></td></tr><tr><td data-num=\"89\"></td><td><pre>    <span class=\"token comment\">// å°†æ ·å¼åº”ç”¨åˆ°æ ‡é¢˜è¡Œçš„æ¯ä¸ªå•å…ƒæ ¼</span></pre></td></tr><tr><td data-num=\"90\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> header<span class=\"token punctuation\">.</span><span class=\"token function\">getPhysicalNumberOfCells</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"91\"></td><td><pre>        header<span class=\"token punctuation\">.</span><span class=\"token function\">getCell</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setCellStyle</span><span class=\"token punctuation\">(</span>cellStyle<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"92\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"93\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure>",
            "tags": [
                "è®¡ç®—æœºå­¦ç§‘",
                "java",
                "ç¬¬ä¸‰æ–¹åº“",
                "è®¡ç®—æœºå­¦ç§‘",
                "ç¬¬ä¸‰æ–¹åº“",
                "poi"
            ]
        },
        {
            "id": "https://pigpigletsgo.github.io/essay/%E5%89%8D%E5%90%8E%E7%AB%AF%E8%81%94%E8%B0%83%E6%80%BB/",
            "url": "https://pigpigletsgo.github.io/essay/%E5%89%8D%E5%90%8E%E7%AB%AF%E8%81%94%E8%B0%83%E6%80%BB/",
            "title": "å‰åç«¯è”è°ƒæ€»",
            "date_published": "2024-08-11T08:29:40.408Z",
            "content_html": "<h1 id=\"å‰åç«¯è”è°ƒæ€»\"><a class=\"anchor\" href=\"#å‰åç«¯è”è°ƒæ€»\">#</a> å‰åç«¯è”è°ƒæ€»</h1>\n<h2 id=\"ä¸ºä»€ä¹ˆéœ€è¦è”è°ƒ\"><a class=\"anchor\" href=\"#ä¸ºä»€ä¹ˆéœ€è¦è”è°ƒ\">#</a> ä¸ºä»€ä¹ˆéœ€è¦è”è°ƒ</h2>\n<blockquote>\n<p>è”è°ƒå°±æ˜¯</p>\n</blockquote>\n<blockquote>\n<ol>\n<li>è”è°ƒæ˜¯å‰åç«¯ä¸€èµ·è§è¯é è°±çš„æµ‹è¯•ç»“æœ</li>\n<li>ç»™éœ€æ±‚æ–¹æä¾›ä¸€ä¸ªæ­£ç¡®çš„éœ€æ±‚éªŒè¯ç¯å¢ƒ</li>\n<li>å°½æ—©æš´æ¼å‰åç«¯å®ç°çš„é—®é¢˜</li>\n</ol>\n</blockquote>\n<h2 id=\"å¦‚ä½•æœ‰æ•ˆçš„è”è°ƒ\"><a class=\"anchor\" href=\"#å¦‚ä½•æœ‰æ•ˆçš„è”è°ƒ\">#</a> å¦‚ä½•æœ‰æ•ˆçš„è”è°ƒ</h2>\n<h3 id=\"è”è°ƒå‰å·¥ä½œ\"><a class=\"anchor\" href=\"#è”è°ƒå‰å·¥ä½œ\">#</a> è”è°ƒå‰å·¥ä½œ</h3>\n<h4 id=\"1éœ€æ±‚åˆ†æ\"><a class=\"anchor\" href=\"#1éœ€æ±‚åˆ†æ\">#</a> 1ï¼Œéœ€æ±‚åˆ†æ</h4>\n<ul>\n<li>ç†è§£éœ€æ±‚ï¼šä¸äº§å“ç»ç†æˆ–éœ€æ±‚æ–¹æ²Ÿé€šï¼Œæ˜ç¡®åŠŸèƒ½éœ€æ±‚ï¼Œç†è§£ä¸šåŠ¡é€»è¾‘ï¼Œç¡®ä¿æ— é—æ¼æˆ–è¯¯è§£</li>\n<li>API æ¥å£è®¾è®¡ï¼šç¡®å®šåŠŸèƒ½éœ€è¦çš„ API æ¥å£ï¼ŒåŒ…æ‹¬æ¥å£çš„è·¯å¾„ï¼Œè¯·æ±‚æ–¹å¼ (GETï¼ŒPOST ç­‰)ï¼Œè¯·æ±‚å‚æ•° (è€ƒè™‘èƒ½ä¸èƒ½ä¼ ï¼Œæ˜¯å¦éœ€è¦ä¼ )ï¼Œè¿”å›å€¼ç»“æ„å’ŒçŠ¶æ€ç  (æå‰æ²Ÿé€šå‰ç«¯è¿”å›ä»€ä¹ˆæ ·çš„æ•°æ®æ ¼å¼æ¯”è¾ƒåˆé€‚)</li>\n</ul>\n<h4 id=\"2ä¸šåŠ¡é€»è¾‘å®ç°\"><a class=\"anchor\" href=\"#2ä¸šåŠ¡é€»è¾‘å®ç°\">#</a> 2ï¼Œä¸šåŠ¡é€»è¾‘å®ç°</h4>\n<ul>\n<li>Service å±‚å¼€å‘ï¼šå®ç°å…·ä½“çš„ä¸šåŠ¡é€»è¾‘ï¼ŒåŒ…æ‹¬æ•°æ®å¤„ç†ï¼Œæ ¡éªŒï¼Œäº‹åŠ¡ç®¡ç†ç­‰ã€‚</li>\n<li>Repository/DAO å±‚å¼€å‘ï¼šå®ç°æ•°æ®è®¿é—®å±‚ï¼Œç¼–å†™æ•°æ®æŸ¥è¯¢ï¼Œæ’å…¥ï¼Œæ›´æ–°ç­‰æ“ä½œ</li>\n<li>æµ‹è¯•ç”¨ä¾‹ç¼–å†™ï¼šä¸ºä¸šåŠ¡é€»è¾‘ç¼–å†™å•å…ƒæµ‹è¯•ç”¨ä¾‹ï¼Œç¡®ä¿ä»£ç åŠŸèƒ½æ­£ç¡®</li>\n</ul>\n<h4 id=\"3apiå¼€å‘\"><a class=\"anchor\" href=\"#3apiå¼€å‘\">#</a> 3ï¼ŒAPI å¼€å‘</h4>\n<ul>\n<li>æ§åˆ¶å™¨å¼€å‘ï¼šå¼€å‘å¯¹åº”çš„æ§åˆ¶å™¨ï¼Œç¼–å†™å¤„ç†è¯·æ±‚çš„æ¥å£é€»è¾‘ï¼Œè°ƒç”¨ Service å±‚å®Œæˆä¸šåŠ¡å¤„ç†</li>\n<li>æ•°æ®æ ¡éªŒï¼šå¯¹è¯·æ±‚å‚æ•°è¿›è¡Œæ ¡éªŒï¼Œç¡®ä¿æ•°æ®æ ¼å¼å’Œå†…å®¹ç¬¦åˆè¦æ±‚</li>\n<li>å¼‚å¸¸å¤„ç†ï¼šç¼–å†™å…¨å±€å¼‚å¸¸å¤„ç†ï¼Œç¡®ä¿å½“å‘ç”Ÿé”™è¯¯æ—¶è¿”å›ç»Ÿä¸€çš„é”™è¯¯ä¿¡æ¯</li>\n</ul>\n<h4 id=\"4æ¥å£æ–‡æ¡£ç¼–å†™\"><a class=\"anchor\" href=\"#4æ¥å£æ–‡æ¡£ç¼–å†™\">#</a> 4ï¼Œæ¥å£æ–‡æ¡£ç¼–å†™</h4>\n<ul>\n<li>API æ–‡æ¡£ç¼–å†™ï¼šä½¿ç”¨ Swaggerï¼ŒPostman ç­‰å·¥å…·ç”Ÿæˆ API æ–‡æ¡£ï¼Œè¯¦ç»†æè¿°æ¥å£çš„ä½¿ç”¨æ–¹æ³•ï¼Œå‚æ•°ï¼Œè¿”å›ç»“æœç­‰ï¼Œæ–¹ä¾¿å‰ç«¯å’Œæµ‹è¯•äººå‘˜å‚è€ƒ</li>\n<li>Mock æ•°æ®æä¾›ï¼šæä¾›æ¥å£çš„ Mock æ•°æ®ï¼Œå¸®åŠ©å‰ç«¯åœ¨åç«¯æ¥å£å°šæœªå®Œæˆæ—¶è¿›è¡Œå¼€å‘å’Œæµ‹è¯•</li>\n</ul>\n<h3 id=\"è‡ªæµ‹\"><a class=\"anchor\" href=\"#è‡ªæµ‹\">#</a> è‡ªæµ‹</h3>\n<blockquote>\n<p>è”è°ƒçš„æ—¶å€™å°é—®é¢˜ä¸æ–­ï¼Œå¤§é—®é¢˜åŠ ç­</p>\n<p>é—®é¢˜ï¼šè”è°ƒä¹‹å‰å‰ç«¯ä¸çŸ¥é“åç«¯è¿”å›è¿‡æ¥çš„æ•°æ®ç»“æ„å¤§æ¦‚æ˜¯ä»€ä¹ˆæ ·çš„ï¼Œè°ƒç”¨åç«¯æ¥å£æ—¶å°é—®é¢˜ä¸æ–­ï¼Œæ•°æ®ä¸å®Œæ•´ï¼Œæµç¨‹èµ°ä¸ä¸‹å»ï¼Œè¿ä¸€ä¸ªèƒ½æ­£å¸¸èµ°ä¸‹å»çš„æµ‹è¯•æ•°æ®éƒ½æ‹¿ä¸å‡ºæ¥</p>\n</blockquote>\n<blockquote>\n<p>è§£å†³æ–¹æ¡ˆï¼šè‡ªæµ‹è‡ªæµ‹è‡ªæµ‹ï¼ï¼ï¼ï¼Œé‡è¦çš„äº‹æƒ…è¯´ 3 éï¼Œå¦‚æœè‡ªæµ‹å‘ç°ï¼Œè§£å†³é—®é¢˜è€—æ—¶ä¸º 1ï¼Œé‚£ä¹ˆè”è°ƒå‘ç°ï¼Œè§£å†³çš„é—®é¢˜ç»å¯¹ä¸æ˜¯ 1 + 1 é‚£ä¹ˆç®€å•ã€‚ä¸€å®šè¦æœ‰ä¸€ä¸ªäººçŸ¥é“æ•°æ®çš„è¿”å›ç»“æ„å¤§æ¦‚æ˜¯ä»€ä¹ˆæ ·å­ï¼Œä¿è¯åç«¯æ¯ä¸ªåˆ¤æ–­åˆ†æ”¯æµ‹è¯•è·‘åˆ°ä½ï¼Œå“ªäº›åœ°æ–¹è¿”å›å€¼æ²¡æœ‰æ˜¯æ­£ç¡®çš„ï¼Œå“ªäº›åœ°æ–¹æ²¡æœ‰è¿”å›å€¼æ˜¯ä¸æ­£ç¡®çš„</p>\n</blockquote>\n<h2 id=\"å¿«é€Ÿå®šä½é—®é¢˜\"><a class=\"anchor\" href=\"#å¿«é€Ÿå®šä½é—®é¢˜\">#</a> å¿«é€Ÿå®šä½é—®é¢˜</h2>\n<blockquote>\n<p>å‰ç«¯å¯¹äºæ¥å£è°ƒç”¨çš„åé¦ˆå°±æ˜¯ä¸€å¥è¯ï¼Œæ¥å£æœ‰é—®é¢˜ï¼</p>\n<p>é—®é¢˜ï¼šé‡åˆ°é—®é¢˜å•¥ä¹Ÿä¸è¯´æ¥ï¼Œ404 æ‰¾ä¸åˆ°æ¥å£è·¯å¾„ï¼Ÿ500 å†…éƒ¨æœåŠ¡å™¨é”™è¯¯ï¼Ÿè¿˜æ˜¯æç¤ºä¼ å…¥å‚æ•°æ ¼å¼ä¸å¯¹ï¼Œå‚æ•°åç§°é”™è¯¯ï¼Ÿå®Œå…¨ä¸çŸ¥é“ï¼Œé—®é¢˜éš¾ä»¥å®šä½ï¼Œç®€å•é—®é¢˜å¤æ‚åŒ–</p>\n</blockquote>\n<blockquote>\n<p>è§£å†³æ–¹æ¡ˆï¼šF12 çœ‹ä¸€ä¸‹ï¼Œæ‰¾ä¸åˆ°æ¥å£ï¼Œswagger é¡µé¢æ‰¾ä¸€ä¸‹ã€‚è¿”å›é”™è¯¯æç¤ºæˆªä¸ªå›¾ï¼Œswagger è°ƒç”¨æ¥å£è·¯å¾„å’Œå‚æ•°å‘ä¸€ä¸‹ï¼Œåç«¯è‡ªè¡Œæ’æŸ¥</p>\n</blockquote>\n<h2 id=\"è´£ä»»è¾¹ç•Œ\"><a class=\"anchor\" href=\"#è´£ä»»è¾¹ç•Œ\">#</a> è´£ä»»è¾¹ç•Œ</h2>\n<blockquote>\n<p>åç«¯ A æƒ³æŠŠåˆ¤æ–­æ”¾åˆ°å‰ç«¯ B åšï¼Œå‰ç«¯ B æƒ³æŠŠæ•°æ®æ ¼å¼æ”¾åˆ°åç«¯ A åš</p>\n<p>é—®é¢˜ï¼šA åœ¨å¿™ï¼Œå°±æƒ³ B æ¥åšã€‚A åæ­£ä¹Ÿåœ¨è¯¥ç±»ä¼¼çš„ï¼Œå°±æƒ³ A æŠŠ B çš„é€»è¾‘å†™åœ¨å‰ç«¯ã€‚A ä¸æ„¿æ„æ”¹ï¼Œå‡­ä»€ä¹ˆæˆ‘æ”¹ï¼Œå°±æƒ³ B æ¥æ”¹ã€‚A è§‰å¾— B èœï¼Œæ‹’ç»æ²Ÿé€š --&gt; æˆ‘ä¸ç®¡åæ­£æˆ‘æ˜¯å¥½çš„</p>\n</blockquote>\n<blockquote>\n<p>è§£å†³æ–¹æ¡ˆï¼šåˆ¤æ–­å°½é‡æ”¾åˆ°åç«¯åšï¼Œæ•°æ®æ ¼å¼åŒ–éƒ½èƒ½åšï¼Œè¿™éƒ½æ˜¯å¸¸è§„å¥½åˆ†æ¸…çš„ã€‚éš¾å°±éš¾åœ¨ä¸¤äººèŒä½ä¸€è‡´ï¼Œæ²¡æœ‰é«˜ä½ä¹‹åˆ†ï¼Œè€å¤§åªçœ‹ç»“æœä¸ç®¡è°å»åšã€‚æœ¬èº«ä¸¤äººå¯èƒ½å°±æ˜¯ç¬¬ä¸€æ¬¡é…åˆä¸å¤Ÿé»˜å¥‘ï¼Œå¯èƒ½èƒ½åŠ›ä¹Ÿå·®ç‚¹äº’ç›¸å«Œå¼ƒï¼Œæ€§å­åˆéƒ½æ¯”è¾ƒæ€¥ï¼Œå·¥æœŸç´§å¼ å‚¬çš„å¾ˆæ€¥ï¼Œæ²¡æœ‰äººå…·ä½“è·Ÿè¿›ï¼Œè´£ä»»è¾¹ç•Œä¸æ˜æ˜¾è°ä¹ŸæŒ‡æŒ¥ä¸äº†è°ã€‚è¿™ä¸ªæ—¶å€™ä¸€å®šè¦åˆ’åˆ†è´£ä»»è¾¹ç•Œï¼Œä¸ä»…ä»…æ˜¯è¿›åº¦ï¼Œè¿˜è¦åˆ°å…·ä½“ç»†èŠ‚ï¼Œç”šè‡³æ˜¯å…·ä½“åˆ°æŸä¸€ä¸ªå‚æ•°</p>\n</blockquote>\n<h2 id=\"åŠæ—¶åé¦ˆ\"><a class=\"anchor\" href=\"#åŠæ—¶åé¦ˆ\">#</a> åŠæ—¶åé¦ˆ</h2>\n<blockquote>\n<p>åç«¯ï¼šæ¥å£éƒ½æ²¡é—®é¢˜ï¼Œå‰ç«¯ï¼šé¡µé¢éƒ½æ²¡é—®é¢˜ï¼Œæœ€ç»ˆäº¤ä»˜ = åŠ ç­</p>\n<p>é—®é¢˜ï¼šåç«¯ï¼šé¡µé¢ç”»çš„å•¥ï¼Œæ•°æ®æ€ä¹ˆæ”¾ï¼Ÿå‰ç«¯ï¼šæ•°æ®ç»™çš„å•¥ï¼Ÿ</p>\n</blockquote>\n<blockquote>\n<p>è§£å†³é—®é¢˜ï¼šåç«¯æ•°æ®åº“é‡Œé¢ä¸€å®šè¦æœ‰æµ‹è¯•æ•°æ®ï¼Œè€Œä¸æ˜¯å·²è·‘é€šä¸æŠ¥é”™ä¸ºç›®çš„ã€‚å‰ç«¯ä¸€å®šè¦æ ¹æ®å½“åˆçº¦å®šå¥½çš„æ•°æ®æ ¼å¼è¦æ±‚åç«¯ï¼Œè¯¥è¦æ•°ç»„è¦æ•°ç»„ï¼Œè¯¥è¦æ ‘ç»“æ„è¦æ ‘ç»“æ„ã€‚æ¥å£æ²¡æœ‰è¿”å›æ•°æ®ä¸€å®šè¦åé¦ˆå‰ç«¯ï¼Œä¸è¦ä»¥ä¸æŠ¥é”™ä¸ºç›®çš„ï¼Œæ•°æ®æ„Ÿè§‰ä¸å¯¹ä¸è¦ä¸ç®¡ä¸é—®ï¼Œç”šè‡³äºå»å…¶ä»–é¡µé¢ &quot;å€Ÿ&quot; ä¸€äº›è«æ— é¡»æœ‰çš„å€¼</p>\n</blockquote>\n<h1 id=\"çœŸæ­£çš„è”è°ƒ\"><a class=\"anchor\" href=\"#çœŸæ­£çš„è”è°ƒ\">#</a> çœŸæ­£çš„è”è°ƒ</h1>\n<ol>\n<li>å‰ç«¯å®Œæˆè‡ªæµ‹</li>\n<li>åç«¯å®Œæˆè‡ªæµ‹</li>\n<li>å‰ï¼Œåç«¯éƒ½æ˜ç¡®çŸ¥é“éœ€æ±‚æ–¹æƒ³è¦ä»€ä¹ˆï¼Œä¸€èµ·éªŒè¯éœ€æ±‚çš„å®ç°ï¼Œæœ‰ä¸€å®šè‡ªå·±çš„çœ‹æ³•</li>\n</ol>\n<h2 id=\"å»ºè®®\"><a class=\"anchor\" href=\"#å»ºè®®\">#</a> å»ºè®®</h2>\n<h3 id=\"è¿œç¦»å…³é”®è·¯å¾„åˆç†è°ƒé…æ—¶é—´\"><a class=\"anchor\" href=\"#è¿œç¦»å…³é”®è·¯å¾„åˆç†è°ƒé…æ—¶é—´\">#</a> è¿œç¦»å…³é”®è·¯å¾„ï¼Œåˆç†è°ƒé…æ—¶é—´</h3>\n<blockquote>\n<p>æŒ‰æ—¶å®Œæˆä»»åŠ¡ï¼Œç•™è¶³æ—¶é—´è‡ªæµ‹ï¼Œåˆ«æ‹–åè…¿</p>\n</blockquote>\n<h3 id=\"æŠŠæ¡å…¨å±€è¿›åº¦æé«˜æ•´ä½“æ•ˆç‡\"><a class=\"anchor\" href=\"#æŠŠæ¡å…¨å±€è¿›åº¦æé«˜æ•´ä½“æ•ˆç‡\">#</a> æŠŠæ¡å…¨å±€è¿›åº¦ï¼Œæé«˜æ•´ä½“æ•ˆç‡</h3>\n<blockquote>\n<p>ç»™äº†ä½ é¡¹ç›®çš„æƒåˆ©ï¼Œå°±è¦è‚©è´Ÿèµ·é¡¹ç›®çš„æ¨åŠ¨ï¼Œåˆ«ä»»ç”±å‰åç«¯æ‰¯çš®æµªè´¹æ—¶é—´</p>\n</blockquote>\n<h3 id=\"ç§¯ææ²Ÿé€šäº¤æµä¸»åŠ¨æ¨è¿›è”è°ƒ\"><a class=\"anchor\" href=\"#ç§¯ææ²Ÿé€šäº¤æµä¸»åŠ¨æ¨è¿›è”è°ƒ\">#</a> ç§¯ææ²Ÿé€šäº¤æµï¼Œä¸»åŠ¨æ¨è¿›è”è°ƒ</h3>\n<blockquote>\n<p>ä¸»åŠ¨æ²Ÿé€šï¼Œé¡¹ç›®é™¤äº†é—®é¢˜ä¸æ˜¯ä¸€ä¸ªäººçš„äº‹æƒ…ï¼Œæ˜¯å¤§å®¶çš„äº‹æƒ…ï¼Œåˆ«ç”©é”…ï¼Œä¹Ÿè®¸è¿™æ¬¡ä½ çš„è´£ä»»æ¯”è¾ƒå°ï¼Œä½†æ˜¯ä½ çš„æ€åº¦å·²ç»å†³å®šäº†å¾ˆå¤šäººå¯¹ä½ çš„æ€åº¦</p>\n</blockquote>\n",
            "tags": [
                "essay",
                "æ–‡ç« "
            ]
        },
        {
            "id": "https://pigpigletsgo.github.io/computer-science/blog/geometry/geometry-shp%E6%96%87%E4%BB%B6%E5%AF%BC%E5%87%BA/",
            "url": "https://pigpigletsgo.github.io/computer-science/blog/geometry/geometry-shp%E6%96%87%E4%BB%B6%E5%AF%BC%E5%87%BA/",
            "title": "geometry-shpæ–‡ä»¶å¯¼å‡º",
            "date_published": "2024-08-09T06:51:33.464Z",
            "content_html": "<h1 id=\"geometry-shpæ–‡ä»¶å¯¼å‡º\"><a class=\"anchor\" href=\"#geometry-shpæ–‡ä»¶å¯¼å‡º\">#</a> geometry-shp æ–‡ä»¶å¯¼å‡º</h1>\n<p>1ï¼Œå¯¼å…¥ä¾èµ–</p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>org.geotools<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>gt-shapefile<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>$&#123;geotools.version&#125;<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>org.geotools<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>gt-swing<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>$&#123;geotools.version&#125;<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>org.geotools<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>gt-geojson<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>$&#123;geotools.version&#125;<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>org.geotools.jdbc<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>gt-jdbc-postgis<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>$&#123;geotools.version&#125;<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>org.geotools<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>gt-epsg-hsql<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>$&#123;geotools.version&#125;<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>org.geotools<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>gt-opengis<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>$&#123;geotools.version&#125;<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p>2ï¼Œå¯¼å…¥å·¥å…·ç±»</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">package</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>supermap<span class=\"token punctuation\">.</span>jczcpt<span class=\"token punctuation\">.</span>pipe<span class=\"token punctuation\">.</span>manage<span class=\"token punctuation\">.</span>planninganalysis<span class=\"token punctuation\">.</span>util</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>geotools<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">FeatureWriter</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>geotools<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Transaction</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>geotools<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>shapefile<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">ShapefileDataStore</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>geotools<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>shapefile<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">ShapefileDataStoreFactory</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>geotools<span class=\"token punctuation\">.</span>feature<span class=\"token punctuation\">.</span>simple<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">SimpleFeatureTypeBuilder</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>geotools<span class=\"token punctuation\">.</span>referencing<span class=\"token punctuation\">.</span>crs<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">DefaultGeographicCRS</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>locationtech<span class=\"token punctuation\">.</span>jts<span class=\"token punctuation\">.</span>geom<span class=\"token punctuation\">.</span></span><span class=\"token operator\">*</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>opengis<span class=\"token punctuation\">.</span>feature<span class=\"token punctuation\">.</span>simple<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">SimpleFeature</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>opengis<span class=\"token punctuation\">.</span>feature<span class=\"token punctuation\">.</span>simple<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">SimpleFeatureType</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre> </pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>io<span class=\"token punctuation\">.</span></span><span class=\"token operator\">*</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>nio<span class=\"token punctuation\">.</span>charset<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Charset</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">HashMap</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">List</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Map</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>zip<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">ZipEntry</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>zip<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">ZipOutputStream</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre> </pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ShapeUtil</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre> </pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"24\"></td><td><pre>     * ç”Ÿæˆ shape æ–‡ä»¶</pre></td></tr><tr><td data-num=\"25\"></td><td><pre>     *</pre></td></tr><tr><td data-num=\"26\"></td><td><pre>     * @param shpPath ç”Ÿæˆ shape æ–‡ä»¶è·¯å¾„ï¼ˆåŒ…å«æ–‡ä»¶åç§°ï¼‰</pre></td></tr><tr><td data-num=\"27\"></td><td><pre>     * @param encode  ç¼–ç </pre></td></tr><tr><td data-num=\"28\"></td><td><pre>     * @param geoType å›¾å¹…ç±»å‹ï¼ŒPoint å’Œ Rolygon</pre></td></tr><tr><td data-num=\"29\"></td><td><pre>     * @param geoms   å›¾å¹…é›†åˆ</pre></td></tr><tr><td data-num=\"30\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">write2Shape</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> shpPath<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> encode<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> geoType<span class=\"token punctuation\">,</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Geometry</span><span class=\"token punctuation\">></span></span> geoms<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>            <span class=\"token comment\">// åˆ›å»º shape æ–‡ä»¶å¯¹è±¡</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>            <span class=\"token class-name\">File</span> file <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">(</span>shpPath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>            <span class=\"token class-name\">Map</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Serializable</span><span class=\"token punctuation\">></span></span> params <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HashMap</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>            params<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ShapefileDataStoreFactory</span><span class=\"token punctuation\">.</span><span class=\"token constant\">URLP</span><span class=\"token punctuation\">.</span>key<span class=\"token punctuation\">,</span> file<span class=\"token punctuation\">.</span><span class=\"token function\">toURI</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toURL</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>            <span class=\"token class-name\">ShapefileDataStore</span> ds <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">ShapefileDataStore</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ShapefileDataStoreFactory</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">createNewDataStore</span><span class=\"token punctuation\">(</span>params<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>            <span class=\"token comment\">// å®šä¹‰å›¾å½¢ä¿¡æ¯å’Œå±æ€§ä¿¡æ¯</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>            <span class=\"token class-name\">SimpleFeatureTypeBuilder</span> tb <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SimpleFeatureTypeBuilder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>            tb<span class=\"token punctuation\">.</span><span class=\"token function\">setCRS</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">DefaultGeographicCRS</span><span class=\"token punctuation\">.</span><span class=\"token constant\">WGS84</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>            tb<span class=\"token punctuation\">.</span><span class=\"token function\">setName</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"shapefile\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre> </pre></td></tr><tr><td data-num=\"43\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"Polygon\"</span><span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span>geoType<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>                tb<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"the_geom\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Polygon</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"MultiPolygon\"</span><span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span>geoType<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>                tb<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"the_geom\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">MultiPolygon</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"Point\"</span><span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span>geoType<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>                tb<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"the_geom\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Point</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"MultiPoint\"</span><span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span>geoType<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>                tb<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"the_geom\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">MultiPoint</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"LineString\"</span><span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span>geoType<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>                tb<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"the_geom\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">LineString</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"MultiLineString\"</span><span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span>geoType<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>                tb<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"the_geom\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">MultiLineString</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>                <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Exception</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Geometryä¸­æ²¡æœ‰è¯¥ç±»å‹ï¼š\"</span> <span class=\"token operator\">+</span> geoType<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre> </pre></td></tr><tr><td data-num=\"59\"></td><td><pre>            ds<span class=\"token punctuation\">.</span><span class=\"token function\">createSchema</span><span class=\"token punctuation\">(</span>tb<span class=\"token punctuation\">.</span><span class=\"token function\">buildFeatureType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>            <span class=\"token comment\">// è®¾ç½®ç¼–ç </span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>            <span class=\"token class-name\">Charset</span> charset <span class=\"token operator\">=</span> <span class=\"token class-name\">Charset</span><span class=\"token punctuation\">.</span><span class=\"token function\">forName</span><span class=\"token punctuation\">(</span>encode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>            ds<span class=\"token punctuation\">.</span><span class=\"token function\">setCharset</span><span class=\"token punctuation\">(</span>charset<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>            <span class=\"token comment\">// è®¾ç½® Writer</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>            <span class=\"token class-name\">FeatureWriter</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">SimpleFeatureType</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">SimpleFeature</span><span class=\"token punctuation\">></span></span> writer <span class=\"token operator\">=</span> ds<span class=\"token punctuation\">.</span><span class=\"token function\">getFeatureWriter</span><span class=\"token punctuation\">(</span>ds<span class=\"token punctuation\">.</span><span class=\"token function\">getTypeNames</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Transaction</span><span class=\"token punctuation\">.</span><span class=\"token constant\">AUTO_COMMIT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>            <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Geometry</span> geom <span class=\"token operator\">:</span> geoms<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>                <span class=\"token comment\">//String type = geom.getGeometryType();</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre> </pre></td></tr><tr><td data-num=\"68\"></td><td><pre>                <span class=\"token comment\">// å†™ä¸‹ä¸€æ¡</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>                <span class=\"token class-name\">SimpleFeature</span> feature <span class=\"token operator\">=</span> writer<span class=\"token punctuation\">.</span><span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre> </pre></td></tr><tr><td data-num=\"71\"></td><td><pre>                feature<span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"the_geom\"</span><span class=\"token punctuation\">,</span> geom<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>            writer<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>            writer<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>            ds<span class=\"token punctuation\">.</span><span class=\"token function\">dispose</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>            e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre> </pre></td></tr><tr><td data-num=\"81\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"82\"></td><td><pre>     * ç”Ÿæˆ shape æ–‡ä»¶</pre></td></tr><tr><td data-num=\"83\"></td><td><pre>     *</pre></td></tr><tr><td data-num=\"84\"></td><td><pre>     * @param shpPath  ç”Ÿæˆ shape æ–‡ä»¶è·¯å¾„ï¼ˆåŒ…å«æ–‡ä»¶åç§°ï¼‰</pre></td></tr><tr><td data-num=\"85\"></td><td><pre>     * @param encode   ç¼–ç </pre></td></tr><tr><td data-num=\"86\"></td><td><pre>     * @param geoType  å›¾å¹…ç±»å‹ï¼ŒPoint å’Œ Rolygon</pre></td></tr><tr><td data-num=\"87\"></td><td><pre>     * @param shpKey   data ä¸­å›¾å¹…çš„ key</pre></td></tr><tr><td data-num=\"88\"></td><td><pre>     * @param attrKeys å±æ€§ key é›†åˆ</pre></td></tr><tr><td data-num=\"89\"></td><td><pre>     * @param data     å›¾å¹…å’Œå±æ€§é›†åˆ</pre></td></tr><tr><td data-num=\"90\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"91\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">write2Shape</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> shpPath<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> encode<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> geoType<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> shpKey<span class=\"token punctuation\">,</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> attrKeys<span class=\"token punctuation\">,</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Map</span><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">></span><span class=\"token punctuation\">></span></span> data<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"92\"></td><td><pre>        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"93\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>data <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">||</span> data<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"94\"></td><td><pre>                <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"95\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"96\"></td><td><pre>            <span class=\"token comment\">// åˆ›å»º shape æ–‡ä»¶å¯¹è±¡</span></pre></td></tr><tr><td data-num=\"97\"></td><td><pre>            <span class=\"token class-name\">File</span> file <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">(</span>shpPath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"98\"></td><td><pre>            <span class=\"token class-name\">Map</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Serializable</span><span class=\"token punctuation\">></span></span> params <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HashMap</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"99\"></td><td><pre>            params<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ShapefileDataStoreFactory</span><span class=\"token punctuation\">.</span><span class=\"token constant\">URLP</span><span class=\"token punctuation\">.</span>key<span class=\"token punctuation\">,</span> file<span class=\"token punctuation\">.</span><span class=\"token function\">toURI</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toURL</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"100\"></td><td><pre>            <span class=\"token class-name\">ShapefileDataStore</span> ds <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">ShapefileDataStore</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ShapefileDataStoreFactory</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">createNewDataStore</span><span class=\"token punctuation\">(</span>params<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"101\"></td><td><pre> </pre></td></tr><tr><td data-num=\"102\"></td><td><pre>            <span class=\"token comment\">// å®šä¹‰å›¾å½¢ä¿¡æ¯å’Œå±æ€§ä¿¡æ¯</span></pre></td></tr><tr><td data-num=\"103\"></td><td><pre>            <span class=\"token class-name\">SimpleFeatureTypeBuilder</span> tb <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SimpleFeatureTypeBuilder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"104\"></td><td><pre>            tb<span class=\"token punctuation\">.</span><span class=\"token function\">setCRS</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">DefaultGeographicCRS</span><span class=\"token punctuation\">.</span><span class=\"token constant\">WGS84</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"105\"></td><td><pre>            tb<span class=\"token punctuation\">.</span><span class=\"token function\">setName</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"shapefile\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"106\"></td><td><pre> </pre></td></tr><tr><td data-num=\"107\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"Polygon\"</span><span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span>geoType<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"108\"></td><td><pre>                tb<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"the_geom\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Polygon</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"109\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"MultiPolygon\"</span><span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span>geoType<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"110\"></td><td><pre>                tb<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"the_geom\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">MultiPolygon</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"111\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"Point\"</span><span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span>geoType<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"112\"></td><td><pre>                tb<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"the_geom\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Point</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"113\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"MultiPoint\"</span><span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span>geoType<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"114\"></td><td><pre>                tb<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"the_geom\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">MultiPoint</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"115\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"LineString\"</span><span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span>geoType<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"116\"></td><td><pre>                tb<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"the_geom\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">LineString</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"117\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"MultiLineString\"</span><span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span>geoType<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"118\"></td><td><pre>                tb<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"the_geom\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">MultiLineString</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"119\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"120\"></td><td><pre>                <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Exception</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Geometryä¸­æ²¡æœ‰è¯¥ç±»å‹ï¼š\"</span> <span class=\"token operator\">+</span> geoType<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"121\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"122\"></td><td><pre> </pre></td></tr><tr><td data-num=\"123\"></td><td><pre>            <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> field <span class=\"token operator\">:</span> attrKeys<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"124\"></td><td><pre>                tb<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>field<span class=\"token punctuation\">.</span><span class=\"token function\">toUpperCase</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"125\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"126\"></td><td><pre> </pre></td></tr><tr><td data-num=\"127\"></td><td><pre>            ds<span class=\"token punctuation\">.</span><span class=\"token function\">createSchema</span><span class=\"token punctuation\">(</span>tb<span class=\"token punctuation\">.</span><span class=\"token function\">buildFeatureType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"128\"></td><td><pre>            <span class=\"token comment\">// è®¾ç½®ç¼–ç </span></pre></td></tr><tr><td data-num=\"129\"></td><td><pre>            <span class=\"token class-name\">Charset</span> charset <span class=\"token operator\">=</span> <span class=\"token class-name\">Charset</span><span class=\"token punctuation\">.</span><span class=\"token function\">forName</span><span class=\"token punctuation\">(</span>encode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"130\"></td><td><pre>            ds<span class=\"token punctuation\">.</span><span class=\"token function\">setCharset</span><span class=\"token punctuation\">(</span>charset<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"131\"></td><td><pre>            <span class=\"token comment\">// è®¾ç½® Writer</span></pre></td></tr><tr><td data-num=\"132\"></td><td><pre>            <span class=\"token class-name\">FeatureWriter</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">SimpleFeatureType</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">SimpleFeature</span><span class=\"token punctuation\">></span></span> writer <span class=\"token operator\">=</span> ds<span class=\"token punctuation\">.</span><span class=\"token function\">getFeatureWriter</span><span class=\"token punctuation\">(</span>ds<span class=\"token punctuation\">.</span><span class=\"token function\">getTypeNames</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Transaction</span><span class=\"token punctuation\">.</span><span class=\"token constant\">AUTO_COMMIT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"133\"></td><td><pre>            <span class=\"token comment\">// å†™å…¥æ–‡ä»¶ä¿¡æ¯</span></pre></td></tr><tr><td data-num=\"134\"></td><td><pre>            <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> data<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"135\"></td><td><pre>                <span class=\"token class-name\">SimpleFeature</span> feature <span class=\"token operator\">=</span> writer<span class=\"token punctuation\">.</span><span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"136\"></td><td><pre>                <span class=\"token class-name\">Map</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">></span></span> row <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"137\"></td><td><pre>                <span class=\"token class-name\">Geometry</span> geom <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Geometry</span><span class=\"token punctuation\">)</span> row<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>shpKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"138\"></td><td><pre>                feature<span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"the_geom\"</span><span class=\"token punctuation\">,</span> geom<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"139\"></td><td><pre>                <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> key <span class=\"token operator\">:</span> row<span class=\"token punctuation\">.</span><span class=\"token function\">keySet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"140\"></td><td><pre>                    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>key<span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span>shpKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"141\"></td><td><pre>                        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>row<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"142\"></td><td><pre>                            feature<span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">.</span><span class=\"token function\">toUpperCase</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> row<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"143\"></td><td><pre>                        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"144\"></td><td><pre>                            feature<span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">.</span><span class=\"token function\">toUpperCase</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"145\"></td><td><pre>                        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"146\"></td><td><pre>                    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"147\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"148\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"149\"></td><td><pre>            writer<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"150\"></td><td><pre>            writer<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"151\"></td><td><pre>            ds<span class=\"token punctuation\">.</span><span class=\"token function\">dispose</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"152\"></td><td><pre> </pre></td></tr><tr><td data-num=\"153\"></td><td><pre>            <span class=\"token comment\">// æ·»åŠ åˆ°å‹ç¼©æ–‡ä»¶</span></pre></td></tr><tr><td data-num=\"154\"></td><td><pre>            <span class=\"token comment\">//zipShapeFile(shpPath);</span></pre></td></tr><tr><td data-num=\"155\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"156\"></td><td><pre>            e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"157\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"158\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"159\"></td><td><pre> </pre></td></tr><tr><td data-num=\"160\"></td><td><pre> </pre></td></tr><tr><td data-num=\"161\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"162\"></td><td><pre>     * å‹ç¼© shape æ–‡ä»¶</pre></td></tr><tr><td data-num=\"163\"></td><td><pre>     *</pre></td></tr><tr><td data-num=\"164\"></td><td><pre>     * @param shpPath shape æ–‡ä»¶è·¯å¾„ï¼ˆåŒ…å« shape æ–‡ä»¶åç§°ï¼‰</pre></td></tr><tr><td data-num=\"165\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"166\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">zipShapeFile</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> shpPath<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"167\"></td><td><pre>        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"168\"></td><td><pre>            <span class=\"token class-name\">File</span> shpFile <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">(</span>shpPath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"169\"></td><td><pre>            <span class=\"token class-name\">String</span> shpRoot <span class=\"token operator\">=</span> shpFile<span class=\"token punctuation\">.</span><span class=\"token function\">getParentFile</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getPath</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"170\"></td><td><pre>            <span class=\"token class-name\">String</span> shpName <span class=\"token operator\">=</span> shpFile<span class=\"token punctuation\">.</span><span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">substring</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> shpFile<span class=\"token punctuation\">.</span><span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">lastIndexOf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"171\"></td><td><pre> </pre></td></tr><tr><td data-num=\"172\"></td><td><pre>            <span class=\"token class-name\">String</span> zipPath <span class=\"token operator\">=</span> shpRoot <span class=\"token operator\">+</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">.</span>separator <span class=\"token operator\">+</span> shpName <span class=\"token operator\">+</span> <span class=\"token string\">\".zip\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"173\"></td><td><pre>            <span class=\"token class-name\">File</span> zipFile <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">(</span>zipPath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"174\"></td><td><pre>            <span class=\"token class-name\">InputStream</span> input <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"175\"></td><td><pre>            <span class=\"token class-name\">ZipOutputStream</span> zipOut <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ZipOutputStream</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">FileOutputStream</span><span class=\"token punctuation\">(</span>zipFile<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"176\"></td><td><pre>            <span class=\"token comment\">//zip çš„åç§°ä¸º</span></pre></td></tr><tr><td data-num=\"177\"></td><td><pre>            zipOut<span class=\"token punctuation\">.</span><span class=\"token function\">setComment</span><span class=\"token punctuation\">(</span>shpName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"178\"></td><td><pre>            <span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> shpFiles <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"179\"></td><td><pre>                    shpRoot <span class=\"token operator\">+</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">.</span>separator <span class=\"token operator\">+</span> shpName <span class=\"token operator\">+</span> <span class=\"token string\">\".dbf\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"180\"></td><td><pre>                    shpRoot <span class=\"token operator\">+</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">.</span>separator <span class=\"token operator\">+</span> shpName <span class=\"token operator\">+</span> <span class=\"token string\">\".prj\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"181\"></td><td><pre>                    shpRoot <span class=\"token operator\">+</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">.</span>separator <span class=\"token operator\">+</span> shpName <span class=\"token operator\">+</span> <span class=\"token string\">\".shp\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"182\"></td><td><pre>                    shpRoot <span class=\"token operator\">+</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">.</span>separator <span class=\"token operator\">+</span> shpName <span class=\"token operator\">+</span> <span class=\"token string\">\".shx\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"183\"></td><td><pre>                    shpRoot <span class=\"token operator\">+</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">.</span>separator <span class=\"token operator\">+</span> shpName <span class=\"token operator\">+</span> <span class=\"token string\">\".fix\"</span></pre></td></tr><tr><td data-num=\"184\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"185\"></td><td><pre> </pre></td></tr><tr><td data-num=\"186\"></td><td><pre>            <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> shpFiles<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"187\"></td><td><pre>                <span class=\"token class-name\">File</span> file <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">(</span>shpFiles<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"188\"></td><td><pre>                input <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FileInputStream</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"189\"></td><td><pre>                zipOut<span class=\"token punctuation\">.</span><span class=\"token function\">putNextEntry</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">ZipEntry</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">.</span><span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"190\"></td><td><pre>                <span class=\"token keyword\">int</span> temp <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"191\"></td><td><pre>                <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>temp <span class=\"token operator\">=</span> input<span class=\"token punctuation\">.</span><span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"192\"></td><td><pre>                    zipOut<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span>temp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"193\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"194\"></td><td><pre>                input<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"195\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"196\"></td><td><pre>            zipOut<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"197\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"198\"></td><td><pre>            e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"199\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"200\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"201\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">package</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>supermap<span class=\"token punctuation\">.</span>jczcpt<span class=\"token punctuation\">.</span>pipe<span class=\"token punctuation\">.</span>manage<span class=\"token punctuation\">.</span>planninganalysis<span class=\"token punctuation\">.</span>util</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>locationtech<span class=\"token punctuation\">.</span>jts<span class=\"token punctuation\">.</span>geom<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Geometry</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>locationtech<span class=\"token punctuation\">.</span>jts<span class=\"token punctuation\">.</span>io<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">ParseException</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>locationtech<span class=\"token punctuation\">.</span>jts<span class=\"token punctuation\">.</span>io<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">WKTReader</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>locationtech<span class=\"token punctuation\">.</span>jts<span class=\"token punctuation\">.</span>io<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">WKTWriter</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"9\"></td><td><pre> * @ClassName WKTUtil</pre></td></tr><tr><td data-num=\"10\"></td><td><pre> * @Description @TODO</pre></td></tr><tr><td data-num=\"11\"></td><td><pre> * @Date 2019/11/18 12:01</pre></td></tr><tr><td data-num=\"12\"></td><td><pre> * @Version v1.0</pre></td></tr><tr><td data-num=\"13\"></td><td><pre> **/</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">WKTUtil</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre> </pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">String</span> <span class=\"token function\">geomToWkt</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Geometry</span> geometry<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token class-name\">String</span> wkt <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token class-name\">WKTWriter</span> writer <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">WKTWriter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        wkt <span class=\"token operator\">=</span> writer<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span>geometry<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token keyword\">return</span> wkt<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre> </pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">Geometry</span> <span class=\"token function\">wktToGeom</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> wkt<span class=\"token punctuation\">)</span>  <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token class-name\">Geometry</span> geometry <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        <span class=\"token class-name\">WKTReader</span> reader <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">WKTReader</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>            geometry <span class=\"token operator\">=</span> reader<span class=\"token punctuation\">.</span><span class=\"token function\">read</span><span class=\"token punctuation\">(</span>wkt<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">ParseException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>        <span class=\"token comment\">//geometry.setSRID(4326);</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>        <span class=\"token keyword\">return</span> geometry<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>å¯¼å‡º web ä¸‹è½½</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>     * å°†ç®¡æ®µæ•°æ®å¯¼å‡ºä¸º shp æ–‡ä»¶</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>     * @param</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>     * @return</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>     * @author dkx</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>     * @date 2024/8/8 23:36</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token annotation punctuation\">@PostMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/exportShp\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token annotation punctuation\">@Operation</span><span class=\"token punctuation\">(</span>summary <span class=\"token operator\">=</span> <span class=\"token string\">\"å°†ç®¡æ®µæ•°æ®å¯¼å‡ºä¸ºshpæ–‡ä»¶\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token annotation punctuation\">@Parameter</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"ids\"</span><span class=\"token punctuation\">,</span> description <span class=\"token operator\">=</span> <span class=\"token string\">\"idé›†åˆ\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">exportShp</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@RequestParam</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ids\"</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> ids<span class=\"token punctuation\">,</span> <span class=\"token class-name\">HttpServletResponse</span> response<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">IOException</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token class-name\">String</span> val <span class=\"token operator\">=</span> <span class=\"token function\">formatListToString</span><span class=\"token punctuation\">(</span>ids<span class=\"token punctuation\">,</span> <span class=\"token string\">\",\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"\\'\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"\\'\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">FacGasPipeSection</span><span class=\"token punctuation\">></span></span> sectionGeo <span class=\"token operator\">=</span> facGasPipeSectionMapper<span class=\"token punctuation\">.</span><span class=\"token function\">getSectionGeo</span><span class=\"token punctuation\">(</span>val<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">CollectionUtil</span><span class=\"token punctuation\">.</span><span class=\"token function\">isNotEmpty</span><span class=\"token punctuation\">(</span>sectionGeo<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>            <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> list <span class=\"token operator\">=</span> <span class=\"token function\">element</span><span class=\"token punctuation\">(</span>sectionGeo<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Geometry</span><span class=\"token punctuation\">></span></span> geometryList <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>            <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> str <span class=\"token operator\">:</span> list<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>                <span class=\"token class-name\">Geometry</span> geom <span class=\"token operator\">=</span> <span class=\"token class-name\">WKTUtil</span><span class=\"token punctuation\">.</span><span class=\"token function\">wktToGeom</span><span class=\"token punctuation\">(</span>str<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>                geometryList<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>geom<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>            <span class=\"token comment\">// ä¸´æ—¶ç”Ÿæˆ Shape æ–‡ä»¶å¹¶å‹ç¼©ä¸º zip</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>            <span class=\"token class-name\">String</span> tempDir <span class=\"token operator\">=</span> <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span><span class=\"token function\">getProperty</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"java.io.tmpdir\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>            <span class=\"token class-name\">String</span> shapeFilePath <span class=\"token operator\">=</span> tempDir <span class=\"token operator\">+</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">.</span>separator <span class=\"token operator\">+</span> <span class=\"token string\">\"ceshi2222.shp\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>            <span class=\"token class-name\">String</span> zipFilePath <span class=\"token operator\">=</span> tempDir <span class=\"token operator\">+</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">.</span>separator <span class=\"token operator\">+</span> <span class=\"token string\">\"ceshi2222.zip\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>            <span class=\"token comment\">// å†™å…¥ Shape æ–‡ä»¶å¹¶å‹ç¼©ä¸º ZIP</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>            <span class=\"token class-name\">ShapeUtil</span><span class=\"token punctuation\">.</span><span class=\"token function\">write2Shape</span><span class=\"token punctuation\">(</span>shapeFilePath<span class=\"token punctuation\">,</span> <span class=\"token string\">\"utf-8\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Polygon\"</span><span class=\"token punctuation\">,</span> geometryList<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>            <span class=\"token class-name\">ShapeUtil</span><span class=\"token punctuation\">.</span><span class=\"token function\">zipShapeFile</span><span class=\"token punctuation\">(</span>shapeFilePath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>            <span class=\"token comment\">// ç¡®ä¿æ–‡ä»¶æ­£ç¡®ç”Ÿæˆ</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>            <span class=\"token class-name\">File</span> zipFile <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">(</span>zipFilePath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>zipFile<span class=\"token punctuation\">.</span><span class=\"token function\">exists</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>                <span class=\"token comment\">// è®¾ç½®å“åº”å¤´ï¼Œæç¤ºæµè§ˆå™¨ä¸‹è½½æ–‡ä»¶</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>                response<span class=\"token punctuation\">.</span><span class=\"token function\">setContentType</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"application/zip\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>                response<span class=\"token punctuation\">.</span><span class=\"token function\">setHeader</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Content-Disposition\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"attachment; filename=ceshi2222.zip\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>                response<span class=\"token punctuation\">.</span><span class=\"token function\">setContentLength</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span> zipFile<span class=\"token punctuation\">.</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>                <span class=\"token comment\">// å°†æ–‡ä»¶å†™å…¥å“åº”æµ</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>                <span class=\"token keyword\">try</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">ServletOutputStream</span> outputStream <span class=\"token operator\">=</span> response<span class=\"token punctuation\">.</span><span class=\"token function\">getOutputStream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>                     <span class=\"token class-name\">FileInputStream</span> fis <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FileInputStream</span><span class=\"token punctuation\">(</span>zipFile<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>                    <span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> buffer <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token number\">1024</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>                    <span class=\"token keyword\">int</span> bytesRead<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>                    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>bytesRead <span class=\"token operator\">=</span> fis<span class=\"token punctuation\">.</span><span class=\"token function\">read</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>                        outputStream<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> bytesRead<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>                    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>                    outputStream<span class=\"token punctuation\">.</span><span class=\"token function\">flush</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">finally</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>                    <span class=\"token comment\">// åˆ é™¤ä¸´æ—¶æ–‡ä»¶</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>                    <span class=\"token class-name\">Files</span><span class=\"token punctuation\">.</span><span class=\"token function\">deleteIfExists</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Paths</span><span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>shapeFilePath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>                    <span class=\"token class-name\">Files</span><span class=\"token punctuation\">.</span><span class=\"token function\">deleteIfExists</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Paths</span><span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>zipFilePath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>                response<span class=\"token punctuation\">.</span><span class=\"token function\">setStatus</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpServletResponse</span><span class=\"token punctuation\">.</span><span class=\"token constant\">SC_INTERNAL_SERVER_ERROR</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>                response<span class=\"token punctuation\">.</span><span class=\"token function\">getWriter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Error generating the ZIP file.\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>            <span class=\"token comment\">// å¤„ç†æ— æ•°æ®çš„æƒ…å†µ</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>            response<span class=\"token punctuation\">.</span><span class=\"token function\">setStatus</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpServletResponse</span><span class=\"token punctuation\">.</span><span class=\"token constant\">SC_NO_CONTENT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">element</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">FacGasPipeSection</span><span class=\"token punctuation\">></span></span> sectionGeo<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>        <span class=\"token class-name\">ArrayList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> list <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">FacGasPipeSection</span> dwdProFacGasPipeSection <span class=\"token operator\">:</span> sectionGeo<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ObjectUtil</span><span class=\"token punctuation\">.</span><span class=\"token function\">isNotEmpty</span><span class=\"token punctuation\">(</span>dwdProFacGasPipeSection<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>                <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token class-name\">StringUtil</span><span class=\"token punctuation\">.</span><span class=\"token function\">isNullOrEmpty</span><span class=\"token punctuation\">(</span>dwdProFacGasPipeSection<span class=\"token punctuation\">.</span><span class=\"token function\">getGeometry</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>                    <span class=\"token comment\">// è§£æ JSON å­—ç¬¦ä¸²</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>                    <span class=\"token class-name\">JSONObject</span> jsonObject <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">JSONObject</span><span class=\"token punctuation\">(</span>dwdProFacGasPipeSection<span class=\"token punctuation\">.</span><span class=\"token function\">getGeometry</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>                    <span class=\"token comment\">// è·å– geometry å¯¹è±¡</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>                    <span class=\"token class-name\">JSONObject</span> geometry <span class=\"token operator\">=</span> jsonObject<span class=\"token punctuation\">.</span><span class=\"token function\">getJSONObject</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"geometry\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>                    <span class=\"token comment\">// è·å– coordinates æ•°ç»„</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>                    <span class=\"token class-name\">JSONArray</span> coordinates <span class=\"token operator\">=</span> geometry<span class=\"token punctuation\">.</span><span class=\"token function\">getJSONArray</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"coordinates\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>                    <span class=\"token comment\">// å°† coordinates æ•°ç»„è½¬æ¢ä¸ºå­—ç¬¦ä¸²</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>                    <span class=\"token class-name\">String</span> result <span class=\"token operator\">=</span> coordinates<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre>                    list<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre>        <span class=\"token keyword\">return</span> list<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre></pre></td></tr><tr><td data-num=\"86\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"87\"></td><td><pre>     * å°†åˆ—è¡¨è½¬æ¢ä¸ºä»¥æŒ‡å®šåˆ†éš”ç¬¦åˆ†éš”çš„å­—ç¬¦ä¸²ï¼Œå¹¶åœ¨æ¯ä¸ªå…ƒç´ ä¹‹å‰å’Œä¹‹åæ·»åŠ æŒ‡å®šçš„å‰ç¼€å’Œåç¼€ã€‚</pre></td></tr><tr><td data-num=\"88\"></td><td><pre>     * @param list è¦è½¬æ¢çš„åˆ—è¡¨</pre></td></tr><tr><td data-num=\"89\"></td><td><pre>     * @param delimiter åˆ†éš”ç¬¦</pre></td></tr><tr><td data-num=\"90\"></td><td><pre>     * @param prefix æ¯ä¸ªå…ƒç´ çš„å‰ç¼€</pre></td></tr><tr><td data-num=\"91\"></td><td><pre>     * @param suffix æ¯ä¸ªå…ƒç´ çš„åç¼€</pre></td></tr><tr><td data-num=\"92\"></td><td><pre>     * @return æ ¼å¼åŒ–åçš„å­—ç¬¦ä¸²</pre></td></tr><tr><td data-num=\"93\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"94\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> <span class=\"token class-name\">String</span> <span class=\"token function\">formatListToString</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> list<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> delimiter<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> prefix<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> suffix<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"95\"></td><td><pre>        <span class=\"token keyword\">return</span> list<span class=\"token punctuation\">.</span><span class=\"token function\">stream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"96\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>item <span class=\"token operator\">-></span> prefix <span class=\"token operator\">+</span> item<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> suffix<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"97\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token function\">collect</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Collectors</span><span class=\"token punctuation\">.</span><span class=\"token function\">joining</span><span class=\"token punctuation\">(</span>delimiter<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"98\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure>",
            "tags": [
                "è®¡ç®—æœºå­¦ç§‘",
                "blog",
                "geometry",
                "è®¡ç®—æœºå­¦ç§‘ - blog - geometry"
            ]
        },
        {
            "id": "https://pigpigletsgo.github.io/computer-science/blog/maven/maven%E4%B8%ADgeotools%E7%9A%84%E5%BC%95%E5%85%A5maven%E7%9A%84repository%E4%B8%8Emirror/",
            "url": "https://pigpigletsgo.github.io/computer-science/blog/maven/maven%E4%B8%ADgeotools%E7%9A%84%E5%BC%95%E5%85%A5maven%E7%9A%84repository%E4%B8%8Emirror/",
            "title": "mavenä¸­geo toolsçš„å¼•å…¥ - mavençš„repositoryä¸mirror",
            "date_published": "2024-08-09T06:50:25.886Z",
            "content_html": "<h1 id=\"mavenä¸­geo-toolsçš„å¼•å…¥-mavençš„repositoryä¸mirror\"><a class=\"anchor\" href=\"#mavenä¸­geo-toolsçš„å¼•å…¥-mavençš„repositoryä¸mirror\">#</a> maven ä¸­ geo tools çš„å¼•å…¥ - maven çš„ repository ä¸ mirror</h1>\n<h2 id=\"mavenä¸­geo-toolsçš„å¼•å…¥-mavençš„repositoryä¸mirror-2\"><a class=\"anchor\" href=\"#mavenä¸­geo-toolsçš„å¼•å…¥-mavençš„repositoryä¸mirror-2\">#</a> maven ä¸­ geo tools çš„å¼•å…¥ - maven çš„ repository ä¸ mirror</h2>\n<h2 id=\"ä¸€é—®é¢˜æè¿°\"><a class=\"anchor\" href=\"#ä¸€é—®é¢˜æè¿°\">#</a> ä¸€ï¼Œé—®é¢˜æè¿°</h2>\n<p>èµ·å› æ˜¯è¿™æ ·çš„ï¼Œæˆ‘æƒ³è¦å¼•å…¥ GeoTools åŒ…ï¼Œå´å‘ç°å³ä½¿æŒ‰ç…§å®˜æ–¹ quick start æ¥æ“ä½œï¼Œä¹Ÿæ²¡æœ‰å¼•å…¥æˆåŠŸï¼Œå§‹ç»ˆæ˜¯æ‰¾ä¸åˆ° jar åŒ…ï¼Œç™¾æ€ä¸å¾—å…¶è§£ã€‚</p>\n<p>æŒ‰ç…§å®˜ç½‘å’Œè°·æ­Œç™¾åº¦æœç´¢çš„ç»“æœçœ‹<br />\nè¦ä½¿ç”¨ GeoToolsï¼Œé¦–å…ˆå¼•å…¥éœ€è¦çš„ GeoTools çš„æ¨¡å—ã€‚GeoTools æœ‰å¾ˆå¤šæ¨¡å—ï¼Œå¦‚ shapefileï¼Œcsv ç­‰ã€‚<br />\nè¿™ä¸ªæ˜¯æˆ‘è¦å¼•å…¥çš„ geojson æ¨¡å—</p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>   <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>org.geotools<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>   <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>gt-geojson<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>   <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>19.0<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p>ç„¶åæ·»åŠ  geo tools å®˜æ–¹çš„ä»“åº“</p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>repository</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>   <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>id</span><span class=\"token punctuation\">></span></span>osgeo<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>id</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>   <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>OSGeo Release Repository<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>   <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>url</span><span class=\"token punctuation\">></span></span>https://repo.osgeo.org/repository/release/<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>url</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>   <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>snapshots</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>enabled</span><span class=\"token punctuation\">></span></span>false<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>enabled</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>snapshots</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>   <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>releases</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>enabled</span><span class=\"token punctuation\">></span></span>true<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>enabled</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>releases</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>repository</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>repository</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>   <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>id</span><span class=\"token punctuation\">></span></span>osgeo-snapshot<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>id</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>   <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>OSGeo Snapshot Repository<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>   <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>url</span><span class=\"token punctuation\">></span></span>https://repo.osgeo.org/repository/snapshot/<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>url</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>   <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>snapshots</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>enabled</span><span class=\"token punctuation\">></span></span>true<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>enabled</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>snapshots</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>   <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>releases</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>enabled</span><span class=\"token punctuation\">></span></span>false<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>enabled</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>releases</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>repository</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p>ä½†å°±æ˜¯æ‰¾ä¸åˆ° jar åŒ…</p>\n<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20240809142140245.png\" alt=\"image-20240809142140245\" /></p>\n<p>dependencies ä¹Ÿæ˜¯æŠ¥é”™</p>\n<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20240809142410052.png\" alt=\"image-20240809142410052\" /></p>\n<p>åæ¥å°è¯•å°†ä»“åº“ä»¥é•œåƒçš„æ–¹å¼å†™å…¥åˆ° settings.xml ä¹‹ä¸­ï¼Œç»“æœå‘ç°å¯è¡Œäº†ã€‚<strong>ï¼ˆå½“ç„¶åç»­å‘ç°è¿™ç§æ–¹æ³•æ˜¯é”™è¯¯çš„è§£å†³æ–¹æ¡ˆï¼Œæ­£ç¡®çš„åšæ³•åœ¨åé¢ï¼‰</strong></p>\n<h2 id=\"äºŒåŸç†è¯´æ˜\"><a class=\"anchor\" href=\"#äºŒåŸç†è¯´æ˜\">#</a> äºŒï¼ŒåŸç†è¯´æ˜</h2>\n<p>å‡ºé”™åŸå› ï¼š æ²¡æœ‰ç†è§£æ¸…æ¥š maven çš„ repository ä¸ mirror çš„å…³ç³»ï¼Œé”™è¯¯åœ°å°†é˜¿é‡Œäº‘é•œåƒçš„ mirrorOf å‚æ•°å€¼è®¾ç½®ä¸º *ï¼ˆæ˜Ÿå·ï¼Œé€šé…ç¬¦ï¼Œè¡¨ç¤ºåŒ¹é…å…¨éƒ¨ä»“åº“ï¼‰ï¼ˆæ­£ç¡®çš„å‚æ•°å€¼ä¸º centralï¼‰</p>\n<p>ä¸ºäº†è®©å„ä½æ›´å¥½åœ°ç†è§£è¿™ä¸ªé—®é¢˜ï¼Œæœ‰å¿…è¦å ç”¨ä¸€äº›ç¯‡å¹…ä»‹ç»ä¸€ä¸‹ maven çš„åŸºæœ¬ä¿¡æ¯å’Œç›¸å…³æ¦‚å¿µ</p>\n<h3 id=\"21-mavençš„ä¸»è¦åŠŸèƒ½\"><a class=\"anchor\" href=\"#21-mavençš„ä¸»è¦åŠŸèƒ½\">#</a> 2.1 maven çš„ä¸»è¦åŠŸèƒ½</h3>\n<p>ä»¥ä¸‹æè¿°æ‘˜è‡ªç»´åŸºç™¾ç§‘</p>\n<blockquote>\n<p>Maven æ˜¯ä¸€ä¸ªä¸»è¦ç”¨äº Java é¡¹ç›®çš„æ„å»ºè‡ªåŠ¨åŒ–å·¥å…·ã€‚Maven è¿˜å¯ä»¥ç”¨æ¥æ„å»ºå’Œç®¡ç†ä½¿ç”¨ c#ã€Rubyã€Scala å’Œå…¶ä»–è¯­è¨€ç¼–å†™çš„é¡¹ç›®ã€‚Maven é¡¹ç›®ç”± Apache è½¯ä»¶åŸºé‡‘ä¼šæ‰˜ç®¡ï¼Œå®ƒä»¥å‰æ˜¯ Jakarta é¡¹ç›®çš„ä¸€éƒ¨åˆ†ã€‚</p>\n</blockquote>\n<blockquote>\n<p>Maven è§£å†³äº†æ„å»ºè½¯ä»¶çš„ä¸¤ä¸ªæ–¹é¢ï¼šå¦‚ä½•æ„å»ºè½¯ä»¶åŠå…¶ä¾èµ–å…³ç³»ã€‚</p>\n</blockquote>\n<p>maven çš„ä¸»è¦åŠŸèƒ½æœ‰ä¸¤ä¸ªï¼šä¸€ä¸ªæ˜¯è§£å†³<strong>é¡¹ç›®çš„æ„å»º</strong>ï¼šåŒ…æ‹¬<strong>ç¼–è¯‘ï¼ˆbuildï¼‰</strong>ã€<strong>æµ‹è¯•ï¼ˆtestï¼‰</strong>ã€** æ‰“åŒ…ï¼ˆpackageï¼‰<strong>å’Œ</strong>éƒ¨ç½²ï¼ˆdeployï¼‰** ç­‰ï¼Œmaven ä½¿ç”¨ç”Ÿå‘½å‘¨æœŸçš„æ¦‚å¿µæè¿°è¿™ä¸€è¿‡ç¨‹ï¼Œå¹¶é€šè¿‡æ’ä»¶å®ç°å’Œæ§åˆ¶é¡¹ç›®æ„å»ºå„ä¸ªé˜¶æ®µçš„æ‰§è¡Œã€‚</p>\n<p>ä¸‹å›¾ä¸ºå®Œæ•´çš„ maven ç”Ÿå‘½å‘¨æœŸ</p>\n<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20240809143214955.png\" alt=\"image-20240809143214955\" /></p>\n<p>maven çš„å¦ä¸€ä¸ªåŠŸèƒ½å°±æ˜¯è§£å†³é¡¹ç›®ä¹‹é—´çš„ä¾èµ–å…³ç³»å¹¶ä»ä»“åº“ (repository) è‡ªåŠ¨ä¸‹è½½éœ€è¦çš„ jar åŒ…ã€‚maven ä½¿ç”¨é¡¹ç›®å¯¹è±¡æ¨¡å‹ (Project Object Modelï¼ŒPOM) å®ç°å¯¹é¡¹ç›®çš„æŠ½è±¡å’Œç®¡ç†ã€‚</p>\n<blockquote>\n<p>é¡¹ç›®å¯¹è±¡æ¨¡å‹ (POM) æä¾›äº†å•ä¸ªé¡¹ç›®çš„æ‰€æœ‰é…ç½®ã€‚ä¸€èˆ¬é…ç½®åŒ…æ‹¬é¡¹ç›®çš„åç§°ï¼ˆnameï¼‰ã€æ‰€æœ‰è€…ï¼ˆownerï¼‰åŠå…¶å¯¹å…¶ä»–é¡¹ç›®çš„ä¾èµ–å…³ç³»ï¼ˆdependenciesï¼‰ã€‚è¿˜å¯ä»¥é…ç½®æ„å»ºè¿‡ç¨‹çš„å„ä¸ªé˜¶æ®µï¼Œè¿™äº›é˜¶æ®µä»¥æ’ä»¶ï¼ˆpluginsï¼‰çš„å½¢å¼å®ç°ã€‚</p>\n</blockquote>\n<blockquote>\n<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰çš„ POM éƒ½ç»§æ‰¿è‡ªè¶…çº§ POMã€‚è¶…çº§ POM æä¾›é»˜è®¤é…ç½®ï¼Œæ¯”å¦‚é»˜è®¤æºç›®å½•ã€é»˜è®¤æ’ä»¶ç­‰ç­‰ã€‚</p>\n</blockquote>\n<p>maven å°†çº¦å®šå¤§äºé…ç½®ä½œä¸ºå…¶è®¾è®¡ç†å¿µï¼Œçº¦å®šä¸€ä¸€äº›é»˜è®¤çš„é…ç½®ï¼Œå¦‚é¡¹ç›®çš„é»˜è®¤ç»“æ„ï¼Œå¯¹æŸä¸ªé¡¹ç›®åæ ‡ï¼Œä¾èµ–å’Œæ’ä»¶çš„è§„å®šçš„é…ç½®æ–¹æ³• (IDE é€šå¸¸ä¼šå¸®åŠ©æ£€æŸ¥é…ç½®é¡¹çš„æ­£ç¡®æ€§) ç­‰ã€‚</p>\n<p>ä¸‹å›¾è¡¨ç¤ºé»˜è®¤çš„ maven é¡¹ç›® ç›®å½•</p>\n<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20240809143516603.png\" alt=\"image-20240809143516603\" /></p>\n<h3 id=\"22-ä»“åº“\"><a class=\"anchor\" href=\"#22-ä»“åº“\">#</a> 2.2 ä»“åº“</h3>\n<p>æ‰€æœ‰çš„ maven é¡¹ç›®éƒ½å­˜å‚¨åœ¨æœåŠ¡å™¨ä¸Šï¼Œæ”¹æœåŠ¡å™¨è¢«æŠ½è±¡ä¸ºä»“åº“ (repository)ï¼Œå½“ç”¨æˆ·éœ€è¦æŸäº› jar åŒ…æ—¶å°±å¯ä»¥ä»ä»“åº“ä¸­ä¸‹è½½ã€‚</p>\n<p>maven é€šè¿‡è¶…çº§ POM æœºåˆ¶é…ç½®äº†é»˜è®¤çš„ä»“åº“ã€‚ç”±äºæ‰€æœ‰çš„ POM éƒ½éšå¼åœ°ç»§æ‰¿è‡ªè¶…çº§ POMï¼Œè¶…çº§ä»“åº“ä¸­é…ç½®äº†ä¸­å¤®ä»“åº“ï¼Œå› æ­¤æ‰€æœ‰çš„é¡¹ç›®é»˜è®¤é…ç½®äº†ä¸­å¤®ä»“åº“ã€‚</p>\n<blockquote>\n<p>å¯¹äº Maven3ï¼Œè¶…çº§ POM åœ¨æ–‡ä»¶ % MAVEN_HOME%/lib/maven-model-builder-x.x.x.jar ä¸­çš„<br />\n org/apache/maven/model/pom-4.0.0.xml è·¯å¾„ä¸‹ã€</p>\n<p>å¯¹äº Maven2ï¼Œè¶…çº§ POM åœ¨æ–‡ä»¶ % MAVEN_HOME%/lib/maven-x.x.x-uber.jar ä¸­çš„<br />\n org/apache/maven/project/pom-4.0.0.xml ç›®å½•ä¸‹ã€‚</p>\n</blockquote>\n<p>é»˜è®¤é…ç½®çš„éƒ¨åˆ†å†…å®¹å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>repositories</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>repository</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>id</span><span class=\"token punctuation\">></span></span>central<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>id</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>Central Repository<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>url</span><span class=\"token punctuation\">></span></span>https://repo.maven.apache.org/maven2<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>url</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>layout</span><span class=\"token punctuation\">></span></span>default<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>layout</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>snapshots</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>enabled</span><span class=\"token punctuation\">></span></span>false<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>enabled</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>snapshots</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>repository</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>repositories</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>pluginRepositories</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>pluginRepository</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>id</span><span class=\"token punctuation\">></span></span>central<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>id</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>Central Repository<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>url</span><span class=\"token punctuation\">></span></span>https://repo.maven.apache.org/maven2<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>url</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>layout</span><span class=\"token punctuation\">></span></span>default<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>layout</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>snapshots</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>enabled</span><span class=\"token punctuation\">></span></span>false<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>enabled</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>snapshots</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>releases</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>updatePolicy</span><span class=\"token punctuation\">></span></span>never<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>updatePolicy</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>releases</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>pluginRepository</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>pluginRepositories</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥è‡ªå·±æ·»åŠ ä»“åº“ï¼Œå¦‚æˆ‘æ·»åŠ äº†æä¾› GeoTools ç›¸å…³åŒ…çš„ä»“åº“ï¼Œid ä¸º <code>osgeo</code> ï¼Œurl åœ°å€ä¸º <code>https://repo.osgeo.org/repository/release/</code> ã€‚</p>\n<p>åœ¨é¡¹ç›®çš„ pom.xml ä¸­åŠ å…¥ä»“åº“é…ç½®ï¼š</p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>repository</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>   <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>id</span><span class=\"token punctuation\">></span></span>osgeo<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>id</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>   <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>OSGeo Release Repository<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>   <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>url</span><span class=\"token punctuation\">></span></span>https://repo.osgeo.org/repository/release/<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>url</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>   <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>snapshots</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>enabled</span><span class=\"token punctuation\">></span></span>false<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>enabled</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>snapshots</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>   <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>releases</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>enabled</span><span class=\"token punctuation\">></span></span>true<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>enabled</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>releases</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>repository</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><h3 id=\"23-é•œåƒ\"><a class=\"anchor\" href=\"#23-é•œåƒ\">#</a> 2.3 é•œåƒ</h3>\n<p>ç”±äº maven çš„ä¸­å¤®ä»“åº“åœ¨å›½å¤–ï¼Œå›½å†…è®¿é—®é€Ÿåº¦è¾ƒæ…¢ï¼Œä¸€èˆ¬æˆ‘ä»¬é‡‡ç”¨é…ç½®é•œåƒï¼ˆmirrorï¼‰çš„æ–¹å¼ä»å›½å†…çš„é•œåƒæœåŠ¡å™¨ä¸­ä¸‹è½½èµ„æºã€‚</p>\n<p>maven æ ¹æ® setting.xml æ–‡ä»¶ä¸­é…ç½®çš„é•œåƒæ‹¦æˆªå‘å¾€åŸä»“åº“çš„è¯·æ±‚ï¼Œå¹¶å°†å…¶è½¬å‘åˆ°é•œåƒä»“åº“ã€‚</p>\n<p>å³ï¼šå½“ä¸€ä¸ªé•œåƒçš„ mirrodOf å‚æ•°ä¸æŸä¸ªä»“åº“çš„ id å‚æ•°ç›¸åŒ¹é…ï¼Œå°±å‘è¯¥é•œåƒè¯·æ±‚èµ„æºï¼Œå¦åˆ™å‘åŸä»“åº“è¯·æ±‚èµ„æºã€‚</p>\n<p>é˜¿é‡Œäº‘é•œåƒæ˜¯å¸¸ç”¨çš„ maven é•œåƒä¹‹ä¸€ï¼Œå…¶é•œåƒäº†ä¸­å¤®ä»“åº“çš„æ‰€æœ‰èµ„æºã€‚</p>\n<p>setting.xml æ–‡ä»¶ä¸­é˜¿é‡Œäº‘é•œåƒçš„é…ç½®å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">&lt;!-- é˜¿é‡Œäº‘é•œåƒ --></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>mirror</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>id</span><span class=\"token punctuation\">></span></span>nexus-aliyun<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>id</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>mirrorOf</span><span class=\"token punctuation\">></span></span>central<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>mirrorOf</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>Nexus aliyun<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>url</span><span class=\"token punctuation\">></span></span>http://maven.aliyun.com/nexus/content/groups/public<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>url</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>mirror</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p>åœ¨<strong> setting.xml æ–‡ä»¶</strong>ä¸­ï¼Œæˆ‘ä»¬è®¾ç½®é˜¿é‡Œäº‘é•œåƒçš„ <code>mirrorOf</code>  å±æ€§ä¸º <code>central</code> ï¼Œä»¥æ­¤å»åŒ¹é… <code>id</code>  å±æ€§ä¸º <code>central</code>  çš„ä¸­å¤®ä»“åº“ã€‚è¿™æ ·æ‰€æœ‰å¯¹ä¸­å¤®ä»“åº“å‘èµ·çš„è¯·æ±‚ï¼Œéƒ½ä¼šè¢«è½¬å‘ç»™é˜¿é‡Œäº‘é•œåƒï¼Œå¤§å¤§æé«˜äº†èµ„æºçš„ä¸‹è½½é€Ÿåº¦ã€‚</p>\n<h3 id=\"24-ä»“åº“ä¸é•œåƒçš„å…³ç³»\"><a class=\"anchor\" href=\"#24-ä»“åº“ä¸é•œåƒçš„å…³ç³»\">#</a> 2.4 ä»“åº“ä¸é•œåƒçš„å…³ç³»</h3>\n<p>å½“æˆ‘ä»¬é…ç½®äº†å¤šä¸ªä»“åº“å’Œå¤šä¸ªé•œåƒæ—¶ï¼Œmaven æ‰§è¡Œçš„ç­–ç•¥ä¸ºï¼š</p>\n<p>1ï¼Œmaven æ ¹æ®é•œåƒé…ç½®æ–‡ä»¶ï¼ˆsetting.xmlï¼‰è‡ªä¸Šè‡³ä¸‹åœ°ä¾æ¬¡æŸ¥çœ‹æ‰€æœ‰çš„é•œåƒï¼Œå¯¹æ¯ä¸€ä¸ªä»“åº“ä¾æ¬¡è¿›è¡ŒåŒ¹é…ï¼Œå¹¶ä½¿ç”¨ç¬¬ä¸€ä¸ªåŒ¹é…ä¸Šçš„é•œåƒã€‚è¢«é•œåƒåŒ¹é…çš„ä»“åº“ï¼Œä»“åº“çš„ url è¢«æ›¿æ¢ä¸ºé•œåƒçš„ urlï¼Œæ²¡æœ‰åŒ¹é…çš„ä»“åº“ï¼Œurl ä¸å˜ã€‚</p>\n<p>2ï¼ŒæŸ¥è¯¢å„ä»“åº“æ˜¯å¦åŒ…è¯·æ±‚çš„èµ„æºï¼ˆé¡¹ç›®ï¼‰ï¼Œå¦‚éƒ½æ²¡æœ‰ï¼Œåˆ™æŠ¥é”™ï¼ˆå¦‚æœªæ‰¾åˆ°ï¼‰ï¼Œå¦åˆ™ä»ç¬¬ä¸€ä¸ªåŒ¹é…ä¸Šçš„ä»“åº“æ‹‰å–èµ„æºã€‚<br />\n<img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20240809143954175.png\" alt=\"image-20240809143954175\" /></p>\n<h2 id=\"ä¸‰è§£å†³æ–¹æ¡ˆä¸å°æŠ€å·§\"><a class=\"anchor\" href=\"#ä¸‰è§£å†³æ–¹æ¡ˆä¸å°æŠ€å·§\">#</a> ä¸‰ï¼Œè§£å†³æ–¹æ¡ˆä¸å°æŠ€å·§</h2>\n<p>1ï¼Œä¸æ˜¯æ‰€æœ‰çš„ jar åŒ…éƒ½è¢«åŒ…å«åœ¨ maven ä¸­å¤®ä»“åº“ä¸­ï¼Œå¦‚æœä¸­å¤®ä»“åº“æ²¡æœ‰è¯¥èµ„æºï¼Œå°±éœ€è¦é…ç½®ç¬¬ä¸‰æ–¹ä»“åº“ï¼ˆä¹Ÿå¯ä»¥ç†è§£ä¸ºåˆ«äººçš„å…¬å¼€ç§æœï¼‰ã€‚maven ä¸­å¤®ä»“åº“ä¸åŒ…å« GeoTools çš„ç›¸å…³èµ„æºï¼Œå› æ­¤éœ€è¦å•ç‹¬é…ç½® OSGeo Release Repository ä»“åº“ã€‚</p>\n<p>2ï¼Œé˜¿é‡Œé•œåƒå’Œæ¸…åé•œåƒåªæä¾›å¯¹ä¸­å¤®ä»“åº“çš„èµ„æºé•œåƒï¼Œå…¶ mirrorOf å±æ€§çš„å€¼åªèƒ½è®¾ç½®ä¸º centralï¼Œä¸è¦è®¾ç½®ä¸º * ã€‚å¦‚æœè®¾ç½®ä¸º *ï¼Œåˆ™æ‰€æœ‰ä»“åº“çš„ url éƒ½ä¼šè¢«æ›¿æ¢ï¼Œå¯¹äºæœ¬æ–‡çš„æƒ…å†µï¼Œå°±æ˜¯æœ¬æ¥åº”å½“å‘å¾€ OSGeo Release Repository ä»“åº“çš„è¯·æ±‚è¢«å‘å¾€é˜¿é‡Œäº‘é•œåƒï¼Œè€Œé˜¿é‡Œäº‘é•œåƒä¸åŒ…å« GeoTools çš„èµ„æºï¼Œè‡ªç„¶æ˜¯æ‰¾ä¸åˆ°äº†ã€‚æ­£ç¡®çš„åšæ³•æ˜¯æ¯ä¸ªé•œåƒçš„ mirrorOf å±æ€§åº”ä¸è¯¥é•œåƒå¯¹åº”çš„ä»“åº“çš„ id å±æ€§ä¿æŒä¸€è‡´ã€‚</p>\n<p>3ï¼Œè¿˜æœ‰ä¸€ç§éªšæ“ä½œï¼ˆé”™è¯¯æ“ä½œï¼‰ï¼Œå°±æ˜¯åœ¨ setting.xml å°†ä»“åº“ä½œä¸ºé•œåƒé…ç½®è¿›å»ã€‚ç”±äº maven çš„é•œåƒæœºåˆ¶ï¼Œä»“åº“çš„ url ä¼šè¢«æ›¿æ¢ä¸ºç¬¬ä¸€ä¸ªåŒ¹é…ä¸Šçš„é•œåƒï¼Œé‚£ä¹ˆåœ¨é˜¿é‡Œäº‘é•œåƒä¹‹å‰æ·»åŠ ä¸€ä¸ªï¼ˆä¼ªï¼‰ä»“åº“é•œåƒï¼Œä¹Ÿå¯ä»¥è§£å†³é—®é¢˜ã€‚ä½†æ˜¯è¿™ä¸ªæ–¹æ³•è‚¯å®šæ˜¯é”™è¯¯ç”¨æ³•ï¼ˆä½†æ˜¯å¾ˆéªšï¼‰ã€‚</p>\n<h3 id=\"é”™è¯¯é…ç½®\"><a class=\"anchor\" href=\"#é”™è¯¯é…ç½®\">#</a> é”™è¯¯é…ç½®</h3>\n<p>setting.xml</p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">&lt;!-- é˜¿é‡Œäº‘é•œåƒ --></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>mirror</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>id</span><span class=\"token punctuation\">></span></span>nexus-aliyun<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>id</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>mirrorOf</span><span class=\"token punctuation\">></span></span>*<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>mirrorOf</span><span class=\"token punctuation\">></span></span> <span class=\"token comment\">&lt;!-- æ­£ç¡®çš„å±æ€§ä¸º central --></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>Nexus aliyun<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>url</span><span class=\"token punctuation\">></span></span>http://maven.aliyun.com/nexus/content/groups/public<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>url</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>mirror</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p>æˆ–è€…</p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">&lt;!-- osgeoï¼ˆä¼ªï¼‰é•œåƒ --></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>mirror</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>id</span><span class=\"token punctuation\">></span></span>mirror-osgeo<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>id</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>mirrorOf</span><span class=\"token punctuation\">></span></span>osgeo<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>mirrorOf</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>Mirror Osgeo<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>url</span><span class=\"token punctuation\">></span></span>https://repo.osgeo.org/repository/release/<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>url</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>mirror</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\">&lt;!-- é˜¿é‡Œäº‘é•œåƒ --></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>mirror</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>id</span><span class=\"token punctuation\">></span></span>nexus-aliyun<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>id</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>mirrorOf</span><span class=\"token punctuation\">></span></span>*<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>mirrorOf</span><span class=\"token punctuation\">></span></span> <span class=\"token comment\">&lt;!-- æ­£ç¡®çš„å±æ€§ä¸º central --></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>Nexus aliyun<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>url</span><span class=\"token punctuation\">></span></span>http://maven.aliyun.com/nexus/content/groups/public<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>url</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>mirror</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p>pom.xml</p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>repository</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>   <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>id</span><span class=\"token punctuation\">></span></span>osgeo<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>id</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>   <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>OSGeo Release Repository<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>   <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>url</span><span class=\"token punctuation\">></span></span>https://repo.osgeo.org/repository/release/<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>url</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>   <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>snapshots</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>enabled</span><span class=\"token punctuation\">></span></span>false<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>enabled</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>snapshots</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>   <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>releases</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>enabled</span><span class=\"token punctuation\">></span></span>true<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>enabled</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>releases</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>repository</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><h3 id=\"æ­£ç¡®é…ç½®\"><a class=\"anchor\" href=\"#æ­£ç¡®é…ç½®\">#</a> æ­£ç¡®é…ç½®</h3>\n<p>setting.xml</p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">&lt;!-- é˜¿é‡Œäº‘é•œåƒ --></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>mirror</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>id</span><span class=\"token punctuation\">></span></span>nexus-aliyun<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>id</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>mirrorOf</span><span class=\"token punctuation\">></span></span>central<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>mirrorOf</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>Nexus aliyun<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>url</span><span class=\"token punctuation\">></span></span>http://maven.aliyun.com/nexus/content/groups/public<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>url</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>mirror</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p>pom.xml</p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>repository</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>   <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>id</span><span class=\"token punctuation\">></span></span>osgeo<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>id</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>   <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>OSGeo Release Repository<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>   <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>url</span><span class=\"token punctuation\">></span></span>https://repo.osgeo.org/repository/release/<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>url</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>   <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>snapshots</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>enabled</span><span class=\"token punctuation\">></span></span>false<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>enabled</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>snapshots</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>   <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>releases</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>enabled</span><span class=\"token punctuation\">></span></span>true<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>enabled</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>releases</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>repository</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><h2 id=\"å››å¦‚ä½•çŸ¥é“æ˜¯å¦éœ€è¦é…ç½®ä»“åº“\"><a class=\"anchor\" href=\"#å››å¦‚ä½•çŸ¥é“æ˜¯å¦éœ€è¦é…ç½®ä»“åº“\">#</a> å››ï¼Œå¦‚ä½•çŸ¥é“æ˜¯å¦éœ€è¦é…ç½®ä»“åº“ï¼Ÿ</h2>\n<p>åœ¨ maven çš„å®˜ç½‘å¯ä»¥æŸ¥è¯¢ç›¸å…³é¡¹ç›®çš„ä¿¡æ¯ï¼Œ<strong>é¡¹ç›®é¡µé¢çš„æ ‡ç­¾æ æ ‡è¯†äº†å­˜å‚¨äº†è¯¥é¡¹ç›®çš„ä»“åº“</strong>ï¼Œåªè¦æ˜¯å­˜å‚¨åœ¨ä¸­å¤®ä»“åº“çš„é¡¹ç›®éƒ½ä¼šæ ‡è¯† <code>Central</code>  æ ‡ç­¾ï¼Œæ­¤æ—¶å°±ä¸ç”¨é…ç½®æ–°çš„ä»“åº“ã€‚</p>\n<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20240809144253604.png\" alt=\"image-20240809144253604\" /></p>\n<p>å¦‚æœæ ‡ç­¾æ ä¸­æ²¡æœ‰æ ‡è¯† Central ä»“åº“ï¼Œè¯´æ˜ä¸­å¤®ä»“åº“ä¸åŒ…å«è¯¥é¡¹ç›®ï¼Œéœ€è¦é…ç½®æ–°çš„ä»“åº“ã€‚<br />\nå¦‚å¯¹äº GeoTools åŒ…ï¼Œä»å›¾ä¸­æˆ‘ä»¬å¯çŸ¥ï¼Œç”±äº Central ä»“åº“ä¸åŒ…å«è¯¥åŒ…ï¼Œæˆ‘ä»¬å°±éœ€è¦ä»å…¶æ ‡ç­¾æ æ ‡è¯†çš„ GeoSolutions ä»“åº“ã€Geomajas ä»“åº“ã€Boundless ä»“åº“æˆ– OSGeo ä»“åº“æ‹‰å– GeoTools åŒ…çš„èµ„æº<br />\n<img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20240809144310027.png\" alt=\"image-20240809144310027\" /></p>\n",
            "tags": [
                "è®¡ç®—æœºå­¦ç§‘",
                "blog",
                "maven",
                "è®¡ç®—æœºå­¦ç§‘ - blog - maven"
            ]
        },
        {
            "id": "https://pigpigletsgo.github.io/bug/windows/%E4%BF%AE%E6%94%B9%E7%94%B5%E8%84%91%E7%94%A8%E6%88%B7%E5%90%8D%E4%B8%BA%E8%8B%B1%E6%96%87/",
            "url": "https://pigpigletsgo.github.io/bug/windows/%E4%BF%AE%E6%94%B9%E7%94%B5%E8%84%91%E7%94%A8%E6%88%B7%E5%90%8D%E4%B8%BA%E8%8B%B1%E6%96%87/",
            "title": "ä¿®æ”¹ç”µè„‘ç”¨æˆ·åä¸ºè‹±æ–‡ï¼ˆwin11ã€win10ä¿®æ”¹ç”¨æˆ·åï¼‰",
            "date_published": "2024-08-09T01:50:36.298Z",
            "content_html": "<h1 id=\"ä¿®æ”¹ç”µè„‘ç”¨æˆ·åä¸ºè‹±æ–‡win11-win10ä¿®æ”¹ç”¨æˆ·å\"><a class=\"anchor\" href=\"#ä¿®æ”¹ç”µè„‘ç”¨æˆ·åä¸ºè‹±æ–‡win11-win10ä¿®æ”¹ç”¨æˆ·å\">#</a> ä¿®æ”¹ç”µè„‘ç”¨æˆ·åä¸ºè‹±æ–‡ï¼ˆwin11ã€win10 ä¿®æ”¹ç”¨æˆ·åï¼‰</h1>\n<h2 id=\"ç¬¬ä¸€æ­¥\"><a class=\"anchor\" href=\"#ç¬¬ä¸€æ­¥\">#</a> ç¬¬ä¸€æ­¥</h2>\n<p>å¼€å¯ç®¡ç†å‘˜è´¦æˆ·ã€‚ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ cmd</p>\n<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20240809093150220.png\" alt=\"image-20240809093150220\" /></p>\n<p>è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼š</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>net user administrator /active:yes</pre></td></tr></table></figure><p>æ­¤æ—¶åœ¨ä½ çš„å¼€å§‹ä¸­ä¼šå¤šä¸€ä¸ª ç®¡ç†å‘˜è´¦æˆ·ï¼Œå¦‚æœæ²¡æœ‰ä¹Ÿä¸ç”¨æ€¥ï¼Œä½ ç‚¹å‡»åˆ‡æ¢ç”¨æˆ·ååº”è¯¥å¯ä»¥çœ‹åˆ°å¤šå‡ºæ¥çš„ç®¡ç†å‘˜è´¦æˆ·çš„</p>\n<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20240809093243690.png\" alt=\"image-20240809093243690\" /></p>\n<p>æˆ‘ä»¬åˆ‡æ¢åˆ°ç®¡ç†å‘˜è´¦æˆ·ä¸­å»</p>\n<h2 id=\"ç¬¬äºŒæ­¥\"><a class=\"anchor\" href=\"#ç¬¬äºŒæ­¥\">#</a> ç¬¬äºŒæ­¥</h2>\n<p>å®Œæˆç¬¬ä¸€æ­¥åå¹¶ä¸éœ€è¦é‡å¯ç”µè„‘ã€‚åªéœ€è¦å…ˆæŠŠå½“å‰ç”¨æˆ· (éœ€è¦ä¿®æ”¹çš„ç”¨æˆ·) æ³¨é”€ï¼ˆæ³¨é”€ä¹‹å‰è¦ä¿è¯é‡Œé¢çš„é‡è¦æ–‡ä»¶å·²ç»ä¿å­˜å¥½äº†ï¼Œæœ€å¥½å°±æ˜¯å¼€æœºä¹‹åä¸è¦è¿è¡Œä»»ä½•ä¸œè¥¿ï¼Œç›´æ¥æ‰§è¡Œç¬¬ä¸€æ­¥çš„æ“ä½œï¼‰ï¼Œç„¶ååœ¨ç™»å½•é¡µé¢é€‰æ‹© Administrator èº«ä»½ç™»å½•ã€‚</p>\n<p>â€‹    æ­¤æ—¶æ‰¾åˆ° C:\\Users ä¸‹é¢ï¼Œæ›´æ”¹ç›´æ¥çš„ä¸­æ–‡åç§°çš„ç”¨æˆ·æ–‡ä»¶å¤¹</p>\n<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20240809093409723.png\" alt=\"image-20240809093409723\" /></p>\n<p>è¿™æ¬¡å°±åˆ«å†æ”¹æˆä¸­æ–‡äº†ï¼Œç›´æ¥æ”¹æˆè‹±æ–‡åã€‚ï¼ˆä¸Šå›¾æˆ‘æ˜¯å·²ç»ä¿®æ”¹å¥½çš„äº†ï¼‰</p>\n<blockquote>\n<p>å¦‚æœ æŠŠå½“å‰ç”¨æˆ· (éœ€è¦ä¿®æ”¹çš„ç”¨æˆ·) æ³¨é”€äº†ä½†æ˜¯è¿˜æ˜¯ä¾æ—§æç¤ºè¿›ç¨‹è¢«ä½¿ç”¨ï¼Œé‚£ä¹ˆå°±éœ€è¦è¿›è¡Œä¸‹é¢æ“ä½œã€‚</p>\n</blockquote>\n<p>ä¿®æ”¹ç”¨æˆ·åçš„æ—¶å€™å¯èƒ½ä¼šå‡ºç° â€œæ–‡ä»¶å¤¹æˆ–é‡Œé¢çš„æ–‡ä»¶æ­£åœ¨è¢«å ç”¨ï¼Œæ— æ³•æ›´æ”¹â€ çš„é—®é¢˜</p>\n<p>æ­¤æ—¶ä¹Ÿä¸éœ€è¦é‡å¯ç”µè„‘å•¥çš„ï¼Œç½‘ä¸Šæœ‰ç”¨çš„åšå®¢å¾ˆå°‘ã€‚è¿™æ˜¯å› ä¸ºç¬”è®°æœ¬é‡ŒæŸäº›åº”ç”¨ä¾æ—§ä½¿ç”¨ç€ä½ è¿™ä¸ªç”¨æˆ·ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œåªéœ€è¦æŠŠè¿™ä¸ªè¿›ç¨‹å…³æ‰å°±å¯ä»¥äº†ã€‚å…·ä½“æ–¹æ³•å¦‚ä¸‹</p>\n<p>é¦–å…ˆï¼šesc+shift+ctrl è¿›å…¥ä»»åŠ¡ç®¡ç†å™¨ï¼Œç„¶åç‚¹å‡»æ€§èƒ½ï¼Œå†åˆ°æ€§èƒ½é¡µé¢ä¸‹é¢æ‰¾åˆ°èµ„æºç›‘è§†å™¨</p>\n<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20240809093732516.png\" alt=\"image-20240809093732516\" /></p>\n<p>åœ¨è¿™ä¸ªé¡µé¢çš„ CPU é€‰é¡¹ä¸‹ï¼Œæ‰¾åˆ° â€œå…³è”çš„å¥æŸ„â€ï¼Œç„¶åæœç´¢éœ€è¦é‡å‘½åçš„æ–‡ä»¶å¤¹ï¼Œå†å³é”®ç»“æŸè¿›ç¨‹å³å¯ï¼Œè¿™æ ·å­å°±èƒ½é‡å‘½åä½ çš„ç”¨æˆ·æ–‡ä»¶å¤¹äº†</p>\n<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20240809093757206.png\" alt=\"image-20240809093757206\" /></p>\n<h2 id=\"ç¬¬ä¸‰æ­¥\"><a class=\"anchor\" href=\"#ç¬¬ä¸‰æ­¥\">#</a> ç¬¬ä¸‰æ­¥</h2>\n<p>ä¿®æ”¹æ³¨å†Œè¡¨</p>\n<p>win+r æ‰“å¼€è¿è¡Œ è¾“å…¥ regedit</p>\n<p>è¿›å…¥æ³¨å†Œè¡¨ç¼–è¾‘å™¨</p>\n<p>æ‰¾åˆ°è¿™ä¸ªç›®å½•ï¼š</p>\n<blockquote>\n<p>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\ProfileListï¼Œ</p>\n</blockquote>\n<p>ç„¶åé€‰æ‹©å°¾å·´ä¸€é•¿ä¸²çš„å¯¹åº”æ–‡ä»¶å¤¹ï¼Œä¾æ¬¡ç‚¹å‡»ï¼Œæ‰¾åˆ°åŒ…å« C:\\Users\\ å†¤ç§çš„è·¯å¾„ï¼Œå°†å†¤ç§æ›¿æ¢ä¸º duanï¼Œè¿™åªæ˜¯ä¸€ä¸ªç¤ºèŒƒï¼Œå…·ä½“çœ‹ä½ æ€ä¹ˆæ”¹ï¼Œåæ­£å°±æ˜¯è‹±æ–‡æ›¿æ¢åŸä¸­æ–‡å</p>\n<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20240809093845274.png\" alt=\"image-20240809093845274\" /></p>\n<p>åœ¨ <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Usermanager</code>  ç›®å½•ä¸‹åšå‡ºåŒæ ·çš„ä¿®æ”¹</p>\n<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20240809093910270.png\" alt=\"image-20240809093910270\" /></p>\n<h2 id=\"ç¬¬å››æ­¥\"><a class=\"anchor\" href=\"#ç¬¬å››æ­¥\">#</a> ç¬¬å››æ­¥</h2>\n<p>å…³é—­ç®¡ç†å‘˜è´¦æˆ·</p>\n<p>é‡å¤ç¬¬ä¸€æ­¥çš„æ“ä½œï¼Œåªä¸è¿‡æ˜¯æŠŠåé¢çš„ yes æ”¹æˆ no</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>net user administrator /active:no</pre></td></tr></table></figure><h2 id=\"ç¬¬äº”æ­¥åˆ‡æ¢åˆ°è¦ä¿®æ”¹çš„ç”¨æˆ·\"><a class=\"anchor\" href=\"#ç¬¬äº”æ­¥åˆ‡æ¢åˆ°è¦ä¿®æ”¹çš„ç”¨æˆ·\">#</a> ç¬¬äº”æ­¥ï¼šåˆ‡æ¢åˆ°è¦ä¿®æ”¹çš„ç”¨æˆ·</h2>\n<p>ä¿®æ”¹ç¯å¢ƒå˜é‡</p>\n<p>æ­¤ç”µè„‘ -&gt; å±æ€§ -&gt; é«˜çº§ç³»ç»Ÿè®¾ç½® -&gt; é«˜çº§ -&gt; ç¯å¢ƒå˜é‡</p>\n<p>è¿›å…¥ç¯å¢ƒå˜é‡åï¼Œé€‰æ‹©ç”¨æˆ·å˜é‡ï¼Œå°†æ‰€æœ‰åŸæ¥çš„ä¸­æ–‡ç”¨æˆ·åæ”¹æˆä½ åˆšåˆšä¿®æ”¹çš„è‹±æ–‡å</p>\n<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20240809094005956.png\" alt=\"image-20240809094005956\" /></p>\n<h2 id=\"ç¬¬å…­æ­¥\"><a class=\"anchor\" href=\"#ç¬¬å…­æ­¥\">#</a> ç¬¬å…­æ­¥</h2>\n<p>ä¿®æ”¹ç”¨æˆ·å</p>\n<p>win+r æ‰“å¼€è¿è¡Œï¼Œè¾“å…¥:control userpasswords2 ç‚¹å‡»ç¡®å®šï¼Œè¿›å…¥ã€ç”¨æˆ·è´¦æˆ·ã€‘ç•Œé¢ï¼Œé€‰æ‹©è¦æ›´æ”¹çš„è´¦æˆ·ï¼Œç‚¹å‡»ã€å±æ€§ã€‘ï¼Œä¿®æ”¹æ­¤æ—¶çš„ä¸­æ–‡ç”¨æˆ·åå³å¯ï¼Œä¿®æ”¹åè®°å¾—ç‚¹å‡»åº”ç”¨ã€‚</p>\n<p>ç„¶åæ³¨é”€å½“å‰è´¦å·ï¼Œé‡å¯è®¡ç®—æœºï¼Œé‡æ–°ç™»å½•å³å¯ã€‚</p>\n<p>ä¿®æ”¹å®Œå onedrive è´¦å·å°†ä¸å¯ç”¨ï¼Œä¼šæŠ¥è·¯å¾„é”™è¯¯ï¼Œä½†æ˜¯æ²¡æœ‰å…³ç³»ï¼Œå’±ä»¬å…ˆå°† Onedrive è´¦æˆ·é€€å‡ºï¼Œçœ‹æ¥ä¸‹æ¥çš„ç¬¬ä¸ƒæ­¥æ“ä½œã€‚</p>\n<p>æ­¤æ—¶ä¹Ÿå¯ä»¥é€šè¿‡ cmd è¾“å…¥ set username æŸ¥çœ‹å½“å‰ç”¨æˆ·åæ˜¯å¦å·²ç»æ”¹å˜</p>\n<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20240809094147663.png\" alt=\"image-20240809094147663\" /></p>\n<h2 id=\"ç¬¬ä¸ƒæ­¥é‡è¦\"><a class=\"anchor\" href=\"#ç¬¬ä¸ƒæ­¥é‡è¦\">#</a> ç¬¬ä¸ƒæ­¥ï¼šé‡è¦ï¼ï¼ï¼</h2>\n<p>è½¯ä»¶è·¯å¾„ä¿®å¤</p>\n<p>å› ä¸ºä¿®æ”¹äº†ç”¨æˆ·æ–‡ä»¶åï¼Œå¾ˆå¤šè½¯ä»¶çš„å­˜å‚¨è·¯å¾„ä¾æ—§åŒ…å«ä½ è¿™ä¸ªæ—§çš„ä¸­æ–‡ç”¨æˆ·åã€‚å› æ­¤æˆ‘ä»¬éœ€è¦ä¿®å¤ã€‚ç‰¹åˆ«æ˜¯åœ¨å‰é¢è¿›è¡Œäº†ä¿®æ”¹æ­¥éª¤ä¹‹åï¼Œä½ é‡å¯è®¡ç®—æœºä¹‹åï¼Œæ¡Œé¢åªå‰©ä¸‹æ­¤ç”µè„‘å’Œå›æ”¶ç«™äº†ã€‚è€Œä¸”è¿˜ä¼šæŠ¥è·¯å¾„é”™è¯¯ã€‚</p>\n<p><strong>ä¿®æ”¹çš„åŠæ³•æœ‰ä¸¤ä¸ª - ä»»é€‰å…¶ä¸€å°±è¡Œ</strong></p>\n<p>1ï¼Œé‡å¤ç¬¬ä¸€æ­¥ï¼Œåœ¨ cmd ä¸­é”®å…¥</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>mklink /d C:<span class=\"token punctuation\">\\</span>Users<span class=\"token punctuation\">\\</span>è€ç”¨æˆ·å C:<span class=\"token punctuation\">\\</span>Users<span class=\"token punctuation\">\\</span>æ–°ç”¨æˆ·å</pre></td></tr></table></figure><p>ç‚¹å‡»ç¡®å®šï¼Œå³å¯ã€‚æ­¤ä¸¾æ˜¯å°† C:\\Users\\ è€ç”¨æˆ·å çš„è·¯å¾„å…¨éƒ¨æŒ‚é’©åˆ° C:\\Users\\ æ–°ç”¨æˆ·å ä¸Šã€‚å› æ­¤ä½ é‡æ–°æ‰“å¼€ C ç›˜çš„ç”¨æˆ·ç›®å½•ä¸‹ä¼šå‘ç°è€ç”¨æˆ·åæ–‡ä»¶å¤¹ä¸‹å¤šäº†ä¸€ä¸ªè¶…çº§é“¾æ¥æ ‡è¯†</p>\n<p>2ï¼Œä½¿ç”¨ç³»ç»Ÿè‡ªå¸¦çš„ä¿®å¤ç¨‹åº (repair)ï¼Œè½¯ä»¶è®¾ç½®ç­‰é€‰é¡¹å¯èƒ½åŒ…å«ä¿®å¤ã€è½¯ä»¶å¸è½½æˆ–å®‰è£…ç¨‹åºè¿è¡Œæ—¶å¯èƒ½å¼¹å‡ºä¿®å¤é€‰é¡¹</p>\n<p><strong>æ¨èä½¿ç”¨ç¬¬ä¸€ä¸ªæ–¹æ³•</strong></p>\n",
            "tags": [
                "é—®é¢˜æ€»æ±‡",
                "windows",
                "é—®é¢˜æ€»æ±‡",
                "windows"
            ]
        },
        {
            "id": "https://pigpigletsgo.github.io/tools/idea/Idea%E6%8F%92%E4%BB%B6%E6%8E%A8%E8%8D%90/",
            "url": "https://pigpigletsgo.github.io/tools/idea/Idea%E6%8F%92%E4%BB%B6%E6%8E%A8%E8%8D%90/",
            "title": "Ideaæ’ä»¶æ¨è",
            "date_published": "2024-08-02T00:58:32.000Z",
            "content_html": "<h1 id=\"ideaæ’ä»¶æ¨è\"><a class=\"anchor\" href=\"#ideaæ’ä»¶æ¨è\">#</a> Idea æ’ä»¶æ¨è</h1>\n<ol>\n<li>AceJump</li>\n<li>Atom Material Icons</li>\n<li>Free MyBatis Tool</li>\n<li>Grep Console</li>\n<li>Idea Vim</li>\n<li>IdeaVim-EsayMotion</li>\n<li>IdeaVimExtension</li>\n<li>Maven Helper</li>\n<li>PMD</li>\n<li>RestfulTool</li>\n<li>PlantUML Integration</li>\n<li>Rainbow Brackets</li>\n<li>JRebel and XRebel</li>\n<li>EditStarters</li>\n<li>GenerateAllSetter</li>\n<li>Java Bean to Json</li>\n<li>GsonFormatPlus</li>\n<li>sequenceDiagram</li>\n<li>Quick Request</li>\n<li>Bean Assistant</li>\n<li>Rename Files Refactor Batch</li>\n<li>amplicode<br />\nPSï¼šæ•™ç¨‹ <span class=\"exturl\" data-url=\"aHR0cHM6Ly9hbXBsaWNvZGUucnUvZG9jdW1lbnRhdGlvbi9pbnN0YWxsYXRpb24tZ3VpZGUtaW50ZWxsaWov\">https://amplicode.ru/documentation/installation-guide-intellij/</span></li>\n<li>Code Reading Note</li>\n<li>CodeGlance</li>\n<li>CamelCase</li>\n<li>Extra ToolWindow Colorful Icons</li>\n<li>Background Image Plus</li>\n<li>jclasslib Bytecode Viewer</li>\n<li>TONGYI Lingma - Your AI Coding Assistant.â€‹ Type less,â€‹ Code more.ï¼ˆé€šä¹‰çµç ï¼‰</li>\n<li>MyBatisX</li>\n</ol>\n",
            "tags": [
                "tools",
                "idea",
                "idea",
                "tools"
            ]
        },
        {
            "id": "https://pigpigletsgo.github.io/computer-science/blog/java-io/java%E5%8E%8B%E7%BC%A9%E4%B8%8E%E8%A7%A3%E5%8E%8B%E6%96%87%E4%BB%B6-%E5%8A%A0%E5%AF%86%E4%B8%8E%E8%A7%A3%E5%AF%86%E6%96%87%E4%BB%B6/",
            "url": "https://pigpigletsgo.github.io/computer-science/blog/java-io/java%E5%8E%8B%E7%BC%A9%E4%B8%8E%E8%A7%A3%E5%8E%8B%E6%96%87%E4%BB%B6-%E5%8A%A0%E5%AF%86%E4%B8%8E%E8%A7%A3%E5%AF%86%E6%96%87%E4%BB%B6/",
            "title": "javaå‹ç¼©ä¸è§£å‹æ–‡ä»¶-åŠ å¯†ä¸è§£å¯†æ–‡ä»¶",
            "date_published": "2024-07-31T10:35:44.000Z",
            "content_html": "<h1 id=\"javaå‹ç¼©ä¸è§£å‹æ–‡ä»¶-åŠ å¯†ä¸è§£å¯†æ–‡ä»¶\"><a class=\"anchor\" href=\"#javaå‹ç¼©ä¸è§£å‹æ–‡ä»¶-åŠ å¯†ä¸è§£å¯†æ–‡ä»¶\">#</a> java å‹ç¼©ä¸è§£å‹æ–‡ä»¶ - åŠ å¯†ä¸è§£å¯†æ–‡ä»¶</h1>\n<h2 id=\"java-keygeneratoråŠ å¯†çš„æ¦‚è¿°\"><a class=\"anchor\" href=\"#java-keygeneratoråŠ å¯†çš„æ¦‚è¿°\">#</a> Java KeyGenerator åŠ å¯†çš„æ¦‚è¿°ï¼š</h2>\n<p>AES/CBC/PKCS5Padding æ˜¯ä¸€ç§å¸¸è§çš„åŠ å¯†é…ç½®ç»„åˆï¼Œç”¨äºåŠ å¯†å’Œè§£å¯†æ•°æ®ã€‚ä»¥ä¸‹æ˜¯æ¯ä¸ªéƒ¨åˆ†çš„è¯¦ç»†è§£é‡Š</p>\n<h3 id=\"aesadvanced-encryption-standard\"><a class=\"anchor\" href=\"#aesadvanced-encryption-standard\">#</a> AES(Advanced Encryption Standard)</h3>\n<p>AES (é«˜çº§åŠ å¯†æ ‡å‡†) æ˜¯ä¸€ç§å¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œç”¨äºåŠ å¯†å’Œè§£å¯†æ•°æ®ã€‚å®ƒæ”¯æŒä¸‰ç§ä¸åŒçš„å¯†é’¥é•¿åº¦ï¼š</p>\n<blockquote>\n<p>128 ä½ï¼Œ192 ä½å’Œ 256 ä½ã€‚AES æ˜¯ä¸€ç§åˆ†ç»„å¯†ç ï¼Œæ¯æ¬¡å¤„ç†å›ºå®šé•¿åº¦çš„æ•°æ®å— (128 ä½ï¼Œå³ 16 å­—èŠ‚)</p>\n</blockquote>\n<h3 id=\"cbccipher-block-chaining\"><a class=\"anchor\" href=\"#cbccipher-block-chaining\">#</a> CBC(Cipher Block Chaining)</h3>\n<p>CBC (å¯†ç åˆ†ç»„é“¾æ¥) æ˜¯ä¸€ç§åˆ†ç»„å¯†ç çš„å·¥ä½œæ¨¡å¼ã€‚åœ¨ CBC æ¨¡å¼ä¸­ï¼Œæ¯ä¸ªæ˜æ–‡å—åœ¨åŠ å¯†ä¹‹å‰ä¼šä¸å‰ä¸€ä¸ªå¯†æ–‡å—è¿›è¡Œå¼‚æˆ– (XOR) æ“ä½œã€‚è¿™ä½¿å¾—ç›¸åŒçš„æ˜æ–‡å—åœ¨åŠ å¯†åä¼šç”Ÿæˆä¸åŒçš„å¯†æ–‡å—ï¼Œä»è€Œå¢å¼ºäº†å®‰å…¨æ€§ã€‚</p>\n<ul>\n<li>åˆå§‹å‘é‡ (IV)ï¼šCBC æ¨¡å¼éœ€è¦ä¸€ä¸ªåˆå§‹å‘é‡ (IV) æ¥å¼€å§‹ç¬¬ä¸€ä¸ªæ˜æ–‡å—çš„åŠ å¯†è¿‡ç¨‹ã€‚IV å¿…é¡»æ˜¯å”¯ä¸€ä¸”ä¸å¯é¢„æµ‹çš„ï¼Œä½†ä¸éœ€è¦ä¿å¯†ã€‚IV çš„é•¿åº¦ä¸åˆ†ç»„å¤§å°ç›¸åŒ (å¯¹äº AES æ˜¯ 16 å­—èŠ‚)</li>\n<li>åŠ å¯†è¿‡ç¨‹ï¼šç¬¬ä¸€ä¸ªæ˜æ–‡å—ä¸ IV è¿›è¡Œå¼‚æˆ–ååŠ å¯†ï¼Œç”Ÿæˆç¬¬ä¸€ä¸ªå¯†æ–‡å—ã€‚ç¬¬äºŒä¸ªæ˜æ–‡å—ä¸ç¬¬ä¸€ä¸ªå¯†æ–‡å—å¼‚æˆ–ååŠ å¯†ï¼Œç”Ÿæˆç¬¬äºŒä¸ªå¯†æ–‡å—ï¼Œä»¥æ­¤ç±»æ¨</li>\n</ul>\n<h3 id=\"pkcs5padding\"><a class=\"anchor\" href=\"#pkcs5padding\">#</a> PKCS5Padding</h3>\n<p>PKCS5Padding æ˜¯ä¸€ç§å¡«å…… (Padding) æ–¹æ¡ˆï¼Œç”¨äºç¡®ä¿å¾…åŠ å¯†æ•°æ®çš„é•¿åº¦æ˜¯åˆ†ç»„å¤§å°çš„æ•´æ•°å€ã€‚</p>\n<p>AES æ˜¯ä¸€ç§åˆ†ç»„å¯†ç ï¼Œéœ€è¦æ•°æ®å—çš„é•¿åº¦æ˜¯åˆ†ç»„å¤§å°çš„æ•´æ•°å€ (16 å­—èŠ‚)ã€‚å¦‚æœå¾…åŠ å¯†æ•°æ®çš„é•¿åº¦ä¸æ˜¯ 16 å­—èŠ‚çš„æ•´æ•°å€ï¼Œå°±éœ€è¦å¡«å……ã€‚</p>\n<ul>\n<li>å¡«å……è§„åˆ™ï¼šPKCS5Padding è§„å®šæ¯ä¸ªå¡«å……å­—èŠ‚çš„å€¼ç­‰äºå¡«å……çš„å­—èŠ‚æ•°ã€‚ä¾‹å¦‚ï¼Œå¦‚æœéœ€è¦å¡«å…… 4 ä¸ªå­—èŠ‚ï¼Œåˆ™æ¯ä¸ªå¡«å……å­—èŠ‚çš„å€¼ç­‰äºå¡«å……çš„å­—èŠ‚æ•°ã€‚ä¾‹å¦‚ï¼Œå¦‚æœéœ€è¦å¡«å…… 4 ä¸ªå­—èŠ‚ï¼Œåˆ™æ¯ä¸ªå¡«å……å­—èŠ‚çš„å€¼ä¸º <code>0x04</code> ã€‚å¦‚æœéœ€è¦å¡«å…… 1 ä¸ªå­—èŠ‚ï¼Œåˆ™å¡«å……å€¼ä¸º <code>0x01</code> ã€‚å¦‚æœæ•°æ®é•¿åº¦æ­£å¥½æ˜¯åˆ†ç»„å¤§å°çš„æ•´æ•°å€ï¼Œåˆ™æ·»åŠ ä¸€ä¸ªå®Œæ•´çš„å¡«å……å— (16 å­—èŠ‚ï¼Œæ¯ä¸ªå­—èŠ‚å€¼ä¸º <code>0x10</code> )</li>\n</ul>\n<h3 id=\"ç»“åˆåœ¨ä¸€èµ·\"><a class=\"anchor\" href=\"#ç»“åˆåœ¨ä¸€èµ·\">#</a> ç»“åˆåœ¨ä¸€èµ·</h3>\n<p>AES/CBC/PKCS5Padding ç»“åˆä½¿ç”¨æ—¶ï¼Œæ•°æ®å…ˆç»è¿‡å¡«å…… (å¦‚æœéœ€è¦)ï¼Œç„¶ååˆ†å—ã€‚æ¯ä¸ªæ•°æ®å—åœ¨åŠ å¯†å‰ä¼šä¸å‰ä¸€ä¸ªå¯†æ–‡å—å¼‚æˆ–ï¼Œå¢å¼ºäº†å®‰å…¨æ€§</p>\n<pre><code>æ˜æ–‡ -&gt; å¡«å…… -&gt; åˆ†å— -&gt; AESåŠ å¯† (ä½¿ç”¨CBCæ¨¡å¼å’ŒIV)\n</code></pre>\n<h3 id=\"æ€»ç»“\"><a class=\"anchor\" href=\"#æ€»ç»“\">#</a> æ€»ç»“ï¼š</h3>\n<p>AES/CBC/PKCS5Padding æ˜¯ä¸€ç§å®‰å…¨çš„åŠ å¯†æ–¹æ¡ˆï¼Œé€‚ç”¨äºè®¸å¤šåº”ç”¨åœºæ™¯ã€‚AES æä¾›å¼ºå¤§çš„åŠ å¯†èƒ½åŠ›ï¼ŒCBC æ¨¡å¼é€šè¿‡é“¾å¼åŠ å¯†æé«˜å®‰å…¨æ€§ï¼ŒPKCS5Padding ç¡®ä¿æ•°æ®å—çš„é•¿åº¦é€‚åˆåŠ å¯†å¤„ç†ã€‚</p>\n<h2 id=\"ä»£ç å¦‚ä¸‹\"><a class=\"anchor\" href=\"#ä»£ç å¦‚ä¸‹\">#</a> ä»£ç å¦‚ä¸‹ï¼š</h2>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">javax<span class=\"token punctuation\">.</span>crypto<span class=\"token punctuation\">.</span></span><span class=\"token operator\">*</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">javax<span class=\"token punctuation\">.</span>crypto<span class=\"token punctuation\">.</span>spec<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">IvParameterSpec</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">javax<span class=\"token punctuation\">.</span>crypto<span class=\"token punctuation\">.</span>spec<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">SecretKeySpec</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>io<span class=\"token punctuation\">.</span></span><span class=\"token operator\">*</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>nio<span class=\"token punctuation\">.</span>charset<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Charset</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>nio<span class=\"token punctuation\">.</span>file<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Files</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>nio<span class=\"token punctuation\">.</span>file<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Paths</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>security<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">NoSuchAlgorithmException</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>security<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">SecureRandom</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>zip<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">ZipEntry</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>zip<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">ZipInputStream</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>zip<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">ZipOutputStream</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"15\"></td><td><pre> * zipIO å­¦ä¹ </pre></td></tr><tr><td data-num=\"16\"></td><td><pre> *</pre></td></tr><tr><td data-num=\"17\"></td><td><pre> * @author: çª¦å‡¯æ¬£</pre></td></tr><tr><td data-num=\"18\"></td><td><pre> * @date: 2024-07-30 11:20</pre></td></tr><tr><td data-num=\"19\"></td><td><pre> **/</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token annotation punctuation\">@SuppressWarnings</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"all\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Demo</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token comment\">// åŠ å¯†ç®—æ³•</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> <span class=\"token constant\">ALGORITHM</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"AES\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token comment\">// è½¬å‹</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> <span class=\"token constant\">TRANSFORMATION</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"AES/CBC/PKCS5Padding\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token comment\">// åŠ å¯†ç§˜é’¥å¤§å°</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">int</span> <span class=\"token constant\">KEY_SIZE</span> <span class=\"token operator\">=</span> <span class=\"token number\">128</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">int</span> <span class=\"token constant\">IV_SIZE</span> <span class=\"token operator\">=</span> <span class=\"token number\">16</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>        <span class=\"token comment\">// å‹ç¼©æ–‡ä»¶</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>        <span class=\"token class-name\">String</span> fileName <span class=\"token operator\">=</span> <span class=\"token string\">\"D:\\\\å†³ç­–æ”¯æŒå¹³å°\\\\äº”å¹´è§„åˆ’æŠ¥å‘Šæ¨¡æ¿\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        <span class=\"token class-name\">String</span> descName <span class=\"token operator\">=</span> <span class=\"token string\">\"D:\\\\è§£å‹ç¼©ç›®å½•\\\\åˆšå‹ç¼©.zip\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        <span class=\"token keyword\">new</span> <span class=\"token class-name\">Demo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">zipFile</span><span class=\"token punctuation\">(</span>fileName<span class=\"token punctuation\">,</span> descName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"å‹ç¼©æ–‡ä»¶å®Œæ¯•ï¼\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>        <span class=\"token comment\">// è§£å‹ç¼©æ–‡ä»¶</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>        <span class=\"token class-name\">String</span> zipFileName <span class=\"token operator\">=</span> <span class=\"token string\">\"D:\\\\è§£å‹ç¼©ç›®å½•\\\\åˆšå‹ç¼©.zip\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>        <span class=\"token class-name\">String</span> descFileName <span class=\"token operator\">=</span> <span class=\"token string\">\"D:\\\\è§£å‹ç¼©ç›®å½•\\\\\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>         <span class=\"token keyword\">new</span> <span class=\"token class-name\">Demo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">unzipFile</span><span class=\"token punctuation\">(</span>zipFileName<span class=\"token punctuation\">,</span> descFileName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>         <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"æ–‡ä»¶è§£å‹ç¼©å®Œæ¯•ï¼\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>        <span class=\"token comment\">// ç”Ÿæˆå¯†é’¥</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>        <span class=\"token class-name\">SecretKey</span> secretKey <span class=\"token operator\">=</span> <span class=\"token function\">generateKey</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>        <span class=\"token comment\">// å°†å¯†é’¥ä¿å­˜åˆ°ç£ç›˜</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>        <span class=\"token function\">saveKey</span><span class=\"token punctuation\">(</span>secretKey<span class=\"token punctuation\">,</span> <span class=\"token string\">\"D:\\\\secret.txt\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>        <span class=\"token comment\">// ç”Ÿæˆ IV</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>        <span class=\"token class-name\">IvParameterSpec</span> iv <span class=\"token operator\">=</span> <span class=\"token function\">generateIv</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>        <span class=\"token comment\">// IV ä¿å­˜åˆ°ç£ç›˜</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>        <span class=\"token function\">saveIv</span><span class=\"token punctuation\">(</span>iv<span class=\"token punctuation\">,</span> <span class=\"token string\">\"D:\\\\iv.txt\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"å¯†é’¥ä¸IVç”Ÿæˆå¹¶ä¿å­˜ç£ç›˜å®Œæ¯•ï¼Œè¯·åšæ£€æŸ¥ã€‚\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>        <span class=\"token comment\">// åŠ å¯†æ–‡ä»¶</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>        <span class=\"token class-name\">String</span> fileNamePwd <span class=\"token operator\">=</span> <span class=\"token string\">\"D:\\\\è§£å‹ç¼©ç›®å½•\\\\äº”å¹´è§„åˆ’æŠ¥å‘Šæ¨¡æ¿\\\\0-å¤©ç„¶æ°”ç®¡ç½‘ä¸šåŠ¡â€œXXäº”â€å‘å±•è§„åˆ’-å‘å±•åŸºç¡€ï¼ˆ1-43ï¼‰.docx\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>        <span class=\"token class-name\">String</span> descFileNamePwd <span class=\"token operator\">=</span> <span class=\"token string\">\"D:\\\\è§£å‹ç¼©ç›®å½•\\\\åŠ å¯†æ–‡ä»¶.dat\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>        <span class=\"token keyword\">new</span> <span class=\"token class-name\">BugFixes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">encryptFile</span><span class=\"token punctuation\">(</span>secretKey<span class=\"token punctuation\">,</span> iv<span class=\"token punctuation\">,</span> fileNamePwd<span class=\"token punctuation\">,</span> descFileNamePwd<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"æ–‡ä»¶åŠ å¯†å®Œæ¯•ï¼\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>        <span class=\"token comment\">// ä»æ–‡ä»¶åŠ è½½å¯†é’¥å’Œ IV</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>        <span class=\"token class-name\">SecretKey</span> secretKeyHF <span class=\"token operator\">=</span> <span class=\"token function\">loadKey</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"D:\\\\secret.txt\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>        <span class=\"token class-name\">IvParameterSpec</span> ivHF <span class=\"token operator\">=</span> <span class=\"token function\">loadIv</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"D:\\\\iv.txt\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"secretKeyHF = \"</span> <span class=\"token operator\">+</span> secretKeyHF<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>        <span class=\"token comment\">// è§£å¯†æ–‡ä»¶</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>        <span class=\"token class-name\">String</span> fileNameHF <span class=\"token operator\">=</span> <span class=\"token string\">\"D:\\\\è§£å‹ç¼©ç›®å½•\\\\åŠ å¯†æ–‡ä»¶.dat\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>        <span class=\"token class-name\">String</span> descFileNameHF <span class=\"token operator\">=</span> <span class=\"token string\">\"D:\\\\è§£å‹ç¼©ç›®å½•\\\\è§£å¯†æ–‡ä»¶.docx\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>        <span class=\"token keyword\">new</span> <span class=\"token class-name\">BugFixes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">decryptFile</span><span class=\"token punctuation\">(</span>secretKeyHF<span class=\"token punctuation\">,</span> ivHF<span class=\"token punctuation\">,</span> fileNameHF<span class=\"token punctuation\">,</span> descFileNameHF<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"æ–‡ä»¶è§£å¯†å®Œæ¯•ï¼\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>    <span class=\"token comment\">// å‹ç¼©æ–‡ä»¶</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">zipFile</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> srcDir<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> zipFileName<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">FileOutputStream</span> fos <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FileOutputStream</span><span class=\"token punctuation\">(</span>zipFileName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>             <span class=\"token class-name\">ZipOutputStream</span> zos <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ZipOutputStream</span><span class=\"token punctuation\">(</span>fos<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>            <span class=\"token class-name\">File</span> srcFile <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">(</span>srcDir<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>            <span class=\"token function\">compressDirectoryToZipFile</span><span class=\"token punctuation\">(</span>srcFile<span class=\"token punctuation\">.</span><span class=\"token function\">getParent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> srcFile<span class=\"token punctuation\">.</span><span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> zos<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"81\"></td><td><pre></pre></td></tr><tr><td data-num=\"82\"></td><td><pre>    <span class=\"token comment\">// é€’å½’ç›®å½•ä¸­çš„æ–‡ä»¶è¿›è¡Œå¤„ç†</span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">compressDirectoryToZipFile</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> rootDir<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> srcDir<span class=\"token punctuation\">,</span> <span class=\"token class-name\">ZipOutputStream</span> zos<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">IOException</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>        <span class=\"token class-name\">File</span> srcFile <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">(</span>rootDir<span class=\"token punctuation\">,</span> srcDir<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>srcFile<span class=\"token punctuation\">.</span><span class=\"token function\">isDirectory</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre>            <span class=\"token class-name\">File</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> files <span class=\"token operator\">=</span> srcFile<span class=\"token punctuation\">.</span><span class=\"token function\">listFiles</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre>            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>files <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre>                <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">File</span> file <span class=\"token operator\">:</span> files<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"89\"></td><td><pre>                    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">.</span><span class=\"token function\">isDirectory</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"90\"></td><td><pre>                        <span class=\"token function\">compressDirectoryToZipFile</span><span class=\"token punctuation\">(</span>rootDir<span class=\"token punctuation\">,</span> srcDir <span class=\"token operator\">+</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">.</span>separator <span class=\"token operator\">+</span> file<span class=\"token punctuation\">.</span><span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> zos<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"91\"></td><td><pre>                    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"92\"></td><td><pre>                        <span class=\"token function\">compressFileToZipFile</span><span class=\"token punctuation\">(</span>rootDir<span class=\"token punctuation\">,</span> srcDir <span class=\"token operator\">+</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">.</span>separator <span class=\"token operator\">+</span> file<span class=\"token punctuation\">.</span><span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> zos<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"93\"></td><td><pre>                    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"94\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"95\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"96\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"97\"></td><td><pre>            <span class=\"token function\">compressFileToZipFile</span><span class=\"token punctuation\">(</span>rootDir<span class=\"token punctuation\">,</span> srcDir<span class=\"token punctuation\">,</span> zos<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"98\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"99\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"100\"></td><td><pre></pre></td></tr><tr><td data-num=\"101\"></td><td><pre>    <span class=\"token comment\">// å°†ä¼ å…¥çš„æ–‡ä»¶è¿›è¡Œå‹ç¼©</span></pre></td></tr><tr><td data-num=\"102\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">compressFileToZipFile</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> rootDir<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> srcFile<span class=\"token punctuation\">,</span> <span class=\"token class-name\">ZipOutputStream</span> zos<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">IOException</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"103\"></td><td><pre>        <span class=\"token class-name\">File</span> file <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">(</span>rootDir<span class=\"token punctuation\">,</span> srcFile<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"104\"></td><td><pre>        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">FileInputStream</span> fis <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FileInputStream</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"105\"></td><td><pre>             <span class=\"token class-name\">BufferedInputStream</span> bis <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">BufferedInputStream</span><span class=\"token punctuation\">(</span>fis<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"106\"></td><td><pre>            <span class=\"token class-name\">ZipEntry</span> zipEntry <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ZipEntry</span><span class=\"token punctuation\">(</span>srcFile<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"107\"></td><td><pre>            zos<span class=\"token punctuation\">.</span><span class=\"token function\">putNextEntry</span><span class=\"token punctuation\">(</span>zipEntry<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"108\"></td><td><pre>            <span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> buffer <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token number\">1024</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"109\"></td><td><pre>            <span class=\"token keyword\">int</span> len<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"110\"></td><td><pre>            <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>len <span class=\"token operator\">=</span> bis<span class=\"token punctuation\">.</span><span class=\"token function\">read</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"111\"></td><td><pre>                zos<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> len<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"112\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"113\"></td><td><pre>            zos<span class=\"token punctuation\">.</span><span class=\"token function\">closeEntry</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"114\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"115\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"116\"></td><td><pre></pre></td></tr><tr><td data-num=\"117\"></td><td><pre>    <span class=\"token comment\">// è§£å‹ç¼©æ–‡ä»¶</span></pre></td></tr><tr><td data-num=\"118\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">unzipFile</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> zipFileName<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> descFileName<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"119\"></td><td><pre>        <span class=\"token class-name\">String</span> descFileNames <span class=\"token operator\">=</span> descFileName<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"120\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>descFileNames<span class=\"token punctuation\">.</span><span class=\"token function\">endsWith</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">File</span><span class=\"token punctuation\">.</span>separator<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"121\"></td><td><pre>            descFileNames <span class=\"token operator\">=</span> descFileNames <span class=\"token operator\">+</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">.</span>separator<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"122\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"123\"></td><td><pre>        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"124\"></td><td><pre>                <span class=\"token class-name\">InputStream</span> fileStream <span class=\"token operator\">=</span> <span class=\"token class-name\">Files</span><span class=\"token punctuation\">.</span><span class=\"token function\">newInputStream</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Paths</span><span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>zipFileName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"125\"></td><td><pre>                <span class=\"token class-name\">ZipInputStream</span> zipInputStream <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ZipInputStream</span><span class=\"token punctuation\">(</span>fileStream<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Charset</span><span class=\"token punctuation\">.</span><span class=\"token function\">forName</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"GBK\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"126\"></td><td><pre>        <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"127\"></td><td><pre>            <span class=\"token comment\">// æ ¹æ® ZIP æ–‡ä»¶åˆ›å»º ZipInputStream å¯¹è±¡</span></pre></td></tr><tr><td data-num=\"128\"></td><td><pre>            <span class=\"token class-name\">ZipEntry</span> entry<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"129\"></td><td><pre>            <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>entry <span class=\"token operator\">=</span> zipInputStream<span class=\"token punctuation\">.</span><span class=\"token function\">getNextEntry</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"130\"></td><td><pre>                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>entry<span class=\"token punctuation\">.</span><span class=\"token function\">isDirectory</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"131\"></td><td><pre>                    <span class=\"token comment\">// å¦‚æœæ˜¯æ–‡ä»¶å¤¹ï¼Œåˆ›å»ºç›®å½•</span></pre></td></tr><tr><td data-num=\"132\"></td><td><pre>                    <span class=\"token keyword\">boolean</span> mkdir <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">(</span>descFileNames <span class=\"token operator\">+</span> entry<span class=\"token punctuation\">.</span><span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">mkdirs</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"133\"></td><td><pre>                    <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"åˆ›å»ºç›®å½•\"</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>mkdir <span class=\"token operator\">?</span> <span class=\"token string\">\"æˆåŠŸ\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"å¤±è´¥\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"äº†\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"134\"></td><td><pre>                    <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"135\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"136\"></td><td><pre>                <span class=\"token comment\">// åˆ›å»ºè¾“å‡ºæ–‡ä»¶</span></pre></td></tr><tr><td data-num=\"137\"></td><td><pre>                <span class=\"token class-name\">File</span> outFile <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">(</span>descFileNames <span class=\"token operator\">+</span> entry<span class=\"token punctuation\">.</span><span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"138\"></td><td><pre>                <span class=\"token comment\">// åˆ›å»ºçˆ¶ç›®å½•</span></pre></td></tr><tr><td data-num=\"139\"></td><td><pre>                <span class=\"token keyword\">boolean</span> mkdir <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">(</span>outFile<span class=\"token punctuation\">.</span><span class=\"token function\">getParent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">mkdirs</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"140\"></td><td><pre>                <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"åˆ›å»ºçˆ¶ç›®å½•\"</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>mkdir <span class=\"token operator\">?</span> <span class=\"token string\">\"æˆåŠŸ\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"å¤±è´¥\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"äº†\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"141\"></td><td><pre>                <span class=\"token keyword\">try</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">BufferedOutputStream</span> bufferedOutputStream <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">BufferedOutputStream</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Files</span><span class=\"token punctuation\">.</span><span class=\"token function\">newOutputStream</span><span class=\"token punctuation\">(</span>outFile<span class=\"token punctuation\">.</span><span class=\"token function\">toPath</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"142\"></td><td><pre>                    <span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> buf <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token number\">1024</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"143\"></td><td><pre>                    <span class=\"token keyword\">int</span> readByte<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"144\"></td><td><pre>                    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>readByte <span class=\"token operator\">=</span> zipInputStream<span class=\"token punctuation\">.</span><span class=\"token function\">read</span><span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"145\"></td><td><pre>                        bufferedOutputStream<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> readByte<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"146\"></td><td><pre>                    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"147\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"148\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"149\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"150\"></td><td><pre>            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"151\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"152\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"153\"></td><td><pre></pre></td></tr><tr><td data-num=\"154\"></td><td><pre>    <span class=\"token comment\">// ç”Ÿæˆå¯†é’¥</span></pre></td></tr><tr><td data-num=\"155\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">SecretKey</span> <span class=\"token function\">generateKey</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"156\"></td><td><pre>        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"157\"></td><td><pre>            <span class=\"token class-name\">KeyGenerator</span> keyGen <span class=\"token operator\">=</span> <span class=\"token class-name\">KeyGenerator</span><span class=\"token punctuation\">.</span><span class=\"token function\">getInstance</span><span class=\"token punctuation\">(</span><span class=\"token constant\">ALGORITHM</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"158\"></td><td><pre>            keyGen<span class=\"token punctuation\">.</span><span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token constant\">KEY_SIZE</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SecureRandom</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"159\"></td><td><pre>            <span class=\"token keyword\">return</span> keyGen<span class=\"token punctuation\">.</span><span class=\"token function\">generateKey</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"160\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">NoSuchAlgorithmException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"161\"></td><td><pre>            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"162\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"163\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"164\"></td><td><pre></pre></td></tr><tr><td data-num=\"165\"></td><td><pre>    <span class=\"token comment\">// ä¿å­˜å¯†é’¥åˆ°ç£ç›˜</span></pre></td></tr><tr><td data-num=\"166\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">saveKey</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">SecretKey</span> key<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> filePath<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"167\"></td><td><pre>        <span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> keyBytes <span class=\"token operator\">=</span> key<span class=\"token punctuation\">.</span><span class=\"token function\">getEncoded</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"168\"></td><td><pre>        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">FileOutputStream</span> fos <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FileOutputStream</span><span class=\"token punctuation\">(</span>filePath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"169\"></td><td><pre>            fos<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span>keyBytes<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"170\"></td><td><pre>            <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"keyBytes = \"</span> <span class=\"token operator\">+</span> keyBytes<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"171\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"172\"></td><td><pre>            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"173\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"174\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"175\"></td><td><pre></pre></td></tr><tr><td data-num=\"176\"></td><td><pre>    <span class=\"token comment\">// ç”Ÿæˆ IV</span></pre></td></tr><tr><td data-num=\"177\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">IvParameterSpec</span> <span class=\"token function\">generateIv</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"178\"></td><td><pre>        <span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> iv <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token constant\">IV_SIZE</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"179\"></td><td><pre>        <span class=\"token keyword\">new</span> <span class=\"token class-name\">SecureRandom</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">nextBytes</span><span class=\"token punctuation\">(</span>iv<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"180\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">IvParameterSpec</span><span class=\"token punctuation\">(</span>iv<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"181\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"182\"></td><td><pre></pre></td></tr><tr><td data-num=\"183\"></td><td><pre>    <span class=\"token comment\">// å°† IV ä¿å­˜åˆ°ç£ç›˜</span></pre></td></tr><tr><td data-num=\"184\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">saveIv</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">IvParameterSpec</span> iv<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> filePath<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"185\"></td><td><pre>        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"186\"></td><td><pre>            <span class=\"token class-name\">Files</span><span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">(</span>filePath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toPath</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> iv<span class=\"token punctuation\">.</span><span class=\"token function\">getIV</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"187\"></td><td><pre>            <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"iv.getIV() = \"</span> <span class=\"token operator\">+</span> iv<span class=\"token punctuation\">.</span><span class=\"token function\">getIV</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"188\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">IOException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"189\"></td><td><pre>            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"190\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"191\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"192\"></td><td><pre></pre></td></tr><tr><td data-num=\"193\"></td><td><pre>    <span class=\"token comment\">// åŠ å¯†æ–‡ä»¶</span></pre></td></tr><tr><td data-num=\"194\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">encryptFile</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">SecretKey</span> secretKey<span class=\"token punctuation\">,</span> <span class=\"token class-name\">IvParameterSpec</span> iv<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> srcFile<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> destFile<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"195\"></td><td><pre>        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"196\"></td><td><pre>            <span class=\"token class-name\">Cipher</span> cipher <span class=\"token operator\">=</span> <span class=\"token class-name\">Cipher</span><span class=\"token punctuation\">.</span><span class=\"token function\">getInstance</span><span class=\"token punctuation\">(</span><span class=\"token constant\">TRANSFORMATION</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"197\"></td><td><pre>            cipher<span class=\"token punctuation\">.</span><span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Cipher</span><span class=\"token punctuation\">.</span><span class=\"token constant\">ENCRYPT_MODE</span><span class=\"token punctuation\">,</span> secretKey<span class=\"token punctuation\">,</span> iv<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"198\"></td><td><pre>            <span class=\"token keyword\">try</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">FileInputStream</span> fis <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FileInputStream</span><span class=\"token punctuation\">(</span>srcFile<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"199\"></td><td><pre>                 <span class=\"token class-name\">FileOutputStream</span> fos <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FileOutputStream</span><span class=\"token punctuation\">(</span>destFile<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"200\"></td><td><pre>                 <span class=\"token class-name\">CipherOutputStream</span> cos <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">CipherOutputStream</span><span class=\"token punctuation\">(</span>fos<span class=\"token punctuation\">,</span> cipher<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"201\"></td><td><pre>                <span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> buffer <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token number\">1024</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"202\"></td><td><pre>                <span class=\"token keyword\">int</span> read<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"203\"></td><td><pre>                <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>read <span class=\"token operator\">=</span> fis<span class=\"token punctuation\">.</span><span class=\"token function\">read</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"204\"></td><td><pre>                    cos<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> read<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"205\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"206\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"207\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"208\"></td><td><pre>            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"209\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"210\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"211\"></td><td><pre></pre></td></tr><tr><td data-num=\"212\"></td><td><pre>    <span class=\"token comment\">// ä»æ–‡ä»¶åŠ è½½å¯†é’¥</span></pre></td></tr><tr><td data-num=\"213\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">SecretKey</span> <span class=\"token function\">loadKey</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> filePath<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"214\"></td><td><pre>        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"215\"></td><td><pre>            <span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> keyBytes <span class=\"token operator\">=</span> <span class=\"token class-name\">Files</span><span class=\"token punctuation\">.</span><span class=\"token function\">readAllBytes</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">(</span>filePath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toPath</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"216\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SecretKeySpec</span><span class=\"token punctuation\">(</span>keyBytes<span class=\"token punctuation\">,</span> <span class=\"token constant\">ALGORITHM</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"217\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">IOException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"218\"></td><td><pre>            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"219\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"220\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"221\"></td><td><pre></pre></td></tr><tr><td data-num=\"222\"></td><td><pre>    <span class=\"token comment\">// ä»æ–‡ä»¶åŠ è½½ IV</span></pre></td></tr><tr><td data-num=\"223\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">IvParameterSpec</span> <span class=\"token function\">loadIv</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> filePath<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"224\"></td><td><pre>        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"225\"></td><td><pre>            <span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> ivBytes <span class=\"token operator\">=</span> <span class=\"token class-name\">Files</span><span class=\"token punctuation\">.</span><span class=\"token function\">readAllBytes</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">(</span>filePath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toPath</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"226\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">IvParameterSpec</span><span class=\"token punctuation\">(</span>ivBytes<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"227\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">IOException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"228\"></td><td><pre>            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"229\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"230\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"231\"></td><td><pre></pre></td></tr><tr><td data-num=\"232\"></td><td><pre>    <span class=\"token comment\">// è§£å¯†æ–‡ä»¶</span></pre></td></tr><tr><td data-num=\"233\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">decryptFile</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">SecretKey</span> secretKey<span class=\"token punctuation\">,</span> <span class=\"token class-name\">IvParameterSpec</span> iv<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> srcFile<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> destFile<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"234\"></td><td><pre>        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"235\"></td><td><pre>            <span class=\"token class-name\">Cipher</span> cipher <span class=\"token operator\">=</span> <span class=\"token class-name\">Cipher</span><span class=\"token punctuation\">.</span><span class=\"token function\">getInstance</span><span class=\"token punctuation\">(</span><span class=\"token constant\">TRANSFORMATION</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"236\"></td><td><pre>            cipher<span class=\"token punctuation\">.</span><span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Cipher</span><span class=\"token punctuation\">.</span><span class=\"token constant\">DECRYPT_MODE</span><span class=\"token punctuation\">,</span> secretKey<span class=\"token punctuation\">,</span> iv<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"237\"></td><td><pre>            <span class=\"token keyword\">try</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">FileInputStream</span> fis <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FileInputStream</span><span class=\"token punctuation\">(</span>srcFile<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"238\"></td><td><pre>                 <span class=\"token class-name\">CipherInputStream</span> cis <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">CipherInputStream</span><span class=\"token punctuation\">(</span>fis<span class=\"token punctuation\">,</span> cipher<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"239\"></td><td><pre>                 <span class=\"token class-name\">FileOutputStream</span> fos <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FileOutputStream</span><span class=\"token punctuation\">(</span>destFile<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"240\"></td><td><pre>                <span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> buffer <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token number\">1024</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"241\"></td><td><pre>                <span class=\"token keyword\">int</span> read<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"242\"></td><td><pre>                <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>read <span class=\"token operator\">=</span> cis<span class=\"token punctuation\">.</span><span class=\"token function\">read</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"243\"></td><td><pre>                    fos<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> read<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"244\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"245\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"246\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"247\"></td><td><pre>            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"248\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"249\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"250\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>æ•ˆæœå¦‚ä¸‹ï¼š</p>\n<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20240731151628904.png\" alt=\"image-20240731151628904\" /></p>\n<p>åŠ å¯†æ–‡ä»¶æ—¶ä¼šåœ¨æŒ‡å®šä½ç½®ç”ŸæˆåŠ å¯†çš„å¯†é’¥å’Œ IV (ä¿æŒåŠ å¯†çš„ä¸€è‡´æ€§)</p>\n<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20240731151819543.png\" alt=\"image-20240731151819543\" /></p>\n",
            "tags": [
                "è®¡ç®—æœºå­¦ç§‘",
                "blog",
                "java-io",
                "è®¡ç®—æœºå­¦ç§‘ - blog - java-io"
            ]
        },
        {
            "id": "https://pigpigletsgo.github.io/computer-science/blog/sql/%E6%9F%A5%E8%AF%A2%E6%95%B0%E6%8D%AE%E7%94%9F%E6%88%90%E5%BA%8F%E5%88%97/",
            "url": "https://pigpigletsgo.github.io/computer-science/blog/sql/%E6%9F%A5%E8%AF%A2%E6%95%B0%E6%8D%AE%E7%94%9F%E6%88%90%E5%BA%8F%E5%88%97/",
            "title": "PostgreSQLçš„generate_seriseçš„å‡½æ•°åº”ç”¨",
            "date_published": "2024-07-24T09:47:20.000Z",
            "content_html": "<h1 id=\"postgresqlçš„generate_seriseçš„å‡½æ•°åº”ç”¨\"><a class=\"anchor\" href=\"#postgresqlçš„generate_seriseçš„å‡½æ•°åº”ç”¨\">#</a> PostgreSQL çš„ generate_serise çš„å‡½æ•°åº”ç”¨</h1>\n<h2 id=\"ç®€ä»‹\"><a class=\"anchor\" href=\"#ç®€ä»‹\">#</a> ç®€ä»‹</h2>\n<p>PostgreSQL ä¸­æœ‰ä¸€ä¸ªå¾ˆæœ‰ç”¨å¤„çš„å†…ç½®å‡½æ•° generate_seriseï¼Œå¯ä»¥æŒ‰ä¸åŒçš„è§„åˆ™äº§ç”Ÿä¸€ç³»åˆ—çš„å¡«å……æ•°æ®</p>\n<h2 id=\"è¯­æ³•\"><a class=\"anchor\" href=\"#è¯­æ³•\">#</a> è¯­æ³•</h2>\n<table>\n<thead>\n<tr>\n<th>å‡½æ•°</th>\n<th>å‚æ•°ç±»å‹</th>\n<th>è¿”å›ç±»å‹</th>\n<th>æè¿°</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>generate_serise(startï¼Œstop)</td>\n<td>int æˆ– bigint</td>\n<td>setof  int æˆ– setof  bigint (ä¸å‚æ•°ç±»å‹ç›¸åŒ)</td>\n<td>ç”Ÿæˆä¸€ä¸ªæ•°å€¼åºåˆ—ï¼Œä» start åˆ° stopï¼Œ&lt;br /&gt; æ­¥è¿›ä¸º 1</td>\n</tr>\n<tr>\n<td>generate_serise(startï¼Œstopï¼Œstep)</td>\n<td>int æˆ– bigint</td>\n<td>setof  int æˆ– setof  bigint (ä¸å‚æ•°ç±»å‹ç›¸åŒ)</td>\n<td>ç”Ÿæˆä¸€ä¸ªæ•°å€¼åºåˆ—ï¼Œä» start åˆ° stop,&lt;br /&gt; æ­¥è¿›ä¸º step</td>\n</tr>\n<tr>\n<td>generate_serise(startï¼Œstopï¼Œstep_interval)</td>\n<td>timestamp or timestamp with time zone</td>\n<td>timestamp æˆ– timestamp with time zone (same as argument type)</td>\n<td>ç”Ÿæˆä¸€ä¸ªæ•°å€¼åºåˆ—ï¼Œä» &lt;br /&gt;start åˆ° stopï¼Œæ­¥è¿›ä¸º step</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"å®ä¾‹\"><a class=\"anchor\" href=\"#å®ä¾‹\">#</a> å®ä¾‹</h2>\n<h3 id=\"int-ç±»å‹\"><a class=\"anchor\" href=\"#int-ç±»å‹\">#</a> int ç±»å‹</h3>\n<ol>\n<li>ä¸å†™æ­¥è¿›æ—¶é»˜è®¤ä¸º 1</li>\n</ol>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">select</span> generate_series<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">-----------------</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre> generate_series </pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">-----------------</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>               <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>               <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>               <span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>               <span class=\"token number\">4</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>               <span class=\"token number\">5</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>               <span class=\"token number\">6</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>               <span class=\"token number\">7</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>               <span class=\"token number\">8</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>               <span class=\"token number\">9</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>              <span class=\"token number\">10</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token punctuation\">(</span><span class=\"token number\">10</span> <span class=\"token keyword\">rows</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><ol start=\"2\">\n<li>è®¾ç½®æ­¥è¿›</li>\n</ol>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">select</span> generate_series<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">-----------------</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre> generate_series </pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">-----------------</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>               <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>               <span class=\"token number\">4</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>               <span class=\"token number\">7</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>              <span class=\"token number\">10</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">(</span><span class=\"token number\">4</span> <span class=\"token keyword\">rows</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><ol start=\"3\">\n<li>å¦‚æœ step æ˜¯æ­£æ•°ï¼Œè€Œ start å¤§äº stopï¼Œé‚£ä¹ˆè¿”å›é›¶è¡Œã€‚ç›¸åï¼Œå¦‚æœ step æ˜¯è´Ÿæ•°ï¼Œstart å°äº stopï¼Œåˆ™è¿”å›é›¶è¡Œã€‚å¦‚æœæ˜¯ NULL è¾“å…¥ï¼Œä¹Ÿäº§ç”Ÿé›¶è¡Œã€‚step ä¸ºé›¶åˆ™æ˜¯ä¸€ä¸ªé”™è¯¯</li>\n</ol>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">select</span> generate_series<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">-----------------</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre> generate_series </pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">-----------------</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">rows</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>NULL inputs</p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">select</span> generate_series<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token boolean\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">-----------------</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre> generate_series </pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">-----------------</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">rows</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>step ä¸ºé›¶</p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">select</span> generate_series<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>ERROR:  step size cannot equal zero</pre></td></tr></table></figure><p>start å¤§äº stopï¼Œstep æ˜¯è´Ÿæ•°</p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">select</span> generate_series<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">-----------------</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre> generate_series </pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">-----------------</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>               <span class=\"token number\">5</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>               <span class=\"token number\">4</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>               <span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>               <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>               <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">(</span><span class=\"token number\">5</span> <span class=\"token keyword\">rows</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>æ—¶é—´ç±»å‹</p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">select</span> generate_series<span class=\"token punctuation\">(</span><span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">'7 days'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'1 day'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">-------------------------------</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        generate_series        </pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">-------------------------------</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre> <span class=\"token number\">2013</span><span class=\"token operator\">-</span><span class=\"token number\">04</span><span class=\"token operator\">-</span><span class=\"token number\">03</span> <span class=\"token number\">14</span>:<span class=\"token number\">22</span>:<span class=\"token number\">26.391852</span><span class=\"token operator\">+</span><span class=\"token number\">08</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre> <span class=\"token number\">2013</span><span class=\"token operator\">-</span><span class=\"token number\">04</span><span class=\"token operator\">-</span><span class=\"token number\">04</span> <span class=\"token number\">14</span>:<span class=\"token number\">22</span>:<span class=\"token number\">26.391852</span><span class=\"token operator\">+</span><span class=\"token number\">08</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre> <span class=\"token number\">2013</span><span class=\"token operator\">-</span><span class=\"token number\">04</span><span class=\"token operator\">-</span><span class=\"token number\">05</span> <span class=\"token number\">14</span>:<span class=\"token number\">22</span>:<span class=\"token number\">26.391852</span><span class=\"token operator\">+</span><span class=\"token number\">08</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre> <span class=\"token number\">2013</span><span class=\"token operator\">-</span><span class=\"token number\">04</span><span class=\"token operator\">-</span><span class=\"token number\">06</span> <span class=\"token number\">14</span>:<span class=\"token number\">22</span>:<span class=\"token number\">26.391852</span><span class=\"token operator\">+</span><span class=\"token number\">08</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre> <span class=\"token number\">2013</span><span class=\"token operator\">-</span><span class=\"token number\">04</span><span class=\"token operator\">-</span><span class=\"token number\">07</span> <span class=\"token number\">14</span>:<span class=\"token number\">22</span>:<span class=\"token number\">26.391852</span><span class=\"token operator\">+</span><span class=\"token number\">08</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre> <span class=\"token number\">2013</span><span class=\"token operator\">-</span><span class=\"token number\">04</span><span class=\"token operator\">-</span><span class=\"token number\">08</span> <span class=\"token number\">14</span>:<span class=\"token number\">22</span>:<span class=\"token number\">26.391852</span><span class=\"token operator\">+</span><span class=\"token number\">08</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre> <span class=\"token number\">2013</span><span class=\"token operator\">-</span><span class=\"token number\">04</span><span class=\"token operator\">-</span><span class=\"token number\">09</span> <span class=\"token number\">14</span>:<span class=\"token number\">22</span>:<span class=\"token number\">26.391852</span><span class=\"token operator\">+</span><span class=\"token number\">08</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre> <span class=\"token number\">2013</span><span class=\"token operator\">-</span><span class=\"token number\">04</span><span class=\"token operator\">-</span><span class=\"token number\">10</span> <span class=\"token number\">14</span>:<span class=\"token number\">22</span>:<span class=\"token number\">26.391852</span><span class=\"token operator\">+</span><span class=\"token number\">08</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">(</span><span class=\"token number\">8</span> <span class=\"token keyword\">rows</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">select</span> generate_series<span class=\"token punctuation\">(</span>to_date<span class=\"token punctuation\">(</span><span class=\"token string\">'20130403'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'yyyymmdd'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> to_date<span class=\"token punctuation\">(</span><span class=\"token string\">'20130404'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'yyyymmdd'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'3 hours'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">------------------------</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    generate_series     </pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">------------------------</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre> <span class=\"token number\">2013</span><span class=\"token operator\">-</span><span class=\"token number\">04</span><span class=\"token operator\">-</span><span class=\"token number\">03</span> <span class=\"token number\">00</span>:<span class=\"token number\">00</span>:<span class=\"token number\">00</span><span class=\"token operator\">+</span><span class=\"token number\">08</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre> <span class=\"token number\">2013</span><span class=\"token operator\">-</span><span class=\"token number\">04</span><span class=\"token operator\">-</span><span class=\"token number\">03</span> <span class=\"token number\">03</span>:<span class=\"token number\">00</span>:<span class=\"token number\">00</span><span class=\"token operator\">+</span><span class=\"token number\">08</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre> <span class=\"token number\">2013</span><span class=\"token operator\">-</span><span class=\"token number\">04</span><span class=\"token operator\">-</span><span class=\"token number\">03</span> <span class=\"token number\">06</span>:<span class=\"token number\">00</span>:<span class=\"token number\">00</span><span class=\"token operator\">+</span><span class=\"token number\">08</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre> <span class=\"token number\">2013</span><span class=\"token operator\">-</span><span class=\"token number\">04</span><span class=\"token operator\">-</span><span class=\"token number\">03</span> <span class=\"token number\">09</span>:<span class=\"token number\">00</span>:<span class=\"token number\">00</span><span class=\"token operator\">+</span><span class=\"token number\">08</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre> <span class=\"token number\">2013</span><span class=\"token operator\">-</span><span class=\"token number\">04</span><span class=\"token operator\">-</span><span class=\"token number\">03</span> <span class=\"token number\">12</span>:<span class=\"token number\">00</span>:<span class=\"token number\">00</span><span class=\"token operator\">+</span><span class=\"token number\">08</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre> <span class=\"token number\">2013</span><span class=\"token operator\">-</span><span class=\"token number\">04</span><span class=\"token operator\">-</span><span class=\"token number\">03</span> <span class=\"token number\">15</span>:<span class=\"token number\">00</span>:<span class=\"token number\">00</span><span class=\"token operator\">+</span><span class=\"token number\">08</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre> <span class=\"token number\">2013</span><span class=\"token operator\">-</span><span class=\"token number\">04</span><span class=\"token operator\">-</span><span class=\"token number\">03</span> <span class=\"token number\">18</span>:<span class=\"token number\">00</span>:<span class=\"token number\">00</span><span class=\"token operator\">+</span><span class=\"token number\">08</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre> <span class=\"token number\">2013</span><span class=\"token operator\">-</span><span class=\"token number\">04</span><span class=\"token operator\">-</span><span class=\"token number\">03</span> <span class=\"token number\">21</span>:<span class=\"token number\">00</span>:<span class=\"token number\">00</span><span class=\"token operator\">+</span><span class=\"token number\">08</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre> <span class=\"token number\">2013</span><span class=\"token operator\">-</span><span class=\"token number\">04</span><span class=\"token operator\">-</span><span class=\"token number\">04</span> <span class=\"token number\">00</span>:<span class=\"token number\">00</span>:<span class=\"token number\">00</span><span class=\"token operator\">+</span><span class=\"token number\">08</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token punctuation\">(</span><span class=\"token number\">9</span> <span class=\"token keyword\">rows</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"ipç±»å‹\"><a class=\"anchor\" href=\"#ipç±»å‹\">#</a> IP ç±»å‹</h3>\n<ol>\n<li>å»ºè¡¨</li>\n</ol>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">create</span> <span class=\"token keyword\">table</span> tbl_david<span class=\"token punctuation\">(</span>id <span class=\"token keyword\">int</span><span class=\"token punctuation\">,</span> ip_start inet<span class=\"token punctuation\">,</span> ip_stop inet<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><ol start=\"2\">\n<li>æ’å…¥æ•°æ®</li>\n</ol>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">insert</span> <span class=\"token keyword\">into</span> tbl_david <span class=\"token keyword\">values</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'192.168.1.6'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'192.168.1.10'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">insert</span> <span class=\"token keyword\">into</span> tbl_david <span class=\"token keyword\">values</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'192.168.2.16'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'192.168.2.20'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">insert</span> <span class=\"token keyword\">into</span> tbl_david <span class=\"token keyword\">values</span> <span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'192.168.3.116'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'192.168.3.120'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><ol start=\"3\">\n<li>æŸ¥è¯¢æ•°æ®</li>\n</ol>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">select</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">from</span> tbl_david <span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">----+---------------+---------------</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre> id <span class=\"token operator\">|</span>   ip_start    <span class=\"token operator\">|</span>    ip_stop    </pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">----+---------------+---------------</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  <span class=\"token number\">1</span> <span class=\"token operator\">|</span> <span class=\"token number\">192.168</span><span class=\"token number\">.1</span><span class=\"token number\">.6</span>   <span class=\"token operator\">|</span> <span class=\"token number\">192.168</span><span class=\"token number\">.1</span><span class=\"token number\">.10</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token number\">2</span> <span class=\"token operator\">|</span> <span class=\"token number\">192.168</span><span class=\"token number\">.2</span><span class=\"token number\">.16</span>  <span class=\"token operator\">|</span> <span class=\"token number\">192.168</span><span class=\"token number\">.2</span><span class=\"token number\">.20</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token number\">3</span> <span class=\"token operator\">|</span> <span class=\"token number\">192.168</span><span class=\"token number\">.3</span><span class=\"token number\">.116</span> <span class=\"token operator\">|</span> <span class=\"token number\">192.168</span><span class=\"token number\">.3</span><span class=\"token number\">.120</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">(</span><span class=\"token number\">3</span> <span class=\"token keyword\">rows</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><ol start=\"4\">\n<li>generate_serise ç”Ÿæˆåºåˆ—</li>\n</ol>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">select</span> id<span class=\"token punctuation\">,</span> generate_series<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> ip_stop<span class=\"token operator\">-</span>ip_start<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>ip_start <span class=\"token keyword\">as</span> ip_new <span class=\"token keyword\">from</span> tbl_david<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">----+---------------</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre> id <span class=\"token operator\">|</span>    ip_new     </pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">----+---------------</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  <span class=\"token number\">1</span> <span class=\"token operator\">|</span> <span class=\"token number\">192.168</span><span class=\"token number\">.1</span><span class=\"token number\">.6</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token number\">1</span> <span class=\"token operator\">|</span> <span class=\"token number\">192.168</span><span class=\"token number\">.1</span><span class=\"token number\">.7</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token number\">1</span> <span class=\"token operator\">|</span> <span class=\"token number\">192.168</span><span class=\"token number\">.1</span><span class=\"token number\">.8</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  <span class=\"token number\">1</span> <span class=\"token operator\">|</span> <span class=\"token number\">192.168</span><span class=\"token number\">.1</span><span class=\"token number\">.9</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  <span class=\"token number\">1</span> <span class=\"token operator\">|</span> <span class=\"token number\">192.168</span><span class=\"token number\">.1</span><span class=\"token number\">.10</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  <span class=\"token number\">2</span> <span class=\"token operator\">|</span> <span class=\"token number\">192.168</span><span class=\"token number\">.2</span><span class=\"token number\">.16</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>  <span class=\"token number\">2</span> <span class=\"token operator\">|</span> <span class=\"token number\">192.168</span><span class=\"token number\">.2</span><span class=\"token number\">.17</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>  <span class=\"token number\">2</span> <span class=\"token operator\">|</span> <span class=\"token number\">192.168</span><span class=\"token number\">.2</span><span class=\"token number\">.18</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>  <span class=\"token number\">2</span> <span class=\"token operator\">|</span> <span class=\"token number\">192.168</span><span class=\"token number\">.2</span><span class=\"token number\">.19</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>  <span class=\"token number\">2</span> <span class=\"token operator\">|</span> <span class=\"token number\">192.168</span><span class=\"token number\">.2</span><span class=\"token number\">.20</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>  <span class=\"token number\">3</span> <span class=\"token operator\">|</span> <span class=\"token number\">192.168</span><span class=\"token number\">.3</span><span class=\"token number\">.116</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>  <span class=\"token number\">3</span> <span class=\"token operator\">|</span> <span class=\"token number\">192.168</span><span class=\"token number\">.3</span><span class=\"token number\">.117</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>  <span class=\"token number\">3</span> <span class=\"token operator\">|</span> <span class=\"token number\">192.168</span><span class=\"token number\">.3</span><span class=\"token number\">.118</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>  <span class=\"token number\">3</span> <span class=\"token operator\">|</span> <span class=\"token number\">192.168</span><span class=\"token number\">.3</span><span class=\"token number\">.119</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>  <span class=\"token number\">3</span> <span class=\"token operator\">|</span> <span class=\"token number\">192.168</span><span class=\"token number\">.3</span><span class=\"token number\">.120</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">(</span><span class=\"token number\">15</span> <span class=\"token keyword\">rows</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>æä¸æ‡‚è¿™æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬å¯ä»¥è¿›è¡Œæ‹†è§£</p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">-- sql æ‰§è¡Œå°† 192.168.1.6-192.168.1.10=4 çš„å€¼ + 192.168.1.6=192.168.1.10</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">SELECT</span> <span class=\"token punctuation\">(</span>ip_stop <span class=\"token operator\">-</span> ip_start<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>ip_start <span class=\"token keyword\">as</span> ip_new <span class=\"token keyword\">FROM</span> tbl_david</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">---------------</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    ip_new     </pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">---------------</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token number\">192.168</span><span class=\"token number\">.1</span><span class=\"token number\">.10</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token number\">192.168</span><span class=\"token number\">.2</span><span class=\"token number\">.20</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token number\">192.168</span><span class=\"token number\">.3</span><span class=\"token number\">.120</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">(</span><span class=\"token number\">3</span> <span class=\"token keyword\">rows</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\">-- ä¸Šé¢çš„ sql ä¹Ÿç±»ä¼¼äºå¦‚ä¸‹ï¼š</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">select</span> id<span class=\"token punctuation\">,</span> generate_series<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>ip_start <span class=\"token keyword\">as</span> ip_new <span class=\"token keyword\">from</span> tbl_david<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\">----+---------------</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre> id <span class=\"token operator\">|</span>    ip_new     </pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\">----+---------------</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>  <span class=\"token number\">1</span> <span class=\"token operator\">|</span> <span class=\"token number\">192.168</span><span class=\"token number\">.1</span><span class=\"token number\">.6</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>  <span class=\"token number\">1</span> <span class=\"token operator\">|</span> <span class=\"token number\">192.168</span><span class=\"token number\">.1</span><span class=\"token number\">.7</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>  <span class=\"token number\">1</span> <span class=\"token operator\">|</span> <span class=\"token number\">192.168</span><span class=\"token number\">.1</span><span class=\"token number\">.8</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>  <span class=\"token number\">1</span> <span class=\"token operator\">|</span> <span class=\"token number\">192.168</span><span class=\"token number\">.1</span><span class=\"token number\">.9</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>  <span class=\"token number\">1</span> <span class=\"token operator\">|</span> <span class=\"token number\">192.168</span><span class=\"token number\">.1</span><span class=\"token number\">.10</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>  <span class=\"token number\">2</span> <span class=\"token operator\">|</span> <span class=\"token number\">192.168</span><span class=\"token number\">.2</span><span class=\"token number\">.16</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>  <span class=\"token number\">2</span> <span class=\"token operator\">|</span> <span class=\"token number\">192.168</span><span class=\"token number\">.2</span><span class=\"token number\">.17</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>  <span class=\"token number\">2</span> <span class=\"token operator\">|</span> <span class=\"token number\">192.168</span><span class=\"token number\">.2</span><span class=\"token number\">.18</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>  <span class=\"token number\">2</span> <span class=\"token operator\">|</span> <span class=\"token number\">192.168</span><span class=\"token number\">.2</span><span class=\"token number\">.19</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>  <span class=\"token number\">2</span> <span class=\"token operator\">|</span> <span class=\"token number\">192.168</span><span class=\"token number\">.2</span><span class=\"token number\">.20</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>  <span class=\"token number\">3</span> <span class=\"token operator\">|</span> <span class=\"token number\">192.168</span><span class=\"token number\">.3</span><span class=\"token number\">.116</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>  <span class=\"token number\">3</span> <span class=\"token operator\">|</span> <span class=\"token number\">192.168</span><span class=\"token number\">.3</span><span class=\"token number\">.117</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>  <span class=\"token number\">3</span> <span class=\"token operator\">|</span> <span class=\"token number\">192.168</span><span class=\"token number\">.3</span><span class=\"token number\">.118</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>  <span class=\"token number\">3</span> <span class=\"token operator\">|</span> <span class=\"token number\">192.168</span><span class=\"token number\">.3</span><span class=\"token number\">.119</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>  <span class=\"token number\">3</span> <span class=\"token operator\">|</span> <span class=\"token number\">192.168</span><span class=\"token number\">.3</span><span class=\"token number\">.120</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token punctuation\">(</span><span class=\"token number\">15</span> <span class=\"token keyword\">rows</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h2 id=\"æ€»ç»“\"><a class=\"anchor\" href=\"#æ€»ç»“\">#</a> æ€»ç»“</h2>\n<p>PostgreSQL çš„ generate_serise å‡½æ•°å¯¹ç”Ÿæˆæµ‹è¯•æ•°æ®ï¼Œæ‰¹é‡æ›´æ–°ä¸€å®šè§„åˆ™çš„æ•°æ®æœ‰æ¯”è¾ƒå¤šçš„åº”ç”¨åœºæ™¯ï¼Œä½¿ç”¨å¾—å½“å¯æå‡å‘å¼€æ•ˆç‡ï¼Œå¦å¤– IP çš„åºåˆ—ç”Ÿæˆä¹Ÿæ˜¯ PG çš„ä¸€ä¸ªäº®ç‚¹</p>\n",
            "tags": [
                "è®¡ç®—æœºå­¦ç§‘",
                "blog",
                "sql",
                "è®¡ç®—æœºå­¦ç§‘",
                "blog",
                "sql"
            ]
        },
        {
            "id": "https://pigpigletsgo.github.io/computer-science/blog/sql/MyBatisPlus%E7%BC%96%E5%86%99SQL%E4%B8%AD%E8%B0%81%E7%A0%B4%E4%B8%8E%E5%88%80%E4%B9%90%E7%9A%84%E4%BD%BF%E7%94%A8%E5%8C%BA%E5%88%AB/",
            "url": "https://pigpigletsgo.github.io/computer-science/blog/sql/MyBatisPlus%E7%BC%96%E5%86%99SQL%E4%B8%AD%E8%B0%81%E7%A0%B4%E4%B8%8E%E5%88%80%E4%B9%90%E7%9A%84%E4%BD%BF%E7%94%A8%E5%8C%BA%E5%88%AB/",
            "title": "MyBatisPlusç¼–å†™SQLä¸­#ä¸$çš„ä½¿ç”¨åŒºåˆ«",
            "date_published": "2024-07-24T08:33:00.000Z",
            "content_html": "<h1 id=\"mybatis-plusç¼–å†™sqlä¸­ä¸çš„ä½¿ç”¨åŒºåˆ«\"><a class=\"anchor\" href=\"#mybatis-plusç¼–å†™sqlä¸­ä¸çš„ä½¿ç”¨åŒºåˆ«\">#</a> MyBatis-plus ç¼–å†™ SQL ä¸­ #ä¸ $ çš„ä½¿ç”¨åŒºåˆ«</h1>\n<h2 id=\"ä»Šå¤©çœ‹åˆ°äº†ä¸€ä¸ªsqlå¦‚ä¸‹\"><a class=\"anchor\" href=\"#ä»Šå¤©çœ‹åˆ°äº†ä¸€ä¸ªsqlå¦‚ä¸‹\">#</a> ä»Šå¤©çœ‹åˆ°äº†ä¸€ä¸ª sql å¦‚ä¸‹ï¼š</h2>\n<p>dao</p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>     * æ ¹æ® price å’Œå¤šä¸ª name æ¥æŸ¥è¯¢ä¿¡æ¯</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>     * @param </pre></td></tr><tr><td data-num=\"4\"></td><td><pre>     * @return</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>     * @author çª¦å‡¯æ¬£</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>     * @date 2024 å¹´ 07 æœˆ 09 æ—¥ 0009 17:38:31</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token variable\">@Select</span><span class=\"token punctuation\">(</span>&#123;</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            <span class=\"token string\">\"SELECT\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>            <span class=\"token string\">\"id, name\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>            <span class=\"token string\">\"FROM tab_class\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            <span class=\"token string\">\"WHERE\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>            <span class=\"token string\">\"price = #&#123;price&#125; and\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>            <span class=\"token string\">\"name in\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            <span class=\"token string\">\"($&#123;res&#125;)\"</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>            &#125;<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    List<span class=\"token operator\">&lt;</span>ClassEntity<span class=\"token operator\">></span> getClassAll<span class=\"token punctuation\">(</span>String res<span class=\"token punctuation\">,</span> <span class=\"token keyword\">Integer</span> price<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h2 id=\"ä¸‰å±‚ä»£ç å¦‚ä¸‹\"><a class=\"anchor\" href=\"#ä¸‰å±‚ä»£ç å¦‚ä¸‹\">#</a> ä¸‰å±‚ä»£ç å¦‚ä¸‹ï¼š</h2>\n<p>controller</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@GetMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/classAll\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ClassEntity</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">getClassAll</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@RequestBody</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> className<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Integer</span> price<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token class-name\">String</span> res <span class=\"token operator\">=</span> className<span class=\"token punctuation\">.</span><span class=\"token function\">stream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>r <span class=\"token operator\">-></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>                <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>                    <span class=\"token class-name\">StringBuilder</span> sb <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">StringBuilder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>                    sb<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"'\"</span> <span class=\"token operator\">+</span> r <span class=\"token operator\">+</span> <span class=\"token string\">\"'\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>                    <span class=\"token keyword\">return</span> sb<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">collect</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Collectors</span><span class=\"token punctuation\">.</span><span class=\"token function\">joining</span><span class=\"token punctuation\">(</span><span class=\"token string\">\",\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token keyword\">return</span> classService<span class=\"token punctuation\">.</span><span class=\"token function\">getClassAll</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">,</span> price<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>service</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ClassEntity</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">getClassAll</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> res<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Integer</span> price<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token keyword\">return</span> classDao<span class=\"token punctuation\">.</span><span class=\"token function\">getClassAll</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">,</span> price<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>è¯·æ±‚ä¼ å‚ï¼š</p>\n<p>json</p>\n<pre><code>[\n    &quot;æ•°å­¦&quot;,&quot;è¯­æ–‡&quot;\n]\n</code></pre>\n<p>param</p>\n<pre><code>price=10\n</code></pre>\n<p>æŸ¥è¯¢ç»“æœï¼š</p>\n<pre><code>[\n    &#123;\n        &quot;id&quot;: 1,\n        &quot;name&quot;: &quot;æ•°å­¦&quot;\n    &#125;,\n    &#123;\n        &quot;id&quot;: 2,\n        &quot;name&quot;: &quot;è¯­æ–‡&quot;\n    &#125;\n]\n</code></pre>\n<h2 id=\"é—®é¢˜\"><a class=\"anchor\" href=\"#é—®é¢˜\">#</a> é—®é¢˜ï¼š</h2>\n<p>ä¸ºä»€ä¹ˆ price æ¡ä»¶æ¥æ”¶å‚æ•°ä½¿ç”¨çš„æ˜¯ <code>#</code> è€Œ name å´æ˜¯ <code>$</code>  å‘¢ï¼Ÿæˆ‘å¯ä»¥æ¢æˆ <code>#</code> å—ï¼Ÿ</p>\n<p>PSï¼šä¸åˆé€‚ï¼</p>\n<p>è§£é‡Šå¦‚ä¸‹ï¼š</p>\n<p>åŸå› åˆ†æï¼š</p>\n<ol>\n<li>\n<p><code>#</code> å‚æ•°æ›¿æ¢ç‰¹ç‚¹</p>\n<p><code>#</code> ä¼šå°†å‚æ•°å®‰å…¨æ›¿æ¢å¹¶è½¬ä¹‰ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå› æ­¤é€‚ç”¨äºå•ä¸ªå€¼çš„ä¼ é€’</p>\n<p>ä½†å¯¹äºåƒ <code>in</code>  å­å¥ä¸­çš„åˆ—è¡¨ï¼Œéœ€è¦ç›´æ¥å°†å‚æ•°æ‹¼æ¥åˆ° SQL è¯­å¥ä¸­ï¼Œè€Œä¸æ˜¯ä½œä¸ºä¸€ä¸ªå•ç‹¬çš„å­—ç¬¦ä¸²</p>\n</li>\n<li>\n<p><code>$</code>  å‚æ•°æ‹¼æ¥ç‰¹ç‚¹</p>\n<p><code>$</code>  ç›´æ¥æ‹¼æ¥å‚æ•°åˆ° SQL è¯­å¥ä¸­ï¼Œé€‚ç”¨äºåŠ¨æ€ç”Ÿæˆçš„ SQL ç‰‡æ®µï¼Œä¾‹å¦‚ <code>in</code>  å­å¥ä¸­çš„åˆ—è¡¨</p>\n<p>è¿™æ ·å¯ä»¥ç¡®ä¿åˆ—è¡¨ä¸­çš„æ¯ä¸ªå€¼éƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å…ƒç´ ï¼Œè€Œä¸æ˜¯è¢«å½“ä½œå•ä¸ªå­—ç¬¦ä¸²å¤„ç†</p>\n</li>\n</ol>\n<p>ä¾‹ä¸¾è¯´æ˜ï¼š</p>\n<p>å‡è®¾ <code>res</code>  çš„å€¼æ˜¯ <code>'æ•°å­¦'</code> ï¼Œ <code>'è¯­æ–‡'</code></p>\n<h3 id=\"ä½¿ç”¨\"><a class=\"anchor\" href=\"#ä½¿ç”¨\">#</a> ä½¿ç”¨ <code>#</code></h3>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token variable\">@Select</span><span class=\"token punctuation\">(</span>&#123;</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>            <span class=\"token string\">\"SELECT\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>            <span class=\"token string\">\"id, name\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>            <span class=\"token string\">\"FROM tab_class\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            <span class=\"token string\">\"WHERE\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>            <span class=\"token string\">\"price = #&#123;price&#125; and\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            <span class=\"token string\">\"name in\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            <span class=\"token string\">\"(#&#123;res&#125;)\"</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    &#125;<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>å¦‚æœ <code>res</code>  çš„å€¼æ˜¯ <code>'æ•°å­¦'</code> ï¼Œ <code>'è¯­æ–‡'</code> ï¼ŒMyBatis ä¼šå°†å…¶è½¬ä¹‰ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¯¼è‡´ç”Ÿæˆçš„ SQL ç±»ä¼¼äº</p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>administrative_division_code <span class=\"token operator\">in</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'\\'001\\', \\'002\\', \\'003\\''</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>è¿™æ˜¾ç„¶æ˜¯ä¸æ­£ç¡®çš„ï¼Œå› ä¸ºå®ƒå°†æ•´ä¸ªåˆ—è¡¨å½“ä½œä¸€ä¸ªå•ç‹¬çš„å­—ç¬¦ä¸²</p>\n<h3 id=\"ä½¿ç”¨-2\"><a class=\"anchor\" href=\"#ä½¿ç”¨-2\">#</a> ä½¿ç”¨ <code>$</code></h3>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token variable\">@Select</span><span class=\"token punctuation\">(</span>&#123;</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>            <span class=\"token string\">\"SELECT\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>            <span class=\"token string\">\"id, name\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>            <span class=\"token string\">\"FROM tab_class\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            <span class=\"token string\">\"WHERE\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>            <span class=\"token string\">\"price = #&#123;price&#125; and\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            <span class=\"token string\">\"name in\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            <span class=\"token string\">\"($&#123;res&#125;)\"</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    &#125;<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>å¦‚æœ <code>res</code>  çš„å€¼æ˜¯ <code>'æ•°å­¦'</code> ï¼Œ <code>'è¯­æ–‡'</code> ï¼ŒMyBatis ä¼šç›´æ¥å°†å…¶æ‹¼æ¥åˆ° SQL è¯­å¥ä¸­ï¼Œç”Ÿæˆçš„ SQL ç±»ä¼¼äº</p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>administrative_division_code <span class=\"token operator\">in</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'001'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'002'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'003'</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>è¿™æ˜¯æ­£ç¡®çš„ï¼Œå› ä¸ºå®ƒå°†åˆ—è¡¨ä¸­çš„æ¯ä¸ªå€¼éƒ½ä½œä¸ºå•ç‹¬çš„å…ƒç´ å¤„ç†</p>\n<h2 id=\"æ€»ç»“\"><a class=\"anchor\" href=\"#æ€»ç»“\">#</a> æ€»ç»“</h2>\n<p><code>#&#123;&#125;</code>  ç”¨äºå®‰å…¨æ›¿æ¢å•ä¸ªå€¼ï¼Œé˜²æ­¢ SQL æ³¨å…¥ï¼Œä½†ä¸é€‚åˆæ›¿æ¢åŒ…å«å¤šä¸ªå€¼çš„åˆ—è¡¨</p>\n<p><code>$&#123;&#125;</code>  ç”¨äºç›´æ¥æ‹¼æ¥ SQL ç‰‡æ®µï¼Œé€‚åˆåŠ¨æ€ç”Ÿæˆçš„ SQL è¯­å¥ç‰‡æ®µï¼Œä¾‹å¦‚ <code>in</code>  å­å¥ä¸­çš„åˆ—è¡¨</p>\n<p>å› æ­¤ï¼Œåœ¨ <code>in</code>  å­å¥ä¸­ä¼ é€’åŠ¨æ€åˆ—è¡¨æ—¶ï¼Œéœ€è¦ä½¿ç”¨ <code>$&#123;&#125;</code>  æ¥ç¡®ä¿ç”Ÿæˆçš„ SQL æ˜¯æ­£ç¡®çš„ã€‚ä½¿ç”¨ <code>#&#123;&#125;</code>  ä¼šå¯¼è‡´ç”Ÿæˆçš„ SQL ä¸ç¬¦åˆé¢„æœŸï¼Œç”šè‡³å¯èƒ½å¼•å‘é”™è¯¯</p>\n<h2 id=\"æ›¿ä»£æ–¹æ¡ˆ\"><a class=\"anchor\" href=\"#æ›¿ä»£æ–¹æ¡ˆ\">#</a> æ›¿ä»£æ–¹æ¡ˆ</h2>\n<p>å¦‚æœæ‚¨æ‹…å¿ƒ SQL æ³¨å…¥ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ä»¥ä¸‹æ–¹å¼ï¼š</p>\n<ol>\n<li>ä¼ é€’ List å‚æ•°</li>\n</ol>\n<p>åœ¨ MyBatis æ˜ å°„æ–‡ä»¶ä¸­ä½¿ç”¨ <code>&lt;foreach&gt;</code>  æ ‡ç­¾</p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>@Select(&#123;</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>            \"<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span>\",</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>            \"SELECT\",</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>            \"id, name\",</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            \"FROM tab_class\",</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>            \"WHERE\",</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            \"price = #&#123;price&#125; and\",</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            \"name in\",</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            \"<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>foreach</span> <span class=\"token attr-name\">collection</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">'</span>res<span class=\"token punctuation\">'</span></span> <span class=\"token attr-name\">item</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">'</span>item<span class=\"token punctuation\">'</span></span> <span class=\"token attr-name\">open</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">'</span>(<span class=\"token punctuation\">'</span></span> <span class=\"token attr-name\">close</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">'</span>)<span class=\"token punctuation\">'</span></span> <span class=\"token attr-name\">separator</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">'</span>,<span class=\"token punctuation\">'</span></span><span class=\"token punctuation\">></span></span>\",</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>            \"#&#123;item&#125;\",</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>            \"<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>foreach</span><span class=\"token punctuation\">></span></span>\",</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            \"<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\"</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    &#125;)</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    List<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ClassEntity</span><span class=\"token punctuation\">></span></span> getClassAll(@Param(\"res\") List<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>String</span><span class=\"token punctuation\">></span></span> res,@Param(\"price\") Integer price);</pre></td></tr></table></figure><p>åœ¨ java ä»£ç ä¸­ä¼ é€’ <code>List&lt;String&gt;</code>  å‚æ•°</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@GetMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/classAll\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ClassEntity</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">getClassAll</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@RequestBody</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> className<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Integer</span> price<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token keyword\">return</span> classService<span class=\"token punctuation\">.</span><span class=\"token function\">getClassAll</span><span class=\"token punctuation\">(</span>className<span class=\"token punctuation\">,</span> price<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>æ‰“å°ç»“æœï¼š</p>\n<pre><code>[\n    &#123;\n        &quot;id&quot;: 1,\n        &quot;name&quot;: &quot;æ•°å­¦&quot;\n    &#125;,\n    &#123;\n        &quot;id&quot;: 2,\n        &quot;name&quot;: &quot;è¯­æ–‡&quot;\n    &#125;\n]\n</code></pre>\n",
            "tags": [
                "è®¡ç®—æœºå­¦ç§‘",
                "blog",
                "sql",
                "è®¡ç®—æœºå­¦ç§‘ - blog - sql"
            ]
        },
        {
            "id": "https://pigpigletsgo.github.io/computer-science/blog/sql/leftjion%E7%9A%84%E4%BD%BF%E7%94%A8%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9/",
            "url": "https://pigpigletsgo.github.io/computer-science/blog/sql/leftjion%E7%9A%84%E4%BD%BF%E7%94%A8%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9/",
            "title": "leftjionçš„ä½¿ç”¨æ³¨æ„äº‹é¡¹",
            "date_published": "2024-07-24T06:48:02.000Z",
            "content_html": "<h1 id=\"left-join-çš„ä½¿ç”¨æ³¨æ„äº‹é¡¹\"><a class=\"anchor\" href=\"#left-join-çš„ä½¿ç”¨æ³¨æ„äº‹é¡¹\">#</a> left-join çš„ä½¿ç”¨æ³¨æ„äº‹é¡¹</h1>\n<p>åœ¨å¾ˆå¤šåœºæ™¯ä¸‹æˆ‘ä»¬éœ€è¦åŒæ—¶æŸ¥è¯¢å¤šå¼ è¡¨è¿›è¡Œå…³è”æŸ¥è¯¢å‡ºæˆ‘ä»¬æƒ³è¦çš„æ•°æ®</p>\n<p>ä¸‹é¢æ˜¯é”™è¯¯çš„å†™æ³•ï¼š</p>\n<p>è¯´æ˜ï¼š</p>\n<blockquote>\n<p>ä¸ºä»€ä¹ˆè¯´è¿™æ˜¯é”™è¯¯çš„å†™æ³•ï¼ŒåŸå› æ˜¯å½“ sql å¾€ä¸‹æ‰§è¡Œçš„æ—¶å€™èµ°åˆ°äº†å·¦è¿æ¥æŸ¥è¯¢æ­¤æ—¶å¹¶æ— å…¶å®ƒçš„æ¡ä»¶ï¼Œè€Œåªæœ‰ä¸€ä¸ªæ¡ä»¶é‚£ä¹ˆå°±æ˜¯ <code>resource_code</code>  æ˜¯ç›¸åŒçš„æ•°æ®æˆ‘ä»¬å°±æŸ¥ï¼Œç„¶åå·¦è¿æ¥æŸ¥è¯¢å‡ºäº†å…³è” <code>resource_code</code>  çš„æ‰€æœ‰æ•°æ®åœ¨å¾€ä¸‹æ‰§è¡Œèµ°åˆ° <code>WHERE</code>  çš„æ—¶å€™åœ¨è¿›è¡Œæ¡ä»¶ç­›é€‰ï¼Œæ­¤æ—¶åˆä¼šè¿‡æ»¤æ‰ä¸€äº›æ•°æ®ã€‚</p>\n</blockquote>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">SELECT</span> T</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\t<span class=\"token punctuation\">.</span>ID<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\tT<span class=\"token punctuation\">.</span>project_id<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\tT<span class=\"token punctuation\">.</span>analysis_id<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\tT<span class=\"token punctuation\">.</span><span class=\"token keyword\">YEAR</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\tT<span class=\"token punctuation\">.</span>resource_code<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\tT<span class=\"token punctuation\">.</span>resource_name<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\tT<span class=\"token punctuation\">.</span>administrative_division_name<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\tT<span class=\"token punctuation\">.</span>main_body<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\tT<span class=\"token punctuation\">.</span>gas_type<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t<span class=\"token punctuation\">(</span> A<span class=\"token punctuation\">.</span>plan_supply_num <span class=\"token operator\">-</span> T<span class=\"token punctuation\">.</span>surrounding_sales_num <span class=\"token operator\">-</span> T<span class=\"token punctuation\">.</span>self_use_num <span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> one_access_volume<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\tT<span class=\"token punctuation\">.</span>surrounding_sales_num<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\tT<span class=\"token punctuation\">.</span>self_use_num </pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">FROM</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\tpro_bala_year_province_d_u_increase_china_gas T <span class=\"token keyword\">LEFT</span> <span class=\"token keyword\">JOIN</span> pro_bala_sup_year_china_gas_supply A </pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\t<span class=\"token keyword\">ON</span> A<span class=\"token punctuation\">.</span>resource_code <span class=\"token operator\">=</span> T<span class=\"token punctuation\">.</span>resource_code </pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token keyword\">WHERE</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>\tT<span class=\"token punctuation\">.</span>analysis_id <span class=\"token operator\">=</span> <span class=\"token string\">'123'</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>\t<span class=\"token operator\">AND</span> A<span class=\"token punctuation\">.</span><span class=\"token keyword\">YEAR</span> <span class=\"token operator\">=</span> T<span class=\"token punctuation\">.</span><span class=\"token keyword\">YEAR</span> </pre></td></tr><tr><td data-num=\"20\"></td><td><pre>\t<span class=\"token operator\">AND</span> T<span class=\"token punctuation\">.</span>analysis_id <span class=\"token operator\">=</span> A<span class=\"token punctuation\">.</span>analysis_id </pre></td></tr><tr><td data-num=\"21\"></td><td><pre>\t<span class=\"token operator\">AND</span> T<span class=\"token punctuation\">.</span>administrative_division_code <span class=\"token operator\">=</span> A<span class=\"token punctuation\">.</span>administrative_division_code </pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token keyword\">ORDER</span> <span class=\"token keyword\">BY</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>\tT<span class=\"token punctuation\">.</span><span class=\"token keyword\">YEAR</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>\tT<span class=\"token punctuation\">.</span>resource_code<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>\tT<span class=\"token punctuation\">.</span>resource_name <span class=\"token keyword\">ASC</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>ä¸‹é¢æ˜¯æ­£ç¡®çš„å†™æ³•</p>\n<p>è¯´æ˜ï¼š</p>\n<blockquote>\n<p>sql å¾€ä¸‹æ‰§è¡Œèµ°åˆ°å·¦è¿æ¥çš„æ—¶å€™ï¼Œå…ˆæŒ‰ç…§æŒ‡å®šçš„æ¡ä»¶ç­›é€‰è¿‡æ»¤æ‰æƒ³è¦çš„æ•°æ®ï¼Œå†å¾€ä¸‹èµ°ç­›é€‰ä¸»è¡¨çš„æ•°æ®æŸ¥è¯¢å‡ºæˆ‘ä»¬æƒ³è¦çš„æ•°æ®ï¼Œè¿™ç§å†™æ³•åœ¨èµ°åˆ°å·¦è¿æ¥æŸ¥è¯¢çš„æ—¶å€™å¹¶ä¸æ˜¯ä¸€å£æ°”æŠŠæ‰€æœ‰åªæœ‰ä¸€ä¸ªæ¡ä»¶çš„æ•°æ®éƒ½æŸ¥è¯¢å‡ºæ¥å†å¾€ä¸‹æ‰§è¡Œ <code>WHERE</code>  çš„è¿‡æ»¤æ¡ä»¶çš„</p>\n</blockquote>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">SELECT</span> T</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\t<span class=\"token punctuation\">.</span>ID<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\tT<span class=\"token punctuation\">.</span>project_id<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\tT<span class=\"token punctuation\">.</span>analysis_id<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\tT<span class=\"token punctuation\">.</span><span class=\"token keyword\">YEAR</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\tT<span class=\"token punctuation\">.</span>resource_code<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\tT<span class=\"token punctuation\">.</span>resource_name<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\tT<span class=\"token punctuation\">.</span>administrative_division_name<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\tT<span class=\"token punctuation\">.</span>main_body<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\tT<span class=\"token punctuation\">.</span>gas_type<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t<span class=\"token punctuation\">(</span> A<span class=\"token punctuation\">.</span>plan_supply_num <span class=\"token operator\">-</span> T<span class=\"token punctuation\">.</span>surrounding_sales_num <span class=\"token operator\">-</span> T<span class=\"token punctuation\">.</span>self_use_num <span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> one_access_volume<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\tT<span class=\"token punctuation\">.</span>surrounding_sales_num<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\tT<span class=\"token punctuation\">.</span>self_use_num </pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">FROM</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\tpro_bala_year_province_d_u_increase_china_gas T <span class=\"token keyword\">LEFT</span> <span class=\"token keyword\">JOIN</span> pro_bala_sup_year_china_gas_supply A </pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\t<span class=\"token keyword\">ON</span> A<span class=\"token punctuation\">.</span>resource_code <span class=\"token operator\">=</span> T<span class=\"token punctuation\">.</span>resource_code </pre></td></tr><tr><td data-num=\"17\"></td><td><pre>\t<span class=\"token operator\">AND</span> A<span class=\"token punctuation\">.</span><span class=\"token keyword\">YEAR</span> <span class=\"token operator\">=</span> T<span class=\"token punctuation\">.</span><span class=\"token keyword\">YEAR</span> </pre></td></tr><tr><td data-num=\"18\"></td><td><pre>\t<span class=\"token operator\">AND</span> T<span class=\"token punctuation\">.</span>analysis_id <span class=\"token operator\">=</span> A<span class=\"token punctuation\">.</span>analysis_id </pre></td></tr><tr><td data-num=\"19\"></td><td><pre>\t<span class=\"token operator\">AND</span> T<span class=\"token punctuation\">.</span>administrative_division_code <span class=\"token operator\">=</span> A<span class=\"token punctuation\">.</span>administrative_division_code </pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token keyword\">WHERE</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>\tT<span class=\"token punctuation\">.</span>analysis_id <span class=\"token operator\">=</span> <span class=\"token string\">'123'</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token keyword\">ORDER</span> <span class=\"token keyword\">BY</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>\tT<span class=\"token punctuation\">.</span><span class=\"token keyword\">YEAR</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>\tT<span class=\"token punctuation\">.</span>resource_code<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>\tT<span class=\"token punctuation\">.</span>resource_name <span class=\"token keyword\">ASC</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure>",
            "tags": [
                "è®¡ç®—æœºå­¦ç§‘",
                "blog",
                "sql",
                "è®¡ç®—æœºå­¦ç§‘ - blog - sql"
            ]
        },
        {
            "id": "https://pigpigletsgo.github.io/computer-science/java/%E6%A1%88%E4%BE%8BDemo/Java8-StringJoiner/",
            "url": "https://pigpigletsgo.github.io/computer-science/java/%E6%A1%88%E4%BE%8BDemo/Java8-StringJoiner/",
            "title": "Java8-StringJoiner",
            "date_published": "2024-07-17T08:05:10.000Z",
            "content_html": "<h1 id=\"java8-stringjoiner\"><a class=\"anchor\" href=\"#java8-stringjoiner\">#</a> Java8-StringJoiner</h1>\n<p>å¼•è¨€ï¼šåœ¨é˜…è¯»é¡¹ç›®ä»£ç æ—¶ï¼Œçªç„¶çœ‹åˆ°äº† StringJoiner è¿™ä¸ªç±»çš„ä½¿ç”¨ï¼Œæ„Ÿè§‰å¾ˆæœ‰æ„æ€ï¼Œå¯¹å®é™…å¼€å‘ä¸­ä¹Ÿæœ‰ç”¨ï¼Œå®é™…ä¸Šæ˜¯è¿ç”¨äº† StringBuilder çš„ä¸€ä¸ªæ‹¼æ¥å­—ç¬¦ä¸²çš„å°è£…å¤„ç†</p>\n<h2 id=\"ä»‹ç»\"><a class=\"anchor\" href=\"#ä»‹ç»\">#</a> ä»‹ç»</h2>\n<p>StringJoiner æ˜¯ java8 æ–°å‡ºçš„ä¸€ä¸ªç±»ï¼Œç”¨äºæ„é€ ç”±åˆ†éš”ç¬¦çš„å­—ç¬¦åºåˆ—ï¼Œå¹¶å¯é€‰æ‹©æ€§åœ°ä»æä¾›çš„å‰ç¼€å¼€å§‹å’Œä»¥æä¾›çš„åç¼€ç»“å°¾ã€‚çœçš„æˆ‘ä»¬å¼€å‘äººå‘˜å†æ¬¡é€šè¿‡ StringBuffer æˆ–è€… StringBuilder æ‹¼æ¥</p>\n<p>æˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹ä»£ç ï¼Œè¯•ç€çŒœä¸€ä¸‹</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">StringJoiner</span> sj <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">StringJoiner</span><span class=\"token punctuation\">(</span><span class=\"token string\">\":\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"[\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"]\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>sj<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"George\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Sally\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Fred\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token class-name\">String</span> desiredString <span class=\"token operator\">=</span> sj<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>ä»£ç è¾“å‡ºä¸º <code>[George:Sally:Fred]</code></p>\n<h2 id=\"æºç \"><a class=\"anchor\" href=\"#æºç \">#</a> æºç </h2>\n<p>è¿™ä¸ªç±»çš„æºç å¾ˆç®€å•ï¼Œå¤§å®¶å¾ˆå®¹æ˜“å°±å¯ä»¥çœ‹æ˜ç™½ã€‚</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">package</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">StringJoiner</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> prefix<span class=\"token punctuation\">;</span><span class=\"token comment\">// å‰ç¼€</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> delimiter<span class=\"token punctuation\">;</span><span class=\"token comment\">// é—´éš”ç¬¦</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> suffix<span class=\"token punctuation\">;</span><span class=\"token comment\">// åç¼€</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">StringBuilder</span> value<span class=\"token punctuation\">;</span><span class=\"token comment\">// å€¼</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> emptyValue<span class=\"token punctuation\">;</span><span class=\"token comment\">// ç©ºå€¼</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">StringJoiner</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">CharSequence</span> delimiter<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">this</span><span class=\"token punctuation\">(</span>delimiter<span class=\"token punctuation\">,</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">// é»˜è®¤å‰ç¼€å’Œåç¼€ä¸º \"\", é‡è½½è°ƒç”¨</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">StringJoiner</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">CharSequence</span> delimiter<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>                        <span class=\"token class-name\">CharSequence</span> prefix<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>                        <span class=\"token class-name\">CharSequence</span> suffix<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token comment\">// é—´éš”ç¬¦ï¼Œå‰ç¼€å’Œåç¼€åˆ¤æ–­æ˜¯å¦ä¸º nullï¼Œnull å°†æŠ›å‡ºå¼‚å¸¸</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token class-name\">Objects</span><span class=\"token punctuation\">.</span><span class=\"token function\">requireNonNull</span><span class=\"token punctuation\">(</span>prefix<span class=\"token punctuation\">,</span> <span class=\"token string\">\"The prefix must not be null\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token class-name\">Objects</span><span class=\"token punctuation\">.</span><span class=\"token function\">requireNonNull</span><span class=\"token punctuation\">(</span>delimiter<span class=\"token punctuation\">,</span> <span class=\"token string\">\"The delimiter must not be null\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token class-name\">Objects</span><span class=\"token punctuation\">.</span><span class=\"token function\">requireNonNull</span><span class=\"token punctuation\">(</span>suffix<span class=\"token punctuation\">,</span> <span class=\"token string\">\"The suffix must not be null\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token comment\">// æˆå‘˜å˜é‡èµ‹å€¼</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>prefix <span class=\"token operator\">=</span> prefix<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>delimiter <span class=\"token operator\">=</span> delimiter<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>suffix <span class=\"token operator\">=</span> suffix<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>emptyValue <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>prefix <span class=\"token operator\">+</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>suffix<span class=\"token punctuation\">;</span><span class=\"token comment\">// ç©ºå€¼è¢«è®¾ç½®ä¸ºåªæœ‰å‰åç¼€</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>   </pre></td></tr><tr><td data-num=\"29\"></td><td><pre>\t<span class=\"token comment\">// è®¾ç½®ç©ºå€¼ï¼Œæ£€æŸ¥æ˜¯å¦ä¸º null</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">StringJoiner</span> <span class=\"token function\">setEmptyValue</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">CharSequence</span> emptyValue<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>emptyValue <span class=\"token operator\">=</span> <span class=\"token class-name\">Objects</span><span class=\"token punctuation\">.</span><span class=\"token function\">requireNonNull</span><span class=\"token punctuation\">(</span>emptyValue<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>            <span class=\"token string\">\"The empty value must not be null\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>value <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>            <span class=\"token keyword\">return</span> emptyValue<span class=\"token punctuation\">;</span><span class=\"token comment\">// æ²¡æœ‰å€¼å°†è¿”å›ç©ºå€¼æˆ–è€…åç»­è®¾ç½®çš„ç©ºå€¼</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>suffix<span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>                <span class=\"token keyword\">return</span> value<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">// åç¼€ä¸º \"\" ç›´æ¥è¿”å›å­—ç¬¦ä¸²ï¼Œä¸ç”¨æ·»åŠ </span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>\t            <span class=\"token comment\">// åç¼€ä¸ä¸º \"\"ï¼Œæ·»åŠ åç¼€ï¼Œç„¶åç›´æ¥è¿”å›å­—ç¬¦ä¸²ï¼Œä¿®æ”¹é•¿åº¦</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>                <span class=\"token keyword\">int</span> initialLength <span class=\"token operator\">=</span> value<span class=\"token punctuation\">.</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>                <span class=\"token class-name\">String</span> result <span class=\"token operator\">=</span> value<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span>suffix<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>                <span class=\"token comment\">// reset value to pre-append initialLength</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>                value<span class=\"token punctuation\">.</span><span class=\"token function\">setLength</span><span class=\"token punctuation\">(</span>initialLength<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>                <span class=\"token keyword\">return</span> result<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>    åˆå§‹åŒ–ï¼Œå…ˆæ·»åŠ å‰ç¼€ï¼Œæœ‰äº†ä¹‹åæ¯æ¬¡å…ˆæ·»åŠ é—´éš”ç¬¦ï¼Œ<span class=\"token class-name\">StringBuilder</span>åç»­appendå­—ç¬¦ä¸²</pre></td></tr><tr><td data-num=\"54\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">StringJoiner</span> <span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">CharSequence</span> newElement<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>        <span class=\"token function\">prepareBuilder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span>newElement<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>   </pre></td></tr><tr><td data-num=\"59\"></td><td><pre>\t<span class=\"token comment\">// åˆå¹¶ StringJoinerï¼Œæ³¨æ„åé¢ StringJoiner çš„å‰ç¼€å°±ä¸è¦äº†ï¼Œåé¢çš„ appen è¿›æ¥</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">StringJoiner</span> <span class=\"token function\">merge</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StringJoiner</span> other<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>        <span class=\"token class-name\">Objects</span><span class=\"token punctuation\">.</span><span class=\"token function\">requireNonNull</span><span class=\"token punctuation\">(</span>other<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>other<span class=\"token punctuation\">.</span>value <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>            <span class=\"token keyword\">final</span> <span class=\"token keyword\">int</span> length <span class=\"token operator\">=</span> other<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">.</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>            <span class=\"token comment\">// lock the length so that we can seize the data to be appended</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>            <span class=\"token comment\">// before initiate copying to avoid interference, especially when</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>            <span class=\"token comment\">// merge 'this'</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>            <span class=\"token class-name\">StringBuilder</span> builder <span class=\"token operator\">=</span> <span class=\"token function\">prepareBuilder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>            builder<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span>other<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">,</span> other<span class=\"token punctuation\">.</span>prefix<span class=\"token punctuation\">.</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>   </pre></td></tr><tr><td data-num=\"73\"></td><td><pre>\t<span class=\"token comment\">// åˆå§‹åŒ–ï¼Œå…ˆæ·»åŠ å‰ç¼€ï¼Œæœ‰äº†ä¹‹åæ¯æ¬¡å…ˆæ·»åŠ é—´éš”ç¬¦</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">StringBuilder</span> <span class=\"token function\">prepareBuilder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>value <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>            value<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span>delimiter<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>            value <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">StringBuilder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span>prefix<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre>        <span class=\"token keyword\">return</span> value<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre></pre></td></tr><tr><td data-num=\"83\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">int</span> <span class=\"token function\">length</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>        <span class=\"token comment\">// Remember that we never actually append the suffix unless we return</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>        <span class=\"token comment\">// the full (present) value or some sub-string or length of it, so that</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre>        <span class=\"token comment\">// we can add on more if we need to.</span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre>        <span class=\"token comment\">// ä¸å¿˜æ·»åŠ åç¼€çš„é•¿åº¦</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>value <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">?</span> value<span class=\"token punctuation\">.</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> suffix<span class=\"token punctuation\">.</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"89\"></td><td><pre>                emptyValue<span class=\"token punctuation\">.</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"90\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"91\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure>",
            "tags": [
                "è®¡ç®—æœºå­¦ç§‘",
                "java",
                "æ¡ˆä¾‹Demo",
                "è®¡ç®—æœºå­¦ç§‘",
                "æ¡ˆä¾‹Demo"
            ]
        },
        {
            "id": "https://pigpigletsgo.github.io/computer-science/java/%E6%A1%88%E4%BE%8BDemo/x-y%E6%9F%B1%E7%8A%B6-%E6%8A%98%E7%BA%BF%E5%9B%BE%E8%BF%94%E5%9B%9E%E6%95%B0%E6%8D%AE/",
            "url": "https://pigpigletsgo.github.io/computer-science/java/%E6%A1%88%E4%BE%8BDemo/x-y%E6%9F%B1%E7%8A%B6-%E6%8A%98%E7%BA%BF%E5%9B%BE%E8%BF%94%E5%9B%9E%E6%95%B0%E6%8D%AE/",
            "title": "x-yæŸ±çŠ¶-æŠ˜çº¿å›¾è¿”å›æ•°æ®",
            "date_published": "2024-07-17T08:02:38.000Z",
            "content_html": "<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20240715095923286.png\" alt=\"image-20240715095923286\" /></p>\n<p>å›¾è¡¨ç±»</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"2\"></td><td><pre> * å›¾è¡¨ç±»</pre></td></tr><tr><td data-num=\"3\"></td><td><pre> * @Author: lizheng</pre></td></tr><tr><td data-num=\"4\"></td><td><pre> * @Date: 2023/10/21 17:28</pre></td></tr><tr><td data-num=\"5\"></td><td><pre> */</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token annotation punctuation\">@Data</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token annotation punctuation\">@NoArgsConstructor</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token annotation punctuation\">@AllArgsConstructor</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token annotation punctuation\">@Schema</span><span class=\"token punctuation\">(</span>description <span class=\"token operator\">=</span> <span class=\"token string\">\"å›¾è¡¨\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Chart</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token annotation punctuation\">@Schema</span><span class=\"token punctuation\">(</span>description <span class=\"token operator\">=</span> <span class=\"token string\">\"xè½´æ•°æ®é›†åˆ\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> xData<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token annotation punctuation\">@Schema</span><span class=\"token punctuation\">(</span>description <span class=\"token operator\">=</span> <span class=\"token string\">\"yè½´æ•°æ®é›†åˆ\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">YData</span><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span><span class=\"token punctuation\">></span></span> yData<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>y è½´æ•°æ®ç±»</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Data</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token annotation punctuation\">@NoArgsConstructor</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token annotation punctuation\">@AllArgsConstructor</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token annotation punctuation\">@Schema</span><span class=\"token punctuation\">(</span>description <span class=\"token operator\">=</span> <span class=\"token string\">\"yè½´æ•°æ®\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">YData</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token annotation punctuation\">@Schema</span><span class=\"token punctuation\">(</span>description <span class=\"token operator\">=</span> <span class=\"token string\">\"æ˜¾ç¤ºåç§°\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> name<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token annotation punctuation\">@Schema</span><span class=\"token punctuation\">(</span>description <span class=\"token operator\">=</span> <span class=\"token string\">\"å­—æ®µåç§°\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> key<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token annotation punctuation\">@Schema</span><span class=\"token punctuation\">(</span>description <span class=\"token operator\">=</span> <span class=\"token string\">\"å›¾è¡¨ç±»å‹(æŸ±çŠ¶ã€æŠ˜çº¿ç­‰)\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> type<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token annotation punctuation\">@Schema</span><span class=\"token punctuation\">(</span>description <span class=\"token operator\">=</span> <span class=\"token string\">\"æ•°æ®\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> data<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>x è½´æ•°æ®ï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œéå†å¹´ï¼Œä¸šåŠ¡ä»£ç å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Chart</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Double</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">naturalGasSupplyAndDemandBalance</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token class-name\">MPJLambdaWrapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">CompGasBalance</span><span class=\"token punctuation\">></span></span> wrapper <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">MPJLambdaWrapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">CompGasBalance</span><span class=\"token punctuation\">></span></span> compGasBalances <span class=\"token operator\">=</span> compGasBalanceMapper<span class=\"token punctuation\">.</span><span class=\"token function\">selectList</span><span class=\"token punctuation\">(</span>wrapper<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>compGasBalances<span class=\"token punctuation\">.</span><span class=\"token function\">isEmpty</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token comment\">//y è½´æ•°æ®</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">YData</span><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Double</span><span class=\"token punctuation\">></span><span class=\"token punctuation\">></span></span> yData <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token comment\">//x è½´æ•°æ®</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> xData <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token comment\">//revenue</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Double</span><span class=\"token punctuation\">></span></span> supplyNum <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token comment\">//increase</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Double</span><span class=\"token punctuation\">></span></span> gasNeedTotal <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">CompGasBalance</span> compGasBalance <span class=\"token operator\">:</span> compGasBalances<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            xData<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>compGasBalance<span class=\"token punctuation\">.</span><span class=\"token function\">getYear</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            supplyNum<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>compGasBalance<span class=\"token punctuation\">.</span><span class=\"token function\">getSupplyNum</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>            gasNeedTotal<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>compGasBalance<span class=\"token punctuation\">.</span><span class=\"token function\">getGasNeedTotal</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        yData<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">YData</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token string\">\"æ”¶å…¥\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"revenue\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">ChartTypeConstants</span><span class=\"token punctuation\">.</span>line<span class=\"token punctuation\">,</span>supplyNum<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        yData<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">YData</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token string\">\"å¢é•¿\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"increase\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">ChartTypeConstants</span><span class=\"token punctuation\">.</span>line<span class=\"token punctuation\">,</span>gasNeedTotal<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Chart</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span>xData<span class=\"token punctuation\">,</span>yData<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure>",
            "tags": [
                "è®¡ç®—æœºå­¦ç§‘",
                "java",
                "æ¡ˆä¾‹Demo",
                "è®¡ç®—æœºå­¦ç§‘",
                "æ¡ˆä¾‹Demo"
            ]
        },
        {
            "id": "https://pigpigletsgo.github.io/computer-science/java/%E7%9F%A5%E8%AF%86%E7%82%B9/lambda/%E5%A6%99%E7%94%A8Function%E5%87%BD%E6%95%B0%E5%BC%8F%E6%8E%A5%E5%8F%A3%E6%B6%88%E7%81%ADif-else/",
            "url": "https://pigpigletsgo.github.io/computer-science/java/%E7%9F%A5%E8%AF%86%E7%82%B9/lambda/%E5%A6%99%E7%94%A8Function%E5%87%BD%E6%95%B0%E5%BC%8F%E6%8E%A5%E5%8F%A3%E6%B6%88%E7%81%ADif-else/",
            "title": "Functionå‡½æ•°å¼æ¥å£",
            "date_published": "2024-07-16T00:25:44.000Z",
            "content_html": "<h2 id=\"functionå‡½æ•°å¼æ¥å£\"><a class=\"anchor\" href=\"#functionå‡½æ•°å¼æ¥å£\">#</a> Function å‡½æ•°å¼æ¥å£</h2>\n<p>ä½¿ç”¨æ³¨è§£ï¼š<mark>@FunctionalInterface</mark> æ ‡è¯†ï¼Œå¹¶ä¸”åªåŒ…å«ä¸€ä¸ª <mark>æŠ½è±¡æ–¹æ³•</mark> çš„æ¥å£æ˜¯ <mark>å‡½æ•°å¼æ¥å£</mark>ã€‚<mark>å‡½æ•°å¼æ¥å£</mark> ä¸»è¦åˆ†ä¸º<mark> supplier</mark> ä¾›ç»™ç±»å‹å‡½æ•°ï¼Œ<mark>Consumer</mark> æ¶ˆè´¹å‹å‡½æ•°ï¼Œ<mark>Runnable</mark> æ— å‚æ— è¿”å›å‹å‡½æ•°å’Œ <mark>Function</mark> æœ‰å‚åˆè¿”å›å‹å‡½æ•°ã€‚</p>\n<blockquote>\n<p>Function å¯ä»¥çœ‹åšè½¬æ¢å‹å‡½æ•°ã€‚</p>\n</blockquote>\n<h2 id=\"supplierä¾›ç»™å‹å‡½æ•°\"><a class=\"anchor\" href=\"#supplierä¾›ç»™å‹å‡½æ•°\">#</a> supplier ä¾›ç»™å‹å‡½æ•°</h2>\n<p><mark>supplier</mark> çš„è¡¨ç°å½¢å¼ä¸ºä¸æ¥å—å‚æ•°ï¼Œåªè¿”å›æ•°æ®</p>\n<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/952ffda3e6f874663fdd9610dd729814.png\" alt=\"img\" /></p>\n<h2 id=\"consumberæ¶ˆè´¹å‹å‡½æ•°\"><a class=\"anchor\" href=\"#consumberæ¶ˆè´¹å‹å‡½æ•°\">#</a> Consumber æ¶ˆè´¹å‹å‡½æ•°</h2>\n<p>Consumber æ¶ˆè´¹å‹å‡½æ•°</p>\n<p>Consumber æ¶ˆè´¹å‹å‡½æ•°å’Œ Supplier åˆšå¥½ç›¸åï¼ŒConsumber æ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œæ²¡æœ‰è¿”å›å€¼ã€‚</p>\n<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/f63e05bfc0cccc6dbf81746853f5b18e.png\" alt=\"img\" /></p>\n<h2 id=\"runnable-æ— å‚æ— è¿”å›å‹å‡½æ•°\"><a class=\"anchor\" href=\"#runnable-æ— å‚æ— è¿”å›å‹å‡½æ•°\">#</a> Runnable æ— å‚æ— è¿”å›å‹å‡½æ•°</h2>\n<p>Runnable çš„è¡¨ç°å½¢å¼ä¸ºæ—¢æ²¡æœ‰å‚æ•°ä¹Ÿæ²¡æœ‰è¿”å›å€¼</p>\n<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/a19d3d82293cb90485074e0cad4e0700.png\" alt=\"img\" /></p>\n<p>Runnable æ— å‚æ— è¿”å›å‹å‡½æ•°</p>\n<p>Function å‡½æ•°çš„è¡¨ç°å½¢å¼ä¸ºæ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªå€¼ã€‚Supplierï¼ŒConsumer å’Œ Runnable å¯ä»¥çœ‹åš Function çš„ä¸€ç§ç‰¹æ®Šè¡¨ç°å½¢å¼</p>\n<p><img data-src=\"https://ask.qcloudimg.com/http-save/yehe-1453135/abc99db8954da6fba7ae801c9d9db54c.png\" alt=\"img\" /></p>\n<p>@FunctionalInterface</p>\n<h2 id=\"ä½¿ç”¨å°æŠ€å·§\"><a class=\"anchor\" href=\"#ä½¿ç”¨å°æŠ€å·§\">#</a> ä½¿ç”¨å°æŠ€å·§</h2>\n<h3 id=\"å¤„ç†æŠ›å‡ºå¼‚å¸¸çš„if\"><a class=\"anchor\" href=\"#å¤„ç†æŠ›å‡ºå¼‚å¸¸çš„if\">#</a> å¤„ç†æŠ›å‡ºå¼‚å¸¸çš„ if</h3>\n<ol>\n<li>\n<p>å®šä¹‰å‡½æ•°</p>\n<p>å®šä¹‰ä¸€ä¸ªæŠ›å‡ºå¼‚å¸¸çš„å½¢å¼çš„ å‡½æ•°å¼æ¥å£ ï¼Œè¿™ä¸ªæ¥å£åªæœ‰å‚æ•°æ²¡æœ‰è¿”å›å€¼æ˜¯ä¸ª æ¶ˆè´¹å‹æ¥å£ã€‚</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@FunctionalInterface</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">ThrowExceptionFunction</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">void</span> <span class=\"token function\">throwMessage</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> message<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure></li>\n<li>\n<p>ç¼–å†™åˆ¤æ–­æ–¹æ³•</p>\n<p>åˆ›å»ºå·¥å…·ç±»ï¼Œå¹¶åˆ›å»ºä¸€ä¸ª isTrue æ–¹æ³•ï¼Œæ–¹æ³•çš„è¿”å›å€¼ä¸ºåˆšæ‰å®šä¹‰çš„ å‡½æ•°å¼æ¥å£ï¼ŒThrowExceptionFunction çš„æ¥å£å®ç°é€»è¾‘ä¸ºå½“å‚æ•° b ä¸º false æ—¶æŠ›å‡ºå¼‚å¸¸</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">FunctionUtils</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">ThrowExceptionFunction</span> <span class=\"token function\">isTrue</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">boolean</span> b<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token keyword\">return</span> errorMessage <span class=\"token operator\">-></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>b<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>                <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>errorMessage<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure></li>\n<li>\n<p>ä½¿ç”¨æ–¹å¼</p>\n<p>è°ƒç”¨å·¥å…·ç±»å‚æ•°åï¼Œè°ƒç”¨ å‡½æ•°å¼æ¥å£ çš„ throwMessage æ–¹æ³•ä¼ å…¥å¼‚å¸¸ä¿¡æ¯ï¼Œå½“å‡ºå…¥çš„å‚æ•°ä¸º false æ˜¯æ­£å¸¸æ‰§è¡Œ</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>   <span class=\"token class-name\">FunctionUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">isTrue</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">throwMessage</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"æŠ¥é”™äº†\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>æ‰“å°ç»“æœï¼š</p>\n<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20240402092802512.png\" alt=\"image-20240402092802512\" /></p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>   <span class=\"token class-name\">FunctionUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">isTrue</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">throwMessage</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"æŠ¥é”™äº†\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20240402092838100.png\" alt=\"image-20240402092838100\" /></p>\n</li>\n</ol>\n<h3 id=\"å¤„ç†ifåˆ†æ”¯æ“ä½œ\"><a class=\"anchor\" href=\"#å¤„ç†ifåˆ†æ”¯æ“ä½œ\">#</a> å¤„ç† if åˆ†æ”¯æ“ä½œ</h3>\n<ol>\n<li>\n<p>å®šä¹‰å‡½æ•°å¼æ¥å£</p>\n<p>åˆ›å»ºä¸€ä¸ªåä¸º BranchHandle çš„å‡½æ•°å¼æ¥å£ï¼Œæ¥å£çš„å‚æ•°ä¸ºä¸¤ä¸ª Runnable æ¥å£ã€‚è¿™ä¸¤ä¸ª Runnable çš„æ¥å£åˆ†åˆ«ä»£è¡¨äº†ä¸º true æˆ– false æ—¶è¦è¿›è¡Œçš„æ“ä½œ</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@FunctionalInterface</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">BranchHandle</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>     *  åˆ†æ”¯æ“ä½œ</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>     * @param trueHandle ä¸º true æ—¶è¦è¿›è¡Œçš„æ“ä½œ</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>     * @param falseHandle ä¸º false æ—¶è¦è¿›è¡Œçš„æ“ä½œ</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">void</span> <span class=\"token function\">trueOrFalseHandle</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Runnable</span> trueHandle<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Runnable</span> falseHandle<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure></li>\n<li>\n<p>ç¼–å†™åˆ¤æ–­æ–¹æ³•</p>\n<p>åœ¨å·¥å…·ç±»åˆ›å»ºä¸€ä¸ªåä¸º isTrueOrFalse çš„æ–¹æ³•ï¼Œæ–¹æ³•è¿”å›å€¼ä¸ºåˆšæ‰å®šä¹‰çš„ å‡½æ•°å¼æ¥å£ - BranchHandleã€‚</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">BranchHandle</span> <span class=\"token function\">isTrueOrFalse</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">boolean</span> b<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>   <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>trueHandle<span class=\"token punctuation\">,</span> falseHandle<span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>      <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>         trueHandle<span class=\"token punctuation\">.</span><span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>      <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>         falseHandle<span class=\"token punctuation\">.</span><span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure></li>\n<li>\n<p>ä½¿ç”¨æ–¹å¼</p>\n<p>å‚æ•°ä¸º true æ—¶ï¼Œæ‰§è¡Œ trueHandleï¼Œå‚æ•°ä¸º false æ—¶ï¼Œæ‰§è¡Œ falseHandle</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>   <span class=\"token class-name\">FunctionUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">isTrueOrFalse</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">trueOrFalseHandle</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>      <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>      <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>         <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"æ—¢ç„¶æ²¡æŠ¥é”™\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>      <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>         <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"åˆæŠ¥é”™äº†\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>   <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>æ‰“å°ç»“æœï¼š</p>\n<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20240402093740772.png\" alt=\"image-20240402093740772\" /></p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>   <span class=\"token class-name\">FunctionUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">isTrueOrFalse</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">trueOrFalseHandle</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>      <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>      <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>         <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"æ—¢ç„¶æ²¡æŠ¥é”™\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>      <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>         <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"åˆæŠ¥é”™äº†\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>   <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>æ‰“å°ç»“æœï¼š</p>\n<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20240402093815667.png\" alt=\"image-20240402093815667\" /></p>\n</li>\n</ol>\n<h3 id=\"åˆ¤æ–­æ˜¯å¦æœ‰å€¼\"><a class=\"anchor\" href=\"#åˆ¤æ–­æ˜¯å¦æœ‰å€¼\">#</a> åˆ¤æ–­æ˜¯å¦æœ‰å€¼</h3>\n<ol>\n<li>\n<p>å®šä¹‰å‡½æ•°</p>\n<p>åˆ›å»ºä¸€ä¸ªåä¸º PresentOrElseHandler çš„å‡½æ•°å¼æ¥å£ï¼Œæ¥å£çš„å‚æ•°ä¸€ä¸ªä¸º Consumer æ¥å£ã€‚ä¸€ä¸ªä¸º Runnable åˆ†åˆ«ä»£è¡¨å€¼ä¸ä¸ºç©ºæ—¶æ‰§è¡Œæ¶ˆè´¹æ“ä½œå’Œå€¼ä¸ºç©ºæ—¶æ‰§è¡Œçš„å…¶å®ƒæ“ä½œ</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@FunctionalInterface</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">PresentOrElseHandler</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>     * å€¼ä¸ä¸ºç©ºæ—¶æ‰§è¡Œæ¶ˆè´¹æ“ä½œ</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>     * å€¼ä¸ºç©ºæ—¶æ‰§è¡Œå…¶å®ƒæ“ä½œ</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>     * @param action  å€¼ä¸ä¸ºç©ºæ—¶æ‰§è¡Œæ¶ˆè´¹æ“ä½œ</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>     * @param emptyAction å€¼ä¸ºç©ºæ—¶æ‰§è¡Œå…¶å®ƒæ“ä½œ</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">void</span> <span class=\"token function\">presentOrElseHandle</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Consumer</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token operator\">?</span> <span class=\"token keyword\">super</span> <span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> action<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Runnable</span> emptyAction<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure></li>\n<li>\n<p>ç¼–å†™åˆ¤æ–­æ–¹æ³•</p>\n<p>åœ¨å·¥å…·ç±»åˆ›å»ºä¸€ä¸ªåä¸º isBlankOrNoBlank çš„æ–¹æ³•ï¼Œæ–¹æ³•çš„è¿”å›å€¼ä¸ºåˆšæ‰å®šä¹‰çš„ å‡½æ•°å¼æ¥å£ - PresentOrElseHandler</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">PresentOrElseHandler</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token operator\">?</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">isBlankOrNoBlank</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> str<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>   <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>consumer<span class=\"token punctuation\">,</span> runnable<span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>   <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>str <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">||</span> str<span class=\"token punctuation\">.</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>      <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>         runnable<span class=\"token punctuation\">.</span><span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>      <span class=\"token keyword\">else</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>      <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>         consumer<span class=\"token punctuation\">.</span><span class=\"token function\">accept</span><span class=\"token punctuation\">(</span>str<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure></li>\n<li>\n<p>ä½¿ç”¨æ–¹å¼</p>\n<p>è°ƒç”¨å·¥å…·ç±»å‚æ•°åï¼Œè°ƒç”¨ å‡½æ•°å¼æ¥å£ çš„ PresentOrElseHandle æ–¹æ³•ä¼ å…¥ä¸€ä¸ª Consumer å’Œ Runnable å‚æ•°ä¸ä¸ºç©ºæ—¶ï¼Œæ‰“å°å‚æ•°</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>   <span class=\"token class-name\">FunctionUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">isBlankOrNoBlank</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"hello\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">presentOrElseHandle</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token operator\">::</span><span class=\"token function\">println</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>      <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"æŠ¥é”™äº†\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>æ‰“å°ç»“æœï¼š</p>\n<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20240402094834029.png\" alt=\"image-20240402094834029\" /></p>\n<p>ä¼ å…¥ä¸€ä¸ªç©ºå€¼</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">FunctionUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">isBlankOrNoBlank</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">presentOrElseHandle</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token operator\">::</span><span class=\"token function\">println</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>   <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"æŠ¥é”™äº†\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>æ‰“å°ç»“æœï¼š</p>\n<p><img data-src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/image-20240402094923939.png\" alt=\"image-20240402094923939\" /></p>\n</li>\n</ol>\n",
            "tags": [
                "è®¡ç®—æœºå­¦ç§‘",
                "java",
                "çŸ¥è¯†ç‚¹",
                "lambda",
                "çŸ¥è¯†ç‚¹",
                "lambda"
            ]
        },
        {
            "id": "https://pigpigletsgo.github.io/computer-science/blog/sql/sql-blog-2024-7-4-pgsql%E4%BB%8E5%E5%BC%A0%E4%B8%8D%E5%90%8C%E8%A1%A8%E6%9F%A5%E8%AF%A2%E5%AD%97%E6%AE%B5%E6%95%B0%E6%8D%AE%E5%B9%B6%E7%BB%BC%E5%90%88%E8%BF%94%E5%9B%9E/",
            "url": "https://pigpigletsgo.github.io/computer-science/blog/sql/sql-blog-2024-7-4-pgsql%E4%BB%8E5%E5%BC%A0%E4%B8%8D%E5%90%8C%E8%A1%A8%E6%9F%A5%E8%AF%A2%E5%AD%97%E6%AE%B5%E6%95%B0%E6%8D%AE%E5%B9%B6%E7%BB%BC%E5%90%88%E8%BF%94%E5%9B%9E/",
            "title": "pgsqlä»5å¼ ä¸åŒè¡¨æŸ¥è¯¢å­—æ®µæ•°æ®å¹¶ç»¼åˆè¿”å›",
            "date_published": "2024-07-09T11:18:56.000Z",
            "content_html": "<h1 id=\"pgsqlä»5å¼ ä¸åŒè¡¨æŸ¥è¯¢å­—æ®µæ•°æ®å¹¶ç»¼åˆè¿”å›\"><a class=\"anchor\" href=\"#pgsqlä»5å¼ ä¸åŒè¡¨æŸ¥è¯¢å­—æ®µæ•°æ®å¹¶ç»¼åˆè¿”å›\">#</a> pgsql ä» 5 å¼ ä¸åŒè¡¨æŸ¥è¯¢å­—æ®µæ•°æ®å¹¶ç»¼åˆè¿”å›</h1>\n<p>ç¼–å†™çš„æŸ¥è¯¢æ•°æ®åº“è¡¨çš„ sql</p>\n<p><mark>æ€è·¯</mark>ï¼šä» 5 å¼ ä¸åŒçš„è¡¨ä¸­ï¼Œå®ƒä»¬çš„ç»“æ„å¤§è‡´ç›¸åŒã€‚æˆ‘ä»¬ä» 5 å¼ è¡¨ä¸­æ‹¿åˆ°ä¸åŒçš„å­—æ®µçš„æ•°æ®å¹¶è¿”å›</p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">SELECT</span> </pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    cr<span class=\"token punctuation\">.</span><span class=\"token keyword\">YEAR</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    CAST<span class=\"token punctuation\">(</span><span class=\"token function\">SUM</span><span class=\"token punctuation\">(</span>cr<span class=\"token punctuation\">.</span>operating_income<span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> <span class=\"token keyword\">DECIMAL</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> total_operating_income<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    CAST<span class=\"token punctuation\">(</span><span class=\"token function\">SUM</span><span class=\"token punctuation\">(</span>nr<span class=\"token punctuation\">.</span>total_profit<span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> <span class=\"token keyword\">DECIMAL</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> total_total_profit<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    CAST<span class=\"token punctuation\">(</span><span class=\"token function\">SUM</span><span class=\"token punctuation\">(</span>nr<span class=\"token punctuation\">.</span>net_profit<span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> <span class=\"token keyword\">DECIMAL</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> total_net_profit<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    CAST<span class=\"token punctuation\">(</span><span class=\"token function\">SUM</span><span class=\"token punctuation\">(</span>cf<span class=\"token punctuation\">.</span>asset_liability_ratio<span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> <span class=\"token keyword\">DECIMAL</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> total_asset_liability_ratio<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    CAST<span class=\"token punctuation\">(</span><span class=\"token function\">SUM</span><span class=\"token punctuation\">(</span>cf<span class=\"token punctuation\">.</span>return_on_equity<span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> <span class=\"token keyword\">DECIMAL</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> total_return_on_equity<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    CAST<span class=\"token punctuation\">(</span><span class=\"token function\">SUM</span><span class=\"token punctuation\">(</span>cf<span class=\"token punctuation\">.</span>operate_cash_ratio<span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> <span class=\"token keyword\">DECIMAL</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> total_operate_cash_ratio<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    CAST<span class=\"token punctuation\">(</span><span class=\"token function\">SUM</span><span class=\"token punctuation\">(</span>cf<span class=\"token punctuation\">.</span>assets<span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> <span class=\"token keyword\">DECIMAL</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> total_assets<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    CAST<span class=\"token punctuation\">(</span><span class=\"token function\">SUM</span><span class=\"token punctuation\">(</span>cf<span class=\"token punctuation\">.</span>operating_activities_cash_flow<span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> <span class=\"token keyword\">DECIMAL</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> total_operating_activities_cash_flow<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    CAST<span class=\"token punctuation\">(</span><span class=\"token function\">SUM</span><span class=\"token punctuation\">(</span>dr<span class=\"token punctuation\">.</span>liabilities<span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> <span class=\"token keyword\">DECIMAL</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> total_liabilities</pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">FROM</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">SELECT</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token keyword\">YEAR</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token function\">SUM</span><span class=\"token punctuation\">(</span>operating_income<span class=\"token punctuation\">)</span> :: <span class=\"token keyword\">NUMERIC</span> <span class=\"token keyword\">AS</span> operating_income</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">FROM</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        pro_va_mea_province_cash_flow_financing_income_costs_result</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">GROUP</span> <span class=\"token keyword\">BY</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token keyword\">YEAR</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> cr</pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token keyword\">LEFT</span> <span class=\"token keyword\">JOIN</span> </pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token keyword\">SELECT</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        <span class=\"token keyword\">YEAR</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        <span class=\"token function\">SUM</span><span class=\"token punctuation\">(</span>total_profit<span class=\"token punctuation\">)</span> :: <span class=\"token keyword\">NUMERIC</span> <span class=\"token keyword\">AS</span> total_profit<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token function\">SUM</span><span class=\"token punctuation\">(</span>net_profit<span class=\"token punctuation\">)</span> :: <span class=\"token keyword\">NUMERIC</span> <span class=\"token keyword\">AS</span> net_profit</pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token keyword\">FROM</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        pro_va_mea_province_cost_profit_net_result</pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token keyword\">GROUP</span> <span class=\"token keyword\">BY</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>        <span class=\"token keyword\">YEAR</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> nr <span class=\"token keyword\">ON</span> cr<span class=\"token punctuation\">.</span><span class=\"token keyword\">YEAR</span> <span class=\"token operator\">=</span> nr<span class=\"token punctuation\">.</span><span class=\"token keyword\">YEAR</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token keyword\">LEFT</span> <span class=\"token keyword\">JOIN</span> </pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    <span class=\"token keyword\">SELECT</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>        <span class=\"token keyword\">YEAR</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>        <span class=\"token function\">SUM</span><span class=\"token punctuation\">(</span>asset_liability_ratio<span class=\"token punctuation\">)</span> :: <span class=\"token keyword\">NUMERIC</span> <span class=\"token keyword\">AS</span> asset_liability_ratio<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>        <span class=\"token function\">SUM</span><span class=\"token punctuation\">(</span>return_on_equity<span class=\"token punctuation\">)</span> :: <span class=\"token keyword\">NUMERIC</span> <span class=\"token keyword\">AS</span> return_on_equity<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>        <span class=\"token function\">SUM</span><span class=\"token punctuation\">(</span>operate_cash_ratio<span class=\"token punctuation\">)</span> :: <span class=\"token keyword\">NUMERIC</span> <span class=\"token keyword\">AS</span> operate_cash_ratio<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>        <span class=\"token function\">SUM</span><span class=\"token punctuation\">(</span>assets<span class=\"token punctuation\">)</span> :: <span class=\"token keyword\">NUMERIC</span> <span class=\"token keyword\">AS</span> assets<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>        <span class=\"token function\">SUM</span><span class=\"token punctuation\">(</span>operating_activities_cash_flow<span class=\"token punctuation\">)</span> :: <span class=\"token keyword\">NUMERIC</span> <span class=\"token keyword\">AS</span> operating_activities_cash_flow</pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    <span class=\"token keyword\">FROM</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>        pro_va_mea_province_equity_ratio_cash_flow</pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    <span class=\"token keyword\">GROUP</span> <span class=\"token keyword\">BY</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>        <span class=\"token keyword\">YEAR</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    <span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> cf <span class=\"token keyword\">ON</span> cr<span class=\"token punctuation\">.</span><span class=\"token keyword\">YEAR</span> <span class=\"token operator\">=</span> cf<span class=\"token punctuation\">.</span><span class=\"token keyword\">YEAR</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre><span class=\"token keyword\">LEFT</span> <span class=\"token keyword\">JOIN</span> </pre></td></tr><tr><td data-num=\"48\"></td><td><pre>    <span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>    <span class=\"token keyword\">SELECT</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>        <span class=\"token keyword\">YEAR</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>        <span class=\"token function\">SUM</span><span class=\"token punctuation\">(</span>liabilities<span class=\"token punctuation\">)</span> :: <span class=\"token keyword\">NUMERIC</span> <span class=\"token keyword\">AS</span> liabilities</pre></td></tr><tr><td data-num=\"52\"></td><td><pre>    <span class=\"token keyword\">FROM</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>        pro_va_mea_province_liabilities_depreciation_result</pre></td></tr><tr><td data-num=\"54\"></td><td><pre>    <span class=\"token keyword\">GROUP</span> <span class=\"token keyword\">BY</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>        <span class=\"token keyword\">YEAR</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>    <span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> dr <span class=\"token keyword\">ON</span> cr<span class=\"token punctuation\">.</span><span class=\"token keyword\">YEAR</span> <span class=\"token operator\">=</span> dr<span class=\"token punctuation\">.</span><span class=\"token keyword\">YEAR</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre><span class=\"token keyword\">GROUP</span> <span class=\"token keyword\">BY</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>    cr<span class=\"token punctuation\">.</span><span class=\"token keyword\">YEAR</span> </pre></td></tr><tr><td data-num=\"59\"></td><td><pre><span class=\"token keyword\">ORDER</span> <span class=\"token keyword\">BY</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>    cr<span class=\"token punctuation\">.</span><span class=\"token keyword\">YEAR</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>è¿”å› List&lt;Map&lt;String, Object&gt;&gt;<br />\n è¿”å›ç»“æœï¼š</p>\n<pre><code>[&#123;\n  year=2021,\n  total_net_profit=0.00,\n  total_asset_liability_ratio=0.00,\n  total_return_on_equity=0.00,\n  total_assets=0.00,\n  total_operating_activities_cash_flow=0.00,\n  total_liabilities=0.00,\n  total_operating_income=0.00,\n  total_total_profit=0.00,\n  total_operate_cash_ratio=0.00\n&#125;\n&#123;\n  year=2022,\n  total_net_profit=0.00,\n  total_asset_liability_ratio=0.00,\n  total_return_on_equity=0.00,\n  total_assets=0.00,\n  total_operating_activities_cash_flow=0.00,\n  total_liabilities=0.00,\n  total_operating_income=0.00,\n  total_total_profit=0.00,\n  total_operate_cash_ratio=0.00\n&#125;\n&#123;\n  year=2023,\n  total_net_profit=0.00,\n  total_asset_liability_ratio=0.00,\n  total_return_on_equity=0.00,\n  total_assets=0.00,\n  total_operating_activities_cash_flow=0.00,\n  total_liabilities=0.00,\n  total_operating_income=0.00,\n  total_total_profit=0.00,\n  total_operate_cash_ratio=0.00\n&#125;]\n</code></pre>\n<p>å¯¹æ•°æ®è¿›è¡Œæ ¼å¼è½¬æ¢ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Map</span><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">></span><span class=\"token punctuation\">></span></span> <span class=\"token function\">formatAnnualEvaluation</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Map</span><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">></span><span class=\"token punctuation\">></span></span> annualEvaluation<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>        <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Map</span><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">></span><span class=\"token punctuation\">></span></span> formattedData <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token comment\">// éœ€è¦æ˜¾ç¤ºçš„å­—æ®µåˆ—è¡¨</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token class-name\">AnnualEvaluationF</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> values <span class=\"token operator\">=</span> <span class=\"token class-name\">AnnualEvaluationF</span><span class=\"token punctuation\">.</span><span class=\"token function\">values</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token class-name\">String</span> fielder <span class=\"token operator\">=</span> <span class=\"token class-name\">Arrays</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span>values<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"[\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"]\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> fields <span class=\"token operator\">=</span> fielder<span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">\",\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token comment\">// éå†æ¯ä¸ªå­—æ®µ</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> field <span class=\"token operator\">:</span> fields<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            <span class=\"token comment\">// åˆå§‹åŒ–ä¸€ä¸ª Map ç”¨äºå­˜å‚¨å½“å‰å­—æ®µçš„æ•°æ®</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>            <span class=\"token class-name\">Map</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">></span></span> fieldData <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HashMap</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>            fieldData<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"field\"</span><span class=\"token punctuation\">,</span> field<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            <span class=\"token comment\">// éå†æ¯ä¸ªå¹´ä»½ï¼Œå°†å½“å‰å­—æ®µçš„å€¼æŒ‰å¹´ä»½å¡«å……åˆ° fieldData ä¸­</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>            <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Map</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">></span></span> entry <span class=\"token operator\">:</span> annualEvaluation<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>                <span class=\"token class-name\">Integer</span> year <span class=\"token operator\">=</span> <span class=\"token class-name\">ObjectUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">isNotNull</span><span class=\"token punctuation\">(</span>entry<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"year\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token class-name\">Integer</span><span class=\"token punctuation\">.</span><span class=\"token function\">valueOf</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">.</span><span class=\"token function\">valueOf</span><span class=\"token punctuation\">(</span>entry<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"year\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>                <span class=\"token class-name\">Object</span> value <span class=\"token operator\">=</span> <span class=\"token class-name\">ObjectUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">isNotNull</span><span class=\"token punctuation\">(</span>entry<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>field<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> entry<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>field<span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>                fieldData<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span>year<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            <span class=\"token comment\">// å°†å½“å‰å­—æ®µçš„æ•°æ®æ·»åŠ åˆ° formattedData ä¸­</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>            formattedData<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>fieldData<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token keyword\">return</span> formattedData<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>æ‰“å°ç»“æœï¼š</p>\n<pre><code>[\n  &#123;\n    2023=0.00,\n    2022=0.00,\n    2021=0.00,\n    field=&quot;total_asset_liability_ratio&quot;\n  &#125;,\n  &#123;\n    2023=0.00,\n    2022=0.00,\n    2021=0.00,\n    field=&quot;total_net_profit&quot;\n  &#125;,\n  &#123;\n    2023=0.00,\n    2022=0.00,\n    2021=0.00,\n    field=&quot;total_return_on_equity&quot;\n  &#125;,\n  &#123;\n    2023=0.00,\n    2022=0.00,\n    2021=0.00,\n    field=&quot;total_assets&quot;\n  &#125;,\n  &#123;\n    2023=0.00,\n    2022=0.00,\n    2021=0.00,\n    field=&quot;total_operating_activities_cash_flow&quot;\n  &#125;,\n  &#123;\n    2023=0.00,\n    2022=0.00,\n    2021=0.00,\n    field=&quot;total_liabilities&quot;\n  &#125;,\n  &#123;\n    2023=0.00,\n    2022=0.00,\n    2021=0.00,\n    field=&quot;total_operating_income&quot;\n  &#125;,\n  &#123;\n    2023=0.00,\n    2022=0.00,\n    2021=0.00,\n    field=&quot;total_total_profit&quot;\n  &#125;,\n  &#123;\n    2023=0.00,\n    2022=0.00,\n    2021=0.00,\n    field=&quot;total_operate_cash_ratio&quot;\n  &#125;\n]\n</code></pre>\n",
            "tags": [
                "è®¡ç®—æœºå­¦ç§‘",
                "blog",
                "sql",
                "è®¡ç®—æœºå­¦ç§‘",
                "blog",
                "sql"
            ]
        }
    ]
}
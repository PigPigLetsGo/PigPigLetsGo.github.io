{
    "version": "https://jsonfeed.org/version/1",
    "title": "homepage • All posts by \"elasticsearch\" category",
    "description": "欢迎来我的博客空间",
    "home_page_url": "https://pigpigletsgo.github.io/homepage",
    "items": [
        {
            "id": "https://pigpigletsgo.github.io/homepage/2024/04/02/computer-science/java/spring/springcloud/Elasticsearch/%E6%A1%88%E4%BE%8Bsql/",
            "url": "https://pigpigletsgo.github.io/homepage/2024/04/02/computer-science/java/spring/springcloud/Elasticsearch/%E6%A1%88%E4%BE%8Bsql/",
            "title": "es案例",
            "date_published": "2024-04-02T10:00:51.022Z",
            "content_html": "<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"2\"></td><td><pre> Navicat Premium Data Transfer</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre> Source Server         : local</pre></td></tr><tr><td data-num=\"5\"></td><td><pre> Source Server Type    : MySQL</pre></td></tr><tr><td data-num=\"6\"></td><td><pre> Source Server Version : 50622</pre></td></tr><tr><td data-num=\"7\"></td><td><pre> Source Host           : localhost:3306</pre></td></tr><tr><td data-num=\"8\"></td><td><pre> Source Schema         : heima</pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre> Target Server Type    : MySQL</pre></td></tr><tr><td data-num=\"11\"></td><td><pre> Target Server Version : 50622</pre></td></tr><tr><td data-num=\"12\"></td><td><pre> File Encoding         : 65001</pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre> Date: 06/05/2021 18:31:05</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token keyword\">SET</span> NAMES utf8mb4<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token keyword\">SET</span> FOREIGN_KEY_CHECKS <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token comment\">-- ----------------------------</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token comment\">-- Table structure for tb_hotel</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token comment\">-- ----------------------------</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token keyword\">DROP</span> <span class=\"token keyword\">TABLE</span> <span class=\"token keyword\">IF</span> <span class=\"token keyword\">EXISTS</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span>  <span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">bigint</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'酒店id'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>name<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">CHARACTER</span> <span class=\"token keyword\">SET</span> utf8mb4 <span class=\"token keyword\">COLLATE</span> utf8mb4_general_ci <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'酒店名称'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>address<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">CHARACTER</span> <span class=\"token keyword\">SET</span> utf8mb4 <span class=\"token keyword\">COLLATE</span> utf8mb4_general_ci <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'酒店地址'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>price<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'酒店价格'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>score<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'酒店评分'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>brand<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">CHARACTER</span> <span class=\"token keyword\">SET</span> utf8mb4 <span class=\"token keyword\">COLLATE</span> utf8mb4_general_ci <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'酒店品牌'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>city<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">CHARACTER</span> <span class=\"token keyword\">SET</span> utf8mb4 <span class=\"token keyword\">COLLATE</span> utf8mb4_general_ci <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'所在城市'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>star_name<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">CHARACTER</span> <span class=\"token keyword\">SET</span> utf8mb4 <span class=\"token keyword\">COLLATE</span> utf8mb4_general_ci <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'酒店星级，1星到5星，1钻到5钻'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>business<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">CHARACTER</span> <span class=\"token keyword\">SET</span> utf8mb4 <span class=\"token keyword\">COLLATE</span> utf8mb4_general_ci <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'商圈'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>latitude<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">CHARACTER</span> <span class=\"token keyword\">SET</span> utf8mb4 <span class=\"token keyword\">COLLATE</span> utf8mb4_general_ci <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'纬度'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>longitude<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">CHARACTER</span> <span class=\"token keyword\">SET</span> utf8mb4 <span class=\"token keyword\">COLLATE</span> utf8mb4_general_ci <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'经度'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>pic<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">CHARACTER</span> <span class=\"token keyword\">SET</span> utf8mb4 <span class=\"token keyword\">COLLATE</span> utf8mb4_general_ci <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'酒店图片'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>  <span class=\"token keyword\">PRIMARY</span> <span class=\"token keyword\">KEY</span> <span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">USING</span> <span class=\"token keyword\">BTREE</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token punctuation\">)</span> <span class=\"token keyword\">ENGINE</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">InnoDB</span> <span class=\"token keyword\">CHARACTER</span> <span class=\"token keyword\">SET</span> <span class=\"token operator\">=</span> utf8mb4 <span class=\"token keyword\">COLLATE</span> <span class=\"token operator\">=</span> utf8mb4_general_ci ROW_FORMAT <span class=\"token operator\">=</span> Compact<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre></pre></td></tr><tr><td data-num=\"40\"></td><td><pre><span class=\"token comment\">-- ----------------------------</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre><span class=\"token comment\">-- Records of tb_hotel</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre><span class=\"token comment\">-- ----------------------------</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">36934</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天连锁酒店(上海宝山路地铁站店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'静安交通路40号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">336</span><span class=\"token punctuation\">,</span> <span class=\"token number\">37</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'四川北路商业区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.251433'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.47522'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G1/M00/3E/40/Cii9EVkyLrKIXo1vAAHgrxo_pUcAALcKQLD688AAeDH564_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">38609</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'速8酒店(上海赤峰路店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'广灵二路126号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">249</span><span class=\"token punctuation\">,</span> <span class=\"token number\">35</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'速8'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'四川北路商业区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.282444'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.479385'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G2/M00/DF/96/Cii-TFkx0ImIQZeiAAITil0LM7cAALCYwKXHQ4AAhOi377_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">38665</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'速8酒店上海中山北路兰田路店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'兰田路38号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">226</span><span class=\"token punctuation\">,</span> <span class=\"token number\">35</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'速8'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'长风公园地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.244288'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.422419'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G2/M00/EF/86/Cii-Tlk2mV2IMZ-_AAEucgG3dx4AALaawEjiycAAS6K083_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">38812</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天连锁酒店(上海漕溪路地铁站店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'徐汇龙华西路315弄58号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">298</span><span class=\"token punctuation\">,</span> <span class=\"token number\">37</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'八万人体育场地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.174377'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.442875'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G2/M00/E0/0E/Cii-TlkyIr2IEWNoAAHQYv7i5CkAALD-QP2iJwAAdB6245_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">39106</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天连锁酒店（上海莘庄地铁站店）'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'闵行莘庄镇七莘路299号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">348</span><span class=\"token punctuation\">,</span> <span class=\"token number\">41</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'莘庄工业区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.113812'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.375869'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G2/M00/D8/11/Cii-T1ku2zGIGR7uAAF1NYY9clwAAKxZAHO8HgAAXVN368_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">39141</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天连锁酒店(上海五角场复旦同济大学店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'杨浦国权路315号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">349</span><span class=\"token punctuation\">,</span> <span class=\"token number\">38</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'江湾、五角场商业区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.290057'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.508804'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G2/M00/C7/E3/Cii-T1knFXCIJzNYAAFB8-uFNAEAAKYkQPcw1IAAUIL012_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">45845</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海西藏大厦万怡酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'虹桥路100号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">589</span><span class=\"token punctuation\">,</span> <span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'万怡'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'四钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'徐家汇地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.192714'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.434717'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/48GNb9GZpJDCejVAcQHYWwYyU8T_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">45870</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海临港豪生大酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'新元南路555号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">896</span><span class=\"token punctuation\">,</span> <span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'豪生'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'四星级'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'滴水湖临港地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'30.871729'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.81959'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/2F5HoQvBgypoDUE46752ppnQaTqs_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">46829</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海浦西万怡酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'恒丰路338号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">726</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'万怡'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'四钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海火车站地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.242977'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.455864'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/x87VCoyaR8cTuYFZmKHe8VC6Wk1_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">47066</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海浦东东站华美达酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'施新路958号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">408</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'华美达'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'四钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'浦东机场核心区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.147989'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.759199'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/2pNujAVaQbXACzkHp8bQMm6zqwhp_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">47478</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'速8酒店(上海松江中心店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'松江荣乐东路677号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">428</span><span class=\"token punctuation\">,</span> <span class=\"token number\">35</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'速8'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'佘山、松江大学城'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.016712'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.261606'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/filebroker/cdn/res/07/36/073662e1718fccefb7130a9da44ddf5c_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">56201</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海齐鲁万怡大酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'东方路838号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">873</span><span class=\"token punctuation\">,</span> <span class=\"token number\">44</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'万怡'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'四星级'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'浦东陆家嘴金融贸易区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.226031'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.525801'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G6/M00/52/B6/Cii-TF3eXKeIJeN7AASiKHbTtx4AAGRegDSBzMABKJA111_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">56214</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海浦东华美达大酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'新金桥路18号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">830</span><span class=\"token punctuation\">,</span> <span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'华美达'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'四星级'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'浦东金桥地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.244916'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.590752'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/3jtXiuMKZEXJAuKuAkc47yLCjUBt_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">56227</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海圣淘沙万怡酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'南桥镇南桥路1号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">899</span><span class=\"token punctuation\">,</span> <span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'万怡'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'四星级'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'奉贤开发区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'30.910917'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.456525'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G6/M00/52/B9/Cii-U13eXSiIdJjXAARSA6FywFYAAGRnwHvy1AABFIb158_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">56392</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海银星皇冠假日酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'番禺路400号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">809</span><span class=\"token punctuation\">,</span> <span class=\"token number\">47</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'皇冠假日'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五星级'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'徐家汇地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.202768'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.429524'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/37ucQ38K3UFdcRqntJ8M5dt884HR_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">56852</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海财大豪生大酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'武东路188号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">592</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'豪生'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'江湾/五角场商业区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.304182'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.492936'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/2jGHezLZvPZqC9cBGesbP5vAhCXi_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">56912</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海华凯华美达广场酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'月华路9号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">747</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'华美达'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'四钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'奉贤开发区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'30.814382'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.464521'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/45iaCNCuZavJTxwTLskhVKzwynLD_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">56977</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海五角场华美达大酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'黄兴路1888号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">499</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'华美达'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'三钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'江湾/五角场商业区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.292932'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.519759'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/26VREqAQdaGFvJdAJALVtjxcNMpL_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">60214</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海金茂君悦大酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'世纪大道88号（54楼办理入住）'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">699</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'君悦'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五星级'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'浦东陆家嘴金融贸易区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.235152'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.506082'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/7Azm3jvGUHuXe3eS1DrixAWVTXY_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">60223</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海希尔顿酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'静安华山路250号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2688</span><span class=\"token punctuation\">,</span> <span class=\"token number\">37</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'希尔顿'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五星级'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'静安寺地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.219306'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.445427'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/filebroker/cdn/res/92/10/9210e74442aceceaf6e196d61fc3b6b1_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">60359</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海外高桥皇冠假日酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'杨高北路1000号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3299</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'皇冠假日'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五星级'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'浦东外高桥地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.338944'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.590611'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/VcKUM9zUSiVgDhFioc6mWQoX9ES_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">60363</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海新世界丽笙大酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'南京西路88号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1341</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'丽笙'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五星级'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'人民广场地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.23462'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.47327'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/2j31b7X3YzGkf4Li3phS6TG1mtwm_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">60398</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海复旦皇冠假日酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'邯郸路199号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">924</span><span class=\"token punctuation\">,</span> <span class=\"token number\">47</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'皇冠假日'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五星级'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'江湾/五角场商业区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.295382'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.502537'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/2H1Gk8LHaBWZfYvR6NYYcGTvACmL_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">60487</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海外滩茂悦大酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'黄浦路199号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">689</span><span class=\"token punctuation\">,</span> <span class=\"token number\">44</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'君悦'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五星级'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'外滩地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.245409'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.492969'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/2Swp2h1fdj9zCUKsk63BQvVgKLTo_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">60522</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海嘉豪淮海国际豪生酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'汾阳路1号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">425</span><span class=\"token punctuation\">,</span> <span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'豪生'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'四钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'淮海路/新天地地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.215497'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.456297'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/38UBi4QYuaF8jN94CxQ7tb7tjtmZ_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">60916</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海绿地万怡酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'沪宜公路3101号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">328</span><span class=\"token punctuation\">,</span> <span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'万怡'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'四钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'嘉定新城'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.368523'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.258567'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/3VLwG9tTQQnp3M3MTeMTdx9nas9B_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">60922</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海虹桥祥源希尔顿酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'红松东路1116号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1108</span><span class=\"token punctuation\">,</span> <span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'希尔顿'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'虹桥地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.18746'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.395312'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/tQRqDTFkHnHzMZiDKjcGV81ekvc_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">60935</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海虹口三至喜来登酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'四平路59号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1899</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'喜来登'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五星级'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'四川北路商业区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.2579'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.487954'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/3C3gxLxLjVwnkxJwJm8rd3f38kcd_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">61075</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海雅居乐万豪酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'西藏中路555号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1152</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'万豪'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'人民广场地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.236681'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.473529'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/3FoT16PkXavKsssvktVvVq5Si6Cr_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">61083</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海滴水湖皇冠假日酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'自由贸易试验区临港新片区南岛1号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">971</span><span class=\"token punctuation\">,</span> <span class=\"token number\">44</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'皇冠假日'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'滴水湖临港地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'30.890867'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.937241'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/312e971Rnj9qFyR3pPv4bTtpj1hX_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">309208</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京王府井希尔顿酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'王府井东街8号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1679</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'希尔顿'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'天安门/王府井地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'39.914539'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.413392'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G6/M00/52/10/Cii-TF3ePt2IX9UEAALb6VYBSmoAAGKMgGsuW8AAtwB147_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">394559</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京东方君悦大酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'长安街1号东方广场'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">686</span><span class=\"token punctuation\">,</span> <span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'君悦'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五星级'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'天安门/王府井地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'39.909635'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.414621'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/3mFqcNSh7eEo9yc3Rw2P5HDNTdDe_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">394617</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京宝辰饭店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'建国门内大街甲18号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">418</span><span class=\"token punctuation\">,</span> <span class=\"token number\">44</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'豪生'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'四星级'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京站/建国门地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'39.905768'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.428153'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/NEYa6EfDHuhhb19Ct85WBbkKHZU_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">394796</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京新云南皇冠假日酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'东北三环西坝河太阳宫桥东北角云南大厦'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">485</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'皇冠假日'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五星级'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'国展中心地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'39.972409'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.434698'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/dfP8K782eTsohQWSRdkd7St9LA2_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">395434</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京希尔顿酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'东三环北路东方路1号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">350</span><span class=\"token punctuation\">,</span> <span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'希尔顿'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五星级'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'燕莎/朝阳公园商业区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'39.952703'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.462387'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/3fwNbKGhk6XCrkdVyxwhC5uGpLVy_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">395702</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京首都机场希尔顿酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'首都机场3号航站楼三经路1号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">222</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'希尔顿'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'首都机场/新国展地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'40.048969'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.619566'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G6/M00/52/10/Cii-U13ePtuIMRSjAAFZ58NGQrMAAGKMgADZ1QAAVn_167_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">395787</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京海航大厦万豪酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'霄云路甲26号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1302</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'万豪'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'燕莎/朝阳公园商业区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'39.959861'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.467363'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/3zFiWi2C9SmbcQwCZgJFQC9ahvs5_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">395799</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京国际艺苑皇冠假日酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'王府井大街48号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">636</span><span class=\"token punctuation\">,</span> <span class=\"token number\">44</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'皇冠假日'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五星级'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'天安门/王府井地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'39.918994'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.411277'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G6/M00/52/10/Cii-U13ePvyIahjPAAMykV278aEAAGKOQO9e4UAAzKp283_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"81\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">395815</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京明豪华美达酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'天竺镇府前一街13号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">558</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'华美达'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'四钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'首都机场/新国展地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'40.062832'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.580678'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G6/M00/52/13/Cii-U13eP2mIKCwvAAODTZXT-fAAAGKVAA9taIAA4Nl245_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">396189</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京朝阳悠唐皇冠假日酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'三丰北里3号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">944</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'皇冠假日'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'三里屯/工体/东直门地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'39.92129'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.43847'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/tT6ipLain1ZovR5gnQ7tJ4KKym5_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">396471</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'维也纳酒店（北京花园路店）'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'海淀北太平庄花园路甲17号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">381</span><span class=\"token punctuation\">,</span> <span class=\"token number\">36</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'维也纳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'三钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'马甸、安贞地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'39.970837'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.365244'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/filebroker/cdn/res/17/00/1700926908bae6ba3e5ef96de7b7d4cc_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"84\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">396506</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京金隅喜来登酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北三环东路36号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">357</span><span class=\"token punctuation\">,</span> <span class=\"token number\">47</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'喜来登'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五星级'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'马甸/安贞地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'39.967163'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.4099'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/29FW2WtGzzUtPhWR1LKxcFZAVa9P_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">413460</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天连锁酒店(北京天坛店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'东城天坛东里甲48号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">753</span><span class=\"token punctuation\">,</span> <span class=\"token number\">38</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'前门、崇文门商贸区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'39.875786'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.421987'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G2/M00/C7/D8/Cii-T1knCK6IWTtxAAI0plLButMAAKYTAJu-woAAjS-422_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">413476</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天连锁酒店(北京南站店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'丰台马家堡西路22号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">478</span><span class=\"token punctuation\">,</span> <span class=\"token number\">37</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'永定门、南站、大红门、南苑地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'39.845363'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.372327'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G1/M00/26/B7/Cii-U1knCtaISM4VAAHkEQd-mrAAAKw0ALVCwEAAeQp741_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">414168</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天连锁酒店(北京西直门店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'西城平安里西大街翠花街育幼胡同甲20-22号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">419</span><span class=\"token punctuation\">,</span> <span class=\"token number\">37</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'西单、金融街地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'39.931338'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.364982'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m2.tuniucdn.com/filebroker/cdn/res/bc/66/bc666859edf4fc072a8006c66758058d_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">414481</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天连锁酒店(北京团结湖地铁站店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'朝阳团结湖北里9号楼'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">525</span><span class=\"token punctuation\">,</span> <span class=\"token number\">36</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'燕莎、三里屯商业区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'39.928457'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.466132'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G1/M00/38/2D/Cii9EFkv2-uIPTaBAALX6P-rbdUAALPpwHv4ykAAtgA277_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"89\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">414698</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天连锁酒店（北京798艺术区店）'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'朝阳北京市朝阳区酒仙桥北路（798艺术区北门）彩虹路6号-电通创意广场大院内'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">553</span><span class=\"token punctuation\">,</span> <span class=\"token number\">37</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'望京、酒仙桥、798地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'39.990671'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.498452'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G2/M00/D8/11/Cii-T1ku2zqIN7SiAAEdvT6RrjUAAKxZQKFooYAAR3V090_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"90\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">415600</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家酒店(北京朝阳北路传媒大学褡裢坡地铁站店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'三间房乡褡裢坡村青年沟西侧558号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">259</span><span class=\"token punctuation\">,</span> <span class=\"token number\">47</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'传媒大学/管庄地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'39.923212'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.560023'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/3NezpxNZWQMdNXibwbMkQuAZjDyJ_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"91\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">415659</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天连锁酒店（北京紫竹桥店）'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'海淀北洼路甲3号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">781</span><span class=\"token punctuation\">,</span> <span class=\"token number\">42</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'西直门及北京展览馆地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'39.936138'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.302405'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G1/M00/3C/22/Cii9EVkxPMqIZJz-AAIh0esETAIAALXbgNQkH8AAiHp053_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"92\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">416121</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家酒店(北京西客站北广场店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'莲花池东路120-2号6层'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">275</span><span class=\"token punctuation\">,</span> <span class=\"token number\">43</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京西站/丽泽商务区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'39.896449'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.317382'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/42DTRnKbiYoiGFVzrV9ZJUxNbvRo_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"93\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">416260</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天连锁酒店(北京通州八里桥店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'永顺镇西马庄小区'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">534</span><span class=\"token punctuation\">,</span> <span class=\"token number\">38</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'果园环岛、通州区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'39.915443'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.631871'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G2/M00/DF/5A/Cii-TlkxkeGIKM0oAAGOb64RvToAALBAAH9Fg8AAY6H201_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"94\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">416268</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'和颐酒店(北京传媒大学财满街店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'朝阳路高井176号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">524</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'和颐'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'三钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'国贸地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'39.918277'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.53015'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G6/M00/52/13/Cii-TF3eP5GIJIOLAAUwsIVCxdAAAGKXgK5a0IABTDI239_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"95\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">416307</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'速8酒店(北京新国展首都机场后沙峪店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'后沙峪镇裕民大街32号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">350</span><span class=\"token punctuation\">,</span> <span class=\"token number\">39</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'速8'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'首都机场/新国展地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'40.099019'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.543655'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G6/M00/52/3E/Cii-TF3eRgGIHCkKAAP_ATvriiQAAGL0AIoLtUAA_8Z513_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"96\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">432335</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天连锁酒店(上海北外滩国际客运中心地铁站店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'唐山路145号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">249</span><span class=\"token punctuation\">,</span> <span class=\"token number\">35</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北外滩地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.252585'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.498753'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m2.tuniucdn.com/filebroker/cdn/res/c1/ba/c1baf64418437c56617f89840c6411ef_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"97\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">433576</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家酒店(上海南京路步行街店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'南京东路480号保安坊内'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">379</span><span class=\"token punctuation\">,</span> <span class=\"token number\">44</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'人民广场地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.236454'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.480948'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G6/M00/52/BA/Cii-U13eXVaIQmdaAAWxgzdXXxEAAGRrgNIOkoABbGb143_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"98\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">434082</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家酒店·neo(上海外滩城隍庙小南门地铁站店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'复兴东路260号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">392</span><span class=\"token punctuation\">,</span> <span class=\"token number\">44</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'豫园地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.220706'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.498769'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G6/M00/52/B6/Cii-U13eXLGIdHFzAAIG-5cEwDEAAGRfQNNIV0AAgcT627_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"99\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">441836</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家酒店(北京国展三元桥店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'西坝河东里36号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">458</span><span class=\"token punctuation\">,</span> <span class=\"token number\">47</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'国展中心地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'39.966238'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.450142'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G6/M00/52/39/Cii-TF3eRTGITp1UAAYIilRD7skAAGLngIuAnQABgii479_w200_h200_c1_t0.png'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"100\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">485775</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家酒店(上海闵行华东师范大学吴泾店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'吴泾镇宝秀路977号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">161</span><span class=\"token punctuation\">,</span> <span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'交大/闵行经济开发区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.047135'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.46224'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/V8pz15CkiMX5xYJRmbbp5zkKWJ8_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"101\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">489756</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天连锁酒店(北京平谷店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'文化北街4-16号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">544</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'平谷城区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'40.14308'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'117.111554'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m2.tuniucdn.com/filebroker/cdn/res/2e/b4/2eb4edb22ddb981307d8570beb1d746d_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"102\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">517915</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家酒店·neo(深圳草埔地铁站店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'布吉路1036号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">159</span><span class=\"token punctuation\">,</span> <span class=\"token number\">44</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'田贝/水贝珠宝城'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.583191'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'114.118499'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/228vhBCQmFRFWQBYX1cgoFQb6x58_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"103\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">527938</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳好日子皇冠假日酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'福华一路28号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">590</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'皇冠假日'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五星级'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'会展中心/CBD'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.537153'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'114.053529'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/b6Ztz5jn4MngK3Hzfxuu9JGsjrm_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"104\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">541619</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家酒店(上海莘庄地铁站龙之梦商业广场店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'莘庄镇莘浜路172号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">149</span><span class=\"token punctuation\">,</span> <span class=\"token number\">44</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'莘庄工业区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.105797'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.37755'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/3mKs3jETvJDj3dDdkRB9UyLLvPna_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"105\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">542068</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海茂业华美达广场酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'沪南路938号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">646</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'华美达'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'三钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'浦东新国际博览中心'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.182761'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.554106'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/2139uDFUZ2VKxrathwSeeE4DwyFU_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"106\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">546869</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳彭年万丽酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'嘉宾路2002号（毗邻金光华购物广场）'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">701</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'万丽'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'罗湖口岸/火车站'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.540989'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'114.122665'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/gwAbqEXFUpjUBmnxUfK89p3zBBT_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"107\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">581859</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'维也纳酒店（北京丰益桥店）（原申晨酒店）'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'丰台丰管路8号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">648</span><span class=\"token punctuation\">,</span> <span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'维也纳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'三钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京西站、丽泽商务区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'39.857707'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.312482'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m2.tuniucdn.com/filebroker/cdn/res/97/43/97438481b9e79abad429e5c30d7f303f_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"108\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">584697</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天连锁酒店（深圳华强赛格广场店）'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'华强南路3024号赛格苑1栋'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">362</span><span class=\"token punctuation\">,</span> <span class=\"token number\">36</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'华强北商业区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.539831'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'114.087899'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G2/M00/D8/11/Cii-T1ku2zmIcP4sAAEw8iuLXFgAAKxZQH7HVYAATEK972_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"109\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">593228</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天连锁酒店（北京颐和园店）'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'海淀厢红旗路功德寺桥北侧'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">730</span><span class=\"token punctuation\">,</span> <span class=\"token number\">38</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'香山、八大处风景区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'40.003959'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.256718'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m2.tuniucdn.com/filebroker/cdn/res/55/84/55841f502c5a711e66dd5454b64f559b_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"110\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">598591</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海丽昂豪生大酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'金新路99号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">529</span><span class=\"token punctuation\">,</span> <span class=\"token number\">47</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'豪生'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'四钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'浦东金桥地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.252496'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.600085'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/2KfPPyPx9rWyVXif2CUuxv61Nryc_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"111\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">607915</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'汉庭酒店(深圳皇岗店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'滨河大道6033号海滨广场国皇大厦3楼'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">313</span><span class=\"token punctuation\">,</span> <span class=\"token number\">42</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'汉庭'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'皇岗口岸/福田口岸'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.528101'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'114.064221'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/qMyCJVYuW21nsCeEBt8CMfmEhra_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"112\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">608374</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家酒店(上海浦东机场龙东大道合庆店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'东川公路5863号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">160</span><span class=\"token punctuation\">,</span> <span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'浦东机场核心区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.237662'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.718556'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/LUYxGGV4pzjKeN5a69K4deU8JD8_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"113\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">609023</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家酒店·neo(上海外高桥保税区北地铁站店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'花山路1209号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">266</span><span class=\"token punctuation\">,</span> <span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'浦东外高桥地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.351148'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.585606'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/3cJ6KTfms9cfEnME8WRkQQBXBkYm_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"114\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">609372</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'豪派特华美达广场酒店(深圳北站店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'民治街道梅龙路与民旺路交汇处'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">498</span><span class=\"token punctuation\">,</span> <span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'华美达'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'四钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳北站地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.620501'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'114.033874'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/3G5TnUCPbjGYHAVWfvuixw8bs69t_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"115\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">624417</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳君悦酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'宝安南路1881号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">442</span><span class=\"token punctuation\">,</span> <span class=\"token number\">47</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'君悦'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'万象城/京基100'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.537247'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'114.111182'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G6/M00/45/EA/Cii-TF3ZpVmIVDJ9AAXvJftz_AgAAFrrQKbI4oABe89086_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"116\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">628327</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家酒店·neo(深圳罗湖口岸国贸地铁站店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'人民南路2011号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">223</span><span class=\"token punctuation\">,</span> <span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'罗湖口岸/火车站'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.536734'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'114.118336'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/2rKHmQWHYiY8GZA3xBHpFKCLZwZo_w200_h200_c1_t0.png'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"117\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">629023</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'和颐酒店(北京十里河欢乐谷店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'十八里店乡周家庄288号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">390</span><span class=\"token punctuation\">,</span> <span class=\"token number\">47</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'和颐'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'四钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'劲松/潘家园地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'39.853354'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.483437'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/28hnDdqn5uzuzCKYkw2x4pYmunXM_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"118\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">629729</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天连锁酒店(上海张江高科园区店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'浦东新区蔡伦路103号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">267</span><span class=\"token punctuation\">,</span> <span class=\"token number\">36</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'浦东张江地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.196154'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.62071'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m2.tuniucdn.com/filebroker/cdn/res/d9/61/d961508a10865b9b29c033064f31b913_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"119\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">635963</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳龙岗珠江皇冠假日酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'龙岗中心城龙翔大道9009号珠江广场'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">737</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'皇冠假日'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五星级'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'龙岗中心区/大运新城'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.722941'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'114.250002'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G6/M00/45/EA/Cii-U13ZpWGIasKjAAY1SNE36KMAAFrrwMNoAwABjVg973_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"120\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">636080</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳大中华喜来登酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'福华路一号大中华国际交易广场'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1556</span><span class=\"token punctuation\">,</span> <span class=\"token number\">47</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'喜来登'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五星级'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'会展中心/CBD'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.535567'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'114.062005'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/3hQRTmAUW9PegTjxMiEfYwh2HnKp_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"121\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">644417</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海外高桥喜来登酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'自由贸易试验区基隆路28号（二号门内）'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2419</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'喜来登'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'浦东外高桥地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.350989'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.588751'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/1Rrtg9n7PdMEivVDhsehbJBrEre_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"122\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">648219</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海金桥红枫万豪酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'新金桥路15号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">891</span><span class=\"token punctuation\">,</span> <span class=\"token number\">47</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'万豪'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'浦东金桥地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.244061'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.591153'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G6/M00/52/B6/Cii-TF3eXKuIR_a0AAUx-Xd2JLQAAGRfACSpvUABTIR560_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"123\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">657192</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳宝安中天美景华美达酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'新桥街道万丰社区中心路7-1号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">498</span><span class=\"token punctuation\">,</span> <span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'华美达'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'四钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳国际会展中心商圈'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.716473'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'113.826391'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G6/M00/45/EA/Cii-U13ZpVeIRbhTAAOzGZSDtlcAAFrrQEWM-AAA7Mx626_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"124\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">659496</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'维也纳酒店(深圳国王店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'龙华新区龙华龙观西路95号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">714</span><span class=\"token punctuation\">,</span> <span class=\"token number\">37</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'维也纳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'三钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳北站地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.65892'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'114.006817'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m2.tuniucdn.com/filebroker/cdn/res/b4/76/b476cacc575a7ff237128ba2fd63923a_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"125\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">670673</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京龙城华美达酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'昌平路319号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">506</span><span class=\"token punctuation\">,</span> <span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'华美达'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'四钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'回龙观/天通苑地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'40.084219'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.304313'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/T3WruZV3S4MfcxdD1HFVhZjaBLW_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"126\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">672207</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'和颐至尊酒店(北京望京798店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'酒仙桥北路9号荧屏里4号楼'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">579</span><span class=\"token punctuation\">,</span> <span class=\"token number\">44</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'和颐'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'四钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'望京/酒仙桥/798地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'39.98835'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.491217'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/2y56zwK8kd2tBuRUyF7XeJ2ucvWM_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"127\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">684720</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'和颐酒店(深圳罗湖口岸火车地铁站店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'沿河南路1064号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">208</span><span class=\"token punctuation\">,</span> <span class=\"token number\">47</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'和颐'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'四钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'罗湖口岸/火车站'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.533753'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'114.122491'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/2LFgB2iFawKKoGADwzhW6jpCSaJT_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"128\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">696948</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海新园华美达广场酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'漕宝路509号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1290</span><span class=\"token punctuation\">,</span> <span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'华美达'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'四星级'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'光大会展中心/漕河泾地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.163802'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.405618'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G6/M00/52/B6/Cii-TF3eXHuIE57sAAZx8iP6rMIAAGRbgAH09gABnIK621_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"129\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">706343</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'速8酒店（北京西客站北广场店）'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'丰台莲花池东路126号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">268</span><span class=\"token punctuation\">,</span> <span class=\"token number\">39</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'速8'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京西站、丽泽商务区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'39.896623'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.315586'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G2/M00/E3/46/Cii-TlkzMXWIL0sAAAGG8a3YwiwAALJlgG-r5YAAYcJ067_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"130\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">707357</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'维也纳酒店（上海南站光大店）'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'徐汇桂林路46号（钦州南路路口往南100米）'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3288</span><span class=\"token punctuation\">,</span> <span class=\"token number\">36</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'维也纳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'三钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'光大会展中心'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.156297'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.419948'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m2.tuniucdn.com/filebroker/cdn/res/f7/13/f713f8f98d777d8d53aafefb37a79ef6_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"131\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">711837</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'速8酒店（北京立水桥店）'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'朝阳安立路3号1幢3层'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">268</span><span class=\"token punctuation\">,</span> <span class=\"token number\">36</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'速8'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'亚运村、奥体中心地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'40.043717'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.410962'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m2.tuniucdn.com/filebroker/cdn/res/b3/87/b3876eaf16af62521cf6fb474504b8ca_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"132\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">727679</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天连锁酒店(深圳步行街老街地铁站二店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'罗湖区东门中路2216号华佳广场12-14楼（东门天桥东头）'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">742</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'东门商业区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.54585'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'114.122227'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G1/M00/39/99/Cii9EFkwVMKIP_mCAAI3fOHlS1wAALSDAMeO2MAAjeU309_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"133\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">728180</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家酒店(深圳宝安西乡地铁站店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'西乡大道298-7号（富通城二期公交站旁）'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">184</span><span class=\"token punctuation\">,</span> <span class=\"token number\">43</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'宝安体育中心商圈'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.569693'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'113.860186'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/FHdugqgUgYLPMoC4u4rdTbAPrVF_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"134\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">728415</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家酒店·neo(深圳东门步行街晒布地铁站店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'晒布路67号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">152</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'东门商业区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.550183'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'114.120771'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G6/M00/25/57/Cii-U13PFNWISSnQAAEpTtoilsQAAEVWgEvur8AASlm647_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"135\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">728461</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'汉庭酒店(深圳会展中心店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'新洲路世纪工艺品广场307栋'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">258</span><span class=\"token punctuation\">,</span> <span class=\"token number\">44</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'汉庭'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'皇岗口岸/福田口岸'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.518026'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'114.046061'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G6/M00/25/56/Cii-TF3PFKOIPl0JAANm4ge6DdMAAEVTQK2SP8AA2b6365_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"136\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">728604</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家酒店·neo(深圳南山地铁站南山市场店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'南新路顺富街18号化州大厦'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">198</span><span class=\"token punctuation\">,</span> <span class=\"token number\">43</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'科技园'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.525561'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'113.920058'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G6/M00/25/57/Cii-TF3PFLmIDGWiAAPHkaNTuOIAAEVVQBGazAAA8ep611_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"137\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">730454</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天连锁酒店(深圳万象城店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'罗湖区嘉宾路4025号城市天地广场内'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">552</span><span class=\"token punctuation\">,</span> <span class=\"token number\">43</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'罗湖口岸/火车站'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.537078'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'114.113733'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G2/M00/C8/4C/Cii-Tlknhz2IFnYNAAInF2jEK14AAKbcQNB5M8AAicv660_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"138\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">730569</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天连锁酒店(深圳梅林卓越城店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'孖岭地铁口C出口左手边，青年学院对面'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">269</span><span class=\"token punctuation\">,</span> <span class=\"token number\">39</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'莲花山/梅林'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.568701'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'114.068464'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G2/M00/D8/0B/Cii-Tlku2dOISeGXAAAUw3MvPrIAAKxYALB2VAAABTb555_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"139\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">730968</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天连锁酒店(深圳宝安地铁站店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'宝安区宝安25区创业二路步行街金麒麟服装广场4栋'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">314</span><span class=\"token punctuation\">,</span> <span class=\"token number\">36</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'宝安中心区/前海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.568162'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'113.900968'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G2/M00/D8/0B/Cii-T1ku2cqIWTOOAAAS_bvRI5UAAKxXwILCFYAABMV285_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"140\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">751035</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天连锁酒店(上海自贸区北门地铁站店)(原外高桥地铁北站店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'花山路706号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">328</span><span class=\"token punctuation\">,</span> <span class=\"token number\">39</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'浦东外高桥地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.348029'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.576896'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G1/M00/3A/21/Cii-U1kwxUCINXaHAAGmh7z6qRAAALUdwMKGREAAaaf928_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"141\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">844350</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天连锁酒店(深圳世界之窗店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'南山区白石洲沙河街2号金三角大厦'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">769</span><span class=\"token punctuation\">,</span> <span class=\"token number\">36</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'华侨城'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.540501'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'113.968858'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G2/M00/D8/11/Cii-TFku2zmIOdjCAAAQJpLFhEEAAKxZQIEvQ0AABA-920_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"142\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2316304</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家酒店(深圳双龙地铁站店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'龙岗街道龙岗墟社区龙平东路62号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">135</span><span class=\"token punctuation\">,</span> <span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'龙岗中心区/大运新城'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.730828'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'114.278337'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/4AzEoQ44awd1D2g95a6XDtJf3dkw_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"143\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2329005</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'维也纳酒店(深圳华之沙店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'福强路新洲九街28号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">651</span><span class=\"token punctuation\">,</span> <span class=\"token number\">39</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'维也纳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'三钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'皇岗口岸/福田口岸'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.524835'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'114.048214'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m2.tuniucdn.com/filebroker/cdn/res/88/f0/88f05cd11990ef39ae187886c76f40a5_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"144\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2351601</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳蛇口希尔顿南海酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'望海路1177号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">509</span><span class=\"token punctuation\">,</span> <span class=\"token number\">47</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'希尔顿'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳湾口岸/蛇口'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.479373'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'113.916013'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G6/M00/45/EA/Cii-TF3ZpXOIfa6fAAJjiUOiuYgAAFrtgDtgpQAAmOh799_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"145\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2359697</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家酒店(北京上地安宁庄东路店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'清河小营安宁庄东路18号20号楼'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">420</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上地产业园/西三旗'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'40.041322'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.333316'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/2wj2f8mo9WZQCmzm51cwkZ9zvyp8_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"146\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">5865979</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京丽都皇冠假日酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'将台路6号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1168</span><span class=\"token punctuation\">,</span> <span class=\"token number\">47</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'皇冠假日'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'望京/酒仙桥/798地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'39.978133'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.478642'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/Yo4xL3RUsYUnDDc5QcQWj7sCrUX_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"147\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">5870456</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海宝华万豪酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'广中西路333号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">922</span><span class=\"token punctuation\">,</span> <span class=\"token number\">47</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'万豪'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'大宁国际商业区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.279371'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.446327'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G6/M00/52/BA/Cii-U13eXVqIZXDFAAUC_xbrQDAAAGRrwPRyOcABQMX057_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"148\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">5871652</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海圣诺亚皇冠假日酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'金沙江路1699号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">770</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'皇冠假日'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'长风公园地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.232346'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.377709'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/J4sP7qRSHa9rFYnKTW75ZPB393M_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"149\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">5872067</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'崇明金茂凯悦酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'陈家镇揽海路799弄'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1024</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'凯悦'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'崇明岛/长兴岛/横沙岛'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.466563'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.799671'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/fsKrbnNsmSsYnNLmhh3ZvVjZ5cA_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"150\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">5873072</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'速8酒店（上海火车站北广场店）'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'闸北芷江西路796号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">190</span><span class=\"token punctuation\">,</span> <span class=\"token number\">41</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'速8'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海火车站地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.255579'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.452903'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m2.tuniucdn.com/filebroker/cdn/res/96/6d/966d6596e6cb7b48c9cc1d7da79b57c8_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"151\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">7094829</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'汉庭酒店(深圳华强南店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'松岭路9号（南园小学对面）'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">215</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'汉庭'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'华强北商业区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.536842'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'114.094316'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/3WDhaZZ9yALHw8yNiU6HJyrdC3u5_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"152\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">189429168</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天连锁酒店(北京大兴黄村清源路地铁站店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'清源西路55号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">392</span><span class=\"token punctuation\">,</span> <span class=\"token number\">38</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'大兴农业生态观光区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'39.743751'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.321676'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G1/M00/4F/25/Cii9EFk3LmOIFtnDAAHm5kdIiM8AAL1FQM8kG0AAeb-418_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"153\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">197487869</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家酒店(北京第二外国语大学南门双桥地铁站店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'三间房乡新房村1号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">321</span><span class=\"token punctuation\">,</span> <span class=\"token number\">47</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'传媒大学/管庄地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'39.90635'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.565528'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/ZkgDAs8tTMvgFHdVPpikNqENEn1_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"154\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">197488318</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'速8酒店（北京立水桥地铁南站店）'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'朝阳北苑路18号院3号楼4层'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">344</span><span class=\"token punctuation\">,</span> <span class=\"token number\">36</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'速8'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'亚运村、奥体中心地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'40.043689'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.414138'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G1/M00/36/4D/Cii9EVkvP72IYYjgAAF7yZeWV-wAALMQACOARMAAXvh983_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"155\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">197492277</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'速8酒店（北京平谷兴谷环岛店）'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'平谷平谷大街31号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">614</span><span class=\"token punctuation\">,</span> <span class=\"token number\">39</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'速8'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'平谷城区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'40.159255'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'117.12401'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G1/M00/38/D5/Cii9EFkwFCiII79zAAHKsXy_LAoAALQuQEmEZ4AAcrJ339_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"156\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">197492479</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家酒店(北京顺义中心地铁站店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'光明南大街14号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">306</span><span class=\"token punctuation\">,</span> <span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'顺义温泉休闲区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'40.124783'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.65751'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/2hNBSjmMTk6JQ2o8ixr5s3ioevhB_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"157\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">197496182</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'和颐酒店(北京团结湖地铁站店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'团结湖路9号楼'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">341</span><span class=\"token punctuation\">,</span> <span class=\"token number\">44</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'和颐'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'三钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'燕莎/朝阳公园商业区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'39.930731'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.466602'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/2gK41VpMb4AwyNkwQEkfFo83uTUU_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"158\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">197496980</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'速8酒店(北京温都水城王府店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'昌平北七家镇平西府村（温都水城东200米）'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">585</span><span class=\"token punctuation\">,</span> <span class=\"token number\">39</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'速8'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'小汤山温泉度假区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'40.10144'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.380641'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G2/M00/C7/CB/Cii-T1km_5eICnpJAAHOWN1GylMAAKYJwF0Hp8AAc5w000_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"159\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">197516492</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'速8酒店（北京南苑东高地店）'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'丰台南大红门路东营房15号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">651</span><span class=\"token punctuation\">,</span> <span class=\"token number\">39</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'速8'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'永定门、南站、大红门、南苑地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'39.78996'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.42081'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G1/M00/3B/D8/Cii-U1kxKGWIQlaxAAIdkjkSALkAALXDQMFbTsAAh2q158_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"160\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">197835483</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天连锁酒店(深圳大学桃园店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'南山区桃园西路160号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">431</span><span class=\"token punctuation\">,</span> <span class=\"token number\">36</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'科技园'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.532576'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'113.916362'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G1/M00/38/40/Cii9EFkv4XKIQN85AAFUcDrkXe0AALPvwPRn08AAVSI037_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"161\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">197837109</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家酒店·neo(深圳龙岗大道布吉地铁站店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'布吉镇深惠路龙珠商城'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">127</span><span class=\"token punctuation\">,</span> <span class=\"token number\">43</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'布吉/深圳东站'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.602482'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'114.123284'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G6/M00/25/58/Cii-TF3PFZOIA7jwAAKInGFN4xgAAEVbAGeP4AAAoi0485_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"162\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">198323591</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'汉庭酒店(深圳北站龙华汽车站店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'龙华新区建辉路2号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">209</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'汉庭'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳北站地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.671313'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'114.02784'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/2dkB2HzbaBUJ7adZZfZaeS9JCvjP_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"163\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">200208940</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海浦东喜来登由由公寓'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'浦建路38号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3168</span><span class=\"token punctuation\">,</span> <span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'喜来登'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'浦东新国际博览中心'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.208553'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.518552'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/m3Nrm37Yx6YV4NwqRvSYnFRNSGk_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"164\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">200210163</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天连锁酒店(上海徐家汇宜山路地铁站店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'徐汇钦州北路78号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">219</span><span class=\"token punctuation\">,</span> <span class=\"token number\">35</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'光大会展中心'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.180615'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.422916'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G2/M00/DF/96/Cii-Tlkx0TOIGtOzAAEe_xcDxeIAALCZQJyxf4AAR8X941_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"165\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">200214437</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海浦东机场华美达广场酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'浦东机场启航路1100号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">600</span><span class=\"token punctuation\">,</span> <span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'华美达'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'四星级'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'浦东机场核心区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.160969'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.799086'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/2D2gbXDgrMx76uWfwzmoWpmSCCXx_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"166\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">200214538</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海绿地万豪酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'江滨路99号（打浦路底）'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">720</span><span class=\"token punctuation\">,</span> <span class=\"token number\">43</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'万豪'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五星级'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'打浦桥地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.192103'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.47298'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/268jVMuWdYok5ehGFhQ2QNhBhUhs_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"167\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">200214715</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海浦东喜来登由由大酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'浦建路38号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2489</span><span class=\"token punctuation\">,</span> <span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'喜来登'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五星级'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'浦东新国际博览中心'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.208739'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.518305'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/36t2KUGs4h5YgYSaLSkr5pMXLM54_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"168\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">200214824</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天连锁酒店(上海陆家嘴八佰伴店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'崂山路689号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">249</span><span class=\"token punctuation\">,</span> <span class=\"token number\">36</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'浦东陆家嘴金融贸易区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.220656'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.525127'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G1/M00/3D/95/Cii9EVkx0JCIRDFfAAIMnl8npiYAALaawHMG2kAAgy2536_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"169\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">200215226</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海颖奕皇冠假日酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'博园路6555号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">907</span><span class=\"token punctuation\">,</span> <span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'皇冠假日'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'嘉定新城'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.272533'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.19179'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/3Uyfi2aBRETE1K5PChiLVZCwtDLF_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"170\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">200215286</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海万豪虹桥大酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'虹桥路2270号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">910</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'万豪'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五星级'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'虹桥地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.191529'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.375577'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G6/M00/52/B6/Cii-TF3eXK6IBQoRAAbgs1dyxJwAAGRfAPXbPQABuDL314_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"171\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">200215365</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家酒店(上海虹桥漕河泾古北店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'虹梅路2971号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">189</span><span class=\"token punctuation\">,</span> <span class=\"token number\">44</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'虹桥地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.180968'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.392415'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/2WPfVp6auQkYoHzAdSbxwHAtQFfa_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"172\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">200215548</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'速8酒店（上海虹桥枢纽九亭中心路店）'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'松江九亭镇中心路128号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">198</span><span class=\"token punctuation\">,</span> <span class=\"token number\">39</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'速8'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'七宝古镇'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.119363'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.322768'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G1/M00/42/40/Cii-U1kziVOIGTw-AAGRMfcIwJwAALi6ACRnUsAAZFJ536_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"173\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">200216665</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'维也纳酒店（上海奉贤南桥中心店）'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'奉贤沪杭公路1758-8号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1289</span><span class=\"token punctuation\">,</span> <span class=\"token number\">38</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'维也纳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'三钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'奉贤开发区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'30.934646'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.451449'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G2/M00/DC/A8/Cii-T1kw5leIQAA3AAFzNYtL4loAAK9OQOyk4sAAXNN152_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"174\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">219484323</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天连锁酒店(深圳观澜章阁店）'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'宝安区章阁村桂月路章阁市场汇龙峰景一期A栋2-4层'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">725</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'观澜'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.746493'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'114.023'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G1/M00/3C/8C/Cii-U1kxXqaIeqeuAAHwF4GDmOcAALYFQI9zMMAAfAv100_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"175\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">223318960</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'和颐酒店(深圳深南大道华强路地铁站店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深南中路2081号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">637</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'和颐'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'四钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'华强北商业区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.540313'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'114.088611'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/2M7am7D8rPTeTQAhxqBeMSANaqGr_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"176\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">233036941</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天连锁酒店(上海东林寺店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'朱泾镇文商路79号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">218</span><span class=\"token punctuation\">,</span> <span class=\"token number\">37</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'金山枫泾古镇地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'30.895912'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.160238'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G4/M00/35/13/Cii_J1zr5PyIY3acAAFCnHJPxLUAAGX-ABvcIMAAUK0087_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"177\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">234719711</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家酒店·neo(北京朝阳北路十里堡地铁站店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'朝阳北路八里庄南里26号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">378</span><span class=\"token punctuation\">,</span> <span class=\"token number\">47</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'国贸地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'39.922472'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.501118'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/2rHdXNCmycnUxw99AniFC25ZDSfJ_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"178\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">234719728</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'速8酒店（北京房山城关店）'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'房山城关镇城隍庙街10号(原房山老公安局)'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">392</span><span class=\"token punctuation\">,</span> <span class=\"token number\">47</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'速8'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'39.705216'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'115.981904'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G1/M00/3F/66/Cii9EFkyeImIB3ZVAAHcTtTFt4oAALdsgICDO0AAdxm378_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"179\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">235196477</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'和颐酒店(北京总部基地店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'丰葆路106号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">379</span><span class=\"token punctuation\">,</span> <span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'和颐'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'四钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'总部基地/丰台体育中心/南宫地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'39.815383'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.291012'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/3J7Hcvwt5xZJL3NkS4wPJ6csmFb9_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"180\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">339777429</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海嘉定喜来登酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'菊园新区嘉唐公路66号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1286</span><span class=\"token punctuation\">,</span> <span class=\"token number\">44</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'喜来登'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'嘉定新城'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.394595'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.245773'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/2v2fKuo5bzhunSBC1n1E42cLTkZV_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"181\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">339952837</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家酒店(北京良乡西路店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'良乡西路7号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">159</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'房山风景区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'39.73167'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.132482'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/3Dpgf5RTTzrxpeN5y3RLnRVtxMEA_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"182\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">343341695</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'和颐酒店(北京中关村软件园店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'东北旺西路8号中关村软件园一期9号楼'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">245</span><span class=\"token punctuation\">,</span> <span class=\"token number\">47</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'和颐'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'四钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上地产业园/西三旗'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'40.044663'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.29607'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/3hSkPeWRQ3VK1heRQpHzJNMTanQz_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"183\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">365011120</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'和颐酒店(北京石景山万达广场店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'鲁谷东街甲26号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">505</span><span class=\"token punctuation\">,</span> <span class=\"token number\">47</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'和颐'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'四钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'公主坟/五棵松/石景山游乐园地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'39.895479'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.240386'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/3iwohdQzyZP9azUkYAwTFj7WzBwd_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"184\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">368343863</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家酒店(上海金桥博兴路地铁站店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'博兴路1119号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">218</span><span class=\"token punctuation\">,</span> <span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'浦东金桥地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.266272'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.593829'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/w5ERtGJEmdgdgy5qtLPatR1xfm4_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"185\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">368701368</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳大中华希尔顿酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'福田深南大道1003号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1666</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'希尔顿'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'会展中心/CBD'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.539313'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'114.069763'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/4EnHseZ73LXdFJY7DSdJ8xqAcjXe_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"186\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1393017952</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'汉庭酒店(深圳宝安松岗地铁站店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'松岗镇河滨北路12号盛华大厦'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">166</span><span class=\"token punctuation\">,</span> <span class=\"token number\">47</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'汉庭'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'松岗商业中心区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.768912'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'113.83325'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/4NehRjdHyZDKxTjAxTYv27FHq8LJ_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"187\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1400304687</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家酒店(深圳横岗地铁站新马商贸城店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'龙岗大道横岗段4004号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">149</span><span class=\"token punctuation\">,</span> <span class=\"token number\">43</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'龙岗中心区/大运新城'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.642629'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'114.202799'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G6/M00/25/5A/Cii-TF3PFkiIb27dAAEqdDcKl3YAAEViQGVWY0AASqM960_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"188\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1406627919</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳中洲万豪酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'海德一道88号中洲控股中心A座'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">204</span><span class=\"token punctuation\">,</span> <span class=\"token number\">47</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'万豪'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'海岸城/后海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.517293'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'113.933785'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/3wsinQAcuWtCdmv1yxauVG2PSYpC_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"189\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1418471719</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海宝龙丽笙酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'金海路2449弄2号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">860</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'丽笙'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'浦东金桥地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.26571'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.650132'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/3myGUurFCriEVMGPy9yYMPFdb9Zh_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"190\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1455383931</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家酒店(深圳宝安客运中心站店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'西乡河西金雅新苑34栋'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">169</span><span class=\"token punctuation\">,</span> <span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'宝安商业区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.590272'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'113.881933'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/2w9cbbpzjjsyd2wRhFrnUpBMT8b4_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"191\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1457521002</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天连锁酒店(深圳西丽茶光地铁站店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'珠光北路280号天下湘军1楼'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">517</span><span class=\"token punctuation\">,</span> <span class=\"token number\">39</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'大学城/西丽动物园'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.576187'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'113.956166'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G2/M00/E3/E0/Cii-Tlkzdl6IfQYfAAHCgNVDe1sAALK6gPBDhQAAcKY242_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"192\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1463484295</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海和平豪生酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'沪南公路2653-2号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">650</span><span class=\"token punctuation\">,</span> <span class=\"token number\">41</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'豪生'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'四钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'周浦康桥地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.146478'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.568218'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/ZxM9gWHqj657ndRsHw4j4p3CQ5k_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"193\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1514269829</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家酒店(上海东川路碧江商业广场店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'东川路2645号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">218</span><span class=\"token punctuation\">,</span> <span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'交大/闵行经济开发区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.008875'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.402813'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/R92UunuCRXiG826G9Ptu7orqs7b_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"194\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1557882030</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'维也纳酒店（深圳东门老街店）'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'罗湖区东门新园路37号益德楼'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">336</span><span class=\"token punctuation\">,</span> <span class=\"token number\">43</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'维也纳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'三钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'东门商业区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.549413'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'114.118866'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G1/M00/45/83/Cii9EFk0opCIPl9CAAKHl3Egm6oAALoKwLNWlwAAoev470_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"195\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1557997004</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海五角场凯悦酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'国定东路88号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1104</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'凯悦'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'江湾/五角场商业区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.300645'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.51918'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/3a3Zz9cDgbJEEJ1GcXzKhTh21YqK_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"196\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1565094427</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海国际旅游度假区万怡酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'秀浦路3999弄17号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">713</span><span class=\"token punctuation\">,</span> <span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'万怡'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'四钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'迪士尼度假区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.132913'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.63464'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/KPBUPunPDETYWg8WaJDSmiZC65z_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"197\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1584362548</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家酒店(上海浦东国际旅游度假区御桥地铁站店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'御青路315-317号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">339</span><span class=\"token punctuation\">,</span> <span class=\"token number\">44</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'周浦康桥地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.15719'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.572392'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/2ybd3wqdoBtBeKcPxmyso9y1hNXa_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"198\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1630005459</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天连锁酒店（深圳地王大厦红桂路店）（原红桂路店）'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'罗湖区宝安南路2078号深港豪苑（与红桂路交汇处）'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">143</span><span class=\"token punctuation\">,</span> <span class=\"token number\">39</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7天酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.550341'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'114.10965'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G2/M00/EA/18/Cii-T1k1KaGIIkQVAAD4fD_T3FcAALTtABiCJ8AAPiU164_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"199\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1637944903</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'速8酒店北京后海店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'西城北京市西城区德胜门内大街兴华胡同五福里2号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">213</span><span class=\"token punctuation\">,</span> <span class=\"token number\">39</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'速8'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'后海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'39.934452'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.38184'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G1/M00/48/0C/Cii9EVk1JNuILdBWAAHv5O89TjMAALrFgJ8bwcAAe_8197_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"200\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1649956165</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海南青华美达酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'华夏东路811号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">299</span><span class=\"token punctuation\">,</span> <span class=\"token number\">47</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'华美达'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'四钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'迪士尼度假区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.195206'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.664791'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/2RHmQgTpte3UVSDJ5KbqobbZGRnE_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"201\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1714520967</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'速8酒店(北京安华桥黄寺大街店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'黄寺大街12号院16号楼'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">559</span><span class=\"token punctuation\">,</span> <span class=\"token number\">43</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'速8'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'马甸、安贞地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'39.962742'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.388431'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G1/M00/4A/21/Cii-U1k1o-uIdcUZAAIbmIKVlKAAALtvQGBb6kAAhuw170_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"202\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1725781423</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海三迪华美达酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'广富林路600弄7号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">690</span><span class=\"token punctuation\">,</span> <span class=\"token number\">43</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'华美达'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'四钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'佘山/松江大学城'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.058023'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.246536'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/NoHym6tuKwVazxy33wRNTNuQWd2_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"203\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1734220581</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'汉庭酒店(深圳大鹏佳兆业店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'大鹏街道新园街12号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">378</span><span class=\"token punctuation\">,</span> <span class=\"token number\">43</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'汉庭'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'较场尾/大鹏所城'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.592661'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'114.475167'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/3nWzyWt63gtwPzRf5xbHvwKM27vU_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"204\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1754929048</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海环球港凯悦酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'宁夏路718号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1336</span><span class=\"token punctuation\">,</span> <span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'凯悦'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'中山公园商业区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.232041'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.412492'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G6/M00/45/B6/Cii-U13ZY-CIF-8MAAXkwQoY7FIAAFpQgEE1bgABeTZ750_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"205\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1762661667</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳佳兆业万豪酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'棕榈大道33号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">223</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'万豪'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'较场尾/大鹏所城'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.569193'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'114.459325'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G6/M00/45/EC/Cii-TF3ZqE-IYM0NAAY6GIHLZNsAAFr2QDhR8EABjow444_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"206\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1765008760</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家酒店(北京西直门北京北站店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'西直门北大街49号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">356</span><span class=\"token punctuation\">,</span> <span class=\"token number\">44</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'西直门/北京展览馆地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'39.945106'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.353827'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/4CLwbCE9346jYn7nFsJTQXuBExTJ_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"207\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1880614409</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海崇明由由喜来登酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'揽海路2888号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2198</span><span class=\"token punctuation\">,</span> <span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'喜来登'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'崇明岛/长兴岛/横沙岛'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.462167'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.823103'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/21gDCGgRT3xFqCd3FxBh633j6Qsu_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"208\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1889333146</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家酒店(北京西客站丽泽桥店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'西三环南路44号-218'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">459</span><span class=\"token punctuation\">,</span> <span class=\"token number\">47</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京西站/丽泽商务区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'39.869638'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.313075'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/kG5corYUDC7U1qE8RAY6xCVnGxq_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"209\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1908594080</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海建工浦江皇冠假日酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'陈行公路3701号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">843</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'皇冠假日'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'浦江镇地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.090063'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.489728'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G6/M00/45/B7/Cii-U13ZZDWIePrGAAPyImW93N0AAFpRgMmj4MAA_I6005_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"210\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1913922369</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海中建万怡酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'蟠文路333号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">889</span><span class=\"token punctuation\">,</span> <span class=\"token number\">47</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'万怡'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'四钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'虹桥机场/国家会展中心'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.185504'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.287709'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/39Afm5Bxgd784eMeFB5DrcsPnhT_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"211\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1916002015</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海苏宁环球万怡酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'丹巴路99号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">689</span><span class=\"token punctuation\">,</span> <span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'万怡'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'四钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'长风公园地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.22292'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.379912'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/svpYHdmVDck91NqAhjtngcXth2G_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"212\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1928731731</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海康桥万豪酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'康新公路4499号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">811</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'万豪'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'迪士尼度假区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.119187'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.618966'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/3inpPxTnvRjMCEB39K9FuHaXohYw_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"213\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1931442052</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳机场凯悦酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'宝安国际机场地面交通中心（GTC）18号出口'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">291</span><span class=\"token punctuation\">,</span> <span class=\"token number\">47</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'凯悦'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'宝安机场商圈'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.622498'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'113.812341'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G6/M00/45/EC/Cii-TF3ZqVeIJcTPAAUq_Ou_CrcAAFr4gKufPUABSsU446_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"214\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1931602865</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳联投东方万怡酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'松岗东方大道46号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">688</span><span class=\"token punctuation\">,</span> <span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'万怡'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'松岗商业中心区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.760746'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'113.856961'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G6/M00/45/EC/Cii-U13ZqVyIOjdpAARI9aeBh-IAAFr4gOQh7oABEkN297_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"215\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1937347815</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京望京凯悦酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'广顺南大街8号院2号楼'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">617</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'凯悦'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'望京/酒仙桥/798地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'39.991546'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.476288'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/2gLT4ZgJ8ZuS7sSmXzYoCXnV248p_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"216\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1942938880</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京乐多港万豪酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'城南街道南口路29号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">227</span><span class=\"token punctuation\">,</span> <span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'万豪'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'昌平城区/十三陵度假区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'40.23264'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.188888'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/3mBWaZeaqq54E7kX2n7g9b2CZX6q_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"217\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1942992995</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海嘉定凯悦酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'裕民南路1366号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">758</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'凯悦'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'嘉定新城'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.352298'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.263314'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G6/M00/53/2D/Cii-U13edkqIfZhLAAJEW25WIF4AAGVxQIg38sAAkRz517_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"218\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1951709780</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳同泰万怡酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'福海街道宝安大道 6259号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">617</span><span class=\"token punctuation\">,</span> <span class=\"token number\">48</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'万怡'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳国际会展中心商圈'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.678611'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'113.805695'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/3oUfktphxMAWq9hUxD9uqdjRdZGB_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"219\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1973839294</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳湾万怡酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'科技南路16号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">508</span><span class=\"token punctuation\">,</span> <span class=\"token number\">47</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'万怡'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'科技园'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.531101'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'113.950615'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/8C9QscRsvTWCx92wt17GAegEMFn_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"220\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1975922994</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家酒店·neo(深圳南山海岸城南油地铁站店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'南商路84-6号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">238</span><span class=\"token punctuation\">,</span> <span class=\"token number\">44</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'如家'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'海岸城/后海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.513566'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'113.9291'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G6/M00/25/5E/Cii-TF3PGD-IQ0FcAAFIZC82AnkAAEVvAKdj4YAAUh8638_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"221\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1989806195</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳博林天瑞喜来登酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'留仙大道4088号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1369</span><span class=\"token punctuation\">,</span> <span class=\"token number\">48</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'喜来登'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'大学城/西丽动物园'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.582918'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'113.97219'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/4Rx55fZoneUeKbE3TCRSPB6WQ6bw_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"222\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1996823660</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海紫竹万怡酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'紫星路588号3幢'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">642</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'万怡'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'四钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'交大/闵行经济开发区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.02118'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.465186'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G6/M00/53/2F/Cii-TF3edraIPzK9AAH_p8vdHKoAAGV3AJgSVEAAf-_019_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"223\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1997830708</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'和颐至尚酒店(北京上地软件园店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'清河小营西路48号汇苑仁和大厦一层'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">753</span><span class=\"token punctuation\">,</span> <span class=\"token number\">47</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'和颐'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'四钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上地产业园/西三旗'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'40.034623'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.323925'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/2sKjxS1hFYyBFVKVBqo2x2hSFvGj_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"224\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2003479905</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海榕港万怡酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'新松江路1277号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">798</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'万怡'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'四钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'佘山/松江大学城'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.038198'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.210178'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/2GM761BYH8k15qkNrJrja3cwfr2D_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"225\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2009548883</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'和颐至尚酒店(北京首都机场新国展店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'府前二街6号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">611</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'和颐'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'三钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'首都机场/新国展地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'40.063953'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.576829'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/43zCTomkMSkUfZByZxn77YH2XidJ_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"226\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2011785622</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京世园凯悦酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'阜康南路1号院1号楼A'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">558</span><span class=\"token punctuation\">,</span> <span class=\"token number\">47</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'凯悦'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五星级'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'延庆休闲度假区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'40.440732'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'115.963259'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/uhGcQze3zZQxe4avSU8BysgYVvx_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"227\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2022598930</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海宝华喜来登酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'南奉公路3111弄228号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2899</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'喜来登'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'奉贤开发区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'30.921659'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.575572'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb2/t1/G6/M00/45/BD/Cii-TF3ZaBmIStrbAASnoOyg7FoAAFpYwEoz9oABKe4992_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"228\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2022881967</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳盐田凯悦酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'海景二路1025号1-6层、30-50层'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">650</span><span class=\"token punctuation\">,</span> <span class=\"token number\">47</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'凯悦'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'盐田区政府/沙头角'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.551323'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'114.23781'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/2RFMLSujkczEn1HoybD6dUpN9pzr_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"229\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2031683181</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'和颐至尚酒店(北京雍和宫和平里店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'小黄庄1区15号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">299</span><span class=\"token punctuation\">,</span> <span class=\"token number\">47</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'和颐'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'四钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'马甸/安贞地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'39.962361'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.412931'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/4Xqm5BN9pZTamwmYS3eLxL417YYt_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"230\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2045052822</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳国际会展中心皇冠假日酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'展云路6号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">675</span><span class=\"token punctuation\">,</span> <span class=\"token number\">47</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'皇冠假日'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳国际会展中心商圈'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.686581'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'113.777655'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/4DGZygQpE4iSpcBDCoXJvjNr4oiR_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"231\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2048042240</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京大兴希尔顿酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'高米店南里18号楼'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1283</span><span class=\"token punctuation\">,</span> <span class=\"token number\">48</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'希尔顿'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'大兴北京新机场地区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'39.76875'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.339199'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/3B32F8zSU2CJCWzs1hoH2o4WcquR_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"232\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2048047291</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京新青海喜来登酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'丽泽金融商务区凤凰嘴北路与金中都西路交叉口西营街8号院1号楼'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">723</span><span class=\"token punctuation\">,</span> <span class=\"token number\">47</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'喜来登'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京西站/丽泽商务区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'39.864026'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.322505'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/4DPQMu5sMM7XR1mvcjoqtWngc7TF_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"233\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2048050570</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'汉庭酒店（深圳坪山火车站店）'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'新和路127-2号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">436</span><span class=\"token punctuation\">,</span> <span class=\"token number\">47</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'汉庭'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'坪山高铁站商圈'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.700753'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'114.339089'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/2nXN2bWjfoqoTkPwHvLJQPYz17qD_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"234\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2048671293</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'汉庭酒店(深圳观澜五和大道店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'观湖街道五和大道327号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">234</span><span class=\"token punctuation\">,</span> <span class=\"token number\">43</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'汉庭'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'观澜'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.684459'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'114.07708'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/2JrQi83S9qgDEkXqWpe5iyi44Uh2_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"235\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2051661320</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'汉庭酒店(深圳罗湖口岸万象城二店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'桂园街道宝安南路1050号嘉宾花园C栋'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">667</span><span class=\"token punctuation\">,</span> <span class=\"token number\">47</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'汉庭'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'三钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'万象城/京基100'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.540352'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'114.112668'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/34FRP7HLPhvKZP1a6tXu4XrJeiaw_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"236\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2056105938</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京通州北投希尔顿酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'新华东街289号2号楼'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1068</span><span class=\"token punctuation\">,</span> <span class=\"token number\">48</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'希尔顿'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'果园环岛/通州区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'39.908805'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'116.659748'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/NGKdpec3tZJNUUNWJ5pd67Cp5AY_w200_h200_c1_t0.png'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"237\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2056126831</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海虹桥金臣皇冠假日酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'申长路630弄1-3 号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2488</span><span class=\"token punctuation\">,</span> <span class=\"token number\">48</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'皇冠假日'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'虹桥机场/国家会展中心'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.19036'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.31535'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/PvFh4Vzc84xXhm5N41F6AqdAqyJ_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"238\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2056132395</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳深铁皇冠假日酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深南大道9819号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">340</span><span class=\"token punctuation\">,</span> <span class=\"token number\">47</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'皇冠假日'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'科技园'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.538923'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'113.944794'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/eBLtrED2uJs7yURWfjnWge9dT1P_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"239\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2056298828</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海中优城市万豪酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'沪南公路7688弄1号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1200</span><span class=\"token punctuation\">,</span> <span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'万豪'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'上海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'南汇/野生动物园'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'31.030053'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'121.662943'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/2gBATEyysyQWmw3wZL863HGdqjaq_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"240\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2058250574</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳湾万丽酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'粤海街道高新区社区科技南路18号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">351</span><span class=\"token punctuation\">,</span> <span class=\"token number\">47</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'万丽'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'科技园'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.531674'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'113.951882'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/2YWUpZsvPVkRiKgdPg95LJxaFmB6_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"241\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2060510277</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京金隅八达岭皇冠假日酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'妫水北街1号1-14幢'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1026</span><span class=\"token punctuation\">,</span> <span class=\"token number\">44</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'皇冠假日'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'北京'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'延庆休闲度假区'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'40.476483'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'115.97481'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/3Dzq2KxgiQbmb1sbc5iK6xqpVuFr_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"242\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2060618247</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'汉庭酒店(深圳海岸城店)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'粤海街道后海社区后海第二统建楼商业裙楼第二层B'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">562</span><span class=\"token punctuation\">,</span> <span class=\"token number\">49</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'汉庭'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'二钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'海岸城/后海'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.507276'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'113.931251'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/TBoXdgEx5Yjc2HobeC3fPWWnSJi_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"243\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tb_hotel<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2062643512</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳国际会展中心希尔顿酒店'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'展丰路80号'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">285</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'希尔顿'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'五钻'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'深圳国际会展中心商圈'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22.705335'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'113.77794'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://m.tuniucdn.com/fb3/s1/2n9c/2SHUVXNrN5NsXsTUwcd1yaHKbrGq_w200_h200_c1_t0.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"244\"></td><td><pre></pre></td></tr><tr><td data-num=\"245\"></td><td><pre><span class=\"token keyword\">SET</span> FOREIGN_KEY_CHECKS <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure>",
            "tags": [
                "计算机学科",
                "案例Demo",
                "springcloud",
                "Elasticsearch"
            ]
        },
        {
            "id": "https://pigpigletsgo.github.io/homepage/2024/04/02/computer-science/java/spring/springcloud/Elasticsearch/%E5%AE%89%E8%A3%85elasticsearch/",
            "url": "https://pigpigletsgo.github.io/homepage/2024/04/02/computer-science/java/spring/springcloud/Elasticsearch/%E5%AE%89%E8%A3%85elasticsearch/",
            "title": "安装elasticsearch",
            "date_published": "2024-04-02T10:00:51.019Z",
            "content_html": "<h1 id=\"安装elasticsearch\"><a class=\"markdownIt-Anchor\" href=\"#安装elasticsearch\">#</a> 安装 elasticsearch</h1>\n<h1 id=\"1部署单点es\"><a class=\"markdownIt-Anchor\" href=\"#1部署单点es\">#</a> 1. 部署单点 es</h1>\n<h2 id=\"11创建网络\"><a class=\"markdownIt-Anchor\" href=\"#11创建网络\">#</a> 1.1. 创建网络</h2>\n<p>因为我们还需要部署 kibana 容器，因此需要让 es 和 kibana 容器互联。这里先创建一个网络：</p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> network create es-net</pre></td></tr></table></figure><h2 id=\"12加载镜像\"><a class=\"markdownIt-Anchor\" href=\"#12加载镜像\">#</a> 1.2. 加载镜像</h2>\n<p>这里我们采用 elasticsearch 的 7.12.1 版本的镜像，这个镜像体积非常大，接近 1G。不建议大家自己 pull。</p>\n<p>课前资料提供了镜像的 tar 包：</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310112020462.png\" alt=\"image-20210510165308064\"></p>\n<p>大家将其上传到虚拟机中，然后运行命令加载即可：</p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 导入数据</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">docker</span> load <span class=\"token parameter variable\">-i</span> es.tar</pre></td></tr></table></figure><p>同理还有 <code>kibana</code>  的 tar 包也需要这样做。</p>\n<h2 id=\"13运行\"><a class=\"markdownIt-Anchor\" href=\"#13运行\">#</a> 1.3. 运行</h2>\n<p>运行 docker 命令，部署单点 es：</p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> run <span class=\"token parameter variable\">-d</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\t<span class=\"token parameter variable\">--name</span> es <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token parameter variable\">-e</span> <span class=\"token string\">\"ES_JAVA_OPTS=-Xms512m -Xmx512m\"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token parameter variable\">-e</span> <span class=\"token string\">\"discovery.type=single-node\"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token parameter variable\">-v</span> es-data:/usr/share/elasticsearch/data <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token parameter variable\">-v</span> es-plugins:/usr/share/elasticsearch/plugins <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token parameter variable\">--privileged</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token parameter variable\">--network</span> es-net <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token parameter variable\">-p</span> <span class=\"token number\">9200</span>:9200 <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token parameter variable\">-p</span> <span class=\"token number\">9300</span>:9300 <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>elasticsearch:7.12.1</pre></td></tr></table></figure><p>命令解释：</p>\n<ul>\n<li><code>-e &quot;cluster.name=es-docker-cluster&quot;</code> ：设置集群名称</li>\n<li><code>-e &quot;http.host=0.0.0.0&quot;</code> ：监听的地址，可以外网访问</li>\n<li><code>-e &quot;ES_JAVA_OPTS=-Xms512m -Xmx512m&quot;</code> ：内存大小</li>\n<li><code>-e &quot;discovery.type=single-node&quot;</code> ：非集群模式</li>\n<li><code>-v es-data:/usr/share/elasticsearch/data</code> ：挂载逻辑卷，绑定 es 的数据目录</li>\n<li><code>-v es-logs:/usr/share/elasticsearch/logs</code> ：挂载逻辑卷，绑定 es 的日志目录</li>\n<li><code>-v es-plugins:/usr/share/elasticsearch/plugins</code> ：挂载逻辑卷，绑定 es 的插件目录</li>\n<li><code>--privileged</code> ：授予逻辑卷访问权</li>\n<li><code>--network es-net</code>  ：加入一个名为 es-net 的网络中</li>\n<li><code>-p 9200:9200</code> ：端口映射配置</li>\n</ul>\n<p>在浏览器中输入：<a href=\"http://192.168.150.101:9200\">http://192.168.150.101:9200</a> 即可看到 elasticsearch 的响应结果：</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310112020815.png\" alt=\"image-20210506101053676\"></p>\n<h1 id=\"2部署kibana\"><a class=\"markdownIt-Anchor\" href=\"#2部署kibana\">#</a> 2. 部署 kibana</h1>\n<p>kibana 可以给我们提供一个 elasticsearch 的可视化界面，便于我们学习。</p>\n<h2 id=\"21部署\"><a class=\"markdownIt-Anchor\" href=\"#21部署\">#</a> 2.1. 部署</h2>\n<p>运行 docker 命令，部署 kibana</p>\n<p>kibana 需要和 elaticsearch 处于同一个网络中</p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> run <span class=\"token parameter variable\">-d</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token parameter variable\">--name</span> kibana <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># 因为它们两个为同一个网络，所以可以使用容器名互联</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token parameter variable\">-e</span> <span class=\"token assign-left variable\">ELASTICSEARCH_HOSTS</span><span class=\"token operator\">=</span>http://es:9200 <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token parameter variable\">--network</span><span class=\"token operator\">=</span>es-net <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token parameter variable\">-p</span> <span class=\"token number\">5601</span>:5601  <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>kibana:7.12.1</pre></td></tr></table></figure><ul>\n<li><code>--network es-net</code>  ：加入一个名为 es-net 的网络中，与 elasticsearch 在同一个网络中</li>\n<li><code>-e ELASTICSEARCH_HOSTS=http://es:9200&quot;</code> ：设置 elasticsearch 的地址，因为 kibana 已经与 elasticsearch 在一个网络，因此可以用容器名直接访问 elasticsearch</li>\n<li><code>-p 5601:5601</code> ：端口映射配置</li>\n</ul>\n<p>kibana 启动一般比较慢，需要多等待一会，可以通过命令：</p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> logs <span class=\"token parameter variable\">-f</span> kibana</pre></td></tr></table></figure><p>查看运行日志，当查看到下面的日志，说明成功：</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310112020301.png\" alt=\"image-20210109105135812\"></p>\n<p>此时，在浏览器输入地址访问：<a href=\"http://192.168.150.101:5601\">http://192.168.150.101:5601</a>，即可看到结果</p>\n<h2 id=\"22devtools\"><a class=\"markdownIt-Anchor\" href=\"#22devtools\">#</a> 2.2.DevTools</h2>\n<p>kibana 中提供了一个 DevTools 界面：</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310112020356.png\" alt=\"image-20210506102630393\"></p>\n<p>这个界面中可以编写 DSL 来操作 elasticsearch。并且对 DSL 语句有自动补全功能。</p>\n<h1 id=\"3安装ik分词器\"><a class=\"markdownIt-Anchor\" href=\"#3安装ik分词器\">#</a> 3. 安装 IK 分词器</h1>\n<h2 id=\"31在线安装ik插件较慢\"><a class=\"markdownIt-Anchor\" href=\"#31在线安装ik插件较慢\">#</a> 3.1. 在线安装 ik 插件（较慢）</h2>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 进入容器内部</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">docker</span> <span class=\"token builtin class-name\">exec</span> <span class=\"token parameter variable\">-it</span> elasticsearch /bin/bash</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># 在线下载并安装</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>./bin/elasticsearch-plugin  <span class=\"token function\">install</span> https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v7.12.1/elasticsearch-analysis-ik-7.12.1.zip</pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\">#退出</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token builtin class-name\">exit</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\">#重启容器</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token function\">docker</span> restart elasticsearch</pre></td></tr></table></figure><h2 id=\"32离线安装ik插件推荐\"><a class=\"markdownIt-Anchor\" href=\"#32离线安装ik插件推荐\">#</a> 3.2. 离线安装 ik 插件（推荐）</h2>\n<h3 id=\"1查看数据卷目录\"><a class=\"markdownIt-Anchor\" href=\"#1查看数据卷目录\">#</a> 1）查看数据卷目录</h3>\n<p>安装插件需要知道 elasticsearch 的 plugins 目录位置，而我们用了数据卷挂载，因此需要查看 elasticsearch 的数据卷目录，通过下面命令查看:</p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> volume inspect es-plugins</pre></td></tr></table></figure><p>显示结果：</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token property\">\"CreatedAt\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"2022-05-06T10:06:34+08:00\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token property\">\"Driver\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"local\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token property\">\"Labels\"</span><span class=\"token operator\">:</span> <span class=\"token null keyword\">null</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token property\">\"Mountpoint\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/var/lib/docker/volumes/es-plugins/_data\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token property\">\"Name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"es-plugins\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token property\">\"Options\"</span><span class=\"token operator\">:</span> <span class=\"token null keyword\">null</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token property\">\"Scope\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"local\"</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">]</span></pre></td></tr></table></figure><p>说明 plugins 目录被挂载到了： <code>/var/lib/docker/volumes/es-plugins/_data </code> 这个目录中。</p>\n<h3 id=\"2解压缩分词器安装包\"><a class=\"markdownIt-Anchor\" href=\"#2解压缩分词器安装包\">#</a> 2）解压缩分词器安装包</h3>\n<p>下面我们需要把课前资料中的 ik 分词器解压缩，重命名为 ik</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310112020922.png\" alt=\"image-20210506110249144\"></p>\n<h3 id=\"3上传到es容器的插件数据卷中\"><a class=\"markdownIt-Anchor\" href=\"#3上传到es容器的插件数据卷中\">#</a> 3）上传到 es 容器的插件数据卷中</h3>\n<p>也就是 <code>/var/lib/docker/volumes/es-plugins/_data </code> ：</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310112020853.png\" alt=\"image-20210506110704293\"></p>\n<h3 id=\"4重启容器\"><a class=\"markdownIt-Anchor\" href=\"#4重启容器\">#</a> 4）重启容器</h3>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 4、重启容器</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">docker</span> restart es</pre></td></tr></table></figure><figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 查看 es 日志</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">docker</span> logs <span class=\"token parameter variable\">-f</span> es</pre></td></tr></table></figure><p>看到这条信息说明安装成功了</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310112200825.png\" alt=\"image-20231011220033681\"></p>\n<h3 id=\"5测试\"><a class=\"markdownIt-Anchor\" href=\"#5测试\">#</a> 5）测试：</h3>\n<p>IK 分词器包含两种模式：</p>\n<ul>\n<li>\n<p><code>ik_smart</code> ：最少切分</p>\n<ul>\n<li>可以搜索到的词的范围比较小</li>\n</ul>\n</li>\n<li>\n<p><code>ik_max_word</code> ：最细切分</p>\n<ul>\n<li>可以搜索到的词的范围比较大</li>\n</ul>\n</li>\n</ul>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>GET /_analyze</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token property\">\"analyzer\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ik_max_word\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token property\">\"text\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"黑马程序员学习java太棒了\"</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>结果：</p>\n<p>ik_smart</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token property\">\"tokens\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>      <span class=\"token property\">\"token\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"黑马\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>      <span class=\"token property\">\"start_offset\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>      <span class=\"token property\">\"end_offset\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>      <span class=\"token property\">\"type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"CN_WORD\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>      <span class=\"token property\">\"position\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token property\">\"token\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"程序员\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      <span class=\"token property\">\"start_offset\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>      <span class=\"token property\">\"end_offset\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>      <span class=\"token property\">\"type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"CN_WORD\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>      <span class=\"token property\">\"position\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>      <span class=\"token property\">\"token\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"学习\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>      <span class=\"token property\">\"start_offset\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>      <span class=\"token property\">\"end_offset\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>      <span class=\"token property\">\"type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"CN_WORD\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>      <span class=\"token property\">\"position\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>      <span class=\"token property\">\"token\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"java\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>      <span class=\"token property\">\"start_offset\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>      <span class=\"token property\">\"end_offset\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>      <span class=\"token property\">\"type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"ENGLISH\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>      <span class=\"token property\">\"position\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>      <span class=\"token property\">\"token\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"太棒了\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>      <span class=\"token property\">\"start_offset\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>      <span class=\"token property\">\"end_offset\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>      <span class=\"token property\">\"type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"CN_WORD\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>      <span class=\"token property\">\"position\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">4</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>  <span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>ik_max_word</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token property\">\"tokens\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>      <span class=\"token property\">\"token\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"黑马\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>      <span class=\"token property\">\"start_offset\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>      <span class=\"token property\">\"end_offset\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>      <span class=\"token property\">\"type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"CN_WORD\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>      <span class=\"token property\">\"position\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token property\">\"token\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"程序员\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      <span class=\"token property\">\"start_offset\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>      <span class=\"token property\">\"end_offset\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>      <span class=\"token property\">\"type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"CN_WORD\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>      <span class=\"token property\">\"position\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>      <span class=\"token property\">\"token\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"程序\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>      <span class=\"token property\">\"start_offset\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>      <span class=\"token property\">\"end_offset\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>      <span class=\"token property\">\"type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"CN_WORD\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>      <span class=\"token property\">\"position\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>      <span class=\"token property\">\"token\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"员\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>      <span class=\"token property\">\"start_offset\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>      <span class=\"token property\">\"end_offset\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>      <span class=\"token property\">\"type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"CN_CHAR\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>      <span class=\"token property\">\"position\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>      <span class=\"token property\">\"token\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"学习\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>      <span class=\"token property\">\"start_offset\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>      <span class=\"token property\">\"end_offset\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>      <span class=\"token property\">\"type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"CN_WORD\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>      <span class=\"token property\">\"position\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">4</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>      <span class=\"token property\">\"token\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"java\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>      <span class=\"token property\">\"start_offset\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>      <span class=\"token property\">\"end_offset\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>      <span class=\"token property\">\"type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"ENGLISH\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>      <span class=\"token property\">\"position\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">5</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>      <span class=\"token property\">\"token\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"太棒了\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>      <span class=\"token property\">\"start_offset\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>      <span class=\"token property\">\"end_offset\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>      <span class=\"token property\">\"type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"CN_WORD\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>      <span class=\"token property\">\"position\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">6</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>      <span class=\"token property\">\"token\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"太棒\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>      <span class=\"token property\">\"start_offset\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>      <span class=\"token property\">\"end_offset\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>      <span class=\"token property\">\"type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"CN_WORD\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>      <span class=\"token property\">\"position\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">7</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>      <span class=\"token property\">\"token\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"了\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>      <span class=\"token property\">\"start_offset\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>      <span class=\"token property\">\"end_offset\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>      <span class=\"token property\">\"type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"CN_CHAR\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>      <span class=\"token property\">\"position\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">8</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>  <span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"33-扩展词词典\"><a class=\"markdownIt-Anchor\" href=\"#33-扩展词词典\">#</a> 3.3 扩展词词典</h2>\n<p>随着互联网的发展，“造词运动” 也越发的频繁。出现了很多新的词语，在原有的词汇列表中并不存在。比如：“奥力给”，“传智播客” 等。</p>\n<p>所以我们的词汇也需要不断的更新，IK 分词器提供了扩展词汇的功能。</p>\n<p>1）打开 IK 分词器 config 目录：</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310112020613.png\" alt=\"image-20210506112225508\"></p>\n<p>2）在 IKAnalyzer.cfg.xml 配置文件内容添加：</p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token prolog\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">properties</span> <span class=\"token name\">SYSTEM</span> <span class=\"token string\">\"http://java.sun.com/dtd/properties.dtd\"</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>properties</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>comment</span><span class=\"token punctuation\">></span></span>IK Analyzer 扩展配置<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>comment</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token comment\">&lt;!-- 用户可以在这里配置自己的扩展字典 *** 添加扩展词典 --></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>entry</span> <span class=\"token attr-name\">key</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>ext_dict<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>ext.dic<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>entry</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>properties</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p>3）新建一个 ext.dic，可以参考 config 目录下复制一个配置文件进行修改</p>\n<figure class=\"highlight properties\"><figcaption data-lang=\".properties\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>传智教育</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>奥力给</pre></td></tr></table></figure><p>4）重启 elasticsearch</p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> restart es</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># 查看 日志</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">docker</span> logs <span class=\"token parameter variable\">-f</span> elasticsearch</pre></td></tr></table></figure><p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310112020980.png\" alt=\"image-20201115230900504\"></p>\n<p>日志中已经成功加载 ext.dic 配置文件</p>\n<p>5）测试效果：</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>GET /_analyze</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token property\">\"analyzer\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ik_max_word\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token property\">\"text\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"传智播客Java就业超过90%,奥力给！\"</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><blockquote>\n<p>注意当前文件的编码必须是 UTF-8 格式，严禁使用 Windows 记事本编辑</p>\n</blockquote>\n<h2 id=\"34-停用词词典\"><a class=\"markdownIt-Anchor\" href=\"#34-停用词词典\">#</a> 3.4 停用词词典</h2>\n<p>在互联网项目中，在网络间传输的速度很快，所以很多语言是不允许在网络上传递的，如：关于宗教、政治等敏感词语，那么我们在搜索时也应该忽略当前词汇。</p>\n<p>IK 分词器也提供了强大的停用词功能，让我们在索引时就直接忽略当前的停用词汇表中的内容。</p>\n<p>1）IKAnalyzer.cfg.xml 配置文件内容添加：</p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token prolog\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">properties</span> <span class=\"token name\">SYSTEM</span> <span class=\"token string\">\"http://java.sun.com/dtd/properties.dtd\"</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>properties</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>comment</span><span class=\"token punctuation\">></span></span>IK Analyzer 扩展配置<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>comment</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token comment\">&lt;!-- 用户可以在这里配置自己的扩展字典 --></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>entry</span> <span class=\"token attr-name\">key</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>ext_dict<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>ext.dic<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>entry</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>         <span class=\"token comment\">&lt;!-- 用户可以在这里配置自己的扩展停止词字典  *** 添加停用词词典 --></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>entry</span> <span class=\"token attr-name\">key</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>ext_stopwords<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>stopword.dic<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>entry</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>properties</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p>3）在 stopword.dic 添加停用词</p>\n<figure class=\"highlight properties\"><figcaption data-lang=\".properties\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>牛逼</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>的</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>小</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>黑</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>子</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>IKUN</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>坤</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>鸡</pre></td></tr></table></figure><p>需要注意：<mark>牛逼</mark>这个词，进行分词时会出现牛，逼 。因为如下解释：</p>\n<p>IK 查询停用词召回的时候会先将查询词根据分词词库配置进行分词，比如 &quot;牛逼&quot; 这个词会被分为 &quot;牛&quot;，“逼”，之后会根据停用词库去看是否 &quot;牛&quot;，&quot;逼&quot; 两个词再库内，如在库内就不会召回。</p>\n<p>说起来 可能抽象看如下的情况吧：</p>\n<p>当我们查询 “牛逼的时候” 结果如下：</p>\n<p>这里你肯定回想，我不是停用了吗怎么还有显示呢，那你就错了因为它被分词为 一个 “牛” 一个 “逼” 它并不是 “牛逼” 了 ，我们再往下看</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310120847300.png\" alt=\"image-20231012084748860\"></p>\n<p>我查询 “小” 的时候结果什么也没有 因为一个字被分词还是一个词而这一个词还是被停用的一次就能匹配到所以就停用看不到了</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310120849089.png\" alt=\"image-20231012084916676\"></p>\n<p>4）重启 elasticsearch</p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 重启服务</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">docker</span> restart elasticsearch</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">docker</span> restart kibana</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\"># 查看 日志</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token function\">docker</span> logs <span class=\"token parameter variable\">-f</span> elasticsearch</pre></td></tr></table></figure><p>日志中已经成功加载 stopword.dic 配置文件</p>\n<p>5）测试效果：</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>GET /_analyze</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token property\">\"analyzer\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ik_max_word\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token property\">\"text\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"传智播客Java就业率超过95%,习大大都点赞,奥力给！\"</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><blockquote>\n<p>注意当前文件的编码必须是 UTF-8 格式，严禁使用 Windows 记事本编辑</p>\n</blockquote>\n<blockquote>\n<p><strong>总结</strong>：</p>\n<p>分词器的作用是什么？</p>\n<ul>\n<li>创建倒排索引时对文档分词</li>\n<li>用户搜索时，对输入的内容分词</li>\n</ul>\n<p>IK 分词器有几种模式？</p>\n<ul>\n<li>ik_smart：智能切分，粗粒度</li>\n<li>ik_max_word：最细切分，细粒度</li>\n</ul>\n<p>IK 分词器如何扩展词条？如何停用词条？</p>\n<ul>\n<li>利用 config 目录的 IkAnalyzer.cfg.xml 文件添加扩展词典和停用词典</li>\n<li>在词典中添加扩展词条或者停用词条</li>\n</ul>\n</blockquote>\n<h1 id=\"4部署es集群\"><a class=\"markdownIt-Anchor\" href=\"#4部署es集群\">#</a> 4. 部署 es 集群</h1>\n<p>部署 es 集群可以直接使用 docker-compose 来完成，不过要求你的 Linux 虚拟机至少有<strong> 4G</strong> 的内存空间</p>\n<p>首先编写一个 docker-compose 文件，内容如下：</p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>version: <span class=\"token string\">'2.2'</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>services:</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  es01:</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    image: docker.elastic.co/elasticsearch/elasticsearch:7.12.1</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    container_name: es01</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    environment:</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>      - <span class=\"token assign-left variable\">node.name</span><span class=\"token operator\">=</span>es01</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>      - <span class=\"token assign-left variable\">cluster.name</span><span class=\"token operator\">=</span>es-docker-cluster</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>      - <span class=\"token assign-left variable\">discovery.seed_hosts</span><span class=\"token operator\">=</span>es02,es03</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>      - <span class=\"token assign-left variable\">cluster.initial_master_nodes</span><span class=\"token operator\">=</span>es01,es02,es03</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      - <span class=\"token assign-left variable\">bootstrap.memory_lock</span><span class=\"token operator\">=</span>true</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      - <span class=\"token string\">\"ES_JAVA_OPTS=-Xms512m -Xmx512m\"</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    ulimits:</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>      memlock:</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        soft: <span class=\"token parameter variable\">-1</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        hard: <span class=\"token parameter variable\">-1</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    volumes:</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>      - data01:/usr/share/elasticsearch/data</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    ports:</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>      - <span class=\"token number\">9200</span>:9200</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    networks:</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>      - elastic</pre></td></tr><tr><td data-num=\"23\"></td><td><pre>  es02:</pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    image: docker.elastic.co/elasticsearch/elasticsearch:7.12.1</pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    container_name: es02</pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    environment:</pre></td></tr><tr><td data-num=\"27\"></td><td><pre>      - <span class=\"token assign-left variable\">node.name</span><span class=\"token operator\">=</span>es02</pre></td></tr><tr><td data-num=\"28\"></td><td><pre>      - <span class=\"token assign-left variable\">cluster.name</span><span class=\"token operator\">=</span>es-docker-cluster</pre></td></tr><tr><td data-num=\"29\"></td><td><pre>      - <span class=\"token assign-left variable\">discovery.seed_hosts</span><span class=\"token operator\">=</span>es01,es03</pre></td></tr><tr><td data-num=\"30\"></td><td><pre>      - <span class=\"token assign-left variable\">cluster.initial_master_nodes</span><span class=\"token operator\">=</span>es01,es02,es03</pre></td></tr><tr><td data-num=\"31\"></td><td><pre>      - <span class=\"token assign-left variable\">bootstrap.memory_lock</span><span class=\"token operator\">=</span>true</pre></td></tr><tr><td data-num=\"32\"></td><td><pre>      - <span class=\"token string\">\"ES_JAVA_OPTS=-Xms512m -Xmx512m\"</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    ulimits:</pre></td></tr><tr><td data-num=\"34\"></td><td><pre>      memlock:</pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        soft: <span class=\"token parameter variable\">-1</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>        hard: <span class=\"token parameter variable\">-1</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    volumes:</pre></td></tr><tr><td data-num=\"38\"></td><td><pre>      - data02:/usr/share/elasticsearch/data</pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    networks:</pre></td></tr><tr><td data-num=\"40\"></td><td><pre>      - elastic</pre></td></tr><tr><td data-num=\"41\"></td><td><pre>  es03:</pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    image: docker.elastic.co/elasticsearch/elasticsearch:7.12.1</pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    container_name: es03</pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    environment:</pre></td></tr><tr><td data-num=\"45\"></td><td><pre>      - <span class=\"token assign-left variable\">node.name</span><span class=\"token operator\">=</span>es03</pre></td></tr><tr><td data-num=\"46\"></td><td><pre>      - <span class=\"token assign-left variable\">cluster.name</span><span class=\"token operator\">=</span>es-docker-cluster</pre></td></tr><tr><td data-num=\"47\"></td><td><pre>      - <span class=\"token assign-left variable\">discovery.seed_hosts</span><span class=\"token operator\">=</span>es01,es02</pre></td></tr><tr><td data-num=\"48\"></td><td><pre>      - <span class=\"token assign-left variable\">cluster.initial_master_nodes</span><span class=\"token operator\">=</span>es01,es02,es03</pre></td></tr><tr><td data-num=\"49\"></td><td><pre>      - <span class=\"token assign-left variable\">bootstrap.memory_lock</span><span class=\"token operator\">=</span>true</pre></td></tr><tr><td data-num=\"50\"></td><td><pre>      - <span class=\"token string\">\"ES_JAVA_OPTS=-Xms512m -Xmx512m\"</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>    ulimits:</pre></td></tr><tr><td data-num=\"52\"></td><td><pre>      memlock:</pre></td></tr><tr><td data-num=\"53\"></td><td><pre>        soft: <span class=\"token parameter variable\">-1</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>        hard: <span class=\"token parameter variable\">-1</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>    volumes:</pre></td></tr><tr><td data-num=\"56\"></td><td><pre>      - data03:/usr/share/elasticsearch/data</pre></td></tr><tr><td data-num=\"57\"></td><td><pre>    networks:</pre></td></tr><tr><td data-num=\"58\"></td><td><pre>      - elastic</pre></td></tr><tr><td data-num=\"59\"></td><td><pre></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>volumes:</pre></td></tr><tr><td data-num=\"61\"></td><td><pre>  data01:</pre></td></tr><tr><td data-num=\"62\"></td><td><pre>    driver: <span class=\"token builtin class-name\">local</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>  data02:</pre></td></tr><tr><td data-num=\"64\"></td><td><pre>    driver: <span class=\"token builtin class-name\">local</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>  data03:</pre></td></tr><tr><td data-num=\"66\"></td><td><pre>    driver: <span class=\"token builtin class-name\">local</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>networks:</pre></td></tr><tr><td data-num=\"69\"></td><td><pre>  elastic:</pre></td></tr><tr><td data-num=\"70\"></td><td><pre>    driver: bridge</pre></td></tr></table></figure><p>将该配置文件上传到 Linux 中</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310161059412.png\" alt=\"image-20231016105943788\"></p>\n<p>es 运行需要修改一些 Linux 系统权限，修改  <code>/etc/sysctl.conf</code>  文件：</p>\n<pre><code class=\"language-sh·\">vi /etc/sysctl.conf\n</code></pre>\n<p>添加下面内容：</p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token assign-left variable\">vm.max_map_count</span><span class=\"token operator\">=</span><span class=\"token number\">262144</span></pre></td></tr></table></figure><p>然后执行命令，让配置生效：</p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># sysctl -p</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>vm.max_map_count <span class=\"token operator\">=</span> <span class=\"token number\">262144</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\">#</span></pre></td></tr></table></figure><p>Run  <code>docker-compose</code>  to bring up the cluster:</p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># docker-compose up -d</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>Starting es03 <span class=\"token punctuation\">..</span>. <span class=\"token keyword\">done</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>Starting es01 <span class=\"token punctuation\">..</span>. <span class=\"token keyword\">done</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>Starting es02 <span class=\"token punctuation\">..</span>. <span class=\"token keyword\">done</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># docker ps -a</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>CONTAINER ID   IMAGE                   COMMAND                  CREATED         STATUS                            PORTS                                                                                                                                                 NAMES</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>c3c4b0e1ffdc   elasticsearch:7.12.1    <span class=\"token string\">\"/bin/tini -- /usr/l…\"</span>   <span class=\"token number\">2</span> minutes ago   Up <span class=\"token number\">13</span> seconds                     <span class=\"token number\">0.0</span>.0.0:9200-<span class=\"token operator\">></span><span class=\"token number\">9200</span>/tcp, :::9200-<span class=\"token operator\">></span><span class=\"token number\">9200</span>/tcp, <span class=\"token number\">9300</span>/tcp                                                                                                   es01</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>073f8e46e296   elasticsearch:7.12.1    <span class=\"token string\">\"/bin/tini -- /usr/l…\"</span>   <span class=\"token number\">2</span> minutes ago   Up <span class=\"token number\">13</span> seconds                     <span class=\"token number\">9300</span>/tcp, <span class=\"token number\">0.0</span>.0.0:9201-<span class=\"token operator\">></span><span class=\"token number\">9200</span>/tcp, :::9201-<span class=\"token operator\">></span><span class=\"token number\">9200</span>/tcp                                                                                                   es02</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>aca2f691e3e2   elasticsearch:7.12.1    <span class=\"token string\">\"/bin/tini -- /usr/l…\"</span>   <span class=\"token number\">2</span> minutes ago   Up <span class=\"token number\">13</span> seconds                     <span class=\"token number\">9300</span>/tcp, <span class=\"token number\">0.0</span>.0.0:9202-<span class=\"token operator\">></span><span class=\"token number\">9200</span>/tcp, :::9202-<span class=\"token operator\">></span><span class=\"token number\">9200</span>/tcp                                                                                                   es03</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>61161df3ec6a   kibana:7.12.1           <span class=\"token string\">\"/bin/tini -- /usr/l…\"</span>   <span class=\"token number\">4</span> days ago      Up <span class=\"token number\">18</span> minutes                     <span class=\"token number\">0.0</span>.0.0:5601-<span class=\"token operator\">></span><span class=\"token number\">5601</span>/tcp, :::5601-<span class=\"token operator\">></span><span class=\"token number\">5601</span>/tcp                                                                                                             kibana</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>318bc511f26c   elasticsearch:7.12.1    <span class=\"token string\">\"/bin/tini -- /usr/l…\"</span>   <span class=\"token number\">4</span> days ago      Exited <span class=\"token punctuation\">(</span><span class=\"token number\">137</span><span class=\"token punctuation\">)</span> About a minute ago                                                                                                                                                         es</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>46756ed1a2ee   rabbitmq:3-management   <span class=\"token string\">\"docker-entrypoint.s…\"</span>   <span class=\"token number\">4</span> days ago      Up <span class=\"token number\">18</span> minutes                     <span class=\"token number\">4369</span>/tcp, <span class=\"token number\">5671</span>/tcp, <span class=\"token number\">0.0</span>.0.0:5672-<span class=\"token operator\">></span><span class=\"token number\">5672</span>/tcp, :::5672-<span class=\"token operator\">></span><span class=\"token number\">5672</span>/tcp, <span class=\"token number\">15671</span>/tcp, <span class=\"token number\">15691</span>-15692/tcp, <span class=\"token number\">25672</span>/tcp, <span class=\"token number\">0.0</span>.0.0:15672-<span class=\"token operator\">></span><span class=\"token number\">15672</span>/tcp, :::15672-<span class=\"token operator\">></span><span class=\"token number\">15672</span>/tcp   mq</pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\">#</span></pre></td></tr></table></figure><h2 id=\"41-集群状态监控\"><a class=\"markdownIt-Anchor\" href=\"#41-集群状态监控\">#</a> 4.1、集群状态监控</h2>\n<p>kibana 可以监控 es 集群，不过新版本需要依赖 es 的 x-pack 功能，配置比较复杂。</p>\n<p>这里推荐使用 cerebro 来监控 es 集群状态，官方网址：<a href=\"https://github.com/lmenezes/cerebro\">https://github.com/lmenezes/cerebro</a></p>\n<p>下载后进行解压</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310161113552.png\" alt=\"image-20231016111307167\"></p>\n<p>解压后进入 bin 目录中</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310161113838.png\" alt=\"image-20231016111341471\"></p>\n<p>双击运行 cerebro.bat 即可运行</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310161115237.png\" alt=\"image-20231016111523818\"></p>\n<p>启动完成后访问：localhost:9000 地址，证明正常启动成功了。</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310161115161.png\" alt=\"image-20231016111547168\"></p>\n<p>这时就可以访问虚拟机中 es 的哪个共同端口号的地址了：<a href=\"http://192.168.249.128:9200\">http://192.168.249.128:9200</a></p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310161154359.png\" alt=\"image-20231016115434836\"></p>\n<h2 id=\"42-创建索引库\"><a class=\"markdownIt-Anchor\" href=\"#42-创建索引库\">#</a> 4.2、创建索引库</h2>\n<h3 id=\"421-利用kibana的devtools创建索引库\"><a class=\"markdownIt-Anchor\" href=\"#421-利用kibana的devtools创建索引库\">#</a> 4.2.1、利用 kibana 的 DevTools 创建索引库</h3>\n<p>在 DevTools 中输入指令：</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>PUT /indexName</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>   <span class=\"token property\">\"settings\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>      <span class=\"token property\">\"number_of_shards\"</span><span class=\"token operator\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 分片数量</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>      <span class=\"token property\">\"number_of_replicas\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span> <span class=\"token comment\">// 副本数量</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>   <span class=\"token property\">\"mappings\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>      <span class=\"token property\">\"properties\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>         <span class=\"token comment\">//mapping 映射定义 ...</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310161201547.png\" alt=\"image-20231016120105950\"></p>\n<p>填写完成后点击 create 创建索引库</p>\n<p>回到首页</p>\n<p>可以看到数据被成功的分成了三片，名称为 itcast</p>\n<p>但是还加了一个副本，每一片都加一个副本就是 3 * 2 = 6 片</p>\n<p>其中实线就是住分片，虚线就是副本分片（就是拷贝了一份）</p>\n<p>每一个分片它的备份都在不同的机器上，这样就确保了任意一台机器宕机，那的备份依然还保留着避免出现数据故障</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310161202468.png\" alt=\"image-20231016120225681\"></p>\n",
            "tags": [
                "计算机学科",
                "基础",
                "springcloud",
                "Elasticsearch"
            ]
        },
        {
            "id": "https://pigpigletsgo.github.io/homepage/2024/04/02/computer-science/java/spring/springcloud/Elasticsearch/springcloud-elasticsearch/",
            "url": "https://pigpigletsgo.github.io/homepage/2024/04/02/computer-science/java/spring/springcloud/Elasticsearch/springcloud-elasticsearch/",
            "title": "九、分布式搜索",
            "date_published": "2024-04-02T10:00:51.016Z",
            "content_html": "<h2 id=\"九-分布式搜索\"><a class=\"markdownIt-Anchor\" href=\"#九-分布式搜索\">#</a> 九、分布式搜索🎄</h2>\n<p>elasticsearch 基础</p>\n<ul>\n<li>初始 elasticsearch</li>\n<li>索引库操作</li>\n<li>文档操作</li>\n<li>RestAPI</li>\n</ul>\n<h3 id=\"91-初始elasticsearch\"><a class=\"markdownIt-Anchor\" href=\"#91-初始elasticsearch\">#</a> 9.1、初始 elasticsearch🌳</h3>\n<ul>\n<li>了解 ES</li>\n<li>倒排索引</li>\n<li>es 的一些概念</li>\n<li>安装 es，kibana</li>\n</ul>\n<h4 id=\"911-什么是elasticsearch\"><a class=\"markdownIt-Anchor\" href=\"#911-什么是elasticsearch\">#</a> 9.1.1、什么是 elasticsearch🌲</h4>\n<p>elasticsearch 是一款非常强大的开源<mark>搜索引擎</mark>，可以帮助我们从<mark>海量数据中快速找到需要的内容</mark>。</p>\n<p>elasticsearch 结合 kibana，Logstash，Beats，也就是 elastic stack (ELK)。被广泛应用在日志数据分析，实时监控等领域。</p>\n<p>elasticsearch 是 elastic stack 的核心，负责存储，搜索，分析数据。</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310111754105.png\" alt=\"image-20231011175401979\"></p>\n<p>Elasticsearch 的底层实现就是<mark> Lucene</mark> 的技术</p>\n<p>Lucene 是一个 Java 语言的<mark>搜索引擎类库</mark>，是 Apache 公司的顶级项目，由 Doug Cutting 于 1999 年研发。</p>\n<p>官网地址：<a href=\"https://lucene.apache.org/\">https://lucene.apache.org/</a></p>\n<p>Lucene 的优势：</p>\n<ul>\n<li>易扩展</li>\n<li>高性能 (基于倒排索引)</li>\n</ul>\n<p>2004 年 Shay Banon 基于 Lucene 开发了 Compass</p>\n<p>2010 年 Shay Banon 重写了 Compass，取名为 Elasticsearch</p>\n<p>官网地址：<a href=\"https://www.elastic.co/cn/\">https://www.elastic.co/cn/</a></p>\n<p>目前最新的版本是：7.12.1</p>\n<p>相比与 lucene，elasticsearch 具备下列优势：</p>\n<ul>\n<li>支持分布式，可水平扩展</li>\n<li>提供 Restful 接口，可被任何语言调用</li>\n</ul>\n<p><strong>为什么学习 elasticsearch?</strong>。</p>\n<p>搜索引擎技术排名：</p>\n<p>1、Elasticsearch：开源的分布式搜索引擎</p>\n<p>2、Splunk：商业项目</p>\n<p>3、Solr：Apache 的开源搜索引擎</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310111923929.png\" alt=\"image-20231011192322393\"></p>\n<blockquote>\n<p><strong>总结</strong>：</p>\n<p>什么是 elasticsearch?</p>\n<ul>\n<li>一个开源的<mark>分布式搜索引擎</mark>，可以用来实现搜索，日志统计，分析，系统监控等功能</li>\n</ul>\n<p>什么是 elastic stack (LEK)？</p>\n<ul>\n<li>是以 elasticsearch 为核心的技术栈，包括 beats，Logstash，kibana，elasticsearch</li>\n</ul>\n<p>什么是 Lucene?</p>\n<ul>\n<li>是 Apache 的开源搜索引擎类库，提供了搜索引擎的核心 API</li>\n</ul>\n</blockquote>\n<h3 id=\"92-正向索引和倒排索引\"><a class=\"markdownIt-Anchor\" href=\"#92-正向索引和倒排索引\">#</a> 9.2、正向索引和倒排索引🌳</h3>\n<p>传统数据库 (如 MySQL) 采用正向索引，例如给下表 (tb_goods) 中的 id 创建索引：</p>\n<p>正向索引：做局部内部检索的时候性能比较差</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310111933421.png\" alt=\"image-20231011193327307\"></p>\n<p>elasticsearch 采用倒排索引：</p>\n<ul>\n<li>文档 (document)：每条数据就是一个文档\n<ul>\n<li>代表的就是数据，每一条数据就是一个文档</li>\n</ul>\n</li>\n<li>词条 (term)：文档按照语义分成的词语\n<ul>\n<li>如果是中文就按照中文的语义进行分词</li>\n</ul>\n</li>\n</ul>\n<p>倒排索引，会形成一个<mark>新的表</mark>。这张<mark>表里面有两个字段</mark>，一个字段是<mark>词条</mark>另一个是<mark>文档 id</mark>。</p>\n<p>倒排索引，它在存储时会先把文档中的<mark>内容分成词条去存储</mark>。比方说我拿到了第一条数据那我要对标题创建倒排索引，那么我就来吧标题内容做个分词得到两个词语小米和手机，然后把每个这两个词语存到词条里，然后后面记录它的文档 id。<mark>重复的词语不会存入词条而是在已存在的词条后面追加上这个重复的词语的 id</mark>.</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310111945438.gif\" alt=\"test\"></p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310111953084.png\" alt=\"image-20231011195333829\"></p>\n<blockquote>\n<p><strong>总结</strong>:</p>\n<p>什么是文档和词条？</p>\n<ul>\n<li>每一条数据就是一个文档</li>\n<li>对文档中的内容分词，得到的词语就是词条</li>\n</ul>\n<p>什么是正向索引？</p>\n<ul>\n<li>基于文档 id 创建索引。查询词条时必须先找到文档，而后判断是否包含词条</li>\n</ul>\n<p>什么是倒排索引？</p>\n<ul>\n<li>对文档内容分词，对词条创建索引，并记录词条所在文档的信息。查询时先根据词条查询到文档 id，而后获取到文档</li>\n</ul>\n</blockquote>\n<h3 id=\"93-文档\"><a class=\"markdownIt-Anchor\" href=\"#93-文档\">#</a> 9.3、文档🌳</h3>\n<p>elasticsearch 是面向文档存储的，可以是数据库中的一条商品数据，一个订单信息。</p>\n<p>文档数据会被序列化为 json 格式后存储在 elasticsearch 中。</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310112001435.png\" alt=\"image-20231011200117293\"></p>\n<h3 id=\"94-索引-index\"><a class=\"markdownIt-Anchor\" href=\"#94-索引-index\">#</a> 9.4、索引 (index)🌳</h3>\n<ul>\n<li>索引 (index)：相同类型的文档的集合</li>\n<li>映射 (mapping)：索引中文档的字段约束信息，类似表的结构约束</li>\n</ul>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310112003417.png\" alt=\"image-20231011200324370\"></p>\n<h3 id=\"95-概念对比\"><a class=\"markdownIt-Anchor\" href=\"#95-概念对比\">#</a> 9.5、概念对比🌳</h3>\n<table>\n<thead>\n<tr>\n<th>MySQL</th>\n<th>Elasticsearch</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Table</td>\n<td>Index</td>\n<td>索引 (index)，就是文档的集合，类似数据库的表 (table)</td>\n</tr>\n<tr>\n<td>Row</td>\n<td>Document</td>\n<td>文档 (document)，就是一条条的数据，类似数据库中的行 (Row)，文档都是 JSON 格式</td>\n</tr>\n<tr>\n<td>Column</td>\n<td>Field</td>\n<td>字段 (Field)，就是 JSON 文档中的字段，类似数据库中的列 (Column)</td>\n</tr>\n<tr>\n<td>Schema</td>\n<td>Mapping</td>\n<td>Mapping (映射) 是索引中文档的约束，例如字段类型约束。类似数据库的表结构 (Schema)</td>\n</tr>\n<tr>\n<td>SQL</td>\n<td>DSL</td>\n<td>DSL 是 elasticsearch 提供的 JSON 风格的请求语句，用来操作 elasticsearch，实现 CRUD</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"95-架构\"><a class=\"markdownIt-Anchor\" href=\"#95-架构\">#</a> 9.5、架构🌳</h3>\n<p>MySQL：擅长事务类型操作，可以确保数据的安全和一致性</p>\n<p>Elasticsearch：擅长海量数据的搜索，分析，计算</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310112013859.png\" alt=\"image-20231011201341793\"></p>\n<blockquote>\n<p><strong>总结</strong>：</p>\n<p>文档：一条数据就是一个文档，es 中是 json 格式</p>\n<p>字段：json 文档中的字段</p>\n<p>索引：同类型文档的集合</p>\n<p>映射：索引中文档的约束，比如字段名称，类型</p>\n<p>elasticsearch 与数据库的关系：</p>\n<ul>\n<li>数据库负责事务类型操作</li>\n<li>elasticsearch 负责海量数据的搜索，分析，计算</li>\n</ul>\n</blockquote>\n<h3 id=\"96-安装和部署\"><a class=\"markdownIt-Anchor\" href=\"#96-安装和部署\">#</a> 9.6、安装和部署🌳</h3>\n<p><a href=\"./Elasearch/%E5%AE%89%E8%A3%85elasticsearch.md\">查看 elaticsearch 安装和部署</a>。</p>\n<h3 id=\"97-分词器\"><a class=\"markdownIt-Anchor\" href=\"#97-分词器\">#</a> 9.7、分词器🌳</h3>\n<p>es 在创建倒排索引时需要对文档进行分词；在搜索时，需要对用户输入内容分词。但默认的分词规则对中文处理并不友好。我们在 kibana 的 DevTools 中测试：</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310112105308.png\" alt=\"image-20231011210532721\"></p>\n<p>语法说明：</p>\n<ul>\n<li>POST：请求方式</li>\n<li>/_analyze：请求路径，这里省略了 http://192.168.150.101:9200，有 kibana 帮我们补充</li>\n<li>请求参数，json 风格：\n<ul>\n<li>analyzer：分词器类型，这里是默认的 standard 分词器</li>\n<li>text：要分词的内容</li>\n</ul>\n</li>\n</ul>\n<p>kibana 中测试结果如下：</p>\n<pre><code>&#123;\n  &quot;tokens&quot; : [\n    &#123;\n      &quot;token&quot; : &quot;黑&quot;,\n      &quot;start_offset&quot; : 0,\n      &quot;end_offset&quot; : 1,\n      &quot;type&quot; : &quot;&lt;IDEOGRAPHIC&gt;&quot;,\n      &quot;position&quot; : 0\n    &#125;,\n    &#123;\n      &quot;token&quot; : &quot;马&quot;,\n      &quot;start_offset&quot; : 1,\n      &quot;end_offset&quot; : 2,\n      &quot;type&quot; : &quot;&lt;IDEOGRAPHIC&gt;&quot;,\n      &quot;position&quot; : 1\n    &#125;,\n    &#123;\n      &quot;token&quot; : &quot;程&quot;,\n      &quot;start_offset&quot; : 2,\n      &quot;end_offset&quot; : 3,\n      &quot;type&quot; : &quot;&lt;IDEOGRAPHIC&gt;&quot;,\n      &quot;position&quot; : 2\n    &#125;,\n    &#123;\n      &quot;token&quot; : &quot;序&quot;,\n      &quot;start_offset&quot; : 3,\n      &quot;end_offset&quot; : 4,\n      &quot;type&quot; : &quot;&lt;IDEOGRAPHIC&gt;&quot;,\n      &quot;position&quot; : 3\n    &#125;,\n    &#123;\n      &quot;token&quot; : &quot;员&quot;,\n      &quot;start_offset&quot; : 4,\n      &quot;end_offset&quot; : 5,\n      &quot;type&quot; : &quot;&lt;IDEOGRAPHIC&gt;&quot;,\n      &quot;position&quot; : 4\n    &#125;,\n    &#123;\n      &quot;token&quot; : &quot;学&quot;,\n      &quot;start_offset&quot; : 5,\n      &quot;end_offset&quot; : 6,\n      &quot;type&quot; : &quot;&lt;IDEOGRAPHIC&gt;&quot;,\n      &quot;position&quot; : 5\n    &#125;,\n    &#123;\n      &quot;token&quot; : &quot;习&quot;,\n      &quot;start_offset&quot; : 6,\n      &quot;end_offset&quot; : 7,\n      &quot;type&quot; : &quot;&lt;IDEOGRAPHIC&gt;&quot;,\n      &quot;position&quot; : 6\n    &#125;,\n    &#123;\n      &quot;token&quot; : &quot;java&quot;,\n      &quot;start_offset&quot; : 7,\n      &quot;end_offset&quot; : 11,\n      &quot;type&quot; : &quot;&lt;ALPHANUM&gt;&quot;,\n      &quot;position&quot; : 7\n    &#125;,\n    &#123;\n      &quot;token&quot; : &quot;太&quot;,\n      &quot;start_offset&quot; : 11,\n      &quot;end_offset&quot; : 12,\n      &quot;type&quot; : &quot;&lt;IDEOGRAPHIC&gt;&quot;,\n      &quot;position&quot; : 8\n    &#125;,\n    &#123;\n      &quot;token&quot; : &quot;棒&quot;,\n      &quot;start_offset&quot; : 12,\n      &quot;end_offset&quot; : 13,\n      &quot;type&quot; : &quot;&lt;IDEOGRAPHIC&gt;&quot;,\n      &quot;position&quot; : 9\n    &#125;,\n    &#123;\n      &quot;token&quot; : &quot;了&quot;,\n      &quot;start_offset&quot; : 13,\n      &quot;end_offset&quot; : 14,\n      &quot;type&quot; : &quot;&lt;IDEOGRAPHIC&gt;&quot;,\n      &quot;position&quot; : 10\n    &#125;\n  ]\n&#125;\n</code></pre>\n<p>可以看到它对英文的分词挺好的但是对中文的分词却不好</p>\n<p>解决办法：</p>\n<p>处理中文分词，一般会使用 IK 分词器：<a href=\"https://github.com/medcl/elasticsearch-analysis-ik\">https://github.com/medcl/elasticsearch-analysis-ik</a></p>\n<p>安装和使用 IK 分词器，参考文章：<a href=\"./Elasearch/%E5%AE%89%E8%A3%85elasticsearch.md\">查看 IK 安装</a>.</p>\n<h3 id=\"98-索引库操作\"><a class=\"markdownIt-Anchor\" href=\"#98-索引库操作\">#</a> 9.8、索引库操作🌳</h3>\n<ul>\n<li>mapping 映射属性</li>\n<li>索引库的 CRUD</li>\n</ul>\n<h4 id=\"981-mapping属性\"><a class=\"markdownIt-Anchor\" href=\"#981-mapping属性\">#</a> 9.8.1、mapping 属性🌲</h4>\n<p>mapping 是对索引库中文档的<mark>约束</mark>，常见的 mapping 属性包括：</p>\n<ul>\n<li>type：字段数据类型，常见的简单类型有\n<ul>\n<li>字符串：text (可分词的文本)，keyword (精确值，例如：品牌，国家，ip 地址)</li>\n<li>数值：long，integer，short，byte，double，float</li>\n<li>布尔：boolean</li>\n<li>日期：date</li>\n<li>对象：object</li>\n</ul>\n</li>\n<li>在 elasticsearch 中是没有数组这种类型的，但是它允许某一个字段有多个值</li>\n<li>index：是否创建倒排索引，默认为 true (全创建倒排索引)</li>\n<li>analyzer：使用哪种分词器 (结合 text 使用除了 text 以外其它都不需要用)\n<ul>\n<li>值：分词器名称：ik_smart 或者 ik_max_word</li>\n</ul>\n</li>\n<li>properties：该字段的子字段\n<ul>\n<li>name 有两个子字段可以使用 properties 来指定子字段了</li>\n</ul>\n</li>\n</ul>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310120907321.png\" alt=\"image-20231012090710123\"></p>\n<blockquote>\n<p><strong>总结</strong>：</p>\n<p>mapping 常见属性有哪些？</p>\n<ul>\n<li>type：数据类型</li>\n<li>index：是否索引</li>\n<li>analyzer：分词器</li>\n<li>properties：子字段</li>\n</ul>\n<p>type 常见的有哪些？</p>\n<ul>\n<li>字符串：text，keyword</li>\n<li>数字：long，integer，short，byte，double，float</li>\n<li>布尔：boolean</li>\n<li>日期：date</li>\n<li>对象 object</li>\n</ul>\n</blockquote>\n<h4 id=\"982-创建索引库\"><a class=\"markdownIt-Anchor\" href=\"#982-创建索引库\">#</a> 9.8.2、创建索引库🌲</h4>\n<p>ES 中通过 Restful 请求操作索引库，文档。请求内容用 DSL 语句来表示。创建索引库和 mapping 的 DSL 语法如下：</p>\n<p>PUT 添加索引</p>\n<p>info 用户信息内容很长所以是可分词的 text，分词器是 ik_smart。email 邮箱 没有分词的必要，因为它作为一个整体才有意义所以使用 keyword 不进行分词，因此不进行分词也就不需要 analyzer 了，使用 index=false 表示这个字段不参与创建倒排索引。name 名称，带有嵌套，它有指定的 properties，里面还有一个 firstName。</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310120918101.png\" alt=\"image-20231012091855829\"></p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>PUT /dkx</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token property\">\"mappings\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token property\">\"properties\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>      <span class=\"token property\">\"info\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token property\">\"analyzer\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ik_smart\"</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>      <span class=\"token property\">\"email\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"keyword\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token property\">\"index\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>      <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"object\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token property\">\"properties\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>          <span class=\"token property\">\"firstName\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"keyword\"</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>          <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>          <span class=\"token property\">\"lastName\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>            <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"keyword\"</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>          <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>运行结果：</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token property\">\"acknowledged\"</span> <span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token property\">\"shards_acknowledged\"</span> <span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token property\">\"index\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"dkx\"</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>创建成功！</p>\n<h4 id=\"983-查看删除索引库\"><a class=\"markdownIt-Anchor\" href=\"#983-查看删除索引库\">#</a> 9.8.3、查看，删除索引库🌲</h4>\n<p>查看索引库语法：</p>\n<pre><code>GET /索引库名\n</code></pre>\n<p>示例：</p>\n<pre><code>GET /dkx\n</code></pre>\n<p>删除索引库的语法：</p>\n<pre><code>DELETE /索引库名\n</code></pre>\n<p>示例：</p>\n<pre><code>DELETE /dkx\n</code></pre>\n<h4 id=\"984-修改索引库\"><a class=\"markdownIt-Anchor\" href=\"#984-修改索引库\">#</a> 9.8.4、修改索引库🌲</h4>\n<p>事实上在 ES 中索引库是不允许修改的</p>\n<p>因为索引库创建完了以后它的数据结构也就是 mapping 映射都已经定义好了。ES 会基于这些 mapping 去创建倒排索引，如果去修改某一个字段就会导致整体倒排索引彻底失效，这样带来的影响是非常大的。</p>\n<p>所以在 ES 中是禁止修改索引库的！</p>\n<p>索引库和 mapping 一旦创建无法修改，但是可以添加新的字段，语法如下：</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>PUT /索引库名/_mapping</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>   <span class=\"token property\">\"properties\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>      <span class=\"token comment\">// 这里必须是新的字段名不能和存在的重复否则它以为你要修改就报错</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>      <span class=\"token property\">\"新字段名\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>         <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"integer\"</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>示例：</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>PUT /dkx/_mapping</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>   <span class=\"token property\">\"properties\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>      <span class=\"token property\">\"age\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>         type<span class=\"token operator\">:</span> <span class=\"token string\">\"integer\"</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>案例演示图：</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310121021571.gif\" alt=\"test\"></p>\n<blockquote>\n<p><strong>总结</strong>：</p>\n<p>索引库操作有哪些？</p>\n<ul>\n<li>创建索引库：PUT / 索引库名</li>\n<li>查询索引库：GET / 索引库名</li>\n<li>删除索引库： DELETE / 索引库名</li>\n<li>添加字段：PUT / 索引库名 /_mapping</li>\n</ul>\n</blockquote>\n<h4 id=\"985-文档操作\"><a class=\"markdownIt-Anchor\" href=\"#985-文档操作\">#</a> 9.8.5、文档操作🌲</h4>\n<ul>\n<li>新增文档</li>\n<li>查询文档</li>\n<li>删除文档</li>\n<li>修改文档</li>\n</ul>\n<h5 id=\"9851-添加文档\"><a class=\"markdownIt-Anchor\" href=\"#9851-添加文档\">#</a> 9.8.5.1、添加文档🌴</h5>\n<p>新增文档的 DSL 语法如下：</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>POST /索引库名/_doc/文档id</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>   <span class=\"token property\">\"字段1\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"值1\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>   <span class=\"token property\">\"字段2\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"值2\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>   <span class=\"token property\">\"字段3\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>      <span class=\"token property\">\"子属性1\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"值3\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>      <span class=\"token property\">\"子属性2\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"值4\"</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>   <span class=\"token comment\">// ...</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310121028570.png\" alt=\"image-20231012102808294\"></p>\n<h5 id=\"9852-查看删除文档\"><a class=\"markdownIt-Anchor\" href=\"#9852-查看删除文档\">#</a> 9.8.5.2、查看，删除文档🌴</h5>\n<p>查看文档语法：</p>\n<pre><code>GET /索引库名/_doc/文档id\n</code></pre>\n<p>示例：</p>\n<pre><code>GET /dkx/_doc/1\n</code></pre>\n<p>删除文档的语法：</p>\n<pre><code>DELETE /索引库名/_doc/文档id\n</code></pre>\n<p>示例：</p>\n<pre><code>DELETE /dkx/_doc/1\n</code></pre>\n<h5 id=\"9853-修改文档\"><a class=\"markdownIt-Anchor\" href=\"#9853-修改文档\">#</a> 9.8.5.3、修改文档🌴</h5>\n<p>方式一：全量修改，会删除旧文档，添加新文档，如果没有旧文档就是新增</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>PUT /索引库名/_doc/文档id</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>   <span class=\"token property\">\"字段1\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"值1\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>   <span class=\"token property\">\"字段2\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"值2\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>   <span class=\"token comment\">//... 略</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310121039009.png\" alt=\"image-20231012103906432\"></p>\n<p>方式二：增量修改，修改指定字段值</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>POST /索引库名/_update/文档id</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>   <span class=\"token property\">\"doc\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>      <span class=\"token property\">\"字段名\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"新的值\"</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310121042126.png\" alt=\"image-20231012104219010\"></p>\n<blockquote>\n<p><strong>总结</strong>：</p>\n<p>文档操作有哪些？</p>\n<ul>\n<li json文档=\"\">创建文档：POST / 索引库名 /_cod/ 文档 id</li>\n<li>查询文档：GET / 索引库名 /_doc/ 文档 id</li>\n<li>删除文档：DELETE / 索引库名 /_doc/ 文档 id</li>\n<li>修改文档：\n<ul>\n<li json文档=\"\">全量修改：PUT / 索引库名 /_doc/ 文档 id</li>\n<li>增量修改：POST / 索引库名 /_update/ 文档 id {“doc”: {字段}}</li>\n</ul>\n</li>\n</ul>\n</blockquote>\n<h4 id=\"986-restclient操作索引库\"><a class=\"markdownIt-Anchor\" href=\"#986-restclient操作索引库\">#</a> 9.8.6、RestClient 操作索引库🌲</h4>\n<ul>\n<li>创建索引库</li>\n<li>删除索引库</li>\n<li>判断索引库是否存在</li>\n</ul>\n<h5 id=\"9861-什么是restclient\"><a class=\"markdownIt-Anchor\" href=\"#9861-什么是restclient\">#</a> 9.8.6.1、什么是 RestClient🌴</h5>\n<p>ES 官方提供了各种不同语言的客户端，用来操作 ES。这些客户端的本质就是组装 DSL 语句，通过 http 请求发送给 ES。官方文档地址：<a href=\"https://www.elastic.co/guide/en/elasticsearch/client/index.html\">https://www.elastic.co/guide/en/elasticsearch/client/index.html</a></p>\n<h5 id=\"9862-案例利用javarestclient实现创建删除索引库判断索引库是否存在\"><a class=\"markdownIt-Anchor\" href=\"#9862-案例利用javarestclient实现创建删除索引库判断索引库是否存在\">#</a> 9.8.6.2、案例，利用 JavaRestClient 实现创建，删除索引库，判断索引库是否存在🌴</h5>\n<p>根据 sql 文件数据创建索引库<a href=\"./Elasearch/%E6%A1%88%E4%BE%8Bsql.md\"> sql 文件</a>。索引库名为 hotel，mapping 属性根据数据库结构定义。</p>\n<p>基本步骤如下：</p>\n<p>1、idea 中导入 hotel-demo 项目，项目地址：<a href=\"https://gitee.com/doukaixin/typora.git\">https://gitee.com/doukaixin/typora.git</a></p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310121121088.png\" alt=\"image-20231012112156928\"></p>\n<p>2、分析数据结构，定义 mapping 属性</p>\n<p>mapping 要考虑的问题：</p>\n<p>字段名，数据类型，是否参与搜索，是否分词，如果分词，分词器是什么？</p>\n<p>其中，字段名和数据类型可以基于表结构一目了然，是否参与搜索与是否分词就比较特殊了，它们与业务强相关的。比如说我们当前的酒店业务，酒店名称就一定是要参与搜索功能的它也要分词因为内容比较长，而分词器我们肯定会使用 ik_max_word 尽可能多的分词搜索范围大一些。</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310121124067.png\" alt=\"image-20231012112427548\"></p>\n<p>根据上述分析去创建对应的索引库</p>\n<blockquote>\n<p>小提示：</p>\n<p>ES 中支持两种地理坐标数据类型：</p>\n<ul>\n<li>\n<p>geo_point：由纬度 (latitude) 和径度 (longitude) 确定的一个点。例如：</p>\n<p>“32.82342343，120.3153263”</p>\n</li>\n<li>\n<p>geo_shape：有多个 geo_point 组成的复杂几何图形。例如一条直线，</p>\n<p>“LINESTRING(-77.12312312，-77.1235343 38.2323234)”</p>\n</li>\n</ul>\n</blockquote>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>PUT /dkx</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token property\">\"mappings\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token property\">\"properties\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>      <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"keyword\"</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>      <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token property\">\"analyzer\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ik_max_word\"</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      <span class=\"token property\">\"address\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"keyword\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token property\">\"index\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>      <span class=\"token property\">\"price\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"integer\"</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>      <span class=\"token property\">\"score\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"integer\"</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>      <span class=\"token property\">\"brand\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"keyword\"</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>      <span class=\"token property\">\"city\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"keyword\"</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>      <span class=\"token property\">\"starName\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"keyword\"</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>      <span class=\"token property\">\"business\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>        <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"keyword\"</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>       # 酒店在地图上用一个点来表示所以使用geo_point，而上图的sql中酒店是两个字段一个经度一个纬度，而在ES中一个geo_point代表了经纬度，所以使用一个字段来包裹geo_point</pre></td></tr><tr><td data-num=\"35\"></td><td><pre>      <span class=\"token property\">\"location\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>        <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"geo_point\"</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>      <span class=\"token property\">\"pic\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>        <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"keyword\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>        <span class=\"token property\">\"index\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>虽然定义完了酒店的所有字段了但是有一个小的问题。那我们的 name，brand，businne 等字段这些都要参与搜索，那这些将来都要参与搜索也就意味着将来用户输入关键字我可能要根据多个字段搜索，也就是查询条件不是一个值而是多个值。那根据一个字段搜效率高，还是根据多个字段搜效率高呢？显然是一个字段搜。但是需求是希望用户输入名称能搜到，输入品牌也能搜到，输入商圈也能搜到，多个搜索条件而我又想性能好该怎么办？</p>\n<p>ES 提供了一个功能可以解决这个问题，如下小提示</p>\n<blockquote>\n<p><strong>小提示</strong>：</p>\n<p>字段拷贝可以使用 copy_to 属性将当前字段拷贝到指定字段。示例：</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token property\">\"all\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>   <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>   <span class=\"token property\">\"analyzer\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ik_max_word\"</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>   <span class=\"token property\">\"brand\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>      <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"keyword\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>      <span class=\"token property\">\"copy_to\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"all\"</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure></blockquote>\n<p>完整的索引库如下：</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>PUT /dkx</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token property\">\"mappings\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token property\">\"properties\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>      <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"keyword\"</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>      <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token property\">\"analyzer\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ik_max_word\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token property\">\"copy_to\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"all\"</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>      <span class=\"token property\">\"address\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"keyword\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token property\">\"index\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>      <span class=\"token property\">\"price\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"integer\"</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>      <span class=\"token property\">\"score\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"integer\"</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>      <span class=\"token property\">\"brand\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"keyword\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        <span class=\"token property\">\"copy_to\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"all\"</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>      <span class=\"token property\">\"city\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"keyword\"</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>      <span class=\"token property\">\"starName\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>        <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"keyword\"</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>      <span class=\"token property\">\"business\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"keyword\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        <span class=\"token property\">\"copy_to\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"all\"</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>      <span class=\"token property\">\"location\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>        <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"geo_point\"</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>      <span class=\"token property\">\"pic\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>        <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"keyword\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>        <span class=\"token property\">\"index\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>      <span class=\"token property\">\"all\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>        <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>        <span class=\"token property\">\"analyzer\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ik_max_word\"</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>3、初始化 JavaRestClient</p>\n<p>3.1、引入 es 的 RestHighLevelClient 依赖：</p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>   <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>org.elasticsearch.client<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>   <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>elasticsearch-rest-high-level-client<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>   <span class=\"token comment\">&lt;!-- 在 properties 中声明了版本在这里可以不加版本 --></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p>3.2、因为 SpringBoot 默认的 ES 版本是 7.6.2、所以我们需要覆盖默认的 ES 版本：</p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>properties</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>   <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>java.version</span><span class=\"token punctuation\">></span></span>1.8<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>java.version</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>   <span class=\"token comment\">&lt;!-- 使用 elasticsearch 必须在 properties 中强制声明版本号 --></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>   <span class=\"token comment\">&lt;!-- 统一控制 elasticsearch 版本号，是因为依赖内部的版本不统一 --></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>   <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>elasticsearch.version</span><span class=\"token punctuation\">></span></span>7.12.1<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>elasticsearch.version</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>properties</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p>3.3、初始化 RestHighLevelClient：</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@BeforeEach</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">setup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>client <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RestHighLevelClient</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">RestClient</span><span class=\"token punctuation\">.</span><span class=\"token function\">builder</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token class-name\">HttpHost</span><span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"http:/192.168.249.128:9200\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    微服务集群可以写多个</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    HttpHost.create (\"http:/192.168.249.128:9200\"),</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    HttpHost.create (\"http:/192.168.249.128:9200\"),</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    HttpHost.create (\"http:/192.168.249.128:9200\")</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    */</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>4、利用 JavaRestClient 创建索引库</p>\n<p>需要注意：dkx 这个索引库已经创建过了再创建就会报错如下：</p>\n<p>需要先将其删除后再进行测试</p>\n<pre><code>[dkx/CGJFBdUgTFCV46PbgurYiA] ElasticsearchStatusException[Elasticsearch exception [type=resource_already_exists_exception, reason=index [dkx/CGJFBdUgTFCV46PbgurYiA] already exists]\n]\n</code></pre>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310121425282.png\" alt=\"image-20231012142539675\"></p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Test</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">createHotelIndex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>   <span class=\"token comment\">// 1. 创建 Request 对象</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>   <span class=\"token class-name\">CreateIndexRequest</span> request <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">CreateIndexRequest</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"dkx\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>   <span class=\"token comment\">// 2. 准备请求的参数：DSL 语句</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>   <span class=\"token class-name\">String</span> msg<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>   <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>      <span class=\"token comment\">// 通过类路径来获取 hote.json 配置文件的绝对路径</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>      <span class=\"token class-name\">String</span> path <span class=\"token operator\">=</span> <span class=\"token class-name\">Thread</span><span class=\"token punctuation\">.</span><span class=\"token function\">currentThread</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getContextClassLoader</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getResource</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"hote.json\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getPath</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token comment\">// 如果获取绝对路径中含有中文可能会乱码所以需要进行编码处理</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      path <span class=\"token operator\">=</span> <span class=\"token class-name\">URLDecoder</span><span class=\"token punctuation\">.</span><span class=\"token function\">decode</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">,</span> <span class=\"token string\">\"utf-8\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>      <span class=\"token comment\">// 通过字符输入流来读取指定位置的 json 文件内容</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>      <span class=\"token class-name\">FileReader</span> reader <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FileReader</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>      msg <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>      <span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>      <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">=</span> reader<span class=\"token punctuation\">.</span><span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>      <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>         <span class=\"token comment\">// 将读取到的内容拼接到一个字符串中</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>         msg <span class=\"token operator\">+=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span><span class=\"token punctuation\">)</span>i<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>      <span class=\"token comment\">//msg 是读取的 json 文件里面是创建索引库的 DSL 语句</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>      request<span class=\"token punctuation\">.</span><span class=\"token function\">source</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">,</span> <span class=\"token class-name\">XContentType</span><span class=\"token punctuation\">.</span><span class=\"token constant\">JSON</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">IOException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>   <span class=\"token comment\">// 3. 发送请求</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>   <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>      client<span class=\"token punctuation\">.</span><span class=\"token function\">indices</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">,</span> <span class=\"token class-name\">RequestOptions</span><span class=\"token punctuation\">.</span><span class=\"token constant\">DEFAULT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">IOException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>hote.json</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token property\">\"mappings\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token property\">\"properties\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>      <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"keyword\"</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>      <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token property\">\"analyzer\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ik_max_word\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token property\">\"copy_to\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"all\"</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      <span class=\"token property\">\"address\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"keyword\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token property\">\"index\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>      <span class=\"token property\">\"price\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"integer\"</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>      <span class=\"token property\">\"score\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"integer\"</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>      <span class=\"token property\">\"brand\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"keyword\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token property\">\"copy_to\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"all\"</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>      <span class=\"token property\">\"city\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"keyword\"</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>      <span class=\"token property\">\"starName\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"keyword\"</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>      <span class=\"token property\">\"business\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"keyword\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        <span class=\"token property\">\"copy_to\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"all\"</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>      <span class=\"token property\">\"location\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>        <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"geo_point\"</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>      <span class=\"token property\">\"pic\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>        <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"keyword\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>        <span class=\"token property\">\"index\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>      <span class=\"token property\">\"all\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>        <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>        <span class=\"token property\">\"analyzer\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ik_max_word\"</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>在 kibana 中执行 GET 请求，请求 /dkx 索引库查看是否存在</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310121533685.png\" alt=\"image-20231012153324541\"></p>\n<p>5、利用 JavaRestClient 删除索引库</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Test</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">deleteHoteIndex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>   <span class=\"token comment\">// 1. 创建 Request 对象</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>   <span class=\"token class-name\">DeleteIndexRequest</span> request <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">DeleteIndexRequest</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"dkx\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>   <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>      <span class=\"token comment\">// 2. 发送请求</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>      client<span class=\"token punctuation\">.</span><span class=\"token function\">indices</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">delete</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">,</span> <span class=\"token class-name\">RequestOptions</span><span class=\"token punctuation\">.</span><span class=\"token constant\">DEFAULT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">IOException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>6、利用 JavaRestClient 判断索引库是否存在</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Test</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">exitHoteIndex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>   <span class=\"token comment\">// 1. 创建 Request 请求</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>   <span class=\"token class-name\">GetIndexRequest</span> request <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">GetIndexRequest</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"dkx\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>   <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>      <span class=\"token comment\">// 2. 发送请求</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>      <span class=\"token keyword\">boolean</span> exists <span class=\"token operator\">=</span> client<span class=\"token punctuation\">.</span><span class=\"token function\">indices</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">exists</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">,</span> <span class=\"token class-name\">RequestOptions</span><span class=\"token punctuation\">.</span><span class=\"token constant\">DEFAULT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>      <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>exists <span class=\"token operator\">?</span> <span class=\"token string\">\"存在\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"不存在\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">IOException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><blockquote>\n<p><strong>总结</strong>:</p>\n<p>索引库操作的基本步骤：</p>\n<ul>\n<li>初始化 RestHighLevelClient</li>\n<li>创建 XxxIndexRequest。Xxx 是 CREATE，Get，Delete</li>\n<li>准备 DSL (CREATE 时需要)</li>\n<li>发送请求。调用 RestHighLevelClient#indices ().xxx () 方法，xxx 是 create，exists，delete</li>\n</ul>\n</blockquote>\n<h4 id=\"987-restclient操作文档\"><a class=\"markdownIt-Anchor\" href=\"#987-restclient操作文档\">#</a> 9.8.7、RestClient 操作文档🌲</h4>\n<ul>\n<li>新增文档</li>\n<li>查询文档</li>\n<li>删除文档</li>\n<li>修改文档</li>\n<li>批量导入文档</li>\n</ul>\n<h5 id=\"9871-案例利用javarestclient实现文档的crud\"><a class=\"markdownIt-Anchor\" href=\"#9871-案例利用javarestclient实现文档的crud\">#</a> 9.8.7.1、案例，利用 JavaRestClient 实现文档的 CRUD🌴</h5>\n<p>去数据库查询酒店数据，导入到 dkx 索引库，实现酒店数据的 CRUD</p>\n<p><strong>基本步骤如下</strong>：</p>\n<p>1、初始化 JavaRestClient</p>\n<p>新建一个测试类，实现文档相关操作，并且完成 JavaRestClient 的初始化</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@SpringBootTest</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">HoteIndexTest1</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">RestHighLevelClient</span> client<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>   </pre></td></tr><tr><td data-num=\"5\"></td><td><pre> \t <span class=\"token annotation punctuation\">@BeforeEach</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">void</span> <span class=\"token function\">setup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>client <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RestHighLevelClient</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">RestClient</span><span class=\"token punctuation\">.</span><span class=\"token function\">builder</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>                <span class=\"token class-name\">HttpHost</span><span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"http://192.168.249.128:9200\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token annotation punctuation\">@AfterEach</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">void</span> <span class=\"token function\">tearDown</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>client<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">IOException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>2、利用 JavaRestClient 新增酒店数据</p>\n<p>先通过 mysql 查询酒店数据，然后给这条数据创建倒排索引，即可完成添加：</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Autowired</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">private</span> <span class=\"token class-name\">IHotelService</span> iHotelService<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token annotation punctuation\">@Test</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">testAddDocument</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>   <span class=\"token comment\">// 根据 id 查询酒店数据</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>   <span class=\"token class-name\">Hotel</span> byId <span class=\"token operator\">=</span> iHotelService<span class=\"token punctuation\">.</span><span class=\"token function\">getById</span><span class=\"token punctuation\">(</span><span class=\"token number\">36934L</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>   <span class=\"token comment\">// 转换为文档类型</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>   <span class=\"token class-name\">HotelDoc</span> hotelDoc <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HotelDoc</span><span class=\"token punctuation\">(</span>byId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>   <span class=\"token comment\">// 1. 准备 Request 对象</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>   <span class=\"token class-name\">IndexRequest</span> request <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">IndexRequest</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"dkx\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">id</span><span class=\"token punctuation\">(</span>hotelDoc<span class=\"token punctuation\">.</span><span class=\"token function\">getId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>   <span class=\"token comment\">// 2. 准备 JSON 文档</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>   request<span class=\"token punctuation\">.</span><span class=\"token function\">source</span><span class=\"token punctuation\">(</span><span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">toJSONString</span><span class=\"token punctuation\">(</span>hotelDoc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">XContentType</span><span class=\"token punctuation\">.</span><span class=\"token constant\">JSON</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>   <span class=\"token comment\">// 3. 发送请求</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>   <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>      client<span class=\"token punctuation\">.</span><span class=\"token function\">index</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">,</span> <span class=\"token class-name\">RequestOptions</span><span class=\"token punctuation\">.</span><span class=\"token constant\">DEFAULT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">IOException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310121557188.png\" alt=\"image-20231012155720876\"></p>\n<p>到 kibana 中通过命令：GET /dkx/_doc/36934 查看是否成功添加了</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310121638859.png\" alt=\"image-20231012163857506\"></p>\n<p>3、利用 JavaRestClient 根据 id 查询酒店数据</p>\n<p>根据 id 查询到的文档数据是 json，需要反序列化为 java 对象：</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Test</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">testGetDocumentById</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>   <span class=\"token comment\">// 1. 准备 Request</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>   <span class=\"token class-name\">GetRequest</span> request <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">GetRequest</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"dkx\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"36934\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>   <span class=\"token comment\">// 2. 发送请求，得到响应</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>   <span class=\"token class-name\">GetResponse</span> documentFields<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>   <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>      documentFields <span class=\"token operator\">=</span> client<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">,</span> <span class=\"token class-name\">RequestOptions</span><span class=\"token punctuation\">.</span><span class=\"token constant\">DEFAULT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">IOException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>   <span class=\"token comment\">// 3. 解析响应结果</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>   <span class=\"token class-name\">String</span> json <span class=\"token operator\">=</span> documentFields<span class=\"token punctuation\">.</span><span class=\"token function\">getSourceAsString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>   <span class=\"token comment\">// 通过 JSON.parseObject 将 json 数据解析为指定的对象</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>   <span class=\"token class-name\">HotelDoc</span> hotelDoc <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parseObject</span><span class=\"token punctuation\">(</span>json<span class=\"token punctuation\">,</span> <span class=\"token class-name\">HotelDoc</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>   <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>hotelDoc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token comment\">//--------------------- 打印结果 ---------------------</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token class-name\">HotelDoc</span><span class=\"token punctuation\">(</span>id<span class=\"token operator\">=</span><span class=\"token number\">36934</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span><span class=\"token number\">7</span>天连锁酒店<span class=\"token punctuation\">(</span>上海宝山路地铁站店<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> address<span class=\"token operator\">=</span>静安交通路<span class=\"token number\">40</span>号<span class=\"token punctuation\">,</span> price<span class=\"token operator\">=</span><span class=\"token number\">336</span><span class=\"token punctuation\">,</span> score<span class=\"token operator\">=</span><span class=\"token number\">37</span><span class=\"token punctuation\">,</span> brand<span class=\"token operator\">=</span><span class=\"token number\">7</span>天酒店<span class=\"token punctuation\">,</span> city<span class=\"token operator\">=</span>上海<span class=\"token punctuation\">,</span> starName<span class=\"token operator\">=</span>二钻<span class=\"token punctuation\">,</span> business<span class=\"token operator\">=</span>四川北路商业区<span class=\"token punctuation\">,</span> location<span class=\"token operator\">=</span><span class=\"token number\">31.251433</span><span class=\"token punctuation\">,</span> <span class=\"token number\">121.47522</span><span class=\"token punctuation\">,</span> pic<span class=\"token operator\">=</span>https<span class=\"token operator\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>m<span class=\"token punctuation\">.</span>tuniucdn<span class=\"token punctuation\">.</span>com<span class=\"token operator\">/</span>fb2<span class=\"token operator\">/</span>t1<span class=\"token operator\">/</span><span class=\"token constant\">G1</span><span class=\"token operator\">/</span><span class=\"token constant\">M00</span><span class=\"token operator\">/</span><span class=\"token number\">3</span>E<span class=\"token operator\">/</span><span class=\"token number\">40</span><span class=\"token operator\">/</span><span class=\"token class-name\">Cii9EVkyLrKIXo1vAAHgrxo_pUcAALcKQLD688AAeDH564_w200_h200_c1_t0</span><span class=\"token punctuation\">.</span>jpg<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310121629666.png\" alt=\"image-20231012162936320\"></p>\n<p>4、利用 JavaRestClient 删除酒店数据</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Test</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">testDeleteDocument</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>   <span class=\"token comment\">// 1. 准备 Request</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>   <span class=\"token class-name\">DeleteRequest</span> request <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">DeleteRequest</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"dkx\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"36934\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>   <span class=\"token comment\">// 2. 发送请求</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>   <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>      client<span class=\"token punctuation\">.</span><span class=\"token function\">delete</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">,</span> <span class=\"token class-name\">RequestOptions</span><span class=\"token punctuation\">.</span><span class=\"token constant\">DEFAULT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">IOException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310121659241.png\" alt=\"image-20231012165946036\"></p>\n<p>如果删除后再去通过 java 代码去查询返回结果就是 null</p>\n<p>5、利用 JavaRestClient 修改酒店数据</p>\n<p>修改文档数据有两种方式：</p>\n<p>方式一：全量更新。再次写入 id 一样的文档，就会删除旧文档，添加新文档，它的 java 代码和添加没有区别</p>\n<p>方式二：局部更新。只更新部分字段，我们演示方式二</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Test</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">testUpdateDocument</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>   <span class=\"token comment\">// 1. 准备 Request</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>   <span class=\"token class-name\">UpdateRequest</span> request <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">UpdateRequest</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"dkx\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"36934\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>   <span class=\"token comment\">// 2. 准备请求参数</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>   request<span class=\"token punctuation\">.</span><span class=\"token function\">doc</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>      <span class=\"token comment\">// 使用 逗号隔开 两个一对</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>      <span class=\"token string\">\"price\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"952\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>      <span class=\"token string\">\"starName\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"五钻\"</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>   <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>   <span class=\"token comment\">// 3. 发送请求</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>   <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>      client<span class=\"token punctuation\">.</span><span class=\"token function\">update</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">,</span> <span class=\"token class-name\">RequestOptions</span><span class=\"token punctuation\">.</span><span class=\"token constant\">DEFAULT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">IOException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310121643267.png\" alt=\"image-20231012164318114\"></p>\n<p>修改前通过 id 获取数据</p>\n<pre><code>HotelDoc(id=36934, name=7天连锁酒店(上海宝山路地铁站店), address=静安交通路40号, price=336, score=37, brand=7天酒店, city=上海, starName=二钻, business=四川北路商业区, location=31.251433, 121.47522, pic=https://m.tuniucdn.com/fb2/t1/G1/M00/3E/40/Cii9EVkyLrKIXo1vAAHgrxo_pUcAALcKQLD688AAeDH564_w200_h200_c1_t0.jpg)\n</code></pre>\n<p>修改后通过 id 获取数据</p>\n<pre><code>HotelDoc(id=36934, name=7天连锁酒店(上海宝山路地铁站店), address=静安交通路40号, price=952, score=37, brand=7天酒店, city=上海, starName=五钻, business=四川北路商业区, location=31.251433, 121.47522, pic=https://m.tuniucdn.com/fb2/t1/G1/M00/3E/40/Cii9EVkyLrKIXo1vAAHgrxo_pUcAALcKQLD688AAeDH564_w200_h200_c1_t0.jpg)\n</code></pre>\n<blockquote>\n<p><strong>总结</strong>：</p>\n<p>文档操作的基本步骤：</p>\n<ul>\n<li>初始化 RestHighLevelClient</li>\n<li>创建 XxxRequest。XXX 是 Index，Get，Update，Delete</li>\n<li>准备参数 (Index 和 Update 时需要)</li>\n<li>发送请求。调用 RestHighLevelClient#.xxx () 方法，xxx 是 Index，Get，Update，Delete</li>\n<li>解析结果 (Get 时需要)</li>\n</ul>\n</blockquote>\n<h4 id=\"988-案例利用javarestclient批量导入酒店数据到es\"><a class=\"markdownIt-Anchor\" href=\"#988-案例利用javarestclient批量导入酒店数据到es\">#</a> 9.8.8、案例，利用 JavaRestClient 批量导入酒店数据到 ES🌲</h4>\n<p>需求：批量查询酒店数据，然后批量导入索引库中</p>\n<p>思路：</p>\n<p>1、利用 mybatis-plus 查询酒店数据</p>\n<p>2、将查询到的酒店数据 (Hotel) 转换为 文档类型数据 (HotelDoc)</p>\n<p>3、利用 JavaRestClient 中的 Bulk 批处理，实现批量新增文档，示例代码如下</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@SpringBootTest</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">HoteIndexTest1</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">RestHighLevelClient</span> client<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token annotation punctuation\">@Autowired</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">IHotelService</span> iHotelService<span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t <span class=\"token annotation punctuation\">@Test</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">testBulkRequest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token comment\">// 批量查询酒店数据</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Hotel</span><span class=\"token punctuation\">></span></span> hotels <span class=\"token operator\">=</span> iHotelService<span class=\"token punctuation\">.</span><span class=\"token function\">list</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token comment\">// 1. 创建 Request</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token class-name\">BulkRequest</span> request <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">BulkRequest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token comment\">// 2. 准备参数，添加多个新增的 Request</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token comment\">// 2.1 对查询出的酒店数据进行遍历</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Hotel</span> hotel<span class=\"token operator\">:</span> hotels<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            <span class=\"token comment\">// 转换为文档类型 HotelDoc</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>            <span class=\"token class-name\">HotelDoc</span> hotelDoc <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HotelDoc</span><span class=\"token punctuation\">(</span>hotel<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>            <span class=\"token comment\">// 创建新增文档的 Request 对象</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>            request<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">IndexRequest</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"dkx\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>                    <span class=\"token punctuation\">.</span><span class=\"token function\">id</span><span class=\"token punctuation\">(</span>hotel<span class=\"token punctuation\">.</span><span class=\"token function\">getId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>                    <span class=\"token punctuation\">.</span><span class=\"token function\">source</span><span class=\"token punctuation\">(</span><span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">toJSONString</span><span class=\"token punctuation\">(</span>hotelDoc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">XContentType</span><span class=\"token punctuation\">.</span><span class=\"token constant\">JSON</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        <span class=\"token comment\">// 3. 发送请求</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>            client<span class=\"token punctuation\">.</span><span class=\"token function\">bulk</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">,</span> <span class=\"token class-name\">RequestOptions</span><span class=\"token punctuation\">.</span><span class=\"token constant\">DEFAULT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">IOException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span>   </pre></td></tr><tr><td data-num=\"32\"></td><td><pre>\t<span class=\"token annotation punctuation\">@BeforeEach</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token keyword\">void</span> <span class=\"token function\">setup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>client <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RestHighLevelClient</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">RestClient</span><span class=\"token punctuation\">.</span><span class=\"token function\">builder</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>                <span class=\"token class-name\">HttpHost</span><span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"http://192.168.249.128:9200\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    <span class=\"token annotation punctuation\">@AfterEach</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    <span class=\"token keyword\">void</span> <span class=\"token function\">tearDown</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>client<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">IOException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>到 kibana 页面通过命令：GET /dkx/_search 查看结果</p>\n<p>可以看到查询出了 201 条数据</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310121723744.png\" alt=\"image-20231012172343307\"></p>\n<h3 id=\"99-dsl查询文档\"><a class=\"markdownIt-Anchor\" href=\"#99-dsl查询文档\">#</a> 9.9、DSL 查询文档🌳</h3>\n<ul>\n<li>DSL 查询分类</li>\n<li>全文检索查询</li>\n<li>精准查询</li>\n<li>地理坐标查询</li>\n<li>组合查询</li>\n</ul>\n<h4 id=\"991-dsl-query的分类\"><a class=\"markdownIt-Anchor\" href=\"#991-dsl-query的分类\">#</a> 9.9.1、DSL Query 的分类🌲</h4>\n<p>Elasticsearch 提供了基于 JSON 的 DSL (Domain Specific Language) 来定义查询。常见的查询类型包括：</p>\n<ul>\n<li>查询所有：查询出所有数据，一般测试用。例如：match_all</li>\n<li>全文检索 (full text) 查询：利用分词器对用户输入内容分词，然后去倒排索引库中匹配。例如：\n<ul>\n<li>match_query</li>\n<li>multi_match_query</li>\n</ul>\n</li>\n<li>精确查询：根据精确词条值查找数据，一般是查找 keyword，数值，日期，boolean 等类型字段。例如：\n<ul>\n<li>ids</li>\n<li>range</li>\n<li>term</li>\n</ul>\n</li>\n<li>地理 (geo) 查询：根据经纬度查询。例如：\n<ul>\n<li>geo_distance</li>\n<li>geo_bounding_box</li>\n</ul>\n</li>\n<li>复合 (compound) 查询：复合查询可以将上述各种查询条件组合起来，合并查询条件。例如：\n<ul>\n<li>bool</li>\n<li>function_score</li>\n</ul>\n</li>\n</ul>\n<h5 id=\"9911-dsl-query基本语法\"><a class=\"markdownIt-Anchor\" href=\"#9911-dsl-query基本语法\">#</a> 9.9.1.1、DSL Query 基本语法🌴</h5>\n<p>查询的基本语法如下：</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>GET /indexName/_search</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>   <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>      <span class=\"token property\">\"查询类型\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>         <span class=\"token property\">\"查询条件\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"条件值\"</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310121738538.png\" alt=\"image-20231012173803886\"></p>\n<blockquote>\n<p>总结：</p>\n<p>查询 DSL 的基本语法是什么？</p>\n<ul>\n<li>GET / 索引库名 /_search</li>\n<li>{“query”: {“查询类型”:{“FIELD”:”TEXT”}}}</li>\n</ul>\n</blockquote>\n<h4 id=\"992-全文检索查询\"><a class=\"markdownIt-Anchor\" href=\"#992-全文检索查询\">#</a> 9.9.2、全文检索查询🌲</h4>\n<p>match 查询：全文检索查询的一种，会对用户输入内容分词，然后去倒排索引检索，语法：</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>GET /indexName/_search</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>   <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>      <span class=\"token property\">\"match\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>         <span class=\"token property\">\"FIELD\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"TEXT\"</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310121802836.png\" alt=\"image-20231012180230588\"></p>\n<p>multi_match：与 match 查询类似，只不过允许同时查询多个字段，语法：</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>GET /indexName/_search</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>   <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>      <span class=\"token property\">\"multi_match\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>         <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"TEXT\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>         <span class=\"token property\">\"fields\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"FIELD1\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"FIELD12\"</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310121933446.png\" alt=\"image-20231012193303357\"></p>\n<blockquote>\n<p><strong>总结</strong>：</p>\n<p>match 和 muliti_match 的区别是什么？</p>\n<ul>\n<li>match：根据一个字段查询</li>\n<li>multi_match：根据多个字段查询，参与查询字段越多，查询性能越差</li>\n</ul>\n</blockquote>\n<h4 id=\"993-精确查询\"><a class=\"markdownIt-Anchor\" href=\"#993-精确查询\">#</a> 9.9.3、精确查询🌲</h4>\n<p>精确查询一般是查找 keyword，数值，日期，boolean 等类型字段。所以<mark>不会</mark>对搜索条件分词。常见的有：</p>\n<ul>\n<li>term：根据词条精确值查询</li>\n<li>range：根据值的范围查询</li>\n</ul>\n<h5 id=\"9931-精确查询-语法\"><a class=\"markdownIt-Anchor\" href=\"#9931-精确查询-语法\">#</a> 9.9.3.1、精确查询 - 语法🌴</h5>\n<p>精确查询一般是根据 id，数值，keyword 类型，或布尔字段来查询。语法如下：</p>\n<p>term 查询：</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">//term 查询</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>GET /indexName/_search</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>   <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>      <span class=\"token property\">\"term\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>         <span class=\"token property\">\"FIELD\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"VLAUE\"</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>         <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310121959434.png\" alt=\"image-20231012195904980\"></p>\n<p>range 查询：</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">//range 查询</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>GET /indexName/_search</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>   <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>      <span class=\"token property\">\"range\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>         <span class=\"token property\">\"FIELD\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>           <span class=\"token property\">\"gte\"</span><span class=\"token operator\">:</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>           <span class=\"token property\">\"lte\"</span><span class=\"token operator\">:</span> <span class=\"token number\">20</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>         <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310122000353.png\" alt=\"image-20231012200031386\"></p>\n<blockquote>\n<p><strong>总结</strong>：</p>\n<p>精确查询常见的有哪些？</p>\n<ul>\n<li>term 查询：根据词条精确匹配，一般搜索 keyword 类型，数值类型，布尔类型，日期类型字段</li>\n<li>range 查询：根据数值范围查询，可以是数值，日期的范围</li>\n</ul>\n</blockquote>\n<h4 id=\"994-地理查询\"><a class=\"markdownIt-Anchor\" href=\"#994-地理查询\">#</a> 9.9.4、地理查询🌲</h4>\n<p>根据经纬度查询。常见的使用场景包括：</p>\n<ul>\n<li>携程：搜索我附近的酒店</li>\n<li>滴滴：搜索我附近的出租车</li>\n<li>微信：搜索我附近的人</li>\n</ul>\n<p>根据经纬度查询，例如：</p>\n<ul>\n<li>geo_bounding_box：查询 geo_point 值落在某个矩形范围的所有文档</li>\n</ul>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">//geo_bounding_box 查询</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>GET /indexName/_search</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>   <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>      <span class=\"token property\">\"geo_bounding_box\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>         <span class=\"token property\">\"FIELD\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            <span class=\"token property\">\"top_left\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>               <span class=\"token property\">\"lat\"</span><span class=\"token operator\">:</span> <span class=\"token number\">31.1</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>           \t\t<span class=\"token property\">\"lon\"</span><span class=\"token operator\">:</span> <span class=\"token number\">121.5</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>            <span class=\"token property\">\"bottom_right\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>               <span class=\"token property\">\"lat\"</span><span class=\"token operator\">:</span> <span class=\"token number\">30.9</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>               <span class=\"token property\">\"lon\"</span><span class=\"token operator\">:</span> <span class=\"token number\">121.7</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>         <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>在搜索的时候根据 “top_left” 和 “bottom_right” 两个点分别画一个横线和竖线 的 经纬度进行相交形成的一个矩形范围</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310122020535.png\" alt=\"image-20231012202007403\"></p>\n<p>根据经纬度查询，例如：</p>\n<ul>\n<li>geo_distance：查询到指定中心点小于某个距离值的所有文档</li>\n</ul>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">//geo_distance 查询</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>GET /indexName/_search</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>   <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>      <span class=\"token property\">\"geo_distance\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>         <span class=\"token property\">\"distance\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"15km\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>         <span class=\"token property\">\"FIELD\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"31.21,121.5\"</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310131024931.png\" alt=\"image-20231013102411621\"></p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310122027316.png\" alt=\"image-20231012202733050\"></p>\n<h4 id=\"995-复合查询\"><a class=\"markdownIt-Anchor\" href=\"#995-复合查询\">#</a> 9.9.5、复合查询🌲</h4>\n<p>复合 (compound) 查询：复合查询可以将其它简单查询组合起来，实现更复杂的搜索逻辑，例如：</p>\n<ul>\n<li>fuction score：算分函数查询，可以控制文档相关性算分，控制文档排名。例如百度竞价</li>\n</ul>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310130800939.png\" alt=\"image-20231013080014517\"></p>\n<p>例如，我们搜索 “虹桥如家” ，结果如下：</p>\n<p>这个词在第一条文档中出现了一次，而这个文档中词条的总数是：5</p>\n<p>所以词条频率就是 1 / 5 = 0.2 分。词条出现的频率越多得分越高</p>\n<p>证明你跟这个词相关性也越高</p>\n<p>但是有个问题：</p>\n<p>如家这个词在这几篇文档中都有出现，那再去吧这个 “如家” 进行累加还有意义吗？。没有意义</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310130801156.png\" alt=\"image-20231013080054602\"></p>\n<p>所以我们就引入一个新的算法：TFIDF 算法</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310130807792.png\" alt=\"image-20231013080723131\"></p>\n<p>我们以如家为例，那么包含如家的文档有三个，而文档总数也是三那 3 /3 = 1 那 Log/1 = 0 。那代表如家这个权重就是 0 。那相反虹桥这个词支出现在一个文档中，所以分母就是 1 ，而文档总数是 3 所以结果就是 3</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310130812773.png\" alt=\"image-20231013081248428\"></p>\n<p>这个算法也是去做累加只不过它在做 tf 和 idf 的时候算法上面会更加复杂一点，为什么要演变一种新的算法呢？</p>\n<p>是因为这种算法它不会受词频影响较大</p>\n<p>在传统的 tf 算法中词频越高，将来得分会无限增加。会越来越高，但是 BM25 算法呢，最终的分会趋于一个水平，也就是它不会无限增长。所以相对来讲这种算法会更好一点得分会更平和一点。因此在 ES 高版本中都会采用默认都会采用 BM25 算法</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310130817842.png\" alt=\"image-20231013081755494\"></p>\n<blockquote>\n<p><strong>总结</strong>：</p>\n<p>elasticsearch 中的相关性打分算法是什么？</p>\n<ul>\n<li>TF-IDF：在 elasticsearch5.0 之前，会随着词频增加而越来越大</li>\n<li>BM25：在 elasticsearch5.0 之后，会随着词频增加而增大，但增长曲线会趋于水平</li>\n</ul>\n</blockquote>\n<h5 id=\"9961-function-score-query\"><a class=\"markdownIt-Anchor\" href=\"#9961-function-score-query\">#</a> 9.9.6.1、Function Score Query🌴</h5>\n<p>使用 fucntion score query ，可以修改文档的相关性算分 (query score) ，根据新得到的算分排序。</p>\n<blockquote>\n<p>我们知道 ES 在搜索文档的时候会对文档做相关性的一个打分，文档与搜索关键字的相关度越高那么打分就自然就越高。排名也会越靠前。不过有些时候我们希望人为的去控制文档的排名，比如说有部分文档人家掏钱了我就让它排名靠前一点，算分高一点那么这个时候就要用到 Function Score Query 了。这个查询可以在原始的相关性算法的基础上加以修改得到一个想要的算分从而去影响文档的排名</p>\n</blockquote>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310130933092.png\" alt=\"image-20231013093343922\"></p>\n<h6 id=\"99611-案例给-如家-这个品牌的酒店排名靠前一些\"><a class=\"markdownIt-Anchor\" href=\"#99611-案例给-如家-这个品牌的酒店排名靠前一些\">#</a> 9.9.6.1.1、案例，给 “如家” 这个品牌的酒店排名靠前一些🎋</h6>\n<p>把这个问题翻译一下，function score 需要的三要素：</p>\n<p>1、哪些文档需要算分加权？</p>\n<ul>\n<li>品牌为如家的酒店</li>\n</ul>\n<p>2、算分函数是什么？</p>\n<ul>\n<li>weight 就可以</li>\n</ul>\n<p>3、加权模式是什么？</p>\n<ul>\n<li>求和</li>\n</ul>\n<p>先正常的进行查询查看结果</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>GET /dkx/_search</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token property\">\"function_score\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>      <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token property\">\"match\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>          <span class=\"token property\">\"all\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"外滩\"</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>结果</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token property\">\"took\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">61</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token property\">\"timed_out\"</span> <span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token property\">\"_shards\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token property\">\"total\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token property\">\"successful\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token property\">\"skipped\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token property\">\"failed\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  <span class=\"token property\">\"hits\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token property\">\"total\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      <span class=\"token property\">\"value\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>      <span class=\"token property\">\"relation\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"eq\"</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token property\">\"max_score\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">6.024319</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token property\">\"hits\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>      <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token property\">\"_index\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"dkx\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token property\">\"_type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"_doc\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token property\">\"_id\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"60487\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token property\">\"_score\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">6.024319</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token property\">\"_source\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>          <span class=\"token property\">\"address\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"黄浦路199号\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>          <span class=\"token property\">\"brand\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"君悦\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>          <span class=\"token property\">\"business\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"外滩地区\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>          <span class=\"token property\">\"city\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"上海\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>          <span class=\"token property\">\"id\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">60487</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>          <span class=\"token property\">\"latitude\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"31.245409\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>          <span class=\"token property\">\"longitude\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"121.492969\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>          <span class=\"token property\">\"name\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"上海外滩茂悦大酒店\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>          <span class=\"token property\">\"pic\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"https://m.tuniucdn.com/fb3/s1/2n9c/2Swp2h1fdj9zCUKsk63BQvVgKLTo_w200_h200_c1_t0.jpg\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>          <span class=\"token property\">\"price\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">689</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>          <span class=\"token property\">\"score\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">44</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>          <span class=\"token property\">\"starName\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"五星级\"</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>      <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>        <span class=\"token property\">\"_index\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"dkx\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>        <span class=\"token property\">\"_type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"_doc\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>        <span class=\"token property\">\"_id\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"432335\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>        <span class=\"token property\">\"_score\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">4.849986</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>        <span class=\"token property\">\"_source\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>          <span class=\"token property\">\"address\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"唐山路145号\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>          <span class=\"token property\">\"brand\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"7天酒店\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>          <span class=\"token property\">\"business\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"北外滩地区\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>          <span class=\"token property\">\"city\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"上海\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>          <span class=\"token property\">\"id\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">432335</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>          <span class=\"token property\">\"latitude\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"31.252585\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>          <span class=\"token property\">\"longitude\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"121.498753\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>          <span class=\"token property\">\"name\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"7天连锁酒店(上海北外滩国际客运中心地铁站店)\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>          <span class=\"token property\">\"pic\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"https://m2.tuniucdn.com/filebroker/cdn/res/c1/ba/c1baf64418437c56617f89840c6411ef_w200_h200_c1_t0.jpg\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>          <span class=\"token property\">\"price\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">249</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>          <span class=\"token property\">\"score\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">35</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>          <span class=\"token property\">\"starName\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"二钻\"</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>      <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>        <span class=\"token property\">\"_index\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"dkx\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>        <span class=\"token property\">\"_type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"_doc\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>        <span class=\"token property\">\"_id\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"434082\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>        <span class=\"token property\">\"_score\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">3.8909411</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>        <span class=\"token property\">\"_source\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>          <span class=\"token property\">\"address\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"复兴东路260号\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>          <span class=\"token property\">\"brand\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"如家\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>          <span class=\"token property\">\"business\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"豫园地区\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>          <span class=\"token property\">\"city\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"上海\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>          <span class=\"token property\">\"id\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">434082</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>          <span class=\"token property\">\"latitude\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"31.220706\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>          <span class=\"token property\">\"longitude\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"121.498769\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>          <span class=\"token property\">\"name\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"如家酒店·neo(上海外滩城隍庙小南门地铁站店)\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>          <span class=\"token property\">\"pic\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"https://m.tuniucdn.com/fb2/t1/G6/M00/52/B6/Cii-U13eXLGIdHFzAAIG-5cEwDEAAGRfQNNIV0AAgcT627_w200_h200_c1_t0.jpg\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>          <span class=\"token property\">\"price\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">392</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>          <span class=\"token property\">\"score\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">44</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>          <span class=\"token property\">\"starName\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"二钻\"</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>    <span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>可以看到 “如家酒店” 排在最后一个我们通过下面的代码让其排名为第一</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>GET /dkx/_search</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token property\">\"function_score\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>      <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token property\">\"match\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>          <span class=\"token property\">\"all\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"外滩\"</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>      <span class=\"token property\">\"functions\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span> <span class=\"token comment\">// 算分函数</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>          <span class=\"token property\">\"filter\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token comment\">// 满足的条件，品牌必须是如家</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>            <span class=\"token property\">\"term\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>              <span class=\"token property\">\"brand\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"如家\"</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>          <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>          <span class=\"token property\">\"weight\"</span><span class=\"token operator\">:</span> <span class=\"token number\">10</span> <span class=\"token comment\">// 算分权重为 10</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>      <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>      <span class=\"token property\">\"boost_mode\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"sum\"</span> <span class=\"token comment\">// 算分模式使用 fucntion_score 与 query_score 相除的方式算分</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>结果：</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token property\">\"took\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">72</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token property\">\"timed_out\"</span> <span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token property\">\"_shards\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token property\">\"total\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token property\">\"successful\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token property\">\"skipped\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token property\">\"failed\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  <span class=\"token property\">\"hits\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token property\">\"total\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      <span class=\"token property\">\"value\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>      <span class=\"token property\">\"relation\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"eq\"</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token property\">\"max_score\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">13.890942</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token property\">\"hits\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>      <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token property\">\"_index\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"dkx\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token property\">\"_type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"_doc\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token property\">\"_id\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"434082\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token property\">\"_score\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">13.890942</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token property\">\"_source\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>          <span class=\"token property\">\"address\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"复兴东路260号\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>          <span class=\"token property\">\"brand\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"如家\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>          <span class=\"token property\">\"business\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"豫园地区\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>          <span class=\"token property\">\"city\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"上海\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>          <span class=\"token property\">\"id\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">434082</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>          <span class=\"token property\">\"latitude\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"31.220706\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>          <span class=\"token property\">\"longitude\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"121.498769\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>          <span class=\"token property\">\"name\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"如家酒店·neo(上海外滩城隍庙小南门地铁站店)\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>          <span class=\"token property\">\"pic\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"https://m.tuniucdn.com/fb2/t1/G6/M00/52/B6/Cii-U13eXLGIdHFzAAIG-5cEwDEAAGRfQNNIV0AAgcT627_w200_h200_c1_t0.jpg\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>          <span class=\"token property\">\"price\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">392</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>          <span class=\"token property\">\"score\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">44</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>          <span class=\"token property\">\"starName\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"二钻\"</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>      <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>        <span class=\"token property\">\"_index\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"dkx\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>        <span class=\"token property\">\"_type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"_doc\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>        <span class=\"token property\">\"_id\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"60487\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>        <span class=\"token property\">\"_score\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">7.024319</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>        <span class=\"token property\">\"_source\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>          <span class=\"token property\">\"address\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"黄浦路199号\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>          <span class=\"token property\">\"brand\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"君悦\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>          <span class=\"token property\">\"business\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"外滩地区\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>          <span class=\"token property\">\"city\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"上海\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>          <span class=\"token property\">\"id\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">60487</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>          <span class=\"token property\">\"latitude\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"31.245409\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>          <span class=\"token property\">\"longitude\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"121.492969\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>          <span class=\"token property\">\"name\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"上海外滩茂悦大酒店\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>          <span class=\"token property\">\"pic\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"https://m.tuniucdn.com/fb3/s1/2n9c/2Swp2h1fdj9zCUKsk63BQvVgKLTo_w200_h200_c1_t0.jpg\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>          <span class=\"token property\">\"price\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">689</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>          <span class=\"token property\">\"score\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">44</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>          <span class=\"token property\">\"starName\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"五星级\"</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>      <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>        <span class=\"token property\">\"_index\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"dkx\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>        <span class=\"token property\">\"_type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"_doc\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>        <span class=\"token property\">\"_id\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"432335\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>        <span class=\"token property\">\"_score\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">5.849986</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>        <span class=\"token property\">\"_source\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>          <span class=\"token property\">\"address\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"唐山路145号\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>          <span class=\"token property\">\"brand\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"7天酒店\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>          <span class=\"token property\">\"business\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"北外滩地区\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>          <span class=\"token property\">\"city\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"上海\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>          <span class=\"token property\">\"id\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">432335</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>          <span class=\"token property\">\"latitude\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"31.252585\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>          <span class=\"token property\">\"longitude\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"121.498753\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>          <span class=\"token property\">\"name\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"7天连锁酒店(上海北外滩国际客运中心地铁站店)\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>          <span class=\"token property\">\"pic\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"https://m2.tuniucdn.com/filebroker/cdn/res/c1/ba/c1baf64418437c56617f89840c6411ef_w200_h200_c1_t0.jpg\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>          <span class=\"token property\">\"price\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">249</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>          <span class=\"token property\">\"score\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">35</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>          <span class=\"token property\">\"starName\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"二钻\"</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>    <span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><blockquote>\n<p><strong>总结</strong>:</p>\n<p>function score query 定义的三要素是什么？</p>\n<ul>\n<li>过滤条件：哪些文档要加分</li>\n<li>算分函数：如何计算 function score</li>\n<li>加权方式：function score 与 query score 如何运算</li>\n</ul>\n</blockquote>\n<h5 id=\"9962-boolean-query\"><a class=\"markdownIt-Anchor\" href=\"#9962-boolean-query\">#</a> 9.9.6.2、Boolean Query🌴</h5>\n<p>布尔查询是一个或多个查询子句的组合。子查询的组合方式有：</p>\n<ul>\n<li>must：必须匹配每个子查询，类似 “与”</li>\n<li>should：选择性匹配子查询，类似 “或”</li>\n<li>must_not：必须不匹配，不参与算分，类似 “非”</li>\n<li>filter：必须匹配，不参与算分</li>\n</ul>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>GET /indexName/_seach</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>   <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>      <span class=\"token property\">\"bool\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>         <span class=\"token comment\">//must 里面是一个数组也就是说可以定义多个查询条件</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>         <span class=\"token property\">\"must\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span> <span class=\"token comment\">// 要求查询的城市必须 是 \"上海\"</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            <span class=\"token punctuation\">&#123;</span><span class=\"token property\">\"term\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span><span class=\"token property\">\"city\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"上海\"</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>         <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>         <span class=\"token property\">\"should\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span> <span class=\"token comment\">// 两个品牌中的任意一个都可以因为是 \"或\" 的关系 一个有表示为 true</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>            <span class=\"token punctuation\">&#123;</span><span class=\"token property\">\"term\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span><span class=\"token property\">\"brand\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"皇冠假日\"</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>            <span class=\"token punctuation\">&#123;</span><span class=\"token property\">\"term\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span><span class=\"token property\">\"brand\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"华美达\"</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>         <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>         <span class=\"token property\">\"must_not\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span> <span class=\"token comment\">// 取反，lte 是小于等于，由于取反操作 所以是查询价格 大于等于 500 的</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>            <span class=\"token punctuation\">&#123;</span><span class=\"token property\">\"range\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span><span class=\"token property\">\"price\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span><span class=\"token property\">\"lte\"</span><span class=\"token operator\">:</span> <span class=\"token number\">500</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>         <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>         <span class=\"token property\">\"filter\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span> <span class=\"token comment\">// 过滤，查询用户评价分大于 45 分的</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            <span class=\"token punctuation\">&#123;</span><span class=\"token property\">\"range\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span><span class=\"token property\">\"score\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span><span class=\"token property\">\"gte\"</span><span class=\"token operator\">:</span> <span class=\"token number\">45</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>         <span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h6 id=\"99621-利用bool查询实现功能\"><a class=\"markdownIt-Anchor\" href=\"#99621-利用bool查询实现功能\">#</a> 9.9.6.2.1、利用 bool 查询实现功能🎋</h6>\n<p><strong>需求</strong>：搜索名字包含 “如家” ， 价格不高于 400，在坐标 31.21，121.5 周围 10km 范围内的酒店。</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>GET /dkx/_search <span class=\"token comment\">// GET 请求 / 索引库名 / 查询全部文档</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token comment\">// </span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token property\">\"bool\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>      <span class=\"token property\">\"must\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>          <span class=\"token property\">\"match\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"如家\"</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>          <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      <span class=\"token property\">\"must_not\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>          <span class=\"token property\">\"range\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            <span class=\"token property\">\"price\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>              <span class=\"token property\">\"gt\"</span><span class=\"token operator\">:</span> <span class=\"token number\">400</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>          <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>      <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>      <span class=\"token property\">\"filter\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>          <span class=\"token property\">\"geo_distance\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>            <span class=\"token property\">\"distance\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"10km\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>            <span class=\"token property\">\"location\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>              <span class=\"token property\">\"lat\"</span><span class=\"token operator\">:</span> <span class=\"token number\">31.21</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>              <span class=\"token property\">\"lon\"</span><span class=\"token operator\">:</span> <span class=\"token number\">121.5</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>          <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>      <span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>结果：</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token property\">\"took\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">173</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token property\">\"timed_out\"</span> <span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token property\">\"_shards\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token property\">\"total\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token property\">\"successful\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token property\">\"skipped\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token property\">\"failed\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  <span class=\"token property\">\"hits\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token property\">\"total\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      <span class=\"token property\">\"value\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>      <span class=\"token property\">\"relation\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"eq\"</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token property\">\"max_score\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">1.716119</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token property\">\"hits\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>      <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token property\">\"_index\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"dkx\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token property\">\"_type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"_doc\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token property\">\"_id\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"433576\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token property\">\"_score\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">1.716119</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token property\">\"_source\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>          <span class=\"token property\">\"address\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"南京东路480号保安坊内\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>          <span class=\"token property\">\"brand\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"如家\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>          <span class=\"token property\">\"business\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"人民广场地区\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>          <span class=\"token property\">\"city\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"上海\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>          <span class=\"token property\">\"id\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">433576</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>          <span class=\"token property\">\"location\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"31.236454, 121.480948\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>          <span class=\"token property\">\"name\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"如家酒店(上海南京路步行街店)\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>          <span class=\"token property\">\"pic\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"https://m.tuniucdn.com/fb2/t1/G6/M00/52/BA/Cii-U13eXVaIQmdaAAWxgzdXXxEAAGRrgNIOkoABbGb143_w200_h200_c1_t0.jpg\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>          <span class=\"token property\">\"price\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">379</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>          <span class=\"token property\">\"score\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">44</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>          <span class=\"token property\">\"starName\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"二钻\"</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>      <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>        <span class=\"token property\">\"_index\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"dkx\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>        <span class=\"token property\">\"_type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"_doc\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>        <span class=\"token property\">\"_id\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"434082\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>        <span class=\"token property\">\"_score\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">1.5234909</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>        <span class=\"token property\">\"_source\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>          <span class=\"token property\">\"address\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"复兴东路260号\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>          <span class=\"token property\">\"brand\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"如家\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>          <span class=\"token property\">\"business\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"豫园地区\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>          <span class=\"token property\">\"city\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"上海\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>          <span class=\"token property\">\"id\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">434082</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>          <span class=\"token property\">\"location\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"31.220706, 121.498769\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>          <span class=\"token property\">\"name\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"如家酒店·neo(上海外滩城隍庙小南门地铁站店)\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>          <span class=\"token property\">\"pic\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"https://m.tuniucdn.com/fb2/t1/G6/M00/52/B6/Cii-U13eXLGIdHFzAAIG-5cEwDEAAGRfQNNIV0AAgcT627_w200_h200_c1_t0.jpg\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>          <span class=\"token property\">\"price\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">392</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>          <span class=\"token property\">\"score\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">44</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>          <span class=\"token property\">\"starName\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"二钻\"</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>      <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>        <span class=\"token property\">\"_index\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"dkx\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>        <span class=\"token property\">\"_type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"_doc\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>        <span class=\"token property\">\"_id\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"1584362548\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>        <span class=\"token property\">\"_score\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">1.4174237</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>        <span class=\"token property\">\"_source\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>          <span class=\"token property\">\"address\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"御青路315-317号\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>          <span class=\"token property\">\"brand\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"如家\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>          <span class=\"token property\">\"business\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"周浦康桥地区\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>          <span class=\"token property\">\"city\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"上海\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>          <span class=\"token property\">\"id\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">1584362548</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>          <span class=\"token property\">\"location\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"31.15719, 121.572392\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>          <span class=\"token property\">\"name\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"如家酒店(上海浦东国际旅游度假区御桥地铁站店)\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>          <span class=\"token property\">\"pic\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"https://m.tuniucdn.com/fb3/s1/2n9c/2ybd3wqdoBtBeKcPxmyso9y1hNXa_w200_h200_c1_t0.jpg\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>          <span class=\"token property\">\"price\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">339</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>          <span class=\"token property\">\"score\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">44</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>          <span class=\"token property\">\"starName\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"二钻\"</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>    <span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><blockquote>\n<p><strong>总结</strong>：</p>\n<p>bool 查询有几种逻辑关系？</p>\n<ul>\n<li>must：必须匹配的条件，可以理解为 “与”</li>\n<li>should：选择性匹配的条件，可以理解为 “或”</li>\n<li>must_not：必须不匹配的条件，不参与打分</li>\n<li>filter：必须匹配的条件，不参与打分</li>\n</ul>\n</blockquote>\n<h4 id=\"996-搜索结果处理\"><a class=\"markdownIt-Anchor\" href=\"#996-搜索结果处理\">#</a> 9.9.6、搜索结果处理🌲</h4>\n<ul>\n<li>排序</li>\n<li>分页</li>\n<li>高亮</li>\n</ul>\n<h5 id=\"9961-排序\"><a class=\"markdownIt-Anchor\" href=\"#9961-排序\">#</a> 9.9.6.1、排序🌴</h5>\n<p>elasticsearch 支持对搜索结果排序，默认是根据相关度算分 (_score) 来排序。可以排序字段类型有：keyword 类型，数值类型，地理坐标类型，日期类型等。</p>\n<p><strong><font color='red'>注意</font>.</strong>：一旦进行排序 score 就会放弃打分，因为打分就没有意义了</p>\n<p>字段</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>GET /indexName/_search</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>   <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>      <span class=\"token property\">\"match_all\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>   <span class=\"token property\">\"sort\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>      <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>         <span class=\"token property\">\"FIELD\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"desc\"</span> <span class=\"token comment\">// 排序字段和排序方式 ASC , DESC</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>   <span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>地理坐标</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>GET /indexName/_search</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>   <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>      <span class=\"token property\">\"match_all\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>   <span class=\"token property\">\"sort\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>      <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>         <span class=\"token property\">\"_geo_distance\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            <span class=\"token property\">\"FIELD\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"纬度，经度\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>            <span class=\"token property\">\"order\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"asc\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>            <span class=\"token property\">\"unit\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"km\"</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>         <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>   <span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h6 id=\"99611-案例对酒店数据按照用户评价降序排序评价相同的按照价格升序排序\"><a class=\"markdownIt-Anchor\" href=\"#99611-案例对酒店数据按照用户评价降序排序评价相同的按照价格升序排序\">#</a> 9.9.6.1.1、案例，对酒店数据按照用户评价降序排序，评价相同的按照价格升序排序🎋</h6>\n<p>评价是 score 字段，价格是 price 字段，按照顺序添加两个排序规则即可。</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>GET /dkx/_search</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token property\">\"match_all\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token property\">\"sort\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>      <span class=\"token property\">\"score\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"desc\"</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token property\">\"price\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"asc\"</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>  <span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h6 id=\"99612-案例实现对酒店数据按照到你的位置坐标距离升序排序\"><a class=\"markdownIt-Anchor\" href=\"#99612-案例实现对酒店数据按照到你的位置坐标距离升序排序\">#</a> 9.9.6.1.2、案例，实现对酒店数据按照到你的位置坐标距离升序排序🎋</h6>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre># 找到 <span class=\"token number\">31.034661</span><span class=\"token punctuation\">,</span> <span class=\"token number\">121.612282</span> 周围的酒店，距离升序排序</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>GET /dkx/_search</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token property\">\"match_all\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token property\">\"sort\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>      <span class=\"token property\">\"_geo_distance\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        # location的两种写法都可以</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        # <span class=\"token property\">\"location\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"31.034661, 121.612282\"</span><span class=\"token punctuation\">,</span> </pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token property\">\"location\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>          <span class=\"token property\">\"lat\"</span><span class=\"token operator\">:</span> <span class=\"token number\">31.034661</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>          <span class=\"token property\">\"lon\"</span><span class=\"token operator\">:</span> <span class=\"token number\">121.612282</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> </pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token property\">\"order\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"desc\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token property\">\"unit\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"km\"</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>  <span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h5 id=\"9962-分页\"><a class=\"markdownIt-Anchor\" href=\"#9962-分页\">#</a> 9.9.6.2、分页🌴</h5>\n<p>elasticsearch 默认情况下只返回 top 10 的数据。而如果要查询更多数据就需要修改分页参数了。</p>\n<p>elasticsearch 中通过修改 from，size 参数来控制要返回的分页结果：</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>GET /indexName/_search</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>   <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>      <span class=\"token property\">\"match_all\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>   <span class=\"token property\">\"from\"</span><span class=\"token operator\">:</span> <span class=\"token number\">990</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 分页开始的位置，默认为 0</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>   <span class=\"token property\">\"size\"</span><span class=\"token operator\">:</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 期望获取的文档总数</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>   <span class=\"token property\">\"sort\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>      <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>         <span class=\"token property\">\"price\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"dsc\"</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>   <span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><mark>计算公式</mark>：from - 1 * size = 当前页数</p>\n<p>虽然 ES 的分页查询与 mysql 很像但是其底层原理有很大差别。ES 底层采用的是倒排索引，它的结构其实是不利于做分页的，所以 ES 采用的是逻辑上的一种分页，比方说要查 <code>990~1000</code>  这是条数据。对于 ES 来说它只能查出从 <code>0~1000</code>  个所有的数据，然后去截取 <code>990~1000</code>  的一部分数据</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310131132651.png\" alt=\"image-20231013113208351\"></p>\n<p>这种情况在单点查询的时候没什么问题，但是如果是集群 ES 就会把数据进行拆分，放到不同的机器上。拆分的每一份称为分片，也就是每一片上的数据都不一样</p>\n<h6 id=\"99621-深度分页问题\"><a class=\"markdownIt-Anchor\" href=\"#99621-深度分页问题\">#</a> 9.9.6.2.1、深度分页问题🎋</h6>\n<p>ES 是分布式的，所以会面临深度分页问题。例如按 price 排序后，获取 from=990，size=10 的数据</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310131135634.png\" alt=\"image-20231013113540176\"></p>\n<p>1、首先在每个数据分片上都排序并查询到 1000 条文档</p>\n<p>2、然后将所有节点的结果聚合，在内存中重新排序选出前 1000 条文档</p>\n<p>3、最后从这 1000 条中，选取从 990 开始的 10 条文档</p>\n<p>如果搜索页数过深，或者结果集 (from + size) 越大，对内存和 CPU 的消耗也越高。因此 ES 设定结果集查询的上限是 10000</p>\n<p>如下演示超出 10000 条会怎么样</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>GET /dkx/_search</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token property\">\"match_all\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token property\">\"from\"</span><span class=\"token operator\">:</span> <span class=\"token number\">9990</span><span class=\"token punctuation\">,</span> </pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token property\">\"size\"</span><span class=\"token operator\">:</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> </pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  <span class=\"token property\">\"sort\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>      <span class=\"token property\">\"price\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"asc\"</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>  <span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\">//----------------------- 查询结果 -----------------------</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>  <span class=\"token property\">\"took\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">33</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>  <span class=\"token property\">\"timed_out\"</span> <span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>  <span class=\"token property\">\"_shards\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token property\">\"total\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token property\">\"successful\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token property\">\"skipped\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token property\">\"failed\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>  <span class=\"token property\">\"hits\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token property\">\"total\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>      <span class=\"token property\">\"value\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">201</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>      <span class=\"token property\">\"relation\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"eq\"</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token property\">\"max_score\"</span> <span class=\"token operator\">:</span> <span class=\"token null keyword\">null</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token property\">\"hits\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span> <span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>9990 - 1 * 10 也就是刚好 10000 条数据，但是如果加 1</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>GET /dkx/_search</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token property\">\"match_all\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token property\">\"from\"</span><span class=\"token operator\">:</span> <span class=\"token number\">9991</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token property\">\"size\"</span><span class=\"token operator\">:</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> </pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  <span class=\"token property\">\"sort\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>      <span class=\"token property\">\"price\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"asc\"</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>  <span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310131143199.png\" alt=\"image-20231013114259949\"></p>\n<p>查询报错了</p>\n<h6 id=\"99622-深度分页解决方案\"><a class=\"markdownIt-Anchor\" href=\"#99622-深度分页解决方案\">#</a> 9.9.6.2.2、深度分页解决方案🎋</h6>\n<p>针对深度分页，ES 提供了两种解决方案</p>\n<ul>\n<li>search after：分页时需要排序，原理是从上一次的排序值开始，查询下一页数据。官方推荐使用的方式。</li>\n<li>scroll：原理将排序数据形成快照，保存在内存。官方已经不推荐使用。</li>\n</ul>\n<blockquote>\n<p><strong>总结</strong>：</p>\n<p>from + size</p>\n<ul>\n<li>优点：支持随机翻页</li>\n<li>缺点：深度分页问题，默认查询上限 (from + size) 是 10000</li>\n<li>场景：百度，京东，谷歌，淘宝这样的随机翻页搜索</li>\n</ul>\n<p>after search：</p>\n<ul>\n<li>优点：没有查询上限 (单次查询的 size 不超过 10000)</li>\n<li>缺点：只能向后逐页查询，不支持随机翻页</li>\n<li>场景：没有随机翻页需求的搜索，例如手机向下滚动翻页</li>\n</ul>\n<p>scroll：</p>\n<ul>\n<li>优点：没有查询上限 (单次查询的 size 不超过 10000)</li>\n<li>缺点：会有额外内存消耗，并且搜索结果是非实时的</li>\n<li>场景：海量数据的获取和迁移。从 ES7.1 开始不推荐，建议使用 after search 方案。</li>\n</ul>\n</blockquote>\n<h5 id=\"9963-高亮\"><a class=\"markdownIt-Anchor\" href=\"#9963-高亮\">#</a> 9.9.6.3、高亮🌴</h5>\n<p><strong>高亮</strong>：就是在搜索结果中把搜索关键字突出显示。</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310131156938.png\" alt=\"image-20231013115559310\"></p>\n<p>原理是这样的：</p>\n<ul>\n<li>将搜索结果中的关键字用标签标记出来</li>\n<li>在页面中给标签添加 css 样式</li>\n</ul>\n<p>语法：</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>GET /indexName/_search</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>   <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>      <span class=\"token property\">\"match\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>         <span class=\"token property\">\"FIELD\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"TEXT\"</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>   <span class=\"token property\">\"highlight\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>      <span class=\"token property\">\"fields\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token comment\">// 指定要高亮的字段</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>         <span class=\"token property\">\"FIELD\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>            <span class=\"token property\">\"pre_tags\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"&lt;em>\"</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 用来标记高亮字段的前置标签</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            <span class=\"token property\">\"post_tags\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"&lt;/em>\"</span> <span class=\"token comment\">// 用来标记高亮字段的后置标签</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>         <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>代码演示：</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre># 高亮查询，默认情况下，ES搜索字段必须与高亮字段一致，否则不会高亮</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>GET /dkx/_search</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token property\">\"match\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>      <span class=\"token property\">\"all\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"如家\"</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  <span class=\"token property\">\"highlight\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token property\">\"fields\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        </pre></td></tr><tr><td data-num=\"13\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token comment\">//------------------- 结果 -------------------</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token property\">\"_index\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"dkx\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token property\">\"_type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"_doc\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token property\">\"_id\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"339952837\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token property\">\"_score\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">2.7569861</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token property\">\"_source\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>          <span class=\"token property\">\"address\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"良乡西路7号\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>          <span class=\"token property\">\"brand\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"如家\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>          <span class=\"token property\">\"business\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"房山风景区\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>          <span class=\"token property\">\"city\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"北京\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>          <span class=\"token property\">\"id\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">339952837</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>          <span class=\"token property\">\"location\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"39.73167, 116.132482\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>          <span class=\"token property\">\"name\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"如家酒店(北京良乡西路店)\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>          <span class=\"token property\">\"pic\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"https://m.tuniucdn.com/fb3/s1/2n9c/3Dpgf5RTTzrxpeN5y3RLnRVtxMEA_w200_h200_c1_t0.jpg\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>          <span class=\"token property\">\"price\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">159</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>          <span class=\"token property\">\"score\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>          <span class=\"token property\">\"starName\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"二钻\"</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><font color='red'>注意</font>：高亮查询，默认情况下，ES 搜索字段必须与高亮字段一致，否则不会高亮</p>\n<p>演示代码：</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre># 高亮查询，默认情况下，ES搜索字段必须与高亮字段一致，否则不会高亮</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>GET /dkx/_search</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token property\">\"match\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>      <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"如家\"</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  <span class=\"token property\">\"highlight\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token property\">\"fields\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        </pre></td></tr><tr><td data-num=\"13\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token comment\">//----------------------------- 结果 -----------------------------</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token property\">\"name\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>   <span class=\"token string\">\"&lt;em>如家&lt;/em>酒店(北京良乡西路店)\"</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">]</span></pre></td></tr></table></figure><p>可以看到 name 字段加上了高亮标签了，但是 。我不希望在查询中指定 name 字段因为 all 搜索到的更多</p>\n<p>解决办法如下：</p>\n<p>“require_field_match”: “true” ：是否需要字段高亮匹配，默认是 true 需要高亮字段与查询字段匹配</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre># 高亮查询，默认情况下，ES搜索字段必须与高亮字段一致，否则不会高亮</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>GET /dkx/_search</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token property\">\"match\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>      <span class=\"token property\">\"all\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"如家\"</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  <span class=\"token property\">\"highlight\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token property\">\"fields\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>         <span class=\"token comment\">// 修改为 false 让其不与查询字段匹配就可以高亮了\t</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token property\">\"require_field_match\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"false\"</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><blockquote>\n<p><strong>总结</strong>：</p>\n<p>搜索结果处理整体语法：</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>GET /dkx/_search</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre> <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token property\">\"match\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>       <span class=\"token property\">\"all\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"如家\"</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre> <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>   <span class=\"token property\">\"from\"</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 分页开始的位置</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>   <span class=\"token property\">\"size\"</span><span class=\"token operator\">:</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 期望获取的文档总数</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>   <span class=\"token property\">\"sort\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>         <span class=\"token property\">\"price\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"asc\"</span> <span class=\"token comment\">// 普通排序</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>      <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>         <span class=\"token property\">\"_geo_distance\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token comment\">// 距离排序</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>            <span class=\"token property\">\"location\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"31.040699,121.618075\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            <span class=\"token property\">\"order\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"asc\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            <span class=\"token property\">\"unit\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"km\"</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>         <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>   <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>   <span class=\"token property\">\"highlight\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>      <span class=\"token property\">\"fields\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token comment\">// 高亮字段</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>         <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>            <span class=\"token property\">\"pre_tags\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"&lt;em>\"</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 用来标记高亮字段的前置标签</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>            <span class=\"token property\">\"post_tags\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"&lt;/em>\"</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 用来标记高亮字段的后置标签</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>            <span class=\"token property\">\"require_field_match\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"false\"</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>         <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure></blockquote>\n<h4 id=\"997-restclient查询文档\"><a class=\"markdownIt-Anchor\" href=\"#997-restclient查询文档\">#</a> 9.9.7、RestClient 查询文档🌲</h4>\n<ul>\n<li>快速入门</li>\n<li>match 查询</li>\n<li>精确查询</li>\n<li>复合查询</li>\n<li>排序，分页，高亮</li>\n</ul>\n<h5 id=\"9971-快速入门\"><a class=\"markdownIt-Anchor\" href=\"#9971-快速入门\">#</a> 9.9.7.1、快速入门🌴</h5>\n<p>我们通过 match_all 来演示下基本的 API，先看请求 DSL 的组织：</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310131223853.png\" alt=\"image-20231013122353640\"></p>\n<p>核心的 API：</p>\n<p>request.source()：</p>\n<p>里面封装了：排序，分页，高亮等所有功能。</p>\n<p>QueryBuilders：</p>\n<p>里面有各种各样的查询 matchQuery，matchAllQuery，boolQuery 等等。</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310131947096.png\" alt=\"image-20231013194730970\"></p>\n<p>代码演示：</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Test</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">testMatchAll</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>   <span class=\"token comment\">// 1. 准备 Request</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>   <span class=\"token class-name\">SearchRequest</span> request <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SearchRequest</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"dkx\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>   <span class=\"token comment\">// 2. 准备 DSL</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>   request<span class=\"token punctuation\">.</span><span class=\"token function\">source</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">query</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">QueryBuilders</span><span class=\"token punctuation\">.</span><span class=\"token function\">matchAllQuery</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>   <span class=\"token comment\">// 3. 发送请求</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>   <span class=\"token class-name\">SearchResponse</span> search<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>   <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      search <span class=\"token operator\">=</span> client<span class=\"token punctuation\">.</span><span class=\"token function\">search</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">,</span> <span class=\"token class-name\">RequestOptions</span><span class=\"token punctuation\">.</span><span class=\"token constant\">DEFAULT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">IOException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>   <span class=\"token comment\">// 4. 解析响应</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>   <span class=\"token class-name\">SearchHits</span> hits <span class=\"token operator\">=</span> search<span class=\"token punctuation\">.</span><span class=\"token function\">getHits</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>   <span class=\"token comment\">// 4.1. 获取总数</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>   <span class=\"token keyword\">long</span> value <span class=\"token operator\">=</span> hits<span class=\"token punctuation\">.</span><span class=\"token function\">getTotalHits</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>   <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"共搜索到\"</span> <span class=\"token operator\">+</span> value <span class=\"token operator\">+</span> <span class=\"token string\">\"条数据\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>   <span class=\"token comment\">// 4.2. 文档数组</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>   <span class=\"token class-name\">SearchHit</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> hits1 <span class=\"token operator\">=</span> hits<span class=\"token punctuation\">.</span><span class=\"token function\">getHits</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>   <span class=\"token comment\">// 4.3. 遍历文档数组</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>   <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">SearchHit</span> hit <span class=\"token operator\">:</span> hits1<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>   <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>      <span class=\"token comment\">// 4.4. 获取文档 source</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>      <span class=\"token class-name\">String</span> json <span class=\"token operator\">=</span> hit<span class=\"token punctuation\">.</span><span class=\"token function\">getSourceAsString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>      <span class=\"token comment\">// 4.5. 反序列化为 HotelDoc 对象</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>      <span class=\"token class-name\">HotelDoc</span> hotelDoc <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parseObject</span><span class=\"token punctuation\">(</span>json<span class=\"token punctuation\">,</span> <span class=\"token class-name\">HotelDoc</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>      <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"HotelDoc: \"</span> <span class=\"token operator\">+</span> hotelDoc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token comment\">//----------------------- 打印结果 -----------------------</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>共搜索到<span class=\"token number\">201</span>条数据</pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token class-name\">HotelDoc</span><span class=\"token operator\">:</span> <span class=\"token class-name\">HotelDoc</span><span class=\"token punctuation\">(</span>id<span class=\"token operator\">=</span><span class=\"token number\">36934</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span><span class=\"token number\">7</span>天连锁酒店<span class=\"token punctuation\">(</span>上海宝山路地铁站店<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> address<span class=\"token operator\">=</span>静安交通路<span class=\"token number\">40</span>号<span class=\"token punctuation\">,</span> price<span class=\"token operator\">=</span><span class=\"token number\">336</span><span class=\"token punctuation\">,</span> score<span class=\"token operator\">=</span><span class=\"token number\">37</span><span class=\"token punctuation\">,</span> brand<span class=\"token operator\">=</span><span class=\"token number\">7</span>天酒店<span class=\"token punctuation\">,</span> city<span class=\"token operator\">=</span>上海<span class=\"token punctuation\">,</span> starName<span class=\"token operator\">=</span>二钻<span class=\"token punctuation\">,</span> business<span class=\"token operator\">=</span>四川北路商业区<span class=\"token punctuation\">,</span> location<span class=\"token operator\">=</span><span class=\"token number\">31.251433</span><span class=\"token punctuation\">,</span> <span class=\"token number\">121.47522</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>                   <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></pre></td></tr></table></figure><p>RestAPI 中其中构建 DSL 是通过 HighLevelRestClient 中的 resource () 来实现的，其中包含了查询，排序，分页，高亮等所有功能：</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310131954682.png\" alt=\"image-20231013194937001\"></p>\n<p>RestAPI 中其中构建查询条件的核心部分是由一名为 QueryBuilders 的工具类提供的，其中包含了各种查询方法：</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310131954893.png\" alt=\"image-20231013195054455\"></p>\n<blockquote>\n<p><strong>总结</strong>：</p>\n<p>查询的基本步骤是：</p>\n<ol>\n<li>创建 SearchRequest 对象</li>\n<li>准备 Request.source ()，也就是 DSL。\n<ol>\n<li>QueryBuilders 来构建查询条件</li>\n<li>传入 Request.source () 的 query () 方法</li>\n</ol>\n</li>\n<li>发送请求，得到结果</li>\n<li>解析结果 (参考 JSON 结果，从外到内，逐层解析)</li>\n</ol>\n</blockquote>\n<h5 id=\"9972-全文检索查询\"><a class=\"markdownIt-Anchor\" href=\"#9972-全文检索查询\">#</a> 9.9.7.2、全文检索查询🌴</h5>\n<p>全文检索的 match 和 multi_match 查询与 match_all 的 API 基本一致。差别是查询条件，也就是 query 的部分。</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310132252478.png\" alt=\"image-20231013225059138\"></p>\n<p>同样是利用 QueryBuilders 提供的方法：</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Test</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">testMatch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>   <span class=\"token comment\">// 1. 准备 request</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>   <span class=\"token class-name\">SearchRequest</span> request <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SearchRequest</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"dkx\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>   <span class=\"token comment\">// 2. 准备 DSL</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>   request<span class=\"token punctuation\">.</span><span class=\"token function\">source</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">query</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">QueryBuilders</span><span class=\"token punctuation\">.</span><span class=\"token function\">matchQuery</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"all\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"如家\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>   <span class=\"token comment\">// 3. 发送请求</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>   <span class=\"token class-name\">SearchResponse</span> search<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>   <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      search <span class=\"token operator\">=</span> client<span class=\"token punctuation\">.</span><span class=\"token function\">search</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">,</span> <span class=\"token class-name\">RequestOptions</span><span class=\"token punctuation\">.</span><span class=\"token constant\">DEFAULT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">IOException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>   <span class=\"token comment\">// 4. 解析响应</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>   <span class=\"token class-name\">SearchHits</span> hits <span class=\"token operator\">=</span> search<span class=\"token punctuation\">.</span><span class=\"token function\">getHits</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>   <span class=\"token keyword\">long</span> value <span class=\"token operator\">=</span> hits<span class=\"token punctuation\">.</span><span class=\"token function\">getTotalHits</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>   <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"共搜索到\"</span> <span class=\"token operator\">+</span> value <span class=\"token operator\">+</span> <span class=\"token string\">\"条数据\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>   <span class=\"token class-name\">SearchHit</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> hits1 <span class=\"token operator\">=</span> hits<span class=\"token punctuation\">.</span><span class=\"token function\">getHits</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>   <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">SearchHit</span> hit <span class=\"token operator\">:</span> hits1<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>   <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>      <span class=\"token class-name\">String</span> json <span class=\"token operator\">=</span> hit<span class=\"token punctuation\">.</span><span class=\"token function\">getSourceAsString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>      <span class=\"token class-name\">HotelDoc</span> hotelDoc <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parseObject</span><span class=\"token punctuation\">(</span>json<span class=\"token punctuation\">,</span> <span class=\"token class-name\">HotelDoc</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>      <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"hotelDoc: \"</span> <span class=\"token operator\">+</span> hotelDoc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token comment\">//-------------------- 打印结果 --------------------</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>共搜索到<span class=\"token number\">30</span>条数据</pre></td></tr><tr><td data-num=\"29\"></td><td><pre>hotelDoc<span class=\"token operator\">:</span> <span class=\"token class-name\">HotelDoc</span><span class=\"token punctuation\">(</span>id<span class=\"token operator\">=</span><span class=\"token number\">339952837</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span>如家酒店<span class=\"token punctuation\">(</span>北京良乡西路店<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> address<span class=\"token operator\">=</span>良乡西路<span class=\"token number\">7</span>号<span class=\"token punctuation\">,</span> price<span class=\"token operator\">=</span><span class=\"token number\">159</span><span class=\"token punctuation\">,</span> score<span class=\"token operator\">=</span><span class=\"token number\">46</span><span class=\"token punctuation\">,</span> brand<span class=\"token operator\">=</span>如家<span class=\"token punctuation\">,</span> city<span class=\"token operator\">=</span>北京<span class=\"token punctuation\">,</span> starName<span class=\"token operator\">=</span>二钻<span class=\"token punctuation\">,</span> business<span class=\"token operator\">=</span>房山风景区<span class=\"token punctuation\">,</span> location<span class=\"token operator\">=</span><span class=\"token number\">39.73167</span><span class=\"token punctuation\">,</span> <span class=\"token number\">116.132482</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>                   <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></pre></td></tr></table></figure><p>方法的抽取</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Test</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">testMatchAll</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>   <span class=\"token comment\">// 1. 准备 Request</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>   <span class=\"token class-name\">SearchRequest</span> request <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SearchRequest</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"dkx\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>   <span class=\"token comment\">// 2. 准备 DSL</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>   request<span class=\"token punctuation\">.</span><span class=\"token function\">source</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">query</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">QueryBuilders</span><span class=\"token punctuation\">.</span><span class=\"token function\">matchAllQuery</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>   <span class=\"token comment\">// 3. 发送请求</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>   <span class=\"token class-name\">SearchResponse</span> search<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>   <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      search <span class=\"token operator\">=</span> client<span class=\"token punctuation\">.</span><span class=\"token function\">search</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">,</span> <span class=\"token class-name\">RequestOptions</span><span class=\"token punctuation\">.</span><span class=\"token constant\">DEFAULT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">IOException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>   <span class=\"token comment\">// 4. 调用解析响应函数</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>   <span class=\"token function\">handle</span><span class=\"token punctuation\">(</span>search<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token annotation punctuation\">@Test</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">testMatch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>   <span class=\"token comment\">// 1. 准备 request</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>   <span class=\"token class-name\">SearchRequest</span> request <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SearchRequest</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"dkx\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>   <span class=\"token comment\">// 2. 准备 DSL</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>   request<span class=\"token punctuation\">.</span><span class=\"token function\">source</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">query</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">QueryBuilders</span><span class=\"token punctuation\">.</span><span class=\"token function\">matchQuery</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"all\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"如家\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>   <span class=\"token comment\">// 3. 发送请求</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>   <span class=\"token class-name\">SearchResponse</span> search<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>   <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>      search <span class=\"token operator\">=</span> client<span class=\"token punctuation\">.</span><span class=\"token function\">search</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">,</span> <span class=\"token class-name\">RequestOptions</span><span class=\"token punctuation\">.</span><span class=\"token constant\">DEFAULT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">IOException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>   <span class=\"token comment\">// 4. 调用解析响应函数</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>   <span class=\"token function\">handle</span><span class=\"token punctuation\">(</span>search<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">handle</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">SearchResponse</span> search<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>   <span class=\"token comment\">// 4. 解析响应</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>   <span class=\"token class-name\">SearchHits</span> hits <span class=\"token operator\">=</span> search<span class=\"token punctuation\">.</span><span class=\"token function\">getHits</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>   <span class=\"token keyword\">long</span> value <span class=\"token operator\">=</span> hits<span class=\"token punctuation\">.</span><span class=\"token function\">getTotalHits</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>   <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"共搜索到\"</span> <span class=\"token operator\">+</span> value <span class=\"token operator\">+</span> <span class=\"token string\">\"条数据\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>   <span class=\"token class-name\">SearchHit</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> hits1 <span class=\"token operator\">=</span> hits<span class=\"token punctuation\">.</span><span class=\"token function\">getHits</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>   <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">SearchHit</span> hit <span class=\"token operator\">:</span> hits1<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>   <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>      <span class=\"token class-name\">String</span> json <span class=\"token operator\">=</span> hit<span class=\"token punctuation\">.</span><span class=\"token function\">getSourceAsString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>      <span class=\"token class-name\">HotelDoc</span> hotelDoc <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parseObject</span><span class=\"token punctuation\">(</span>json<span class=\"token punctuation\">,</span> <span class=\"token class-name\">HotelDoc</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>      <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"hotelDoc: \"</span> <span class=\"token operator\">+</span> hotelDoc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h5 id=\"9973-精确查询\"><a class=\"markdownIt-Anchor\" href=\"#9973-精确查询\">#</a> 9.9.7.3、精确查询🌴</h5>\n<p>精确查询常见的有 term 查询和 range 查询，同样利用 QueryBuilder 实现：</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310132252500.png\" alt=\"image-20231013210337545\"></p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Test</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">testJingque</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>   <span class=\"token comment\">// 1. 准备 Request</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>   <span class=\"token class-name\">SearchRequest</span> request <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SearchRequest</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"dkx\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>   <span class=\"token comment\">// 2. 准备 DSL</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>   <span class=\"token comment\">// 2.1 词条查询</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>   request<span class=\"token punctuation\">.</span><span class=\"token function\">source</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">query</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">QueryBuilders</span><span class=\"token punctuation\">.</span><span class=\"token function\">termQuery</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"city\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"深圳\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>   <span class=\"token comment\">// 2.2 范围查询</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>   request<span class=\"token punctuation\">.</span><span class=\"token function\">source</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">query</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">QueryBuilders</span><span class=\"token punctuation\">.</span><span class=\"token function\">rangeQuery</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"price\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">gte</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">lte</span><span class=\"token punctuation\">(</span><span class=\"token number\">150</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>   <span class=\"token comment\">// 3. 发送请求</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>   <span class=\"token class-name\">SearchResponse</span> search<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>   <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>      search <span class=\"token operator\">=</span> client<span class=\"token punctuation\">.</span><span class=\"token function\">search</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">,</span> <span class=\"token class-name\">RequestOptions</span><span class=\"token punctuation\">.</span><span class=\"token constant\">DEFAULT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">IOException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>   <span class=\"token function\">handle</span><span class=\"token punctuation\">(</span>search<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">handle</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">SearchResponse</span> search<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>   <span class=\"token comment\">// 4. 解析响应</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>   <span class=\"token class-name\">SearchHits</span> hits <span class=\"token operator\">=</span> search<span class=\"token punctuation\">.</span><span class=\"token function\">getHits</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>   <span class=\"token keyword\">long</span> value <span class=\"token operator\">=</span> hits<span class=\"token punctuation\">.</span><span class=\"token function\">getTotalHits</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>   <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"共搜索到\"</span> <span class=\"token operator\">+</span> value <span class=\"token operator\">+</span> <span class=\"token string\">\"条数据\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>   <span class=\"token class-name\">SearchHit</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> hits1 <span class=\"token operator\">=</span> hits<span class=\"token punctuation\">.</span><span class=\"token function\">getHits</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>   <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">SearchHit</span> hit <span class=\"token operator\">:</span> hits1<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>      <span class=\"token class-name\">String</span> json <span class=\"token operator\">=</span> hit<span class=\"token punctuation\">.</span><span class=\"token function\">getSourceAsString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>      <span class=\"token class-name\">HotelDoc</span> hotelDoc <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parseObject</span><span class=\"token punctuation\">(</span>json<span class=\"token punctuation\">,</span> <span class=\"token class-name\">HotelDoc</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>      <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"hotelDoc: \"</span> <span class=\"token operator\">+</span> hotelDoc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token comment\">//----------------- 打印结果 -----------------</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>共搜索到<span class=\"token number\">5</span>条数据</pre></td></tr><tr><td data-num=\"34\"></td><td><pre>hotelDoc<span class=\"token operator\">:</span> <span class=\"token class-name\">HotelDoc</span><span class=\"token punctuation\">(</span>id<span class=\"token operator\">=</span><span class=\"token number\">541619</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span>如家酒店<span class=\"token punctuation\">(</span>上海莘庄地铁站龙之梦商业广场店<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> address<span class=\"token operator\">=</span>莘庄镇莘浜路<span class=\"token number\">172</span>号<span class=\"token punctuation\">,</span> price<span class=\"token operator\">=</span><span class=\"token number\">149</span><span class=\"token punctuation\">,</span> score<span class=\"token operator\">=</span><span class=\"token number\">44</span><span class=\"token punctuation\">,</span> brand<span class=\"token operator\">=</span>如家<span class=\"token punctuation\">,</span> city<span class=\"token operator\">=</span>上海<span class=\"token punctuation\">,</span> starName<span class=\"token operator\">=</span>二钻<span class=\"token punctuation\">,</span> business<span class=\"token operator\">=</span>莘庄工业区<span class=\"token punctuation\">,</span> location<span class=\"token operator\">=</span><span class=\"token number\">31.105797</span><span class=\"token punctuation\">,</span> <span class=\"token number\">121.37755</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>                   <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></pre></td></tr></table></figure><h5 id=\"9974-复合查询-boolean-query\"><a class=\"markdownIt-Anchor\" href=\"#9974-复合查询-boolean-query\">#</a> 9.9.7.4、复合查询 - boolean query🌴</h5>\n<p>精确查询常见的有 term 查询和 range 查询，同样利用 QueryBuilders 实现：</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310141059562.png\" alt=\"image-20231014105919882\"></p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Test</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">testBooleanQuery</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>   <span class=\"token comment\">// 1. 准备 Request</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>   <span class=\"token class-name\">SearchRequest</span> request <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SearchRequest</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"dkx\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>   <span class=\"token comment\">// 2. 准备 DSL</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>   <span class=\"token comment\">// 2.1. 准备 BoolQuery</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>   <span class=\"token class-name\">BoolQueryBuilder</span> boolQuery <span class=\"token operator\">=</span> <span class=\"token class-name\">QueryBuilders</span><span class=\"token punctuation\">.</span><span class=\"token function\">boolQuery</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>   <span class=\"token comment\">// 2.2. 添加 term</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>   boolQuery<span class=\"token punctuation\">.</span><span class=\"token function\">must</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">QueryBuilders</span><span class=\"token punctuation\">.</span><span class=\"token function\">termQuery</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"city\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"深圳\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>   <span class=\"token comment\">// 2.3. 添加 range</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>   boolQuery<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">QueryBuilders</span><span class=\"token punctuation\">.</span><span class=\"token function\">rangeQuery</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"price\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">lte</span><span class=\"token punctuation\">(</span><span class=\"token number\">250</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>   <span class=\"token comment\">// 2.4. 将条件添加到 发送请求中</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>   request<span class=\"token punctuation\">.</span><span class=\"token function\">source</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">query</span><span class=\"token punctuation\">(</span>boolQuery<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>   <span class=\"token comment\">// 3. 发送请求</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>   <span class=\"token class-name\">SearchResponse</span> search<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>   <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>      search <span class=\"token operator\">=</span> client<span class=\"token punctuation\">.</span><span class=\"token function\">search</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">,</span> <span class=\"token class-name\">RequestOptions</span><span class=\"token punctuation\">.</span><span class=\"token constant\">DEFAULT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">IOException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>   <span class=\"token function\">handle</span><span class=\"token punctuation\">(</span>search<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">handle</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">SearchResponse</span> search<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>   <span class=\"token comment\">// 4. 解析响应</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>   <span class=\"token class-name\">SearchHits</span> hits <span class=\"token operator\">=</span> search<span class=\"token punctuation\">.</span><span class=\"token function\">getHits</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>   <span class=\"token keyword\">long</span> value <span class=\"token operator\">=</span> hits<span class=\"token punctuation\">.</span><span class=\"token function\">getTotalHits</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>   <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"共搜索到\"</span> <span class=\"token operator\">+</span> value <span class=\"token operator\">+</span> <span class=\"token string\">\"条数据\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>   <span class=\"token class-name\">SearchHit</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> hits1 <span class=\"token operator\">=</span> hits<span class=\"token punctuation\">.</span><span class=\"token function\">getHits</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>   <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">SearchHit</span> hit <span class=\"token operator\">:</span> hits1<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>      <span class=\"token class-name\">String</span> json <span class=\"token operator\">=</span> hit<span class=\"token punctuation\">.</span><span class=\"token function\">getSourceAsString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>      <span class=\"token class-name\">HotelDoc</span> hotelDoc <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parseObject</span><span class=\"token punctuation\">(</span>json<span class=\"token punctuation\">,</span> <span class=\"token class-name\">HotelDoc</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>      <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"hotelDoc: \"</span> <span class=\"token operator\">+</span> hotelDoc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token comment\">//-------------------- 打印结果 --------------------</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>共搜索到<span class=\"token number\">18</span>条数据</pre></td></tr><tr><td data-num=\"39\"></td><td><pre>hotelDoc<span class=\"token operator\">:</span> <span class=\"token class-name\">HotelDoc</span><span class=\"token punctuation\">(</span>id<span class=\"token operator\">=</span><span class=\"token number\">517915</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span>如家酒店·<span class=\"token function\">neo</span><span class=\"token punctuation\">(</span>深圳草埔地铁站店<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> address<span class=\"token operator\">=</span>布吉路<span class=\"token number\">1036</span>号<span class=\"token punctuation\">,</span> price<span class=\"token operator\">=</span><span class=\"token number\">159</span><span class=\"token punctuation\">,</span> score<span class=\"token operator\">=</span><span class=\"token number\">44</span><span class=\"token punctuation\">,</span> brand<span class=\"token operator\">=</span>如家<span class=\"token punctuation\">,</span> city<span class=\"token operator\">=</span>深圳<span class=\"token punctuation\">,</span> starName<span class=\"token operator\">=</span>二钻<span class=\"token punctuation\">,</span> business<span class=\"token operator\">=</span>田贝<span class=\"token operator\">/</span>水贝珠宝城<span class=\"token punctuation\">,</span> location<span class=\"token operator\">=</span><span class=\"token number\">22.583191</span><span class=\"token punctuation\">,</span> <span class=\"token number\">114.118499</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>                   <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></pre></td></tr></table></figure><blockquote>\n<p><strong>总结</strong>：</p>\n<p>要构建查询条件，只要记住一个类：QueryBuilders</p>\n</blockquote>\n<h5 id=\"9975-搜索结果处理\"><a class=\"markdownIt-Anchor\" href=\"#9975-搜索结果处理\">#</a> 9.9.7.5、搜索结果处理🌴</h5>\n<h6 id=\"99751-排序和分页\"><a class=\"markdownIt-Anchor\" href=\"#99751-排序和分页\">#</a> 9.9.7.5.1、排序和分页🎋</h6>\n<p>搜索结果的排序和分页是与 query 同级的参数，对应的 API 如下：</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310141103708.png\" alt=\"image-20231014110315292\"></p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Test</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">testPageAndSort</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>   <span class=\"token comment\">// 页码，每页大小</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>   <span class=\"token keyword\">int</span> page <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>size <span class=\"token operator\">=</span> <span class=\"token number\">5</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>   <span class=\"token comment\">// 1. 准备 Request</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>   <span class=\"token class-name\">SearchRequest</span> request <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SearchRequest</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"dkx\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>   <span class=\"token comment\">// 2. 准备 DSL</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>   request<span class=\"token punctuation\">.</span><span class=\"token function\">source</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">query</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">QueryBuilders</span><span class=\"token punctuation\">.</span><span class=\"token function\">matchAllQuery</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>   <span class=\"token comment\">// 2.1. 排序 sort</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>   request<span class=\"token punctuation\">.</span><span class=\"token function\">source</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">sort</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"price\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">SortOrder</span><span class=\"token punctuation\">.</span><span class=\"token constant\">ASC</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>   <span class=\"token comment\">// 2.2. 分页 from size</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>   request<span class=\"token punctuation\">.</span><span class=\"token function\">source</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>page <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span>size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>   <span class=\"token comment\">// 3. 发送请求</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>   <span class=\"token class-name\">SearchResponse</span> search<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>   <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>      search <span class=\"token operator\">=</span> client<span class=\"token punctuation\">.</span><span class=\"token function\">search</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">,</span> <span class=\"token class-name\">RequestOptions</span><span class=\"token punctuation\">.</span><span class=\"token constant\">DEFAULT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">IOException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>   <span class=\"token function\">handle</span><span class=\"token punctuation\">(</span>search<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">handle</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">SearchResponse</span> search<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>   <span class=\"token comment\">// 4. 解析响应</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>   <span class=\"token class-name\">SearchHits</span> hits <span class=\"token operator\">=</span> search<span class=\"token punctuation\">.</span><span class=\"token function\">getHits</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>   <span class=\"token keyword\">long</span> value <span class=\"token operator\">=</span> hits<span class=\"token punctuation\">.</span><span class=\"token function\">getTotalHits</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>   <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"共搜索到\"</span> <span class=\"token operator\">+</span> value <span class=\"token operator\">+</span> <span class=\"token string\">\"条数据\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>   <span class=\"token class-name\">SearchHit</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> hits1 <span class=\"token operator\">=</span> hits<span class=\"token punctuation\">.</span><span class=\"token function\">getHits</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>   <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">SearchHit</span> hit <span class=\"token operator\">:</span> hits1<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>      <span class=\"token class-name\">String</span> json <span class=\"token operator\">=</span> hit<span class=\"token punctuation\">.</span><span class=\"token function\">getSourceAsString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>      <span class=\"token class-name\">HotelDoc</span> hotelDoc <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parseObject</span><span class=\"token punctuation\">(</span>json<span class=\"token punctuation\">,</span> <span class=\"token class-name\">HotelDoc</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>      <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"hotelDoc: \"</span> <span class=\"token operator\">+</span> hotelDoc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token comment\">//----------------------- 打印结果 -----------------------</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>共搜索到<span class=\"token number\">201</span>条数据</pre></td></tr><tr><td data-num=\"38\"></td><td><pre>hotelDoc<span class=\"token operator\">:</span> <span class=\"token class-name\">HotelDoc</span><span class=\"token punctuation\">(</span>id<span class=\"token operator\">=</span><span class=\"token number\">197837109</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span>如家酒店·<span class=\"token function\">neo</span><span class=\"token punctuation\">(</span>深圳龙岗大道布吉地铁站店<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> address<span class=\"token operator\">=</span>布吉镇深惠路龙珠商城<span class=\"token punctuation\">,</span> price<span class=\"token operator\">=</span><span class=\"token number\">127</span><span class=\"token punctuation\">,</span> score<span class=\"token operator\">=</span><span class=\"token number\">43</span><span class=\"token punctuation\">,</span> brand<span class=\"token operator\">=</span>如家<span class=\"token punctuation\">,</span> city<span class=\"token operator\">=</span>深圳<span class=\"token punctuation\">,</span> starName<span class=\"token operator\">=</span>二钻<span class=\"token punctuation\">,</span> business<span class=\"token operator\">=</span>布吉<span class=\"token operator\">/</span>深圳东站<span class=\"token punctuation\">,</span> location<span class=\"token operator\">=</span><span class=\"token number\">22.602482</span><span class=\"token punctuation\">,</span> <span class=\"token number\">114.123284</span><span class=\"token punctuation\">,</span> pic<span class=\"token operator\">=</span>https<span class=\"token operator\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>m<span class=\"token punctuation\">.</span>tuniucdn<span class=\"token punctuation\">.</span>com<span class=\"token operator\">/</span>fb2<span class=\"token operator\">/</span>t1<span class=\"token operator\">/</span><span class=\"token constant\">G6</span><span class=\"token operator\">/</span><span class=\"token constant\">M00</span><span class=\"token operator\">/</span><span class=\"token number\">25</span><span class=\"token operator\">/</span><span class=\"token number\">58</span><span class=\"token operator\">/</span><span class=\"token class-name\">Cii</span><span class=\"token operator\">-</span><span class=\"token class-name\">TF3PFZOIA7jwAAKInGFN4xgAAEVbAGeP4AAAoi0485_w200_h200_c1_t0</span><span class=\"token punctuation\">.</span>jpg<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>hotelDoc<span class=\"token operator\">:</span> <span class=\"token class-name\">HotelDoc</span><span class=\"token punctuation\">(</span>id<span class=\"token operator\">=</span><span class=\"token number\">2316304</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span>如家酒店<span class=\"token punctuation\">(</span>深圳双龙地铁站店<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> address<span class=\"token operator\">=</span>龙岗街道龙岗墟社区龙平东路<span class=\"token number\">62</span>号<span class=\"token punctuation\">,</span> price<span class=\"token operator\">=</span><span class=\"token number\">135</span><span class=\"token punctuation\">,</span> score<span class=\"token operator\">=</span><span class=\"token number\">45</span><span class=\"token punctuation\">,</span> brand<span class=\"token operator\">=</span>如家<span class=\"token punctuation\">,</span> city<span class=\"token operator\">=</span>深圳<span class=\"token punctuation\">,</span> starName<span class=\"token operator\">=</span>二钻<span class=\"token punctuation\">,</span> business<span class=\"token operator\">=</span>龙岗中心区<span class=\"token operator\">/</span>大运新城<span class=\"token punctuation\">,</span> location<span class=\"token operator\">=</span><span class=\"token number\">22.730828</span><span class=\"token punctuation\">,</span> <span class=\"token number\">114.278337</span><span class=\"token punctuation\">,</span> pic<span class=\"token operator\">=</span>https<span class=\"token operator\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>m<span class=\"token punctuation\">.</span>tuniucdn<span class=\"token punctuation\">.</span>com<span class=\"token operator\">/</span>fb3<span class=\"token operator\">/</span>s1<span class=\"token operator\">/</span><span class=\"token number\">2</span>n9c<span class=\"token operator\">/</span><span class=\"token number\">4</span>AzEoQ44awd1D2g95a6XDtJf3dkw_w200_h200_c1_t0<span class=\"token punctuation\">.</span>jpg<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>hotelDoc<span class=\"token operator\">:</span> <span class=\"token class-name\">HotelDoc</span><span class=\"token punctuation\">(</span>id<span class=\"token operator\">=</span><span class=\"token number\">1630005459</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span><span class=\"token number\">7</span>天连锁酒店（深圳地王大厦红桂路店）（原红桂路店）<span class=\"token punctuation\">,</span> address<span class=\"token operator\">=</span>罗湖区宝安南路<span class=\"token number\">2078</span>号深港豪苑（与红桂路交汇处）<span class=\"token punctuation\">,</span> price<span class=\"token operator\">=</span><span class=\"token number\">143</span><span class=\"token punctuation\">,</span> score<span class=\"token operator\">=</span><span class=\"token number\">39</span><span class=\"token punctuation\">,</span> brand<span class=\"token operator\">=</span><span class=\"token number\">7</span>天酒店<span class=\"token punctuation\">,</span> city<span class=\"token operator\">=</span>深圳<span class=\"token punctuation\">,</span> starName<span class=\"token operator\">=</span>二钻<span class=\"token punctuation\">,</span> business<span class=\"token operator\">=</span><span class=\"token punctuation\">,</span> location<span class=\"token operator\">=</span><span class=\"token number\">22.550341</span><span class=\"token punctuation\">,</span> <span class=\"token number\">114.10965</span><span class=\"token punctuation\">,</span> pic<span class=\"token operator\">=</span>https<span class=\"token operator\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>m<span class=\"token punctuation\">.</span>tuniucdn<span class=\"token punctuation\">.</span>com<span class=\"token operator\">/</span>fb2<span class=\"token operator\">/</span>t1<span class=\"token operator\">/</span><span class=\"token constant\">G2</span><span class=\"token operator\">/</span><span class=\"token constant\">M00</span><span class=\"token operator\">/</span><span class=\"token constant\">EA</span><span class=\"token operator\">/</span><span class=\"token number\">18</span><span class=\"token operator\">/</span><span class=\"token class-name\">Cii</span><span class=\"token operator\">-</span><span class=\"token class-name\">T1k1KaGIIkQVAAD4fD_T3FcAALTtABiCJ8AAPiU164_w200_h200_c1_t0</span><span class=\"token punctuation\">.</span>jpg<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>hotelDoc<span class=\"token operator\">:</span> <span class=\"token class-name\">HotelDoc</span><span class=\"token punctuation\">(</span>id<span class=\"token operator\">=</span><span class=\"token number\">541619</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span>如家酒店<span class=\"token punctuation\">(</span>上海莘庄地铁站龙之梦商业广场店<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> address<span class=\"token operator\">=</span>莘庄镇莘浜路<span class=\"token number\">172</span>号<span class=\"token punctuation\">,</span> price<span class=\"token operator\">=</span><span class=\"token number\">149</span><span class=\"token punctuation\">,</span> score<span class=\"token operator\">=</span><span class=\"token number\">44</span><span class=\"token punctuation\">,</span> brand<span class=\"token operator\">=</span>如家<span class=\"token punctuation\">,</span> city<span class=\"token operator\">=</span>上海<span class=\"token punctuation\">,</span> starName<span class=\"token operator\">=</span>二钻<span class=\"token punctuation\">,</span> business<span class=\"token operator\">=</span>莘庄工业区<span class=\"token punctuation\">,</span> location<span class=\"token operator\">=</span><span class=\"token number\">31.105797</span><span class=\"token punctuation\">,</span> <span class=\"token number\">121.37755</span><span class=\"token punctuation\">,</span> pic<span class=\"token operator\">=</span>https<span class=\"token operator\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>m<span class=\"token punctuation\">.</span>tuniucdn<span class=\"token punctuation\">.</span>com<span class=\"token operator\">/</span>fb3<span class=\"token operator\">/</span>s1<span class=\"token operator\">/</span><span class=\"token number\">2</span>n9c<span class=\"token operator\">/</span><span class=\"token number\">3</span>mKs3jETvJDj3dDdkRB9UyLLvPna_w200_h200_c1_t0<span class=\"token punctuation\">.</span>jpg<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>hotelDoc<span class=\"token operator\">:</span> <span class=\"token class-name\">HotelDoc</span><span class=\"token punctuation\">(</span>id<span class=\"token operator\">=</span><span class=\"token number\">1400304687</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span>如家酒店<span class=\"token punctuation\">(</span>深圳横岗地铁站新马商贸城店<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> address<span class=\"token operator\">=</span>龙岗大道横岗段<span class=\"token number\">4004</span>号<span class=\"token punctuation\">,</span> price<span class=\"token operator\">=</span><span class=\"token number\">149</span><span class=\"token punctuation\">,</span> score<span class=\"token operator\">=</span><span class=\"token number\">43</span><span class=\"token punctuation\">,</span> brand<span class=\"token operator\">=</span>如家<span class=\"token punctuation\">,</span> city<span class=\"token operator\">=</span>深圳<span class=\"token punctuation\">,</span> starName<span class=\"token operator\">=</span>二钻<span class=\"token punctuation\">,</span> business<span class=\"token operator\">=</span>龙岗中心区<span class=\"token operator\">/</span>大运新城<span class=\"token punctuation\">,</span> location<span class=\"token operator\">=</span><span class=\"token number\">22.642629</span><span class=\"token punctuation\">,</span> <span class=\"token number\">114.202799</span><span class=\"token punctuation\">,</span> pic<span class=\"token operator\">=</span>https<span class=\"token operator\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>m<span class=\"token punctuation\">.</span>tuniucdn<span class=\"token punctuation\">.</span>com<span class=\"token operator\">/</span>fb2<span class=\"token operator\">/</span>t1<span class=\"token operator\">/</span><span class=\"token constant\">G6</span><span class=\"token operator\">/</span><span class=\"token constant\">M00</span><span class=\"token operator\">/</span><span class=\"token number\">25</span><span class=\"token operator\">/</span><span class=\"token number\">5</span>A<span class=\"token operator\">/</span><span class=\"token class-name\">Cii</span><span class=\"token operator\">-</span><span class=\"token class-name\">TF3PFkiIb27dAAEqdDcKl3YAAEViQGVWY0AASqM960_w200_h200_c1_t0</span><span class=\"token punctuation\">.</span>jpg<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h6 id=\"99752-高亮\"><a class=\"markdownIt-Anchor\" href=\"#99752-高亮\">#</a> 9.9.7.5.2、高亮🎋</h6>\n<p>高亮 API 包括请求 DSL 构建和结果解析两部分。我们先看请求的 DSL 构建：</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310141251993.png\" alt=\"image-20231014125137358\"></p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Test</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">testHighlight</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>   <span class=\"token comment\">// 1. 准备 Request</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>   <span class=\"token class-name\">SearchRequest</span> request <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SearchRequest</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"dkx\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>   <span class=\"token comment\">// 2. 准备 DSL</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>   <span class=\"token comment\">// 2.1.query 查询</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>   request<span class=\"token punctuation\">.</span><span class=\"token function\">source</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">query</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">QueryBuilders</span><span class=\"token punctuation\">.</span><span class=\"token function\">matchQuery</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"all\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"如家\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>   <span class=\"token comment\">// 2.2. 高亮</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>   request<span class=\"token punctuation\">.</span><span class=\"token function\">source</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">highlighter</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">HighlightBuilder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>                                <span class=\"token punctuation\">.</span><span class=\"token function\">field</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"name\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>                                <span class=\"token punctuation\">.</span><span class=\"token function\">requireFieldMatch</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                               <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>   <span class=\"token comment\">// 3. 发送请求</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>   <span class=\"token class-name\">SearchResponse</span> search<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>   <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>      search <span class=\"token operator\">=</span> client<span class=\"token punctuation\">.</span><span class=\"token function\">search</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">,</span> <span class=\"token class-name\">RequestOptions</span><span class=\"token punctuation\">.</span><span class=\"token constant\">DEFAULT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">IOException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>   <span class=\"token function\">handle</span><span class=\"token punctuation\">(</span>search<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">handle</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">SearchResponse</span> search<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>   <span class=\"token comment\">// 4. 解析响应</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>   <span class=\"token class-name\">SearchHits</span> hits <span class=\"token operator\">=</span> search<span class=\"token punctuation\">.</span><span class=\"token function\">getHits</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>   <span class=\"token keyword\">long</span> value <span class=\"token operator\">=</span> hits<span class=\"token punctuation\">.</span><span class=\"token function\">getTotalHits</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>   <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"共搜索到\"</span> <span class=\"token operator\">+</span> value <span class=\"token operator\">+</span> <span class=\"token string\">\"条数据\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>   <span class=\"token class-name\">SearchHit</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> hits1 <span class=\"token operator\">=</span> hits<span class=\"token punctuation\">.</span><span class=\"token function\">getHits</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>   <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">SearchHit</span> hit <span class=\"token operator\">:</span> hits1<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>      <span class=\"token class-name\">String</span> json <span class=\"token operator\">=</span> hit<span class=\"token punctuation\">.</span><span class=\"token function\">getSourceAsString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>      <span class=\"token class-name\">HotelDoc</span> hotelDoc <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parseObject</span><span class=\"token punctuation\">(</span>json<span class=\"token punctuation\">,</span> <span class=\"token class-name\">HotelDoc</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>      <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"hotelDoc: \"</span> <span class=\"token operator\">+</span> hotelDoc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token comment\">//--------------------- 打印结果 ---------------------</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>共搜索到<span class=\"token number\">30</span>条数据</pre></td></tr><tr><td data-num=\"38\"></td><td><pre>hotelDoc<span class=\"token operator\">:</span> <span class=\"token class-name\">HotelDoc</span><span class=\"token punctuation\">(</span>id<span class=\"token operator\">=</span><span class=\"token number\">339952837</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span>如家酒店<span class=\"token punctuation\">(</span>北京良乡西路店<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> address<span class=\"token operator\">=</span>良乡西路<span class=\"token number\">7</span>号<span class=\"token punctuation\">,</span> price<span class=\"token operator\">=</span><span class=\"token number\">159</span><span class=\"token punctuation\">,</span> score<span class=\"token operator\">=</span><span class=\"token number\">46</span><span class=\"token punctuation\">,</span> brand<span class=\"token operator\">=</span>如家<span class=\"token punctuation\">,</span> city<span class=\"token operator\">=</span>北京<span class=\"token punctuation\">,</span> starName<span class=\"token operator\">=</span>二钻<span class=\"token punctuation\">,</span> business<span class=\"token operator\">=</span>房山风景区<span class=\"token punctuation\">,</span> location<span class=\"token operator\">=</span><span class=\"token number\">39.73167</span><span class=\"token punctuation\">,</span> <span class=\"token number\">116.132482</span><span class=\"token punctuation\">,</span> pic<span class=\"token operator\">=</span>https<span class=\"token operator\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>m<span class=\"token punctuation\">.</span>tuniucdn<span class=\"token punctuation\">.</span>com<span class=\"token operator\">/</span>fb3<span class=\"token operator\">/</span>s1<span class=\"token operator\">/</span><span class=\"token number\">2</span>n9c<span class=\"token operator\">/</span><span class=\"token number\">3D</span>pgf5RTTzrxpeN5y3RLnRVtxMEA_w200_h200_c1_t0<span class=\"token punctuation\">.</span>jpg<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>hotelDoc<span class=\"token operator\">:</span> <span class=\"token class-name\">HotelDoc</span><span class=\"token punctuation\">(</span>id<span class=\"token operator\">=</span><span class=\"token number\">1455383931</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span>如家酒店<span class=\"token punctuation\">(</span>深圳宝安客运中心站店<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> address<span class=\"token operator\">=</span>西乡河西金雅新苑<span class=\"token number\">34</span>栋<span class=\"token punctuation\">,</span> price<span class=\"token operator\">=</span><span class=\"token number\">169</span><span class=\"token punctuation\">,</span> score<span class=\"token operator\">=</span><span class=\"token number\">45</span><span class=\"token punctuation\">,</span> brand<span class=\"token operator\">=</span>如家<span class=\"token punctuation\">,</span> city<span class=\"token operator\">=</span>深圳<span class=\"token punctuation\">,</span> starName<span class=\"token operator\">=</span>二钻<span class=\"token punctuation\">,</span> business<span class=\"token operator\">=</span>宝安商业区<span class=\"token punctuation\">,</span> location<span class=\"token operator\">=</span><span class=\"token number\">22.590272</span><span class=\"token punctuation\">,</span> <span class=\"token number\">113.881933</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>                   <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></pre></td></tr></table></figure><p>从上面的打印结果中可以看到并没有找到高亮的部分啊。这是因为打印的是 source 的部分</p>\n<p>高亮的部分在另一个部分中如下图所示：</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310141305411.png\" alt=\"image-20231014130537007\"></p>\n<h6 id=\"997521-高亮结果解析\"><a class=\"markdownIt-Anchor\" href=\"#997521-高亮结果解析\">#</a> 9.9.7.5.2.1、高亮结果解析：</h6>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Test</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">testHighlight</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>   <span class=\"token comment\">// 1. 准备 Request</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>   <span class=\"token class-name\">SearchRequest</span> request <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SearchRequest</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"dkx\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>   <span class=\"token comment\">// 2. 准备 DSL</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>   <span class=\"token comment\">// 2.1.query 查询</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>   request<span class=\"token punctuation\">.</span><span class=\"token function\">source</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">query</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">QueryBuilders</span><span class=\"token punctuation\">.</span><span class=\"token function\">matchQuery</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"all\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"如家\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>   <span class=\"token comment\">// 2.2. 高亮</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>   request<span class=\"token punctuation\">.</span><span class=\"token function\">source</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">highlighter</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">HighlightBuilder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>                                <span class=\"token punctuation\">.</span><span class=\"token function\">field</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"name\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>                                <span class=\"token punctuation\">.</span><span class=\"token function\">requireFieldMatch</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                               <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>   <span class=\"token comment\">// 3. 发送请求</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>   <span class=\"token class-name\">SearchResponse</span> search<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>   <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>      search <span class=\"token operator\">=</span> client<span class=\"token punctuation\">.</span><span class=\"token function\">search</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">,</span> <span class=\"token class-name\">RequestOptions</span><span class=\"token punctuation\">.</span><span class=\"token constant\">DEFAULT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">IOException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>   <span class=\"token function\">handle</span><span class=\"token punctuation\">(</span>search<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">handle</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">SearchResponse</span> search<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>   <span class=\"token comment\">// 4. 解析响应</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>   <span class=\"token class-name\">SearchHits</span> hits <span class=\"token operator\">=</span> search<span class=\"token punctuation\">.</span><span class=\"token function\">getHits</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>   <span class=\"token keyword\">long</span> value <span class=\"token operator\">=</span> hits<span class=\"token punctuation\">.</span><span class=\"token function\">getTotalHits</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>   <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"共搜索到\"</span> <span class=\"token operator\">+</span> value <span class=\"token operator\">+</span> <span class=\"token string\">\"条数据\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>   <span class=\"token class-name\">SearchHit</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> hits1 <span class=\"token operator\">=</span> hits<span class=\"token punctuation\">.</span><span class=\"token function\">getHits</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>   <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">SearchHit</span> hit <span class=\"token operator\">:</span> hits1<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>      <span class=\"token class-name\">String</span> json <span class=\"token operator\">=</span> hit<span class=\"token punctuation\">.</span><span class=\"token function\">getSourceAsString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>      <span class=\"token class-name\">HotelDoc</span> hotelDoc <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parseObject</span><span class=\"token punctuation\">(</span>json<span class=\"token punctuation\">,</span> <span class=\"token class-name\">HotelDoc</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>      <span class=\"token comment\">// 获取高亮结果</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>      <span class=\"token class-name\">Map</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">HighlightField</span><span class=\"token punctuation\">></span></span> highlightFields <span class=\"token operator\">=</span> hit<span class=\"token punctuation\">.</span><span class=\"token function\">getHighlightFields</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>      <span class=\"token comment\">// CollectionUtils：Spring 提供的工具类 isEmpty 判断 Map 集合是否为空</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>      <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span> <span class=\"token class-name\">CollectionUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">isEmpty</span><span class=\"token punctuation\">(</span>highlightFields<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>      <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>         <span class=\"token comment\">// 根据字段名获取高亮结果</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>         <span class=\"token class-name\">HighlightField</span> name <span class=\"token operator\">=</span> highlightFields<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"name\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>         <span class=\"token comment\">// 判断根据字段获取的内容是否为 null</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>         <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>         <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>            <span class=\"token comment\">// 获取高亮值</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>            <span class=\"token class-name\">String</span> content <span class=\"token operator\">=</span> name<span class=\"token punctuation\">.</span><span class=\"token function\">getFragments</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">string</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>            <span class=\"token comment\">// 覆盖非高亮结果</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>            hotelDoc<span class=\"token punctuation\">.</span><span class=\"token function\">setName</span><span class=\"token punctuation\">(</span>content<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>         <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>      <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"hotelDoc: \"</span> <span class=\"token operator\">+</span> hotelDoc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre><span class=\"token comment\">//----------------- 打印结果 -----------------</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>共搜索到<span class=\"token number\">30</span>条数据</pre></td></tr><tr><td data-num=\"54\"></td><td><pre>hotelDoc<span class=\"token operator\">:</span> <span class=\"token class-name\">HotelDoc</span><span class=\"token punctuation\">(</span>id<span class=\"token operator\">=</span><span class=\"token number\">339952837</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>em<span class=\"token punctuation\">></span></span>如家<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>em<span class=\"token operator\">></span>酒店<span class=\"token punctuation\">(</span>北京良乡西路店<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> address<span class=\"token operator\">=</span>良乡西路<span class=\"token number\">7</span>号<span class=\"token punctuation\">,</span> price<span class=\"token operator\">=</span><span class=\"token number\">159</span><span class=\"token punctuation\">,</span> score<span class=\"token operator\">=</span><span class=\"token number\">46</span><span class=\"token punctuation\">,</span> brand<span class=\"token operator\">=</span>如家<span class=\"token punctuation\">,</span> city<span class=\"token operator\">=</span>北京<span class=\"token punctuation\">,</span> starName<span class=\"token operator\">=</span>二钻<span class=\"token punctuation\">,</span> business<span class=\"token operator\">=</span>房山风景区<span class=\"token punctuation\">,</span> location<span class=\"token operator\">=</span><span class=\"token number\">39.73167</span><span class=\"token punctuation\">,</span> <span class=\"token number\">116.132482</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>                   <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></pre></td></tr></table></figure><blockquote>\n<p><strong>总结</strong>：</p>\n<ul>\n<li>\n<p>所有搜索 DSL 的构建，记住一个 API：</p>\n<p>SearchRequest 的 source () 方法</p>\n</li>\n<li>\n<p>高亮结果解析是参考 JSON 结果，逐层解析</p>\n</li>\n</ul>\n</blockquote>\n<h6 id=\"99753-距离排序\"><a class=\"markdownIt-Anchor\" href=\"#99753-距离排序\">#</a> 9.9.7.5.3、距离排序🎋</h6>\n<p>距离排序与普通字段排序有所差异，API 如下：</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310141655675.png\" alt=\"image-20231014165529717\"></p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Test</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">testJvliSort</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>   <span class=\"token comment\">// 1. 准备 Request</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>   <span class=\"token class-name\">SearchRequest</span> request <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SearchRequest</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"dkx\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>   <span class=\"token comment\">// 2.3. 排序</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>   <span class=\"token class-name\">String</span> location <span class=\"token operator\">=</span> <span class=\"token string\">\"31.251433, 121.47522\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>   <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>location <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span>location<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>   <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>      <span class=\"token comment\">// 2.4. 根据距离进行排序</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      request<span class=\"token punctuation\">.</span><span class=\"token function\">source</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">sort</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">SortBuilders</span><span class=\"token punctuation\">.</span><span class=\"token function\">geoDistanceSort</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"location\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>                                                         <span class=\"token keyword\">new</span> <span class=\"token class-name\">GeoPoint</span><span class=\"token punctuation\">(</span>location<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                                                        <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>                            <span class=\"token punctuation\">.</span><span class=\"token function\">order</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">SortOrder</span><span class=\"token punctuation\">.</span><span class=\"token constant\">ASC</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>                            <span class=\"token punctuation\">.</span><span class=\"token function\">unit</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">DistanceUnit</span><span class=\"token punctuation\">.</span><span class=\"token constant\">KILOMETERS</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>                           <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>   <span class=\"token comment\">// 3. 发送请求</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>   <span class=\"token class-name\">SearchResponse</span> search<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>   <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>      search <span class=\"token operator\">=</span> client<span class=\"token punctuation\">.</span><span class=\"token function\">search</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">,</span> <span class=\"token class-name\">RequestOptions</span><span class=\"token punctuation\">.</span><span class=\"token constant\">DEFAULT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">IOException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>   <span class=\"token comment\">// 4. 解析响应结果</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>   <span class=\"token function\">handle</span><span class=\"token punctuation\">(</span>search<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">handle</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">SearchResponse</span> search<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>   <span class=\"token comment\">// 4. 解析响应</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>   <span class=\"token class-name\">SearchHits</span> hits <span class=\"token operator\">=</span> search<span class=\"token punctuation\">.</span><span class=\"token function\">getHits</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>   <span class=\"token keyword\">long</span> value <span class=\"token operator\">=</span> hits<span class=\"token punctuation\">.</span><span class=\"token function\">getTotalHits</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>   <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"共搜索到\"</span> <span class=\"token operator\">+</span> value <span class=\"token operator\">+</span> <span class=\"token string\">\"条数据\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>   <span class=\"token class-name\">SearchHit</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> hits1 <span class=\"token operator\">=</span> hits<span class=\"token punctuation\">.</span><span class=\"token function\">getHits</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>   <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">SearchHit</span> hit <span class=\"token operator\">:</span> hits1<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>      <span class=\"token class-name\">String</span> json <span class=\"token operator\">=</span> hit<span class=\"token punctuation\">.</span><span class=\"token function\">getSourceAsString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>      <span class=\"token class-name\">HotelDoc</span> hotelDoc <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parseObject</span><span class=\"token punctuation\">(</span>json<span class=\"token punctuation\">,</span> <span class=\"token class-name\">HotelDoc</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>      <span class=\"token comment\">// 获取高亮结果</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>      <span class=\"token class-name\">Map</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">HighlightField</span><span class=\"token punctuation\">></span></span> highlightFields <span class=\"token operator\">=</span> hit<span class=\"token punctuation\">.</span><span class=\"token function\">getHighlightFields</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>      <span class=\"token comment\">// CollectionUtils：Spring 提供的工具类 isEmpty 判断 Map 集合是否为空</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>      <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span> <span class=\"token class-name\">CollectionUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">isEmpty</span><span class=\"token punctuation\">(</span>highlightFields<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>      <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>         <span class=\"token comment\">// 根据字段名获取高亮结果</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>         <span class=\"token class-name\">HighlightField</span> name <span class=\"token operator\">=</span> highlightFields<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"name\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>         <span class=\"token comment\">// 判断根据字段获取的内容是否为 null</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>         <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>         <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>            <span class=\"token comment\">// 获取高亮值</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>            <span class=\"token class-name\">String</span> content <span class=\"token operator\">=</span> name<span class=\"token punctuation\">.</span><span class=\"token function\">getFragments</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">string</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>            <span class=\"token comment\">// 覆盖非高亮结果</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>            hotelDoc<span class=\"token punctuation\">.</span><span class=\"token function\">setName</span><span class=\"token punctuation\">(</span>content<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>         <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>      <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"hotelDoc: \"</span> <span class=\"token operator\">+</span> hotelDoc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre><span class=\"token comment\">//-------------------- 打印结果 --------------------</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>共搜索到<span class=\"token number\">201</span>条数据</pre></td></tr><tr><td data-num=\"59\"></td><td><pre>hotelDoc<span class=\"token operator\">:</span> <span class=\"token class-name\">HotelDoc</span><span class=\"token punctuation\">(</span>id<span class=\"token operator\">=</span><span class=\"token number\">36934</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span><span class=\"token number\">7</span>天连锁酒店<span class=\"token punctuation\">(</span>上海宝山路地铁站店<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> address<span class=\"token operator\">=</span>静安交通路<span class=\"token number\">40</span>号<span class=\"token punctuation\">,</span> price<span class=\"token operator\">=</span><span class=\"token number\">336</span><span class=\"token punctuation\">,</span> score<span class=\"token operator\">=</span><span class=\"token number\">37</span><span class=\"token punctuation\">,</span> brand<span class=\"token operator\">=</span><span class=\"token number\">7</span>天酒店<span class=\"token punctuation\">,</span> city<span class=\"token operator\">=</span>上海<span class=\"token punctuation\">,</span> starName<span class=\"token operator\">=</span>二钻<span class=\"token punctuation\">,</span> business<span class=\"token operator\">=</span>四川北路商业区<span class=\"token punctuation\">,</span> location<span class=\"token operator\">=</span><span class=\"token number\">31.251433</span><span class=\"token punctuation\">,</span> <span class=\"token number\">121.47522</span><span class=\"token punctuation\">,</span> pic<span class=\"token operator\">=</span>https<span class=\"token operator\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>m<span class=\"token punctuation\">.</span>tuniucdn<span class=\"token punctuation\">.</span>com<span class=\"token operator\">/</span>fb2<span class=\"token operator\">/</span>t1<span class=\"token operator\">/</span><span class=\"token constant\">G1</span><span class=\"token operator\">/</span><span class=\"token constant\">M00</span><span class=\"token operator\">/</span><span class=\"token number\">3</span>E<span class=\"token operator\">/</span><span class=\"token number\">40</span><span class=\"token operator\">/</span><span class=\"token class-name\">Cii9EVkyLrKIXo1vAAHgrxo_pUcAALcKQLD688AAeDH564_w200_h200_c1_t0</span><span class=\"token punctuation\">.</span>jpg<span class=\"token punctuation\">,</span> distance<span class=\"token operator\">=</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> isAD<span class=\"token operator\">=</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>hotelDoc<span class=\"token operator\">:</span> <span class=\"token class-name\">HotelDoc</span><span class=\"token punctuation\">(</span>id<span class=\"token operator\">=</span><span class=\"token number\">60935</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span>上海虹口三至喜来登酒店<span class=\"token punctuation\">,</span> address<span class=\"token operator\">=</span>四平路<span class=\"token number\">59</span>号<span class=\"token punctuation\">,</span> price<span class=\"token operator\">=</span><span class=\"token number\">1899</span><span class=\"token punctuation\">,</span> score<span class=\"token operator\">=</span><span class=\"token number\">46</span><span class=\"token punctuation\">,</span> brand<span class=\"token operator\">=</span>喜来登<span class=\"token punctuation\">,</span> city<span class=\"token operator\">=</span>上海<span class=\"token punctuation\">,</span> starName<span class=\"token operator\">=</span>五星级<span class=\"token punctuation\">,</span> business<span class=\"token operator\">=</span>四川北路商业区<span class=\"token punctuation\">,</span> location<span class=\"token operator\">=</span><span class=\"token number\">31.2579</span><span class=\"token punctuation\">,</span> <span class=\"token number\">121.487954</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>                   <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></pre></td></tr></table></figure><h6 id=\"99754-组合查询-function-score\"><a class=\"markdownIt-Anchor\" href=\"#99754-组合查询-function-score\">#</a> 9.9.7.5.4、组合查询 - function score🎋</h6>\n<p>Function Score 查询可以控制文档的相关性算分，使用方式如下：</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310141739473.png\" alt=\"image-20231014173905116\"></p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Test</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">testFunctionScore</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>   <span class=\"token comment\">// 1. 准备 Request</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>   <span class=\"token class-name\">SearchRequest</span> request <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SearchRequest</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"dkx\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>   <span class=\"token comment\">// 2. 准备 DSL</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>   <span class=\"token comment\">// 算分控制</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>   <span class=\"token class-name\">FunctionScoreQueryBuilder</span> functionScoreQueryBuilder <span class=\"token operator\">=</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>      <span class=\"token class-name\">QueryBuilders</span><span class=\"token punctuation\">.</span><span class=\"token function\">functionScoreQuery</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>      <span class=\"token comment\">// 查询 name = 外滩</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token class-name\">QueryBuilders</span><span class=\"token punctuation\">.</span><span class=\"token function\">matchQuery</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"name\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"外滩\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      <span class=\"token keyword\">new</span> <span class=\"token class-name\">FunctionScoreQueryBuilder<span class=\"token punctuation\">.</span>FilterFunctionBuilder</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>         <span class=\"token keyword\">new</span> <span class=\"token class-name\">FunctionScoreQueryBuilder<span class=\"token punctuation\">.</span>FilterFunctionBuilder</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>            <span class=\"token comment\">// 过滤字段</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            <span class=\"token class-name\">QueryBuilders</span><span class=\"token punctuation\">.</span><span class=\"token function\">termQuery</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"brand\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"如家\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>            <span class=\"token comment\">// 加权</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            <span class=\"token class-name\">ScoreFunctionBuilders</span><span class=\"token punctuation\">.</span><span class=\"token function\">weightFactorFunction</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>         <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>   <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>   request<span class=\"token punctuation\">.</span><span class=\"token function\">source</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">query</span><span class=\"token punctuation\">(</span>functionScoreQueryBuilder<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>   <span class=\"token comment\">// 3. 发送请求</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>   <span class=\"token class-name\">SearchResponse</span> search<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>   <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>      search <span class=\"token operator\">=</span> client<span class=\"token punctuation\">.</span><span class=\"token function\">search</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">,</span> <span class=\"token class-name\">RequestOptions</span><span class=\"token punctuation\">.</span><span class=\"token constant\">DEFAULT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">IOException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>   <span class=\"token function\">handle</span><span class=\"token punctuation\">(</span>search<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">handle</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">SearchResponse</span> search<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>   <span class=\"token comment\">// 4. 解析响应</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>   <span class=\"token class-name\">SearchHits</span> hits <span class=\"token operator\">=</span> search<span class=\"token punctuation\">.</span><span class=\"token function\">getHits</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>   <span class=\"token keyword\">long</span> value <span class=\"token operator\">=</span> hits<span class=\"token punctuation\">.</span><span class=\"token function\">getTotalHits</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>   <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"共搜索到\"</span> <span class=\"token operator\">+</span> value <span class=\"token operator\">+</span> <span class=\"token string\">\"条数据\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>   <span class=\"token class-name\">SearchHit</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> hits1 <span class=\"token operator\">=</span> hits<span class=\"token punctuation\">.</span><span class=\"token function\">getHits</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>   <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">SearchHit</span> hit <span class=\"token operator\">:</span> hits1<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>      <span class=\"token class-name\">String</span> json <span class=\"token operator\">=</span> hit<span class=\"token punctuation\">.</span><span class=\"token function\">getSourceAsString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>      <span class=\"token class-name\">HotelDoc</span> hotelDoc <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parseObject</span><span class=\"token punctuation\">(</span>json<span class=\"token punctuation\">,</span> <span class=\"token class-name\">HotelDoc</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>      <span class=\"token comment\">// 获取高亮结果</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>      <span class=\"token class-name\">Map</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">HighlightField</span><span class=\"token punctuation\">></span></span> highlightFields <span class=\"token operator\">=</span> hit<span class=\"token punctuation\">.</span><span class=\"token function\">getHighlightFields</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>      <span class=\"token comment\">// CollectionUtils：Spring 提供的工具类 isEmpty 判断 Map 集合是否为空</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>      <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span> <span class=\"token class-name\">CollectionUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">isEmpty</span><span class=\"token punctuation\">(</span>highlightFields<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>      <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>         <span class=\"token comment\">// 根据字段名获取高亮结果</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>         <span class=\"token class-name\">HighlightField</span> name <span class=\"token operator\">=</span> highlightFields<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"name\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>         <span class=\"token comment\">// 判断根据字段获取的内容是否为 null</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>         <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>         <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>            <span class=\"token comment\">// 获取高亮值</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>            <span class=\"token class-name\">String</span> content <span class=\"token operator\">=</span> name<span class=\"token punctuation\">.</span><span class=\"token function\">getFragments</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">string</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>            <span class=\"token comment\">// 覆盖非高亮结果</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>            hotelDoc<span class=\"token punctuation\">.</span><span class=\"token function\">setName</span><span class=\"token punctuation\">(</span>content<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>         <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>      <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"hotelDoc: \"</span> <span class=\"token operator\">+</span> hotelDoc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre><span class=\"token comment\">//--------------------- 打印结果 ---------------------</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>共搜索到<span class=\"token number\">3</span>条数据</pre></td></tr><tr><td data-num=\"62\"></td><td><pre>hotelDoc<span class=\"token operator\">:</span> <span class=\"token class-name\">HotelDoc</span><span class=\"token punctuation\">(</span>id<span class=\"token operator\">=</span><span class=\"token number\">434082</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span>如家酒店·<span class=\"token function\">neo</span><span class=\"token punctuation\">(</span>上海外滩城隍庙小南门地铁站店<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> address<span class=\"token operator\">=</span>复兴东路<span class=\"token number\">260</span>号<span class=\"token punctuation\">,</span> price<span class=\"token operator\">=</span><span class=\"token number\">392</span><span class=\"token punctuation\">,</span> score<span class=\"token operator\">=</span><span class=\"token number\">44</span><span class=\"token punctuation\">,</span> brand<span class=\"token operator\">=</span>如家<span class=\"token punctuation\">,</span> city<span class=\"token operator\">=</span>上海<span class=\"token punctuation\">,</span> starName<span class=\"token operator\">=</span>二钻<span class=\"token punctuation\">,</span> business<span class=\"token operator\">=</span>豫园地区<span class=\"token punctuation\">,</span> location<span class=\"token operator\">=</span><span class=\"token number\">31.220706</span><span class=\"token punctuation\">,</span> <span class=\"token number\">121.498769</span><span class=\"token punctuation\">,</span> pic<span class=\"token operator\">=</span>https<span class=\"token operator\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>m<span class=\"token punctuation\">.</span>tuniucdn<span class=\"token punctuation\">.</span>com<span class=\"token operator\">/</span>fb2<span class=\"token operator\">/</span>t1<span class=\"token operator\">/</span><span class=\"token constant\">G6</span><span class=\"token operator\">/</span><span class=\"token constant\">M00</span><span class=\"token operator\">/</span><span class=\"token number\">52</span><span class=\"token operator\">/</span><span class=\"token constant\">B6</span><span class=\"token operator\">/</span><span class=\"token class-name\">Cii</span><span class=\"token operator\">-</span><span class=\"token class-name\">U13eXLGIdHFzAAIG</span><span class=\"token operator\">-</span><span class=\"token number\">5</span>cEwDEAAGRfQNNIV0AAgcT627_w200_h200_c1_t0<span class=\"token punctuation\">.</span>jpg<span class=\"token punctuation\">,</span> distance<span class=\"token operator\">=</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> isAD<span class=\"token operator\">=</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>hotelDoc<span class=\"token operator\">:</span> <span class=\"token class-name\">HotelDoc</span><span class=\"token punctuation\">(</span>id<span class=\"token operator\">=</span><span class=\"token number\">60487</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span>上海外滩茂悦大酒店<span class=\"token punctuation\">,</span> address<span class=\"token operator\">=</span>黄浦路<span class=\"token number\">199</span>号<span class=\"token punctuation\">,</span> price<span class=\"token operator\">=</span><span class=\"token number\">689</span><span class=\"token punctuation\">,</span> score<span class=\"token operator\">=</span><span class=\"token number\">44</span><span class=\"token punctuation\">,</span> brand<span class=\"token operator\">=</span>君悦<span class=\"token punctuation\">,</span> city<span class=\"token operator\">=</span>上海<span class=\"token punctuation\">,</span> starName<span class=\"token operator\">=</span>五星级<span class=\"token punctuation\">,</span> business<span class=\"token operator\">=</span>外滩地区<span class=\"token punctuation\">,</span> location<span class=\"token operator\">=</span><span class=\"token number\">31.245409</span><span class=\"token punctuation\">,</span> <span class=\"token number\">121.492969</span><span class=\"token punctuation\">,</span> pic<span class=\"token operator\">=</span>https<span class=\"token operator\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>m<span class=\"token punctuation\">.</span>tuniucdn<span class=\"token punctuation\">.</span>com<span class=\"token operator\">/</span>fb3<span class=\"token operator\">/</span>s1<span class=\"token operator\">/</span><span class=\"token number\">2</span>n9c<span class=\"token operator\">/</span><span class=\"token number\">2</span>Swp2h1fdj9zCUKsk63BQvVgKLTo_w200_h200_c1_t0<span class=\"token punctuation\">.</span>jpg<span class=\"token punctuation\">,</span> distance<span class=\"token operator\">=</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> isAD<span class=\"token operator\">=</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>hotelDoc<span class=\"token operator\">:</span> <span class=\"token class-name\">HotelDoc</span><span class=\"token punctuation\">(</span>id<span class=\"token operator\">=</span><span class=\"token number\">432335</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span><span class=\"token number\">7</span>天连锁酒店<span class=\"token punctuation\">(</span>上海北外滩国际客运中心地铁站店<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> address<span class=\"token operator\">=</span>唐山路<span class=\"token number\">145</span>号<span class=\"token punctuation\">,</span> price<span class=\"token operator\">=</span><span class=\"token number\">249</span><span class=\"token punctuation\">,</span> score<span class=\"token operator\">=</span><span class=\"token number\">35</span><span class=\"token punctuation\">,</span> brand<span class=\"token operator\">=</span><span class=\"token number\">7</span>天酒店<span class=\"token punctuation\">,</span> city<span class=\"token operator\">=</span>上海<span class=\"token punctuation\">,</span> starName<span class=\"token operator\">=</span>二钻<span class=\"token punctuation\">,</span> business<span class=\"token operator\">=</span>北外滩地区<span class=\"token punctuation\">,</span> location<span class=\"token operator\">=</span><span class=\"token number\">31.252585</span><span class=\"token punctuation\">,</span> <span class=\"token number\">121.498753</span><span class=\"token punctuation\">,</span> pic<span class=\"token operator\">=</span>https<span class=\"token operator\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>m2<span class=\"token punctuation\">.</span>tuniucdn<span class=\"token punctuation\">.</span>com<span class=\"token operator\">/</span>filebroker<span class=\"token operator\">/</span>cdn<span class=\"token operator\">/</span>res<span class=\"token operator\">/</span>c1<span class=\"token operator\">/</span>ba<span class=\"token operator\">/</span>c1baf64418437c56617f89840c6411ef_w200_h200_c1_t0<span class=\"token punctuation\">.</span>jpg<span class=\"token punctuation\">,</span> distance<span class=\"token operator\">=</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> isAD<span class=\"token operator\">=</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h6 id=\"es-restclient黑马旅游案例项目地址httpsgiteecomdoukaixintyporagit\"><a class=\"markdownIt-Anchor\" href=\"#es-restclient黑马旅游案例项目地址httpsgiteecomdoukaixintyporagit\">#</a> ES-RestClient 黑马旅游案例，项目地址：<a href=\"https://gitee.com/doukaixin/typora.git\">https://gitee.com/doukaixin/typora.git</a></h6>\n<h3 id=\"910-深入elasticsearch\"><a class=\"markdownIt-Anchor\" href=\"#910-深入elasticsearch\">#</a> 9.10、深入 elasticsearch🌳</h3>\n<ul>\n<li>数据聚合</li>\n<li>自动补全</li>\n<li>数据同步</li>\n<li>集群</li>\n</ul>\n<h4 id=\"9101-数据聚合\"><a class=\"markdownIt-Anchor\" href=\"#9101-数据聚合\">#</a> 9.10.1、数据聚合🌲</h4>\n<ul>\n<li>聚合的种类</li>\n<li>DSL 实现聚合</li>\n<li>RestAPI 实现聚合</li>\n</ul>\n<h5 id=\"91011-聚合的分类\"><a class=\"markdownIt-Anchor\" href=\"#91011-聚合的分类\">#</a> 9.10.1.1、聚合的分类🌴</h5>\n<p>聚合 (aggregations) 可以实现对文档数据的统计，分析，运算。聚合常见的有三类：</p>\n<p><font color='red'>注意</font>：聚合的字段一定是不分词的。可以是 keyword，日期，数值，布尔，但绝对不可以是 text 类型的</p>\n<ul>\n<li>桶 (Bucket) 聚合：用来对文档做分组\n<ul>\n<li>TermAggregation：按照文档字段值分组</li>\n<li>Date Histogram：按照日期阶梯分组，例如 一周为一组，或者 一月为一组</li>\n</ul>\n</li>\n<li>度量 (Metric) 聚合：用以计算一些值，比如：最大值，最小值，平均值等\n<ul>\n<li>Avg：求平均值</li>\n<li>Max：求最大值</li>\n<li>Min：求最小值</li>\n<li>Stats：同时求 max，min，avg，sum 等</li>\n</ul>\n</li>\n<li>管道 (pipeline) 聚合：对其它聚合的结果为基础做聚合</li>\n</ul>\n<blockquote>\n<p><strong>总结</strong>：</p>\n<p>什么是聚合？</p>\n<ul>\n<li>聚合是对文档数据的统计，分析，计算</li>\n</ul>\n<p>聚合的常见种类有哪些？</p>\n<ul>\n<li>Bucket：对文档数据分组，并统计每组数量</li>\n<li>Metric：对文档数据做计算，例如 avg</li>\n<li>Pipeline：基于其它聚合结果再做聚合</li>\n</ul>\n<p>参与聚合的字段类型必须是：</p>\n<ul>\n<li>keyword</li>\n<li>数值</li>\n<li>日期</li>\n<li>布尔</li>\n</ul>\n</blockquote>\n<h6 id=\"910111-dsl实现bucket聚合\"><a class=\"markdownIt-Anchor\" href=\"#910111-dsl实现bucket聚合\">#</a> 9.10.1.1.1、DSL 实现 Bucket 聚合🎋</h6>\n<p>现在，我们要统计所有数据中的酒店品牌有几种，此时可以根据酒店品牌的名称做聚合。</p>\n<p>类型为 term 类型，DSL 示例：</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>GET /indexName/_search</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>   <span class=\"token property\">\"size\"</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 设置 size 为 0, 结果中不包含文档，只包含聚合结果</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>   <span class=\"token property\">\"aggs\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token comment\">// 定义聚合</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>      <span class=\"token property\">\"brandAgg\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token comment\">// 给聚合起个名字</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>         <span class=\"token property\">\"terms\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token comment\">// 聚合的类型，按照品牌值聚合，所以选择 term</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            <span class=\"token property\">\"field\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"brand\"</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 参与聚合的字段</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            <span class=\"token property\">\"size\"</span><span class=\"token operator\">:</span> <span class=\"token number\">20</span> <span class=\"token comment\">// 希望获取的聚合结果数量</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>         <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>代码演示：</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre># 聚合功能</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>GET /dkx/_search</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token property\">\"size\"</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  <span class=\"token property\">\"aggs\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token property\">\"brandAgg\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>      <span class=\"token property\">\"terms\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token property\">\"field\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"brand\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token property\">\"size\"</span><span class=\"token operator\">:</span> <span class=\"token number\">10</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\">//----------------- 查询结果 -----------------</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token property\">\"buckets\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>          <span class=\"token property\">\"key\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"7天酒店\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>          <span class=\"token property\">\"doc_count\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">30</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>          <span class=\"token property\">\"key\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"如家\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>          <span class=\"token property\">\"doc_count\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">30</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>          <span class=\"token property\">\"key\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"皇冠假日\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>          <span class=\"token property\">\"doc_count\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">17</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>          <span class=\"token property\">\"key\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"速8\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>          <span class=\"token property\">\"doc_count\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">15</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>   ...</pre></td></tr></table></figure><p>默认是倒序排序值越大的越靠前，排序的规则是可以进行修改的</p>\n<h6 id=\"910112-bucket聚合-聚合结果排序\"><a class=\"markdownIt-Anchor\" href=\"#910112-bucket聚合-聚合结果排序\">#</a> 9.10.1.1.2、Bucket 聚合 - 聚合结果排序🎋</h6>\n<p>默认情况下，Bucket 聚合会统计 Bucket 内的文档数量，记为 <code>_count</code> ，并按照 <code>_count</code>  降序排序。</p>\n<p>我们可以修改结果排序方式：</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>GET /indexName/_search</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>   <span class=\"token property\">\"size\"</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>   <span class=\"token property\">\"aggs\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>      <span class=\"token property\">\"brandAgg\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>         <span class=\"token property\">\"terms\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            <span class=\"token property\">\"field\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"brand\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            <span class=\"token property\">\"order\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>               <span class=\"token property\">\"_count\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"asc\"</span> <span class=\"token comment\">// 按照_count 升序排列</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>            <span class=\"token property\">\"size\"</span><span class=\"token operator\">:</span> <span class=\"token number\">20</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>         <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>代码演示：</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre># 聚合功能</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>GET /dkx/_search</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token property\">\"size\"</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  <span class=\"token property\">\"aggs\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token property\">\"brandAgg\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>      <span class=\"token property\">\"terms\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token property\">\"field\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"brand\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token property\">\"size\"</span><span class=\"token operator\">:</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token property\">\"order\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>          <span class=\"token property\">\"_count\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"asc\"</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token comment\">//-------------- 打印结果 --------------</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token property\">\"brandAgg\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>      <span class=\"token property\">\"doc_count_error_upper_bound\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>      <span class=\"token property\">\"sum_other_doc_count\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">130</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>      <span class=\"token property\">\"buckets\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>          <span class=\"token property\">\"key\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"万丽\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>          <span class=\"token property\">\"doc_count\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>          <span class=\"token property\">\"key\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"丽笙\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>          <span class=\"token property\">\"doc_count\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>          <span class=\"token property\">\"key\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"君悦\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>          <span class=\"token property\">\"doc_count\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">4</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>         ...</pre></td></tr></table></figure><h6 id=\"910113-bucket聚合-限定聚合范围\"><a class=\"markdownIt-Anchor\" href=\"#910113-bucket聚合-限定聚合范围\">#</a> 9.10.1.1.3、Bucket 聚合 - 限定聚合范围🎋</h6>\n<p>默认情况下，Bucket 聚合是对索引库的所有文档做聚合，我们可以限定要聚合的文档范围，只要添加 query 条件即可。</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>GET /indexName/_search</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>   <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>      <span class=\"token property\">\"range\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>         <span class=\"token property\">\"price\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>            <span class=\"token property\">\"lte\"</span><span class=\"token operator\">:</span> <span class=\"token number\">200</span> <span class=\"token comment\">// 只对 200 元以下的文档聚合</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>         <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>   <span class=\"token property\">\"size\"</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>   <span class=\"token property\">\"aggs\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      <span class=\"token property\">\"brandAgg\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>         <span class=\"token property\">\"terms\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>            <span class=\"token property\">\"field\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"brand\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            <span class=\"token property\">\"size\"</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>         <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>代码演示：</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre># 聚合功能，限定聚合范围</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>GET /dkx/_search</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token property\">\"range\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>      <span class=\"token property\">\"price\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token property\">\"lte\"</span><span class=\"token operator\">:</span> <span class=\"token number\">200</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>  <span class=\"token property\">\"size\"</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> </pre></td></tr><tr><td data-num=\"12\"></td><td><pre>  <span class=\"token property\">\"aggs\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token property\">\"brandAgg\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>      <span class=\"token property\">\"terms\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token property\">\"field\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"brand\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token property\">\"size\"</span><span class=\"token operator\">:</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token property\">\"order\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>          <span class=\"token property\">\"_count\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"asc\"</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token comment\">//---------------- 打印结果 ----------------</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token property\">\"buckets\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>          <span class=\"token property\">\"key\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"7天酒店\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>          <span class=\"token property\">\"doc_count\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>          <span class=\"token property\">\"key\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"汉庭\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>          <span class=\"token property\">\"doc_count\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>          <span class=\"token property\">\"key\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"速8\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>          <span class=\"token property\">\"doc_count\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>          <span class=\"token property\">\"key\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"如家\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>          <span class=\"token property\">\"doc_count\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">13</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>      <span class=\"token punctuation\">]</span></pre></td></tr></table></figure><blockquote>\n<p><strong>总结</strong>：</p>\n<p>aggs 代表聚合，与 query 同级，此时 query 的作用是？</p>\n<ul>\n<li>限定聚合的文档范围</li>\n</ul>\n<p>聚合必须得三要素：</p>\n<ul>\n<li>聚合名称</li>\n<li>聚合类型</li>\n<li>聚合字段</li>\n</ul>\n<p>聚合可配置属性有：</p>\n<ul>\n<li>size：指定聚合结果数量</li>\n<li>order：指定聚合结果排序方式</li>\n<li>field：指定聚合字段</li>\n</ul>\n</blockquote>\n<h6 id=\"910114-dsl实现metrics聚合\"><a class=\"markdownIt-Anchor\" href=\"#910114-dsl实现metrics聚合\">#</a> 9.10.1.1.4、DSL 实现 Metrics 聚合🎋</h6>\n<p>例如，我们要求获取每个品牌的用户评分的 min，max，avg 等值。</p>\n<p>我们可以利用 stats 聚合：</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>GET /indexName/_search</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>   <span class=\"token property\">\"size\"</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>   <span class=\"token property\">\"aggs\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>      <span class=\"token property\">\"brandAgg\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>         <span class=\"token property\">\"terms\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            <span class=\"token property\">\"field\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"brand\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            <span class=\"token property\">\"size\"</span><span class=\"token operator\">:</span> <span class=\"token number\">20</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>         <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>         <span class=\"token property\">\"aggs\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token comment\">// 是 brands 聚合的子聚合，也就是分组后每组分别计算</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>            <span class=\"token property\">\"score_stats\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token comment\">// 聚合名称</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>               <span class=\"token property\">\"stats\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token comment\">// 聚合类型，这里 stats 可以计算 min，max，avg 等</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                  <span class=\"token property\">\"field\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"score\"</span> <span class=\"token comment\">// 聚合字段，这里是 score</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>               <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>         <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>代码演示：</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre># 嵌套聚合metrics</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>GET /dkx/_search</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token property\">\"size\"</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  <span class=\"token property\">\"aggs\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token property\">\"brandAgg\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>      <span class=\"token property\">\"terms\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token property\">\"field\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"brand\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token property\">\"size\"</span><span class=\"token operator\">:</span> <span class=\"token number\">20</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token property\">\"aggs\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token property\">\"score_stats\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>          <span class=\"token property\">\"stats\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>            <span class=\"token property\">\"field\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"score\"</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>          <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token comment\">//------------------------- 打印结果 -------------------------</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token property\">\"buckets\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>          <span class=\"token property\">\"key\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"7天酒店\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>          <span class=\"token property\">\"doc_count\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">30</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>          <span class=\"token property\">\"score_stats\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>            <span class=\"token property\">\"count\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">30</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>            <span class=\"token property\">\"min\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">35.0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>            <span class=\"token property\">\"max\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">43.0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>            <span class=\"token property\">\"avg\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">37.86666666666667</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>            <span class=\"token property\">\"sum\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">1136.0</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>          <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>          <span class=\"token property\">\"key\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"如家\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>          <span class=\"token property\">\"doc_count\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">30</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>          <span class=\"token property\">\"score_stats\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>            <span class=\"token property\">\"count\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">30</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>            <span class=\"token property\">\"min\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">43.0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>            <span class=\"token property\">\"max\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">47.0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>            <span class=\"token property\">\"avg\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">44.833333333333336</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>            <span class=\"token property\">\"sum\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">1345.0</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>          <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>   ...</pre></td></tr></table></figure><p>对 score_stats 中的 avg 做一个排序</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre># 嵌套聚合metrics</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>GET /dkx/_search</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token property\">\"size\"</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  <span class=\"token property\">\"aggs\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token property\">\"brandAgg\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>      <span class=\"token property\">\"terms\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token property\">\"field\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"brand\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token property\">\"size\"</span><span class=\"token operator\">:</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token property\">\"order\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>          <span class=\"token property\">\"score_stats.avg\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"desc\"</span> <span class=\"token comment\">// 对 score_stats 中的 avg 进行降序排序</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>      <span class=\"token property\">\"aggs\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token property\">\"score_stats\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>          <span class=\"token property\">\"stats\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            <span class=\"token property\">\"field\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"score\"</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>          <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token comment\">//---------------------- 打印结果 ----------------------</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token property\">\"buckets\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>          <span class=\"token property\">\"key\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"万丽\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>          <span class=\"token property\">\"doc_count\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>          <span class=\"token property\">\"score_stats\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>            <span class=\"token property\">\"count\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>            <span class=\"token property\">\"min\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">46.0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>            <span class=\"token property\">\"max\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">47.0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>            <span class=\"token property\">\"avg\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">46.5</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>            <span class=\"token property\">\"sum\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">93.0</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>          <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>          <span class=\"token property\">\"key\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"凯悦\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>          <span class=\"token property\">\"doc_count\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>          <span class=\"token property\">\"score_stats\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>            <span class=\"token property\">\"count\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>            <span class=\"token property\">\"min\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">45.0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>            <span class=\"token property\">\"max\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">47.0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>            <span class=\"token property\">\"avg\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">46.25</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>            <span class=\"token property\">\"sum\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">370.0</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>          <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>   ...</pre></td></tr></table></figure><h5 id=\"91012-restapi实现聚合\"><a class=\"markdownIt-Anchor\" href=\"#91012-restapi实现聚合\">#</a> 9.10.1.2、RestAPI 实现聚合🌴</h5>\n<p>我们以品牌聚合为例，演示下 Java 的 RestClient 使用，先看请求组装：</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310142115151.png\" alt=\"image-20231014211458877\"></p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>@Test</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>public void testAggreation()</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>   <span class=\"token comment\">// 1. 准备 Request</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>   SearchRequest request = new SearchRequest(<span class=\"token string\">\"dkx\"</span>);</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\">// 2. 准备 DSL</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\">// 2.1. 设置 size 去掉文档数据</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>request.source().size(<span class=\"token number\">0</span>);</pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\">// 2.2. 聚合</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>request.source().aggregation(AggregationBuilders</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>                             .terms(<span class=\"token string\">\"brandAgg\"</span>)</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>                             .field(<span class=\"token string\">\"brand\"</span>)</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                             .size(<span class=\"token number\">10</span>)</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>                            );</pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\">// 3. 发送请求</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>SearchResponse search;</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>try <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>   search = client.search(request<span class=\"token punctuation\">,</span> RequestOptions.DEFAULT);</pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token punctuation\">&#125;</span> catch (IOException e) <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>   throw new RuntimeException(e);</pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>System.out.println(search);</pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token comment\">//-------------------- 打印结果 --------------------</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token punctuation\">&#123;</span><span class=\"token property\">\"took\"</span><span class=\"token operator\">:</span><span class=\"token number\">83</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"timed_out\"</span><span class=\"token operator\">:</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"_shards\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">&#123;</span><span class=\"token property\">\"total\"</span><span class=\"token operator\">:</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"successful\"</span><span class=\"token operator\">:</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"skipped\"</span><span class=\"token operator\">:</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"failed\"</span><span class=\"token operator\">:</span><span class=\"token number\">0</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"hits\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">&#123;</span><span class=\"token property\">\"total\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">&#123;</span><span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span><span class=\"token number\">201</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"relation\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"eq\"</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"max_score\"</span><span class=\"token operator\">:</span><span class=\"token null keyword\">null</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"hits\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"aggregations\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">&#123;</span><span class=\"token property\">\"sterms#brandAgg\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">&#123;</span><span class=\"token property\">\"doc_count_error_upper_bound\"</span><span class=\"token operator\">:</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"sum_other_doc_count\"</span><span class=\"token operator\">:</span><span class=\"token number\">39</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"buckets\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">&#123;</span><span class=\"token property\">\"key\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"7天酒店\"</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"doc_count\"</span><span class=\"token operator\">:</span><span class=\"token number\">30</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">&#123;</span><span class=\"token property\">\"key\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"如家\"</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"doc_count\"</span><span class=\"token operator\">:</span><span class=\"token number\">30</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">&#123;</span><span class=\"token property\">\"key\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"皇冠假日\"</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"doc_count\"</span><span class=\"token operator\">:</span><span class=\"token number\">17</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">&#123;</span><span class=\"token property\">\"key\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"速8\"</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"doc_count\"</span><span class=\"token operator\">:</span><span class=\"token number\">15</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">&#123;</span><span class=\"token property\">\"key\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"万怡\"</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"doc_count\"</span><span class=\"token operator\">:</span><span class=\"token number\">13</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">&#123;</span><span class=\"token property\">\"key\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"华美达\"</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"doc_count\"</span><span class=\"token operator\">:</span><span class=\"token number\">13</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">&#123;</span><span class=\"token property\">\"key\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"和颐\"</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"doc_count\"</span><span class=\"token operator\">:</span><span class=\"token number\">12</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">&#123;</span><span class=\"token property\">\"key\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"万豪\"</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"doc_count\"</span><span class=\"token operator\">:</span><span class=\"token number\">11</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">&#123;</span><span class=\"token property\">\"key\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"喜来登\"</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"doc_count\"</span><span class=\"token operator\">:</span><span class=\"token number\">11</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">&#123;</span><span class=\"token property\">\"key\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"希尔顿\"</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"doc_count\"</span><span class=\"token operator\">:</span><span class=\"token number\">10</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h6 id=\"910121-聚合结果解析\"><a class=\"markdownIt-Anchor\" href=\"#910121-聚合结果解析\">#</a> 9.10.1.2.1、聚合结果解析🌴</h6>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310142127780.png\" alt=\"image-20231014212710555\"></p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Test</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">testAggreation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>   <span class=\"token comment\">// 1. 准备 Request</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>   <span class=\"token class-name\">SearchRequest</span> request <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SearchRequest</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"dkx\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>   <span class=\"token comment\">// 2. 准备 DSL</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>   <span class=\"token comment\">// 2.1. 设置 size 去掉文档数据</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>   request<span class=\"token punctuation\">.</span><span class=\"token function\">source</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>   <span class=\"token comment\">// 2.2. 聚合</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>   request<span class=\"token punctuation\">.</span><span class=\"token function\">source</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">aggregation</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">AggregationBuilders</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>                                <span class=\"token punctuation\">.</span><span class=\"token function\">terms</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"brandAgg\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>                                <span class=\"token punctuation\">.</span><span class=\"token function\">field</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"brand\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                                <span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>                               <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>   <span class=\"token comment\">// 3. 发送请求</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>   <span class=\"token class-name\">SearchResponse</span> search<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>   <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>      search <span class=\"token operator\">=</span> client<span class=\"token punctuation\">.</span><span class=\"token function\">search</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">,</span> <span class=\"token class-name\">RequestOptions</span><span class=\"token punctuation\">.</span><span class=\"token constant\">DEFAULT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">IOException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>   <span class=\"token comment\">// 4. 调用函数解析响应结果</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>   <span class=\"token function\">handleAgg</span><span class=\"token punctuation\">(</span>search<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">handleAgg</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">SearchResponse</span> search<span class=\"token punctuation\">)</span> </pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>   <span class=\"token class-name\">Aggregations</span> aggregations <span class=\"token operator\">=</span> search<span class=\"token punctuation\">.</span><span class=\"token function\">getAggregations</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>   <span class=\"token comment\">// 4.1. 根据聚合名称获取聚合结果</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>   <span class=\"token class-name\">Terms</span> brandTerms <span class=\"token operator\">=</span> aggregations<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"brandAgg\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>   <span class=\"token comment\">// 4.2. 获取 Buckets</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>   <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token operator\">?</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Terms<span class=\"token punctuation\">.</span>Bucket</span><span class=\"token punctuation\">></span></span> buckets <span class=\"token operator\">=</span> brandTerms<span class=\"token punctuation\">.</span><span class=\"token function\">getBuckets</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>   <span class=\"token comment\">// 4.3. 遍历桶</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>   <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Terms<span class=\"token punctuation\">.</span>Bucket</span> bucket <span class=\"token operator\">:</span> buckets<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>      <span class=\"token comment\">// 4.4. 获取 key</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>      <span class=\"token class-name\">String</span> keyAsString <span class=\"token operator\">=</span> bucket<span class=\"token punctuation\">.</span><span class=\"token function\">getKeyAsString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>      <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>keyAsString<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre><span class=\"token comment\">//------------------- 打印结果 -------------------</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre><span class=\"token number\">7</span>天酒店</pre></td></tr><tr><td data-num=\"42\"></td><td><pre>如家</pre></td></tr><tr><td data-num=\"43\"></td><td><pre>皇冠假日</pre></td></tr><tr><td data-num=\"44\"></td><td><pre>速<span class=\"token number\">8</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>万怡</pre></td></tr><tr><td data-num=\"46\"></td><td><pre>华美达</pre></td></tr><tr><td data-num=\"47\"></td><td><pre>和颐</pre></td></tr><tr><td data-num=\"48\"></td><td><pre>万豪</pre></td></tr><tr><td data-num=\"49\"></td><td><pre>喜来登</pre></td></tr><tr><td data-num=\"50\"></td><td><pre>希尔顿</pre></td></tr></table></figure><h4 id=\"9102-自动补全\"><a class=\"markdownIt-Anchor\" href=\"#9102-自动补全\">#</a> 9.10.2、自动补全🌲</h4>\n<ul>\n<li>拼音分词器</li>\n<li>自定义分词器</li>\n<li>自动补全查询</li>\n<li>实现酒店搜索框自动补全</li>\n</ul>\n<h5 id=\"91021-自动补全需求说明\"><a class=\"markdownIt-Anchor\" href=\"#91021-自动补全需求说明\">#</a> 9.10.2.1、自动补全需求说明🌴</h5>\n<p>当用户在搜索框输入字符时，我们应该提示出与该字符有关的搜索项，如图：</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310142231178.png\" alt=\"image-20231014223100805\"></p>\n<h5 id=\"91022-使用拼音分词\"><a class=\"markdownIt-Anchor\" href=\"#91022-使用拼音分词\">#</a> 9.10.2.2、使用拼音分词🌴</h5>\n<p>要实现根据字母做不全，就必须对文档按照拼音分词。在 GitHub 上恰好有 elasticsearch 的拼音分词插件。地址：<a href=\"https://github.com/medcl/elasticsearch-analysis-pinyin/releases\">https://github.com/medcl/elasticsearch-analysis-pinyin/releases</a></p>\n<p>安装方式与 IK 分词器一样，分三步：</p>\n<p>1、解压</p>\n<p>2、上传到虚拟机中，elasticsearch 的 plugin 目录</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310142242869.png\" alt=\"image-20231014224223983\"></p>\n<p>3、重启 elasticsearch</p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@192 _data<span class=\"token punctuation\">]</span><span class=\"token comment\"># docker restart es</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>es</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">[</span>root@192 _data<span class=\"token punctuation\">]</span><span class=\"token comment\">#</span></pre></td></tr></table></figure><p>4、测试</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310142248099.png\" alt=\"image-20231014224855664\"></p>\n<h5 id=\"91023-自定义分词器\"><a class=\"markdownIt-Anchor\" href=\"#91023-自定义分词器\">#</a> 9.10.2.3、自定义分词器🌴</h5>\n<p>elasticsearch 中分词器 (analyzer) 的组成包含三部分：</p>\n<ul>\n<li>character filters：在 tokenizer 之前对本文进行处理。例如删除字符，替换字符</li>\n<li>tokenizer：将文本按照一定的规则切割成词条 (term)。例如 keyword，就是不分词；还有 ik_smart</li>\n<li>tokenizer filter：将 tokenizer 输出的词条做进一步处理。例如大小写转换，同义词处理，拼音处理等</li>\n</ul>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310151109094.png\" alt=\"image-20231015110900632\"></p>\n<p>我们可以在创建索引库时，通过 settings 来配置自定义的 analyzer (分词器)：</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310151115651.png\" alt=\"image-20231015111515104\"></p>\n<p>代码演示：</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre># 自定义分词器</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>PUT /test</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token property\">\"settings\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token property\">\"analysis\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>      <span class=\"token property\">\"analyzer\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token property\">\"my_analzer\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>          <span class=\"token property\">\"tokenizer\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ik_max_word\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>          <span class=\"token property\">\"filter\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"py\"</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      <span class=\"token property\">\"filter\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token property\">\"py\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>          <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"pinyin\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>          <span class=\"token property\">\"keep_full_pinyin\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>          <span class=\"token property\">\"keep_joined_full_pinyin\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>          <span class=\"token property\">\"keep_original\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>          <span class=\"token property\">\"limit_first_letter_length\"</span><span class=\"token operator\">:</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>          <span class=\"token property\">\"remove_duplicated_term\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>          <span class=\"token property\">\"none_chinese_pinyin_tokenize\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>  <span class=\"token property\">\"mappings\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token property\">\"properties\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>      <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        <span class=\"token property\">\"analyzer\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"my_analzer\"</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>测试</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>POST /test/_analyze <span class=\"token comment\">// 使用 my_analzer 自定义分词器需要带上 test 索引库名</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token property\">\"text\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"如家酒店还不错嘛\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token property\">\"analyzer\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"my_analzer\"</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\">//------------------ 查询结果 ------------------</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token property\">\"tokens\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>      <span class=\"token property\">\"token\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"如家\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>      <span class=\"token property\">\"start_offset\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token property\">\"end_offset\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      <span class=\"token property\">\"type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"CN_WORD\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>      <span class=\"token property\">\"position\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>      <span class=\"token property\">\"token\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"rujia\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>      <span class=\"token property\">\"start_offset\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>      <span class=\"token property\">\"end_offset\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>      <span class=\"token property\">\"type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"CN_WORD\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>      <span class=\"token property\">\"position\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>      <span class=\"token property\">\"token\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"rj\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>      <span class=\"token property\">\"start_offset\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>      <span class=\"token property\">\"end_offset\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>      <span class=\"token property\">\"type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"CN_WORD\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>      <span class=\"token property\">\"position\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>      <span class=\"token property\">\"token\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"酒店\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>      <span class=\"token property\">\"start_offset\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>      <span class=\"token property\">\"end_offset\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>      <span class=\"token property\">\"type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"CN_WORD\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>      <span class=\"token property\">\"position\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>      <span class=\"token property\">\"token\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"jiudian\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>      <span class=\"token property\">\"start_offset\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>      <span class=\"token property\">\"end_offset\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>      <span class=\"token property\">\"type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"CN_WORD\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>      <span class=\"token property\">\"position\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>      <span class=\"token property\">\"token\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"jd\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>      <span class=\"token property\">\"start_offset\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>      <span class=\"token property\">\"end_offset\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>      <span class=\"token property\">\"type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"CN_WORD\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>      <span class=\"token property\">\"position\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>   ...</pre></td></tr></table></figure><p>添加两个 name 字段然后再通过拼音测试是否能查询到</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>POST /test/_doc/<span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"狮子\"</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>POST /test/_doc/<span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"柿子\"</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>查询测试：</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>GET /test/_search</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token property\">\"match\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>      <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"shizi\"</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\">//---------------------- 查询结果 ----------------------</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token property\">\"hits\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token property\">\"_index\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"test\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token property\">\"_type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"_doc\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token property\">\"_id\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"1\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token property\">\"_score\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">0.25069216</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token property\">\"_source\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>          <span class=\"token property\">\"id\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>          <span class=\"token property\">\"name\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"狮子\"</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>      <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token property\">\"_index\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"test\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token property\">\"_type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"_doc\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token property\">\"_id\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"2\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        <span class=\"token property\">\"_score\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">0.25069216</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        <span class=\"token property\">\"_source\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>          <span class=\"token property\">\"id\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>          <span class=\"token property\">\"name\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"柿子\"</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token punctuation\">]</span></pre></td></tr></table></figure><p>但是有个问题，如果查询的是中文的 “狮子” 也就查询出同音的结果测试如下：</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>GET /test/_search</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token property\">\"match\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>      <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"掉入狮子笼\"</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\">//-------------------- 查询结果 --------------------</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token property\">\"hits\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token property\">\"_index\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"test\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token property\">\"_type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"_doc\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token property\">\"_id\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"1\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token property\">\"_score\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">0.33425623</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token property\">\"_source\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>          <span class=\"token property\">\"id\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>          <span class=\"token property\">\"name\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"狮子\"</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>      <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token property\">\"_index\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"test\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token property\">\"_type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"_doc\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token property\">\"_id\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"2\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        <span class=\"token property\">\"_score\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">0.3085442</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        <span class=\"token property\">\"_source\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>          <span class=\"token property\">\"id\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>          <span class=\"token property\">\"name\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"柿子\"</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token punctuation\">]</span></pre></td></tr></table></figure><p>拼音分词器合适在创建倒排索引的时候使用，但不能在搜索的时候使用。</p>\n<p>创建倒排索引时：</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310151144762.png\" alt=\"image-20231015114300456\"></p>\n<p>我们要分开，创建时和搜索时使用不同的分词器</p>\n<p>因此字段在创建倒排索引时应该用  <code>my_analyer</code>  分词器，字段在搜索时应该使用  <code>ik_smart</code>  分词器；</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre># 自定义分词器</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>PUT /test</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token property\">\"settings\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token property\">\"analysis\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>      <span class=\"token property\">\"analyzer\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token property\">\"my_analzer\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>          <span class=\"token property\">\"tokenizer\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ik_max_word\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>          <span class=\"token property\">\"filter\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"py\"</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      <span class=\"token property\">\"filter\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token property\">\"py\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>          ...</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>  <span class=\"token property\">\"mappings\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token property\">\"properties\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>      <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token property\">\"analyzer\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"my_analzer\"</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 创建索引时使用的分词器</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>         <span class=\"token property\">\"search_analyzer\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ik_smart\"</span> <span class=\"token comment\">// 搜索时使用的分词器</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>代码演示：</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre># 自定义分词器</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>PUT /test</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token property\">\"settings\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token property\">\"analysis\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>      <span class=\"token property\">\"analyzer\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token property\">\"my_analzer\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>          <span class=\"token property\">\"tokenizer\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ik_max_word\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>          <span class=\"token property\">\"filter\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"py\"</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      <span class=\"token property\">\"filter\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token property\">\"py\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>          <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"pinyin\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>          <span class=\"token property\">\"keep_full_pinyin\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>          <span class=\"token property\">\"keep_joined_full_pinyin\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>          <span class=\"token property\">\"keep_original\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>          <span class=\"token property\">\"limit_first_letter_length\"</span><span class=\"token operator\">:</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>          <span class=\"token property\">\"remove_duplicated_term\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>          <span class=\"token property\">\"none_chinese_pinyin_tokenize\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>  <span class=\"token property\">\"mappings\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token property\">\"properties\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>      <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        <span class=\"token property\">\"analyzer\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"my_analzer\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        <span class=\"token property\">\"search_analyzer\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ik_smart\"</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>POST /test/_doc/<span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>  <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>  <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"狮子\"</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>POST /test/_doc/<span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>  <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>  <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"柿子\"</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>测试查询结果：</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>GET /test/_search</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token property\">\"match\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>      <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"掉入狮子笼\"</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\">//--------------------- 查询结果 ---------------------</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token property\">\"hits\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token property\">\"_index\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"test\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token property\">\"_type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"_doc\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token property\">\"_id\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"1\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token property\">\"_score\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">0.9530773</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token property\">\"_source\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>          <span class=\"token property\">\"id\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>          <span class=\"token property\">\"name\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"狮子\"</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token punctuation\">]</span></pre></td></tr></table></figure><blockquote>\n<p>总结：</p>\n<p>如何使用拼音分词器？</p>\n<ol>\n<li>下载 pinyin 分词器</li>\n<li>解压并放到 elasticsearch 的 plugin 目录</li>\n<li>重启即可</li>\n</ol>\n<p>如何自定义分词器？</p>\n<ol>\n<li>创建索引库时，在 settings 中配置，可以包含三部分</li>\n<li>character filter</li>\n<li>tokenizer</li>\n<li>filter</li>\n</ol>\n<p>拼音分词器注意事项？</p>\n<ul>\n<li>为了避免搜索到同音字，搜索时不要使用拼音分词器</li>\n</ul>\n</blockquote>\n<h5 id=\"91024-completion-suggester查询\"><a class=\"markdownIt-Anchor\" href=\"#91024-completion-suggester查询\">#</a> 9.10.2.4、completion suggester 查询🌴</h5>\n<p>elasticsearch 提供了 Completion Suggester 查询来实现自动补全功能。这个查询会匹配以用户输入内容开头的词条并返回。为了提高补全查询的效率，对于文档中字段的类型有一些约束</p>\n<ul>\n<li>参与补全查询的字段必须是 completion 类型。</li>\n<li>字段的内容一般是用来补全的多个词条形成的数组。</li>\n</ul>\n<p>文档中 title：[“Sony”, “WH-1000XM3”] 。字段值是一个数组，“品牌”, “产品”。它是形成了两个词条而不是一个词条为什么要分开呢？</p>\n<p>原因：自动补全是根据词条做自动补全的，如果将两个信息何为一个字符串将来做自动补全时就只能通过 S 来补全了，而输入 W 时是不会补全产品名称的，分成数组就是两个词。用户输入 S 时能补全 “Sony”，用户输入 W 时能补全 “WH-1000XM3”，我们尽量吧词语分成一个一个词条放到数组中</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310151210270.png\" alt=\"image-20231015121026947\"></p>\n<p>查询语法如下：</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// 自动补全查询</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>GET /test/_search</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>   <span class=\"token property\">\"suggest\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>      <span class=\"token property\">\"title_suggest\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>         <span class=\"token property\">\"text\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"s\"</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 关键字</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>         <span class=\"token property\">\"completion\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            <span class=\"token property\">\"field\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"title\"</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 补全查询的字段</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            <span class=\"token property\">\"skip_duplicates\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 跳过重复的</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>            <span class=\"token property\">\"size\"</span><span class=\"token operator\">:</span> <span class=\"token number\">10</span> <span class=\"token comment\">// 获取前 10 条结果</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>         <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>代码演示：</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre># 自动补全的索引库</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>PUT /test1</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token property\">\"mappings\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token property\">\"properties\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>      <span class=\"token property\">\"title\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"completion\"</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre># 添加示例数据</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>POST /test1/_doc</pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>  <span class=\"token property\">\"title\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"Sony\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"WH-1000XM3\"</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>POST /test1/_doc</pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>  <span class=\"token property\">\"title\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"SK-II\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"PITERA\"</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>POST /test1/_doc</pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>  <span class=\"token property\">\"title\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"Nintendo\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"switch\"</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>测试查询补全结果：</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre># 自动补全查询</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>GET /test1/_search</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token property\">\"suggest\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token property\">\"titleSuggest\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>      <span class=\"token property\">\"text\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"so\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>      <span class=\"token property\">\"completion\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token property\">\"field\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"title\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token property\">\"skip_duplicates\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span> </pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token property\">\"size\"</span><span class=\"token operator\">:</span> <span class=\"token number\">10</span> </pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\">//------------------- 查询结果 -------------------</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token property\">\"options\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>          <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            <span class=\"token property\">\"text\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"Sony\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>            <span class=\"token property\">\"_index\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"test1\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>            <span class=\"token property\">\"_type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"_doc\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>            <span class=\"token property\">\"_id\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"reCRMYsBNslGvgguxrYc\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>            <span class=\"token property\">\"_score\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">1.0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>            <span class=\"token property\">\"_source\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>              <span class=\"token property\">\"title\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>                <span class=\"token string\">\"Sony\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>                <span class=\"token string\">\"WH-1000XM3\"</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>              <span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>          <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        <span class=\"token punctuation\">]</span></pre></td></tr></table></figure><blockquote>\n<p><strong>总结</strong>：</p>\n<p>自动补全对字段的要求：</p>\n<ul>\n<li>类型是 completion 类型</li>\n<li>字段值是多次词条的数组</li>\n</ul>\n</blockquote>\n<h5 id=\"91025-restapi实现自动补全\"><a class=\"markdownIt-Anchor\" href=\"#91025-restapi实现自动补全\">#</a> 9.10.2.5、RestAPI 实现自动补全🌴</h5>\n<p>先看请求参数构造的 API：</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310151435297.png\" alt=\"image-20231015143537333\"></p>\n<p>代码演示：</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>@Test</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>public void testSuggest()</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token comment\">// 1. 准备 Request</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    SearchRequest request = new SearchRequest(<span class=\"token string\">\"dkx\"</span>);</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token comment\">// 2. 准备 DSL</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    request.source().suggest(new SuggestBuilder()</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            .addSuggestion(</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>                    <span class=\"token string\">\"mySuggestion\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>                    SuggestBuilders</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>                            .completionSuggestion(<span class=\"token string\">\"suggestion\"</span>)</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>                            .prefix(<span class=\"token string\">\"so\"</span>)</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                            .size(<span class=\"token number\">10</span>)</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>            ));</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token comment\">// 3. 发送请求</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    SearchResponse search;</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    try <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>         search = client.search(request<span class=\"token punctuation\">,</span> RequestOptions.DEFAULT);</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>     <span class=\"token punctuation\">&#125;</span> catch (IOException e) <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>         throw new RuntimeException(e);</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>     <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>     System.out.println(search);</pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token comment\">//---------------------- 打印结果 ----------------------</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token property\">\"suggest\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">&#123;</span><span class=\"token property\">\"mySuggestion\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">&#123;</span><span class=\"token property\">\"text\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"so\"</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"offset\"</span><span class=\"token operator\">:</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"length\"</span><span class=\"token operator\">:</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"options\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">&#123;</span><span class=\"token property\">\"text\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"松岗商业中心区\"</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"_index\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"dkx\"</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"_type\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"_doc\"</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"_id\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"1393017952\"</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"_score\"</span><span class=\"token operator\">:</span><span class=\"token number\">1.0</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"_source\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">&#123;</span><span class=\"token property\">\"address\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"松岗镇河滨北路12号盛华大厦\"</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"brand\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"汉庭\"</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"business\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"松岗商业中心区\"</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"city\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"深圳\"</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span><span class=\"token number\">1393017952</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"location\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"22.768912, 113.83325\"</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"汉庭酒店(深圳宝安松岗地铁站店)\"</span><span class=\"token punctuation\">,</span></pre></td></tr></table></figure><h6 id=\"910251-结果解析\"><a class=\"markdownIt-Anchor\" href=\"#910251-结果解析\">#</a> 9.10.2.5.1、结果解析🎋</h6>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310151448335.png\" alt=\"image-20231015144817860\"></p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Test</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">testSuggest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>   <span class=\"token comment\">// 1. 准备 Request</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>   <span class=\"token class-name\">SearchRequest</span> request <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SearchRequest</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"dkx\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>   <span class=\"token comment\">// 2. 准备 DSL</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>   request<span class=\"token punctuation\">.</span><span class=\"token function\">source</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">suggest</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">SuggestBuilder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>                            <span class=\"token punctuation\">.</span><span class=\"token function\">addSuggestion</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>                               <span class=\"token string\">\"suggestions\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>                               <span class=\"token class-name\">SuggestBuilders</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>                               <span class=\"token punctuation\">.</span><span class=\"token function\">completionSuggestion</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"suggestion\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>                               <span class=\"token punctuation\">.</span><span class=\"token function\">prefix</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"so\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                               <span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>                            <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>   <span class=\"token comment\">// 3. 发送请求</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>   <span class=\"token class-name\">SearchResponse</span> search<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>   <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>      search <span class=\"token operator\">=</span> client<span class=\"token punctuation\">.</span><span class=\"token function\">search</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">,</span> <span class=\"token class-name\">RequestOptions</span><span class=\"token punctuation\">.</span><span class=\"token constant\">DEFAULT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">IOException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>   <span class=\"token comment\">// 4. 解析结果</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>   <span class=\"token function\">handleSuggestion</span><span class=\"token punctuation\">(</span>search<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">handleSuggestion</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">SearchResponse</span> search<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>   <span class=\"token class-name\">Suggest</span> suggest <span class=\"token operator\">=</span> search<span class=\"token punctuation\">.</span><span class=\"token function\">getSuggest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>   <span class=\"token comment\">// 4.1. 根据补全查询名称，获取补全结果</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>   <span class=\"token class-name\">CompletionSuggestion</span> suggestion <span class=\"token operator\">=</span> suggest<span class=\"token punctuation\">.</span><span class=\"token function\">getSuggestion</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"suggestions\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>   <span class=\"token comment\">// 4.2. 获取 options</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>   <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">CompletionSuggestion<span class=\"token punctuation\">.</span>Entry<span class=\"token punctuation\">.</span>Option</span><span class=\"token punctuation\">></span></span> options <span class=\"token operator\">=</span> suggestion<span class=\"token punctuation\">.</span><span class=\"token function\">getOptions</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>   <span class=\"token comment\">// 4.3. 遍历结果</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>   <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">CompletionSuggestion<span class=\"token punctuation\">.</span>Entry<span class=\"token punctuation\">.</span>Option</span> option <span class=\"token operator\">:</span> options<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>      <span class=\"token comment\">// 4.4. 获取 text 的值</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>      <span class=\"token class-name\">String</span> content <span class=\"token operator\">=</span> option<span class=\"token punctuation\">.</span><span class=\"token function\">getText</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>      <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>content<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token comment\">//-------------------- 打印结果 --------------------</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>松岗商业中心区</pre></td></tr><tr><td data-num=\"41\"></td><td><pre>松岗商业中心区</pre></td></tr><tr><td data-num=\"42\"></td><td><pre>松江大学城</pre></td></tr><tr><td data-num=\"43\"></td><td><pre>松江大学城</pre></td></tr><tr><td data-num=\"44\"></td><td><pre>松江大学城</pre></td></tr></table></figure><h4 id=\"9103-数据同步\"><a class=\"markdownIt-Anchor\" href=\"#9103-数据同步\">#</a> 9.10.3、数据同步🌲</h4>\n<ul>\n<li>数据同步思路分析</li>\n<li>实现 elasticsearch 与数据库数据同步</li>\n</ul>\n<h5 id=\"91031-数据同步问题分析\"><a class=\"markdownIt-Anchor\" href=\"#91031-数据同步问题分析\">#</a> 9.10.3.1、数据同步问题分析🌴</h5>\n<p>elasticsearch 中的酒店数据来自于 mysql 数据库，因此 mysql 数据发生改变时，elasticsearch 也必须跟着改变，这个就是 elasticsearch 与 mysql 之间的<mark>数据同步</mark>。</p>\n<h6 id=\"910311-方案一同步调用\"><a class=\"markdownIt-Anchor\" href=\"#910311-方案一同步调用\">#</a> 9.10.3.1.1、方案一：同步调用🎋</h6>\n<p>缺点：业务耦合</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310151525267.png\" alt=\"image-20231015152527620\"></p>\n<h6 id=\"910312-方案二异步通知\"><a class=\"markdownIt-Anchor\" href=\"#910312-方案二异步通知\">#</a> 9.10.3.1.2、方案二：异步通知🎋</h6>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310151528971.png\" alt=\"image-20231015152813104\"></p>\n<h6 id=\"910313-方案三监听binlog\"><a class=\"markdownIt-Anchor\" href=\"#910313-方案三监听binlog\">#</a> 9.10.3.1.3、方案三：监听 binlog🎋</h6>\n<p>在 mysql 中 binlog 默认是关闭的，但是开启了 binlog 在 mysql 里做 CRUD 时都会将相应的操作记录在 binlog 中。也就是说 mysql 变化了 binlog 就会变化，而我们可以利用 Canal 这样的中间件去监听 binlog。一旦 binlog 发生变化就去通知微服务更新 es 数据</p>\n<p>缺点：增加了 mysql 的压力</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310151529543.png\" alt=\"image-20231015152942969\"></p>\n<blockquote>\n<p><strong>总结</strong>:</p>\n<p>方式一：同步调用</p>\n<ul>\n<li>优点：实现简单，粗暴</li>\n<li>缺点：业务耦合度太高</li>\n</ul>\n<p>方式二：异步通知</p>\n<ul>\n<li>优点：低耦合，实现难度一般</li>\n<li>缺点：依赖 mq 的可靠性</li>\n</ul>\n<p>方式三：监听 binlog</p>\n<ul>\n<li>优点：完全解除服务间耦合</li>\n<li>缺点：开启 binlog 增加数据库负担，实现复杂度高</li>\n</ul>\n</blockquote>\n<h5 id=\"91032-利用mq实现mysql与elasticsearch数据同步\"><a class=\"markdownIt-Anchor\" href=\"#91032-利用mq实现mysql与elasticsearch数据同步\">#</a> 9.10.3.2、利用 MQ 实现 mysql 与 elasticsearch 数据同步🌴</h5>\n<p>利用课前资料提供的 hotel-admin 项目作为酒店管理的微服务。当数据库发生 CRUD 时，要求对 elasticsearch 中数据也要完成相同操作。</p>\n<p>步骤：</p>\n<ul>\n<li>导入 hotel-admin 项目 (项目地址：<a href=\"https://gitee.com/doukaixin/typora.git\">https://gitee.com/doukaixin/typora.git</a>)，启动并测试酒店数据的 CRUD</li>\n<li>声明 exchange，queue，Routingkey</li>\n<li>在 hotel-admin 中的增，删，改业务中完成消息发送</li>\n<li>在 hotel-demo (项目地址：<a href=\"https://gitee.com/doukaixin/typora.git\">https://gitee.com/doukaixin/typora.git</a>) 中完成消息监听，并更新 elasticsearch 中数据</li>\n<li>启动并测试数据同步功能</li>\n</ul>\n<p>1、导入 hotel-admin 项目，启动并测试酒店数据的 CRUD</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310151942076.png\" alt=\"image-20231015194242526\"></p>\n<p>2、声明 exchange，queue，Routingkey</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310151945245.png\" alt=\"image-20231015194554807\"></p>\n<p>2.1、创建 MqConstans 类记录队列名称和 Routingkey</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MqConstans</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token comment\">// 交换机</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">String</span> <span class=\"token constant\">HOTEL_EXCHANGE</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"hotel.topic\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token comment\">// 监听新增和修改的队里</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">String</span> <span class=\"token constant\">HOTEL_INSERT_QUEUE</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"hotel.insert.queue\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token comment\">// 监听删除的队列</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">String</span> <span class=\"token constant\">HOTEL_DELETE_QUEUE</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"hotel.delete.queue\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token comment\">// 新增或修改的 RoutingKey</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">String</span> <span class=\"token constant\">HOTEL_INSERT_KEY</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"hotel.insert\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token comment\">// 删除的 RoutingKey</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">String</span> <span class=\"token constant\">HOTEL_DELETE_KEY</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"hotel.delete\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>2.2、创建 MqConfig 配置类，配置队列与交换机的关系绑定</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Configuration</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MqConfig</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token comment\">// 定义交换机 Bean</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token annotation punctuation\">@Bean</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">TopicExchange</span> <span class=\"token function\">topicExchange</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token comment\">//name：交换机名称 ，durable：是否持久化，autoDelete：是否自动解除绑定关系</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">TopicExchange</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MqConstans</span><span class=\"token punctuation\">.</span><span class=\"token constant\">HOTEL_EXCHANGE</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token comment\">// 定义队列</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token annotation punctuation\">@Bean</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Queue</span> <span class=\"token function\">insertQueue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token comment\">//name：队列名称，durable：是否持久化</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Queue</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MqConstans</span><span class=\"token punctuation\">.</span><span class=\"token constant\">HOTEL_INSERT_QUEUE</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token comment\">// 定义队列</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token annotation punctuation\">@Bean</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Queue</span> <span class=\"token function\">deleteQueue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token comment\">//name：队列名称，durable：是否持久化</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Queue</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MqConstans</span><span class=\"token punctuation\">.</span><span class=\"token constant\">HOTEL_DELETE_QUEUE</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token annotation punctuation\">@Bean</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token comment\">// 绑定关系</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Binding</span> <span class=\"token function\">insertQueueBinding</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>        <span class=\"token comment\">// 将 insertQueue 队列绑定到交换机上，并绑定 Routingkey</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token class-name\">BindingBuilder</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token function\">insertQueue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token keyword\">to</span><span class=\"token punctuation\">(</span><span class=\"token function\">topicExchange</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">with</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MqConstans</span><span class=\"token punctuation\">.</span><span class=\"token constant\">HOTEL_INSERT_KEY</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token annotation punctuation\">@Bean</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Binding</span> <span class=\"token function\">deleteQueueBinding</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>        <span class=\"token comment\">// 将 insertQueue 队列绑定到交换机上，并绑定 Routingkey</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token class-name\">BindingBuilder</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token function\">insertQueue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token keyword\">to</span><span class=\"token punctuation\">(</span><span class=\"token function\">topicExchange</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">with</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MqConstans</span><span class=\"token punctuation\">.</span><span class=\"token constant\">HOTEL_DELETE_KEY</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>3、在 hotel-admin 中的增，删，改业务中完成消息发送</p>\n<p>3.1、在 hotel-admin 项目中也添加 constans/MqConstans 类方便调用</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MqConstans</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token comment\">// 交换机</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">String</span> <span class=\"token constant\">HOTEL_EXCHANGE</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"hotel.topic\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token comment\">// 监听新增和修改的队里</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">String</span> <span class=\"token constant\">HOTEL_INSERT_QUEUE</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"hotel.insert.queue\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token comment\">// 监听删除的队列</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">String</span> <span class=\"token constant\">HOTEL_DELETE_QUEUE</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"hotel.delete.queue\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token comment\">// 新增或修改的 RoutingKey</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">String</span> <span class=\"token constant\">HOTEL_INSERT_KEY</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"hotel.insert\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token comment\">// 删除的 RoutingKey</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">String</span> <span class=\"token constant\">HOTEL_DELETE_KEY</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"hotel.delete\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>3.2、配置 RabbitMQ 的 yml 并导入依赖</p>\n<p>3.3、在 Controller 中编写发生消息的代码</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@RestController</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token annotation punctuation\">@RequestMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"hotel\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">HotelController</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token annotation punctuation\">@Autowired</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">IHotelService</span> hotelService<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token annotation punctuation\">@Autowired</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">RabbitTemplate</span> rabbitTemplate<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token annotation punctuation\">@GetMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/&#123;id&#125;\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Hotel</span> <span class=\"token function\">queryById</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@PathVariable</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"id\"</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">Long</span> id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token keyword\">return</span> hotelService<span class=\"token punctuation\">.</span><span class=\"token function\">getById</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token annotation punctuation\">@GetMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/list\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">PageResult</span> <span class=\"token function\">hotelList</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            <span class=\"token annotation punctuation\">@RequestParam</span><span class=\"token punctuation\">(</span>value <span class=\"token operator\">=</span> <span class=\"token string\">\"page\"</span><span class=\"token punctuation\">,</span> defaultValue <span class=\"token operator\">=</span> <span class=\"token string\">\"1\"</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">Integer</span> page<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>            <span class=\"token annotation punctuation\">@RequestParam</span><span class=\"token punctuation\">(</span>value <span class=\"token operator\">=</span> <span class=\"token string\">\"size\"</span><span class=\"token punctuation\">,</span> defaultValue <span class=\"token operator\">=</span> <span class=\"token string\">\"1\"</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">Integer</span> size</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token class-name\">Page</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Hotel</span><span class=\"token punctuation\">></span></span> result <span class=\"token operator\">=</span> hotelService<span class=\"token punctuation\">.</span><span class=\"token function\">page</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Page</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span>page<span class=\"token punctuation\">,</span> size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">PageResult</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">.</span><span class=\"token function\">getTotal</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> result<span class=\"token punctuation\">.</span><span class=\"token function\">getRecords</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token annotation punctuation\">@PostMapping</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">saveHotel</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@RequestBody</span> <span class=\"token class-name\">Hotel</span> hotel<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        hotelService<span class=\"token punctuation\">.</span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span>hotel<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        rabbitTemplate<span class=\"token punctuation\">.</span><span class=\"token function\">convertAndSend</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MqConstans</span><span class=\"token punctuation\">.</span><span class=\"token constant\">HOTEL_EXCHANGE</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">MqConstans</span><span class=\"token punctuation\">.</span><span class=\"token constant\">HOTEL_INSERT_KEY</span><span class=\"token punctuation\">,</span> hotel<span class=\"token punctuation\">.</span><span class=\"token function\">getId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token annotation punctuation\">@PutMapping</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">updateById</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@RequestBody</span> <span class=\"token class-name\">Hotel</span> hotel<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>hotel<span class=\"token punctuation\">.</span><span class=\"token function\">getId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">InvalidParameterException</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"id不能为空\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>        hotelService<span class=\"token punctuation\">.</span><span class=\"token function\">updateById</span><span class=\"token punctuation\">(</span>hotel<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>        rabbitTemplate<span class=\"token punctuation\">.</span><span class=\"token function\">convertAndSend</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MqConstans</span><span class=\"token punctuation\">.</span><span class=\"token constant\">HOTEL_EXCHANGE</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">MqConstans</span><span class=\"token punctuation\">.</span><span class=\"token constant\">HOTEL_INSERT_KEY</span><span class=\"token punctuation\">,</span> hotel<span class=\"token punctuation\">.</span><span class=\"token function\">getId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    <span class=\"token annotation punctuation\">@DeleteMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/&#123;id&#125;\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">deleteById</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@PathVariable</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"id\"</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">Long</span> id<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>        hotelService<span class=\"token punctuation\">.</span><span class=\"token function\">removeById</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>        rabbitTemplate<span class=\"token punctuation\">.</span><span class=\"token function\">convertAndSend</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MqConstans</span><span class=\"token punctuation\">.</span><span class=\"token constant\">HOTEL_EXCHANGE</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">MqConstans</span><span class=\"token punctuation\">.</span><span class=\"token constant\">HOTEL_DELETE_KEY</span><span class=\"token punctuation\">,</span> id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>4、在 hotel-demo 中完成消息监听，并更新 elasticsearch 中数据</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">insertOrupdateByid</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Long</span> id<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>   <span class=\"token class-name\">Hotel</span> hotel <span class=\"token operator\">=</span> <span class=\"token function\">getById</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>   <span class=\"token class-name\">HotelDoc</span> hotelDoc <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HotelDoc</span><span class=\"token punctuation\">(</span>hotel<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>   <span class=\"token comment\">// 1. 准备 Request</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>   <span class=\"token class-name\">IndexRequest</span> request <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">IndexRequest</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"dkx\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">id</span><span class=\"token punctuation\">(</span>hotel<span class=\"token punctuation\">.</span><span class=\"token function\">getId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>   <span class=\"token comment\">// 2. 准备 DSL</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>   request<span class=\"token punctuation\">.</span><span class=\"token function\">source</span><span class=\"token punctuation\">(</span><span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">toJSONString</span><span class=\"token punctuation\">(</span>hotelDoc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">XContentType</span><span class=\"token punctuation\">.</span><span class=\"token constant\">JSON</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>   <span class=\"token comment\">// 3. 发送请求</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>   <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      client<span class=\"token punctuation\">.</span><span class=\"token function\">index</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">,</span> <span class=\"token class-name\">RequestOptions</span><span class=\"token punctuation\">.</span><span class=\"token constant\">DEFAULT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">IOException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">deleteById</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Long</span> id<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>   <span class=\"token comment\">// 1. 准备 Request</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>   <span class=\"token class-name\">DeleteRequest</span> request <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">DeleteRequest</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"dkx\"</span><span class=\"token punctuation\">,</span> id<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>   <span class=\"token comment\">// 2. 准备 DSL</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>   <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>      client<span class=\"token punctuation\">.</span><span class=\"token function\">delete</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">,</span> <span class=\"token class-name\">RequestOptions</span><span class=\"token punctuation\">.</span><span class=\"token constant\">DEFAULT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">IOException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>5、启动并测试数据同步功能</p>\n<p><font color='red'>注意</font>：要启动 RabbitMQ 否则链接就会报错</p>\n<p>启动两个项目后查看 队列 情况</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310152133072.png\" alt=\"image-20231015213307513\"></p>\n<p>再看一下交换机</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310152133845.png\" alt=\"image-20231015213344108\"></p>\n<p>证明 队列和交换机创建成功了。</p>\n<p>查看它们的绑定关系</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310152134821.png\" alt=\"image-20231015213451830\"></p>\n<p>两个 BindingKey 分别绑定了 Routingkey</p>\n<p>接下来进行修改测试，比如说先修改这个广告位的价格看下，找到它的 id</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310160743271.png\" alt=\"image-20231016074258159\"></p>\n<p>然后在酒店管理中找到这个对应的 id 信息，对其进行修改</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310160744989.png\" alt=\"image-20231016074402893\"></p>\n<p>现在的价格是 589，修改为 1058</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310160745904.png\" alt=\"image-20231016074503675\"></p>\n<p>然后去查看网页的价格是否更新了</p>\n<p>可以看到价格被改变了，说明数据同步成功了。</p>\n<p>但是这里有个问题就是 每次修改后广告就没了，自然权重也就下降看不到它是第一个了，这里需要做持久化否则每次更新 isAD 的状态就消息了</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310160812307.png\" alt=\"image-20231016081236685\"></p>\n<p>测试删除，删除如下选中的酒店信息</p>\n<p>找到对应的 id，然后去管理页面进行删除操作</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310160925485.png\" alt=\"image-20231016092546878\"></p>\n<p>在酒店管理页面找到对应信息进行删除操作。</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310160926330.png\" alt=\"image-20231016092628220\"></p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310160926213.png\" alt=\"image-20231016092649279\"></p>\n<p>删除后查看酒店信息网页，可以看到少了一条信息也就证明了那条信息被删除了</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310160930574.png\" alt=\"image-20231016092713820\"></p>\n<h4 id=\"9104-elasticsearch集群\"><a class=\"markdownIt-Anchor\" href=\"#9104-elasticsearch集群\">#</a> 9.10.4、elasticsearch 集群🌲</h4>\n<ul>\n<li>搭建 ES 集群</li>\n<li>集群脑裂问题</li>\n<li>集群故障转移</li>\n<li>集群分布式存储</li>\n<li>集群分布式查询</li>\n</ul>\n<h5 id=\"91041-es集群结构\"><a class=\"markdownIt-Anchor\" href=\"#91041-es集群结构\">#</a> 9.10.4.1、ES 集群结构🌴</h5>\n<p>单击的 elasticsearch 做数据存储，必然面临两个问题：海量数据存储问题，单点故障问题。</p>\n<ul>\n<li>海量数据存储问题：将索引库从逻辑上拆分为 N 个分片 (shard) ，存储到多个节点</li>\n<li>单点故障问题：将分片数据在不同节点备份 (replica)</li>\n</ul>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310161025488.png\" alt=\"image-20231016102545479\"></p>\n<h5 id=\"91042-搭建es集群\"><a class=\"markdownIt-Anchor\" href=\"#91042-搭建es集群\">#</a> 9.10.4.2、搭建 ES 集群🌴</h5>\n<p>我们计划利用 3 个 docker 容器模拟 3 个 es 的节点。具体步骤参考 elasticsearch 文章：<a href=\"./Elasearch/%E5%AE%89%E8%A3%85elasticsearch.md\">查看</a>.</p>\n<h5 id=\"91043-es集群的节点角色\"><a class=\"markdownIt-Anchor\" href=\"#91043-es集群的节点角色\">#</a> 9.10.4.3、ES 集群的节点角色🌴</h5>\n<p>elasticsearch 中集群节点有不同的职责划分：</p>\n<table>\n<thead>\n<tr>\n<th>节点类型</th>\n<th>配置参数</th>\n<th>默认值</th>\n<th>节点职责</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>master  eligible</td>\n<td>node.master</td>\n<td>true</td>\n<td>备选主节点：主节点可以管理和记录集群状态，决定<br />分片在哪个节点，处理创建和删除索引库的请求</td>\n</tr>\n<tr>\n<td>data</td>\n<td>node.data</td>\n<td>true</td>\n<td>数据节点：存储数据，搜索，聚合，CRUD</td>\n</tr>\n<tr>\n<td>ingest</td>\n<td>node.ingest</td>\n<td>true</td>\n<td>数据存储之前的预处理</td>\n</tr>\n<tr>\n<td>coordinating</td>\n<td>上面 3 个参数都为 false<br />则为 coordinating 节点</td>\n<td>无</td>\n<td>路由请求到其它节点<br />合并其它节点处理的结果，返回给用户</td>\n</tr>\n</tbody>\n</table>\n<h5 id=\"91044-es集群的分布式查询\"><a class=\"markdownIt-Anchor\" href=\"#91044-es集群的分布式查询\">#</a> 9.10.4.4、ES 集群的分布式查询🌴</h5>\n<p>elasticsearch 中的每个节点角色都有自己不用的职责，因此建议集群部署时，每个节点都有独立的角色。</p>\n<p>下图中，有三个 coordinating 节点 (协调节点) 还有 n 个数据节点 和 三个候选主节点。将来有一个节点挂了就可以从三个候选主节点中选取一个出来。LB 为负载均衡器，对协调节点做负载均衡</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310161339823.png\" alt=\"image-20231016133909366\"></p>\n<p>缺点：</p>\n<p>候选主节点结构会有一个脑裂问题</p>\n<h5 id=\"91045-es集群的脑裂\"><a class=\"markdownIt-Anchor\" href=\"#91045-es集群的脑裂\">#</a> 9.10.4.5、ES 集群的脑裂🌴</h5>\n<p>默认情况下，每个节点都是 mster gligible 节点，因此一旦 master 节点宕机，其它候选节点会选举一个成为主节点。当主节点与其它节点网络故障时，可能发生脑裂问题。</p>\n<p>什么是脑裂呢？</p>\n<p>比方说，有三个候选主节点，第一个节点现在当选为主节点。剩下两个是候选节点</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310161346747.png\" alt=\"image-20231016134608313\"></p>\n<p>现在假设说发生了网络故障</p>\n<p>不是宕机了，是因为网络的原因导致，node2 和 node3 跟 node1 连接不上了，但是 node1 跟其它部分数据节点还是可以连同的。node2 和 node3 和一些数据节点也是可以连同的。这个时候就等于集群被分开了。</p>\n<p>当 node2 和 node3 连不上 node1 的时候它会认为 node1 挂了，就会在 node2 和 node3 中又选举出一个老大</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310161347107.png\" alt=\"image-20231016134716821\"></p>\n<p>比方说选举的老大为 node3</p>\n<p>这是集群里面就等于出现了两个老大</p>\n<p>现在就出问题了，因为有两个老大，一部分数据节点跟 node1 结合将来做 CRUD 的时候由 node1 来控制</p>\n<p>还有另一部分由 node3 来控制，它们各自去处理各自的集群。一旦网络恢复，当用户来访问时就会出现两边数据不一致的情况。这可就出大事儿了，这就是脑裂问题。</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310161350808.png\" alt=\"image-20231016135040891\"></p>\n<p>为了避免脑裂，需要要求选票超过 (eligible 节点数量 + 1) / 2 才能当选为主，因此 eligible 节点数量最好是奇数。对应配置项是 discovery.zen.minimun_master_nodes，在 es7.0 以后，已经成为默认配置，因此一般不会发生脑裂问题。</p>\n<blockquote>\n<p><strong>总结</strong>：</p>\n<p>master eligible 节点的作用是什么？</p>\n<ul>\n<li>参与集群选主</li>\n<li>主节点可以管理集群状态，管理分片信息，处理创建和删除索引库的请求</li>\n</ul>\n<p>data 节点的作用是什么？</p>\n<ul>\n<li>数据的 CRUD</li>\n</ul>\n<p>coordinator 节点的作用是什么？</p>\n<ul>\n<li>路由请求到其它节点</li>\n<li>合并查询到的结果，返回给用户</li>\n</ul>\n</blockquote>\n<h5 id=\"91046-测试引出问题\"><a class=\"markdownIt-Anchor\" href=\"#91046-测试引出问题\">#</a> 9.10.4.6、测试引出问题🌴</h5>\n<p>当新增文档时，应该保存到不同分片，保证数据均衡，那么 coordinating node 如何确定数据该存储到哪个分片呢？</p>\n<p>这里由于虚拟机中没有启动 kibana 所以使用 postman，api 接口测试工具来进行添加文档数据</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310161409037.png\" alt=\"image-20231016140915224\"></p>\n<p>进行查询文档的数据情况</p>\n<p>三条数据就查询出来了</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310161413380.png\" alt=\"image-20231016141318310\"></p>\n<p>查询端口为 9201 为 es02 的数据情况</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310161414897.png\" alt=\"image-20231016141452636\"></p>\n<p>查询端口为 9202 为 es03 的数据情况</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310161415226.png\" alt=\"image-20231016141537985\"></p>\n<p>可以看到都是同样的结果，我是在 9200 插入的文档数据结果在每一个节点都可以查到。那问题来了这些数据到底是存到哪个分片上了呢？</p>\n<p>我们可以通过 “explain” 命令，这个命令可以让我们看到查询的结果到底在哪里</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token property\">\"explain\"</span> <span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token property\">\"match_all\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>查询的结果：</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token property\">\"hits\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>            <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>                <span class=\"token property\">\"_shard\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"[itcast][0]\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>                <span class=\"token property\">\"_node\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"tzSKl2laTTKoDwMz4AfkAQ\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>                <span class=\"token property\">\"_index\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"itcast\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>                <span class=\"token property\">\"_type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"_doc\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>                <span class=\"token property\">\"_id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"5\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>                <span class=\"token property\">\"_score\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1.0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>                <span class=\"token property\">\"_source\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>                    <span class=\"token property\">\"title\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"试着插入一条 id = 1\"</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>                <span class=\"token property\">\"_explanation\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                    <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1.0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>                    <span class=\"token property\">\"description\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"*:*\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>                    <span class=\"token property\">\"details\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>                <span class=\"token property\">\"_shard\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"[itcast][1]\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>                <span class=\"token property\">\"_node\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"tzSKl2laTTKoDwMz4AfkAQ\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>                <span class=\"token property\">\"_index\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"itcast\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>                <span class=\"token property\">\"_type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"_doc\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>                <span class=\"token property\">\"_id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"3\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>                <span class=\"token property\">\"_score\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1.0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>                <span class=\"token property\">\"_source\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>                    <span class=\"token property\">\"title\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"试着插入一条 id = 1\"</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>                <span class=\"token property\">\"_explanation\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>                    <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1.0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>                    <span class=\"token property\">\"description\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"*:*\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>                    <span class=\"token property\">\"details\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>            <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>                <span class=\"token property\">\"_shard\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"[itcast][2]\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>                <span class=\"token property\">\"_node\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"nrhAcc9RQX2XXJoxYWFYPg\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>                <span class=\"token property\">\"_index\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"itcast\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>                <span class=\"token property\">\"_type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"_doc\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>                <span class=\"token property\">\"_id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>                <span class=\"token property\">\"_score\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1.0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>                <span class=\"token property\">\"_source\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>                    <span class=\"token property\">\"title\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"试着插入一条 id = 1\"</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>                <span class=\"token property\">\"_explanation\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>                    <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1.0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>                    <span class=\"token property\">\"description\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"*:*\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>                    <span class=\"token property\">\"details\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>        <span class=\"token punctuation\">]</span></pre></td></tr></table></figure><p>可以看到 id 为 5 的在 0 号分片，id 为 3 的在 1 号分片，id 为 1 的在 2 号分片</p>\n<p>刚好这三条数据在每个分片上都有一个，那么问题来了，我明明是在 9200 插入的数据怎么会出现在三台机器上呢，这说明 协调节点 确实是工作了。那问题是它是怎么工作的呢？</p>\n<p>elasticsearch 会通过 hash 算法来计算文档应该存储到哪个分片：</p>\n<pre><code>shard = hash(_routing) % number_of_shards\n</code></pre>\n<p>用 hash 计算的结果去对 number_of_shards 进行取余，只要_routing 值变化那么计算出的结果也会随着变化</p>\n<p>说明：</p>\n<ul>\n<li>_routing 默认是文档 id</li>\n<li>算法与分片数量有关，因此索引库一旦创建，分片数量不能修改 (如果改了数据就找不到了)！</li>\n</ul>\n<h5 id=\"91047-通过案例进行分析\"><a class=\"markdownIt-Anchor\" href=\"#91047-通过案例进行分析\">#</a> 9.10.4.7、通过案例进行分析🌴</h5>\n<p>比方说现在来做新增</p>\n<p>新增文档流程：</p>\n<p>如下有集群三个节点，分别是 node1，node2，node3。在这个集群的每个节点上都会有一些分片。其中深蓝色叫 primarisha 主分片，p-0，p-1，p-2 分别就是 0 号主分片，1 号主分片，2 号主分片。每个分片都要有副本，浅蓝色就是副本 r-0 就是 0 号分片的副本分片</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310161431150.png\" alt=\"image-20231016143113264\"></p>\n<p>如果说我现在要插入一条文档，文档的 id 为 1 。请求到达了 node1。这是 node1 就充当了协调节点的角色</p>\n<p>协调角色要用上述的哈希运算了，假设说文档 id 为 1 哈希运算结果为 2，那就意味着它要存储到 2 号分片</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310161435085.png\" alt=\"image-20231016143543105\"></p>\n<p>于是就把请求路由到 node3 节点了</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310161437775.png\" alt=\"image-20231016143719016\"></p>\n<p>然后就把数据写入到 2 号分片了，写入后发现自己是老大还是主分片，所以它就要把主分片数据同步给从分片。从分片的副本分片在 1 号分片中 于是请求就同步过去了</p>\n<p>这样主分片和副本分片就都保存了这个数据了</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310161440114.png\" alt=\"image-20231016144022919\"></p>\n<p>最终把相应结果返回给协调节点，然后再返回给用户</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310161442717.png\" alt=\"image-20231016144216794\"></p>\n<p>如果是 id 去查询也是相同的道理，删除，修改都是如此。所以凡是根据 id 操作都是这个流程</p>\n<p>但是上面代码中进行查询的时候我们使用的是如下代码：</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token property\">\"explain\"</span> <span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token property\">\"match_all\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>当发送请求时，并不知道要查询的数据在哪个分片上，没有 id 啊，那这种情况下协调节点又是怎么工作的呢？</p>\n<p>那这就是分布式查询的过程了：</p>\n<p>elasticsearch 的查询分成两个阶段：</p>\n<ul>\n<li>\n<p>scatter phase：分散阶段，coordinating node 会把请求发到每一个分片</p>\n<p>每个分片都查询了后进入聚集阶段</p>\n</li>\n<li>\n<p>gather phase：聚集阶段，coordinating node 汇总 data node 的搜索结果，并处理为最终结果集返回给用户</p>\n</li>\n</ul>\n<p>协调节点为虚线，表示这里的协调节点可以是三个节点中任意一个，因为默认情况下每个节点都是协调节点</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310161447068.png\" alt=\"image-20231016144743512\"></p>\n<blockquote>\n<p><strong>总结</strong>：</p>\n<p>分布式新增如何确定分片？</p>\n<ul>\n<li>coordinating node 根据 id 做 hash 运算，得到结果 shard 数量取余，余数就是对应的分片</li>\n</ul>\n<p>分布式查询：</p>\n<ul>\n<li>分散阶段：coordinating node 将查询请求分发给不同分配</li>\n<li>收集阶段：将查询结果汇总到 coordinating node，整理并返回给用户</li>\n</ul>\n</blockquote>\n<h5 id=\"91048-es集群的故障转移\"><a class=\"markdownIt-Anchor\" href=\"#91048-es集群的故障转移\">#</a> 9.10.4.8、ES 集群的故障转移🌲</h5>\n<p>集群的 master 节点会监控集群中的节点状态，如果发现有节点宕机，会立即将宕机节点的分片数据迁移到其它节点，确保数据安全，这个叫做故障转移。</p>\n<p>比方说，有集群三个节点 node1，node2，node3 每个节点上都有分片目前主节点是 node1。</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310161457402.png\" alt=\"image-20231016145745390\"></p>\n<p>现在假设说其中一个节点出现了故障，比如说 node1 主节点挂了。此时两个候选节点就会选出一个主节点</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310161500046.png\" alt=\"image-20231016150004147\"></p>\n<p>比方说选中了 node2，这时集群就有主了，主节点就要发挥自己的工作了。它要查看下集群的健康状态了，分片状态。</p>\n<p>它一看这不行啊，因为 p-1 有主分片，但是没有副本分片。p-2 有主分片有副本分片。p-0 只有副本分片，没有主分片。</p>\n<p>那也就是说 1 号  分片 和 0 号分片的数据是不安全的，因为只有一份一旦挂了就完了。</p>\n<p>这时集群的状态就不是健康的了，而是处于危险的边缘</p>\n<p>这时主节点就会做个措施。它会检查挂掉的节点它上面有什么分片，然后把它迁移到健康的节点上。确保任何一个分片都至少有两份，也就是一个主分片，一个副本分片。</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310161507621.png\" alt=\"image-20231016150711670\"></p>\n<p>我们看下控制台</p>\n<p>现在 es01 是主节点，集群状态是健康的，我们把 es01 给它停掉</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310161510371.png\" alt=\"image-20231016151046860\"></p>\n<p>通过命令： <code>docker-compose stop es01</code>  这样主节点就被停掉了</p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># docker-compose stop es01</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>Stopping es01 <span class=\"token punctuation\">..</span>. <span class=\"token keyword\">done</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\">#</span></pre></td></tr></table></figure><p>我们再去看控制台，发现主变成了 es02，并且把数据进行了迁移</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310161514231.png\" alt=\"image-20231016151445895\"></p>\n<p>那么数据有没有丢失呢，我们搜索查看一下：</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token property\">\"match_all\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>查询结果：</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token property\">\"took\"</span><span class=\"token operator\">:</span> <span class=\"token number\">27</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token property\">\"timed_out\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token property\">\"_shards\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token property\">\"total\"</span><span class=\"token operator\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token property\">\"successful\"</span><span class=\"token operator\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token property\">\"skipped\"</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token property\">\"failed\"</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token property\">\"hits\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token property\">\"total\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>            <span class=\"token property\">\"relation\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"eq\"</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token property\">\"max_score\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1.0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token property\">\"hits\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>                <span class=\"token property\">\"_index\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"itcast\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>                <span class=\"token property\">\"_type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"_doc\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>                <span class=\"token property\">\"_id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"5\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>                <span class=\"token property\">\"_score\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1.0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>                <span class=\"token property\">\"_source\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>                    <span class=\"token property\">\"title\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"试着插入一条 id = 1\"</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>            <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>                <span class=\"token property\">\"_index\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"itcast\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>                <span class=\"token property\">\"_type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"_doc\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>                <span class=\"token property\">\"_id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"3\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>                <span class=\"token property\">\"_score\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1.0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>                <span class=\"token property\">\"_source\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>                    <span class=\"token property\">\"title\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"试着插入一条 id = 1\"</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>            <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>                <span class=\"token property\">\"_index\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"itcast\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>                <span class=\"token property\">\"_type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"_doc\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>                <span class=\"token property\">\"_id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>                <span class=\"token property\">\"_score\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1.0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>                <span class=\"token property\">\"_source\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>                    <span class=\"token property\">\"title\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"试着插入一条 id = 1\"</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>        <span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>数据没有丢失</p>\n<p>如果我再重启 es01 节点，执行命令： <code>docker-compose start es01</code></p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># docker-compose start es01</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>Starting es01 <span class=\"token punctuation\">..</span>. <span class=\"token keyword\">done</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\">#</span></pre></td></tr></table></figure><p>再切回到控制台看下情况</p>\n<p>我们发现 es01 又回来了，但是不是主了。但是现在的主节点又把数据给迁移回去了</p>\n<p>确保 每一个分片上都会有数据，确保数据是均衡的</p>\n<p><img src=\"https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310161519914.png\" alt=\"image-20231016151901158\"></p>\n<blockquote>\n<p><strong>总结</strong>:</p>\n<p>故障转移：</p>\n<ul>\n<li>master 宕机后，EligibleMaster 选举为新的主节点。</li>\n<li>master 节点监控分片，节点状态，将故障节点上的分片转移到正常节点，确保数据安全</li>\n</ul>\n</blockquote>\n",
            "tags": [
                "计算机学科",
                "springcloud",
                "Elasticsearch"
            ]
        }
    ]
}
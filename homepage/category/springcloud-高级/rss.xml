<?xml version="1.0"?>
<rss version="2.0">
    <channel>
        <title>homepage â€¢ Posts by &#34;springcloud-é«˜çº§&#34; category</title>
        <link>https://pigpigletsgo.github.io/homepage</link>
        <description>æ¬¢è¿æ¥æˆ‘çš„åšå®¢ç©ºé—´</description>
        <language>zh-CN</language>
        <pubDate>Tue, 02 Apr 2024 14:23:31 +0800</pubDate>
        <lastBuildDate>Tue, 02 Apr 2024 14:23:31 +0800</lastBuildDate>
        <category>mybatis</category>
        <category>é—®é¢˜æ€»æ±‡</category>
        <category>jdkç‰ˆæœ¬é—®é¢˜</category>
        <category>linux</category>
        <category>æŠ¥é”™</category>
        <category>ç¼–ç é—®é¢˜</category>
        <category>springboot</category>
        <category>è¯»å–é…ç½®æ–‡ä»¶</category>
        <category>JdbcTemplate</category>
        <category>Jwt</category>
        <category>MyBatisPlus</category>
        <category>ç‰ˆæœ¬é—®é¢˜</category>
        <category>nginx</category>
        <category>Swing</category>
        <category>java</category>
        <category>vim</category>
        <category>è¾“å…¥æ³•</category>
        <category>hexo</category>
        <category>shoka</category>
        <category>è®¡ç®—æœºåº•å±‚</category>
        <category>english</category>
        <category>math</category>
        <category>ç®—æ³•</category>
        <category>è®¡ç®—æœºå­¦ç§‘</category>
        <category>C</category>
        <category>ä»‹ç»</category>
        <category>åŸºç¡€</category>
        <category>mysql</category>
        <category>git</category>
        <category>web</category>
        <category>å‘ç‚¹</category>
        <category>tools</category>
        <category>idea</category>
        <category>é¡¹ç›®</category>
        <category>nodeJs</category>
        <category>vscode</category>
        <category>windows</category>
        <category>å¯†ç ç®¡ç†</category>
        <category>jvm</category>
        <category>æ•°æ®ç»“æ„ä¸ç®—æ³•</category>
        <category>å›¾</category>
        <category>å¤šè·¯æŸ¥æ‰¾æ ‘</category>
        <category>é€’å½’</category>
        <category>é“¾è¡¨</category>
        <category>é˜Ÿåˆ—</category>
        <category>æ ˆ</category>
        <category>æ•°ç»„</category>
        <category>æ’åº</category>
        <category>æŸ¥æ‰¾</category>
        <category>å“ˆå¸Œè¡¨</category>
        <category>æ ‘ç»“æ„</category>
        <category>ç¨‹åºå‘˜å¸¸ç”¨çš„10ä¸­ç®—æ³•</category>
        <category>configé…ç½®ç±»</category>
        <category>maven</category>
        <category>ç¼–ç¨‹é¢˜</category>
        <category>åŠ¨æ€è§„åˆ’</category>
        <category>è´ªå¿ƒç®—æ³•</category>
        <category>äºŒå‰æ ‘</category>
        <category>å±‚åºéå†</category>
        <category>ååºéå†</category>
        <category>å¹¿åº¦ä¼˜å…ˆæœç´¢</category>
        <category>è¿˜åŸäºŒå‰æ ‘</category>
        <category>åŒæŒ‡é’ˆ</category>
        <category>å¿«æ…¢æŒ‡é’ˆ</category>
        <category>åˆ†è€Œæ²»ä¹‹</category>
        <category>å¯¹ç§°äºŒå‰æ ‘</category>
        <category>å•è°ƒæ ˆ</category>
        <category>å †</category>
        <category>å°é¡¶å †</category>
        <category>å¤§é¡¶å †</category>
        <category>é€†æ³¢å…°è¡¨è¾¾å¼</category>
        <category>servlet</category>
        <category>spring</category>
        <category>å·¥å…·ç±»</category>
        <category>å¼€æºé¡¹ç›®æ¡†æ¶</category>
        <category>ç¬¬ä¸‰æ–¹åº“</category>
        <category>Minio</category>
        <category>Thymeleaf</category>
        <category>hutool</category>
        <category>çˆ¬è™«</category>
        <category>ä¸ƒç‰›äº‘</category>
        <category>è®¾è®¡æ¨¡å¼</category>
        <category>æ¡ˆä¾‹Demo</category>
        <category>èœå•æ•°æ®ç»“æ„</category>
        <category>ç½‘ç»œç¼–ç¨‹</category>
        <category>åˆ†é¡µ</category>
        <category>å¤šçº¿ç¨‹</category>
        <category>lombok</category>
        <category>çŸ¥è¯†ç‚¹</category>
        <category>APIçš„åŒºåˆ«</category>
        <category>database</category>
        <category>JDBC</category>
        <category>mongodb</category>
        <category>navicat</category>
        <category>redis</category>
        <category>é›†ç¾¤</category>
        <category>ä»£ç ç»éªŒ</category>
        <category>vue3</category>
        <category>websocket</category>
        <category>å‰åç«¯äº¤äº’</category>
        <category>æ•°æ®æ ¼å¼</category>
        <category>axios</category>
        <category>avlæ ‘</category>
        <category>äºŒå‰æ ‘çš„éå†</category>
        <category>äºŒå‰æ ‘æœç´¢æ ‘</category>
        <category>ä¼˜å…ˆçº§é˜Ÿåˆ—</category>
        <category>å®Œå…¨äºŒå‰æ ‘</category>
        <category>heapify</category>
        <category>åŠ¨æ€æ•°ç»„</category>
        <category>å †æ’åº</category>
        <category>çº¢é»‘æ ‘</category>
        <category>é˜»å¡é˜Ÿåˆ—</category>
        <category>è¿›é˜¶</category>
        <category>SSM</category>
        <category>springcloud</category>
        <category>springmvc</category>
        <category>springsecurity</category>
        <category>MD5</category>
        <category>JWT</category>
        <category>thymeleaf</category>
        <category>æºç </category>
        <category>æ‹¦æˆªå™¨</category>
        <category>æ•´åˆjaråŒ…</category>
        <category>Junit</category>
        <category>String</category>
        <category>IO</category>
        <category>number</category>
        <category>lambda</category>
        <category>http</category>
        <category>streamæµ</category>
        <category>å¯¹è±¡</category>
        <category>æ³›å‹</category>
        <category>é›†åˆ</category>
        <category>ORM</category>
        <category>mybatisplus-join</category>
        <category>js</category>
        <category>jquery</category>
        <category>JSR303</category>
        <category>Knife4j</category>
        <category>devtools</category>
        <category>springbooté«˜çº§</category>
        <category>Docker</category>
        <category>Elasticsearch</category>
        <category>Nacos</category>
        <category>RabbitMQ</category>
        <category>éƒ¨ç½²</category>
        <category>OpenResty</category>
        <category>Canal</category>
        <category>Sentinel</category>
        <category>æŒä¹…åŒ–</category>
        <category>Seata</category>
        <item>
            <guid isPermalink="true">https://pigpigletsgo.github.io/homepage/2024/04/02/computer-science/java/spring/springcloud/springcloud-%E9%AB%98%E7%BA%A7/sentinel/sentinel%E8%A7%84%E5%88%99%E6%8C%81%E4%B9%85%E5%8C%96/</guid>
            <title>Sentinelè§„åˆ™æŒä¹…åŒ–</title>
            <link>https://pigpigletsgo.github.io/homepage/2024/04/02/computer-science/java/spring/springcloud/springcloud-%E9%AB%98%E7%BA%A7/sentinel/sentinel%E8%A7%84%E5%88%99%E6%8C%81%E4%B9%85%E5%8C%96/</link>
            <category>è®¡ç®—æœºå­¦ç§‘</category>
            <category>springcloud</category>
            <category>Sentinel</category>
            <category>æŒä¹…åŒ–</category>
            <pubDate>Tue, 02 Apr 2024 14:23:31 +0800</pubDate>
            <description><![CDATA[ &lt;h1 id=&#34;sentinel-è§„åˆ™æŒä¹…åŒ–&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#sentinel-è§„åˆ™æŒä¹…åŒ–&#34;&gt;#&lt;/a&gt; Sentinel è§„åˆ™æŒä¹…åŒ–&lt;/h1&gt;
&lt;h2 id=&#34;ä¸€-ä¿®æ”¹order-serviceæœåŠ¡&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä¸€-ä¿®æ”¹order-serviceæœåŠ¡&#34;&gt;#&lt;/a&gt; ä¸€ã€ä¿®æ”¹ order-service æœåŠ¡&lt;/h2&gt;
&lt;p&gt;ä¿®æ”¹ OrderServiceï¼Œè®©å…¶ç›‘å¬ Nacos ä¸­çš„ sentinel è§„åˆ™é…ç½®ã€‚&lt;/p&gt;
&lt;p&gt;å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;h3 id=&#34;1å¼•å…¥ä¾èµ–&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1å¼•å…¥ä¾èµ–&#34;&gt;#&lt;/a&gt; 1. å¼•å…¥ä¾èµ–&lt;/h3&gt;
&lt;p&gt;åœ¨ order-service ä¸­å¼•å…¥ sentinel ç›‘å¬ nacos çš„ä¾èµ–ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight xml&#34;&gt;&lt;figcaption data-lang=&#34;XML&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;dependency&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;groupId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;com.alibaba.csp&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;/&lt;/span&gt;groupId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;artifactId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;sentinel-datasource-nacos&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;/&lt;/span&gt;artifactId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;/&lt;/span&gt;dependency&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h3 id=&#34;2é…ç½®nacosåœ°å€&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2é…ç½®nacosåœ°å€&#34;&gt;#&lt;/a&gt; 2. é…ç½® nacos åœ°å€&lt;/h3&gt;
&lt;p&gt;åœ¨ order-service ä¸­çš„ application.yml æ–‡ä»¶é…ç½® nacos åœ°å€åŠç›‘å¬çš„é…ç½®ä¿¡æ¯ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight yaml&#34;&gt;&lt;figcaption data-lang=&#34;YAML&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key atrule&#34;&gt;spring&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token key atrule&#34;&gt;cloud&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;sentinel&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;datasource&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token key atrule&#34;&gt;flow&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;          &lt;span class=&#34;token key atrule&#34;&gt;nacos&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token key atrule&#34;&gt;server-addr&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; localhost&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;8848&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# nacos åœ°å€&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token key atrule&#34;&gt;dataId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; orderservice&lt;span class=&#34;token punctuation&#34;&gt;-&lt;/span&gt;flow&lt;span class=&#34;token punctuation&#34;&gt;-&lt;/span&gt;rules&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token key atrule&#34;&gt;groupId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; SENTINEL_GROUP&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token key atrule&#34;&gt;rule-type&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; flow &lt;span class=&#34;token comment&#34;&gt;# è¿˜å¯ä»¥æ˜¯ï¼šdegradeã€authorityã€param-flow&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h2 id=&#34;äºŒ-ä¿®æ”¹sentinel-dashboardæºç &#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#äºŒ-ä¿®æ”¹sentinel-dashboardæºç &#34;&gt;#&lt;/a&gt; äºŒã€ä¿®æ”¹ sentinel-dashboard æºç &lt;/h2&gt;
&lt;p&gt;SentinelDashboard é»˜è®¤ä¸æ”¯æŒ nacos çš„æŒä¹…åŒ–ï¼Œéœ€è¦ä¿®æ”¹æºç ã€‚&lt;/p&gt;
&lt;h3 id=&#34;1-è§£å‹&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1-è§£å‹&#34;&gt;#&lt;/a&gt; 1. è§£å‹&lt;/h3&gt;
&lt;p&gt;è§£å‹è¯¾å‰èµ„æ–™ä¸­çš„ sentinel æºç åŒ…ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171644436.png&#34; alt=&#34;image-20210618201340086&#34;&gt;&lt;/p&gt;
&lt;p&gt;ç„¶åå¹¶ç”¨ IDEA æ‰“å¼€è¿™ä¸ªé¡¹ç›®ï¼Œç»“æ„å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171644159.png&#34; alt=&#34;image-20210618201412878&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;2-ä¿®æ”¹nacosä¾èµ–&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2-ä¿®æ”¹nacosä¾èµ–&#34;&gt;#&lt;/a&gt; 2. ä¿®æ”¹ nacos ä¾èµ–&lt;/h3&gt;
&lt;p&gt;åœ¨ sentinel-dashboard æºç çš„ pom æ–‡ä»¶ä¸­ï¼Œnacos çš„ä¾èµ–é»˜è®¤çš„ scope æ˜¯ testï¼Œåªèƒ½åœ¨æµ‹è¯•æ—¶ä½¿ç”¨ï¼Œè¿™é‡Œè¦å»é™¤ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171644823.png&#34; alt=&#34;image-20210618201607831&#34;&gt;&lt;/p&gt;
&lt;p&gt;å°† sentinel-datasource-nacos ä¾èµ–çš„ scope å»æ‰ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight xml&#34;&gt;&lt;figcaption data-lang=&#34;XML&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;dependency&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;groupId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;com.alibaba.csp&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;/&lt;/span&gt;groupId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;artifactId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;sentinel-datasource-nacos&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;/&lt;/span&gt;artifactId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;/&lt;/span&gt;dependency&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h3 id=&#34;3-æ·»åŠ nacosæ”¯æŒ&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#3-æ·»åŠ nacosæ”¯æŒ&#34;&gt;#&lt;/a&gt; 3. æ·»åŠ  nacos æ”¯æŒ&lt;/h3&gt;
&lt;p&gt;åœ¨ sentinel-dashboard çš„ test åŒ…ä¸‹ï¼Œå·²ç»ç¼–å†™äº†å¯¹ nacos çš„æ”¯æŒï¼Œæˆ‘ä»¬éœ€è¦å°†å…¶æ‹·è´åˆ° main ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171644434.png&#34; alt=&#34;image-20210618201726280&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;4-ä¿®æ”¹nacosåœ°å€&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#4-ä¿®æ”¹nacosåœ°å€&#34;&gt;#&lt;/a&gt; 4. ä¿®æ”¹ nacos åœ°å€&lt;/h3&gt;
&lt;p&gt;ç„¶åï¼Œè¿˜éœ€è¦ä¿®æ”¹æµ‹è¯•ä»£ç ä¸­çš„ NacosConfig ç±»ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171644320.png&#34; alt=&#34;image-20210618201912078&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä¿®æ”¹å…¶ä¸­çš„ nacos åœ°å€ï¼Œè®©å…¶è¯»å– application.properties ä¸­çš„é…ç½®ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171644820.png&#34; alt=&#34;image-20210618202047575&#34;&gt;&lt;/p&gt;
&lt;p&gt;åœ¨ sentinel-dashboard çš„ application.properties ä¸­æ·»åŠ  nacos åœ°å€é…ç½®ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight properties&#34;&gt;&lt;figcaption data-lang=&#34;.properties&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;nacos.addr&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;localhost:8848&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h3 id=&#34;5-é…ç½®nacosæ•°æ®æº&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#5-é…ç½®nacosæ•°æ®æº&#34;&gt;#&lt;/a&gt; 5. é…ç½® nacos æ•°æ®æº&lt;/h3&gt;
&lt;p&gt;å¦å¤–ï¼Œè¿˜éœ€è¦ä¿®æ”¹ com.alibaba.csp.sentinel.dashboard.controller.v2 åŒ…ä¸‹çš„ FlowControllerV2 ç±»ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171644684.png&#34; alt=&#34;w&#34;&gt;&lt;/p&gt;
&lt;p&gt;è®©æˆ‘ä»¬æ·»åŠ çš„ Nacos æ•°æ®æºç”Ÿæ•ˆï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171644334.png&#34; alt=&#34;image-20210618202334536&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;6-ä¿®æ”¹å‰ç«¯é¡µé¢&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#6-ä¿®æ”¹å‰ç«¯é¡µé¢&#34;&gt;#&lt;/a&gt; 6. ä¿®æ”¹å‰ç«¯é¡µé¢&lt;/h3&gt;
&lt;p&gt;æ¥ä¸‹æ¥ï¼Œè¿˜è¦ä¿®æ”¹å‰ç«¯é¡µé¢ï¼Œæ·»åŠ ä¸€ä¸ªæ”¯æŒ nacos çš„èœå•ã€‚&lt;/p&gt;
&lt;p&gt;ä¿®æ”¹ src/main/webapp/resources/app/scripts/directives/sidebar/ ç›®å½•ä¸‹çš„ sidebar.html æ–‡ä»¶ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171644086.png&#34; alt=&#34;image-20210618202433356&#34;&gt;&lt;/p&gt;
&lt;p&gt;å°†å…¶ä¸­çš„è¿™éƒ¨åˆ†æ³¨é‡Šæ‰“å¼€ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171644031.png&#34; alt=&#34;image-20210618202449881&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä¿®æ”¹å…¶ä¸­çš„æ–‡æœ¬ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171644504.png&#34; alt=&#34;image-20210618202501928&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;7-é‡æ–°ç¼–è¯‘-æ‰“åŒ…é¡¹ç›®&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#7-é‡æ–°ç¼–è¯‘-æ‰“åŒ…é¡¹ç›®&#34;&gt;#&lt;/a&gt; 7. é‡æ–°ç¼–è¯‘ã€æ‰“åŒ…é¡¹ç›®&lt;/h3&gt;
&lt;p&gt;è¿è¡Œ IDEA ä¸­çš„ maven æ’ä»¶ï¼Œç¼–è¯‘å’Œæ‰“åŒ…ä¿®æ”¹å¥½çš„ Sentinel-Dashboardï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171644941.png&#34; alt=&#34;image-20210618202701492&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;8å¯åŠ¨&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#8å¯åŠ¨&#34;&gt;#&lt;/a&gt; 8. å¯åŠ¨&lt;/h3&gt;
&lt;p&gt;å¯åŠ¨æ–¹å¼è·Ÿå®˜æ–¹ä¸€æ ·ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight sh&#34;&gt;&lt;figcaption data-lang=&#34;sh&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token function&#34;&gt;java&lt;/span&gt; &lt;span class=&#34;token parameter variable&#34;&gt;-jar&lt;/span&gt; sentinel-dashboard.jar&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;å¦‚æœè¦ä¿®æ”¹ nacos åœ°å€ï¼Œéœ€è¦æ·»åŠ å‚æ•°ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight sh&#34;&gt;&lt;figcaption data-lang=&#34;sh&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token function&#34;&gt;java&lt;/span&gt; &lt;span class=&#34;token parameter variable&#34;&gt;-jar&lt;/span&gt; &lt;span class=&#34;token parameter variable&#34;&gt;-Dnacos.addr&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;localhost:8848 sentinel-dashboard.jar&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt; ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://pigpigletsgo.github.io/homepage/2024/04/02/computer-science/java/spring/springcloud/springcloud-%E9%AB%98%E7%BA%A7/seata/seata%E7%9A%84%E9%83%A8%E7%BD%B2%E5%92%8C%E9%9B%86%E6%88%90/</guid>
            <title>seataçš„éƒ¨ç½²å’Œé›†æˆ</title>
            <link>https://pigpigletsgo.github.io/homepage/2024/04/02/computer-science/java/spring/springcloud/springcloud-%E9%AB%98%E7%BA%A7/seata/seata%E7%9A%84%E9%83%A8%E7%BD%B2%E5%92%8C%E9%9B%86%E6%88%90/</link>
            <category>è®¡ç®—æœºå­¦ç§‘</category>
            <category>springcloud</category>
            <category>éƒ¨ç½²</category>
            <category>Seata</category>
            <pubDate>Tue, 02 Apr 2024 14:23:31 +0800</pubDate>
            <description><![CDATA[ &lt;h1 id=&#34;seataçš„éƒ¨ç½²å’Œé›†æˆ&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#seataçš„éƒ¨ç½²å’Œé›†æˆ&#34;&gt;#&lt;/a&gt; seata çš„éƒ¨ç½²å’Œé›†æˆ&lt;/h1&gt;
&lt;h1 id=&#34;ä¸€-éƒ¨ç½²seataçš„tc-server&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä¸€-éƒ¨ç½²seataçš„tc-server&#34;&gt;#&lt;/a&gt; ä¸€ã€éƒ¨ç½² Seata çš„ tc-server&lt;/h1&gt;
&lt;h2 id=&#34;1ä¸‹è½½&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1ä¸‹è½½&#34;&gt;#&lt;/a&gt; 1. ä¸‹è½½&lt;/h2&gt;
&lt;p&gt;é¦–å…ˆæˆ‘ä»¬è¦ä¸‹è½½ seata-server åŒ…ï¼Œåœ°å€åœ¨&lt;a href=&#34;http://seata.io/zh-cn/blog/download.html&#34;&gt; http&lt;/a&gt;&lt;a href=&#34;http://seata.io/zh-cn/blog/download.html&#34;&gt;ğŸ˜•/seata.io/zh-cn/blog/download&lt;/a&gt;&lt;a href=&#34;http://seata.io/zh-cn/blog/download.html&#34;&gt;.&lt;/a&gt;&lt;a href=&#34;http://seata.io/zh-cn/blog/download.html&#34;&gt;html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å½“ç„¶ï¼Œè¯¾å‰èµ„æ–™ä¹Ÿå‡†å¤‡å¥½äº†ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310180750149.png&#34; alt=&#34;image-20210622202357640&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;2è§£å‹&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2è§£å‹&#34;&gt;#&lt;/a&gt; 2. è§£å‹&lt;/h2&gt;
&lt;p&gt;åœ¨éä¸­æ–‡ç›®å½•è§£å‹ç¼©è¿™ä¸ª zip åŒ…ï¼Œå…¶ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310180750336.png&#34; alt=&#34;image-20210622202515014&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;3ä¿®æ”¹é…ç½®&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#3ä¿®æ”¹é…ç½®&#34;&gt;#&lt;/a&gt; 3. ä¿®æ”¹é…ç½®&lt;/h2&gt;
&lt;p&gt;ä¿®æ”¹ conf ç›®å½•ä¸‹çš„ registry.conf æ–‡ä»¶ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310180750504.png&#34; alt=&#34;image-20210622202622874&#34;&gt;&lt;/p&gt;
&lt;p&gt;å†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight properties&#34;&gt;&lt;figcaption data-lang=&#34;.properties&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;registry&lt;/span&gt; &lt;span class=&#34;token value attr-value&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;  # tc æœåŠ¡çš„æ³¨å†Œä¸­å¿ƒç±»ï¼Œè¿™é‡Œé€‰æ‹© nacosï¼Œä¹Ÿå¯ä»¥æ˜¯ eurekaã€zookeeper ç­‰&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;  type&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token value attr-value&#34;&gt;&#34;nacos&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;  nacos&lt;/span&gt; &lt;span class=&#34;token value attr-value&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;    # seata tc æœåŠ¡æ³¨å†Œåˆ° nacos çš„æœåŠ¡åç§°ï¼Œå¯ä»¥è‡ªå®šä¹‰&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;    application&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token value attr-value&#34;&gt;&#34;seata-tc-server&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;    serverAddr&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token value attr-value&#34;&gt;&#34;127.0.0.1:8848&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;    group&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token value attr-value&#34;&gt;&#34;DEFAULT_GROUP&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;    namespace&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token value attr-value&#34;&gt;&#34;&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;    cluster&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token value attr-value&#34;&gt;&#34;SH&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;    username&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token value attr-value&#34;&gt;&#34;nacos&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;    password&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token value attr-value&#34;&gt;&#34;nacos&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &amp;#125;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&amp;#125;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;config&lt;/span&gt; &lt;span class=&#34;token value attr-value&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;  # è¯»å– tc æœåŠ¡ç«¯çš„é…ç½®æ–‡ä»¶çš„æ–¹å¼ï¼Œè¿™é‡Œæ˜¯ä» nacos é…ç½®ä¸­å¿ƒè¯»å–ï¼Œè¿™æ ·å¦‚æœ tc æ˜¯é›†ç¾¤ï¼Œå¯ä»¥å…±äº«é…ç½®&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;  type&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token value attr-value&#34;&gt;&#34;nacos&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;  # é…ç½® nacos åœ°å€ç­‰ä¿¡æ¯&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;21&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;  nacos&lt;/span&gt; &lt;span class=&#34;token value attr-value&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;22&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;    serverAddr&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token value attr-value&#34;&gt;&#34;127.0.0.1:8848&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;23&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;    namespace&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token value attr-value&#34;&gt;&#34;&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;24&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;    group&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token value attr-value&#34;&gt;&#34;SEATA_GROUP&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;25&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;    username&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token value attr-value&#34;&gt;&#34;nacos&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;26&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;    password&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token value attr-value&#34;&gt;&#34;nacos&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;27&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;    dataId&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token value attr-value&#34;&gt;&#34;seataServer.properties&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;28&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &amp;#125;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;29&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&amp;#125;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;Seata-1.7.0 ç‰ˆæœ¬çš„é…ç½®å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;æ‰¾åˆ° yml é…ç½®æ–‡ä»¶&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310180927758.png&#34; alt=&#34;image-20231018092704361&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight yml&#34;&gt;&lt;figcaption data-lang=&#34;YAML&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key atrule&#34;&gt;server&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token key atrule&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;7091&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key atrule&#34;&gt;spring&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token key atrule&#34;&gt;application&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; seata&lt;span class=&#34;token punctuation&#34;&gt;-&lt;/span&gt;server&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key atrule&#34;&gt;logging&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token key atrule&#34;&gt;config&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; classpath&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;logback&lt;span class=&#34;token punctuation&#34;&gt;-&lt;/span&gt;spring.xml&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token key atrule&#34;&gt;file&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; $&lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;user.home&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;/logs/seata&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token key atrule&#34;&gt;extend&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;logstash-appender&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;destination&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; 127.0.0.1&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;4560&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;kafka-appender&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;bootstrap-servers&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; 127.0.0.1&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;9092&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;topic&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; logback_to_logstash&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key atrule&#34;&gt;console&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token key atrule&#34;&gt;user&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;21&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;username&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; seata&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;22&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;password&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; seata&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;23&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;24&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key atrule&#34;&gt;seata&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;25&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token key atrule&#34;&gt;config&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;26&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;# support: nacos, consul, apollo, zk, etcd3&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;27&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; nacos&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;28&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;nacos&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;29&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;server-addr&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; 127.0.0.1&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;8848&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;30&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;31&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token comment&#34;&gt;# æ”¹è¿™é‡Œä¼šæŠ¥é”™&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;32&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;group&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; SEATA_GROUP&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;33&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;username&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; nacos&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;34&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;password&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; nacos&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;35&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token comment&#34;&gt;##if use MSE Nacos with auth, mutex with username/password attribute&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;36&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token comment&#34;&gt;#access-key: &#34;&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;37&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token comment&#34;&gt;#secret-key: &#34;&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;38&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;data-id&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; seataServer.properties&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;39&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;40&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token key atrule&#34;&gt;registry&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;41&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;# support: nacos, eureka, redis, zk, consul, etcd3, sofa&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;42&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; nacos&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;43&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;preferred-networks&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; 30.240.*&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;44&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;nacos&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;45&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;application&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; seata&lt;span class=&#34;token punctuation&#34;&gt;-&lt;/span&gt;tc&lt;span class=&#34;token punctuation&#34;&gt;-&lt;/span&gt;server&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;46&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;server-addr&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; 127.0.0.1&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;8848&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;47&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;group&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; DEFAULT_GROUP&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;48&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;49&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;cluster&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; SH&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;50&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;username&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; nacos&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;51&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;password&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; nacos&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;52&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token comment&#34;&gt;##if use MSE Nacos with auth, mutex with username/password attribute&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;53&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token comment&#34;&gt;#access-key: &#34;&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;54&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token comment&#34;&gt;#secret-key: &#34;&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;55&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token key atrule&#34;&gt;store&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;56&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;# support: file ã€ db ã€ redis&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;57&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;mode&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; db&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;58&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;db&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;59&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;datasource&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; druid&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;60&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;db-type&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; mysql&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;61&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;driver-class-name&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; com.mysql.cj.jdbc.Driver&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;62&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;url&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; jdbc&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;mysql&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;//127.0.0.1&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;13306/seata&lt;span class=&#34;token punctuation&#34;&gt;?&lt;/span&gt;useUnicode=true&lt;span class=&#34;token important&#34;&gt;&amp;amp;rewriteBatchedStatements=true&amp;amp;serverTimezone=GMT&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;63&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;user&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; root&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;64&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;password&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; dkx.&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;65&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;min-conn&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;5&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;66&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;max-conn&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;100&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;67&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;global-table&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; global_table&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;68&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;branch-table&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; branch_table&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;69&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;lock-table&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; lock_table&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;70&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;distributed-lock-table&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; distributed_lock&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;71&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;query-limit&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;100&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;72&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;max-wait&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;5000&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;73&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;#  server:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;74&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;#    service-port: 8091 #If not configured, the default is &#39;$&amp;#123;server.port&amp;#125; + 1000&#39;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;75&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token key atrule&#34;&gt;security&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;76&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;secretKey&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; SeataSecretKey0c382ef121d778043159209298fd40bf3850a017&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;77&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;tokenValidityInMilliseconds&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1800000&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;78&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;ignore&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;79&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;urls&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; /&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;/&lt;span class=&#34;token important&#34;&gt;**/*.css&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;/&lt;span class=&#34;token important&#34;&gt;**/*.js&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;/&lt;span class=&#34;token important&#34;&gt;**/*.html&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;/&lt;span class=&#34;token important&#34;&gt;**/*.map&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;/&lt;span class=&#34;token important&#34;&gt;**/*.svg&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;/&lt;span class=&#34;token important&#34;&gt;**/*.png&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;/&lt;span class=&#34;token important&#34;&gt;**/*.ico&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;/console&lt;span class=&#34;token punctuation&#34;&gt;-&lt;/span&gt;fe/public/&lt;span class=&#34;token important&#34;&gt;**&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;/api/v1/auth/login&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h2 id=&#34;4åœ¨nacosæ·»åŠ é…ç½®&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#4åœ¨nacosæ·»åŠ é…ç½®&#34;&gt;#&lt;/a&gt; 4. åœ¨ nacos æ·»åŠ é…ç½®&lt;/h2&gt;
&lt;p&gt;ç‰¹åˆ«æ³¨æ„ï¼Œä¸ºäº†è®© tc æœåŠ¡çš„é›†ç¾¤å¯ä»¥å…±äº«é…ç½®ï¼Œæˆ‘ä»¬é€‰æ‹©äº† nacos ä½œä¸ºç»Ÿä¸€é…ç½®ä¸­å¿ƒã€‚å› æ­¤æœåŠ¡ç«¯é…ç½®æ–‡ä»¶ seataServer.properties æ–‡ä»¶éœ€è¦åœ¨ nacos ä¸­é…å¥½ã€‚&lt;/p&gt;
&lt;p&gt;æ ¼å¼å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310180750398.png&#34; alt=&#34;image-20210622203609227&#34;&gt;&lt;/p&gt;
&lt;p&gt;é…ç½®å†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight properties&#34;&gt;&lt;figcaption data-lang=&#34;.properties&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# æ•°æ®å­˜å‚¨æ–¹å¼ï¼Œdb ä»£è¡¨æ•°æ®åº“&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;store.mode&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;db&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;store.db.datasource&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;druid&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;store.db.dbType&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;mysql&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;store.db.driverClassName&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;com.mysql.jdbc.Driver&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;store.db.url&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;jdbc:mysql://127.0.0.1:3306/seata?useUnicode=true&amp;amp;rewriteBatchedStatements=true&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;store.db.user&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;root&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;store.db.password&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;123&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;store.db.minConn&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;5&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;store.db.maxConn&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;30&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;store.db.globalTable&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;global_table&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;store.db.branchTable&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;branch_table&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;store.db.queryLimit&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;100&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;store.db.lockTable&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;lock_table&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;store.db.maxWait&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;5000&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# äº‹åŠ¡ã€æ—¥å¿—ç­‰é…ç½®&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;server.recovery.committingRetryPeriod&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;1000&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;server.recovery.asynCommittingRetryPeriod&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;1000&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;server.recovery.rollbackingRetryPeriod&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;1000&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;server.recovery.timeoutRetryPeriod&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;1000&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;21&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;server.maxCommitRetryTimeout&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;-1&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;22&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;server.maxRollbackRetryTimeout&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;-1&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;23&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;server.rollbackRetryTimeoutUnlockEnable&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;false&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;24&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;server.undo.logSaveDays&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;7&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;25&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;server.undo.logDeletePeriod&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;86400000&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;26&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;27&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯ä¼ è¾“æ–¹å¼&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;28&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;transport.serialization&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;seata&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;29&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;transport.compressor&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;none&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;30&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# å…³é—­ metrics åŠŸèƒ½ï¼Œæé«˜æ€§èƒ½&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;31&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;metrics.enabled&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;false&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;32&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;metrics.registryType&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;compact&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;33&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;metrics.exporterList&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;prometheus&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;34&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;metrics.exporterPrometheusPort&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;9898&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;&lt;mark&gt;å…¶ä¸­çš„æ•°æ®åº“åœ°å€ã€ç”¨æˆ·åã€å¯†ç éƒ½éœ€è¦ä¿®æ”¹æˆä½ è‡ªå·±çš„æ•°æ®åº“ä¿¡æ¯ã€‚&lt;/mark&gt;&lt;/p&gt;
&lt;h2 id=&#34;5åˆ›å»ºæ•°æ®åº“è¡¨&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#5åˆ›å»ºæ•°æ®åº“è¡¨&#34;&gt;#&lt;/a&gt; 5. åˆ›å»ºæ•°æ®åº“è¡¨&lt;/h2&gt;
&lt;p&gt;ç‰¹åˆ«æ³¨æ„ï¼štc æœåŠ¡åœ¨ç®¡ç†åˆ†å¸ƒå¼äº‹åŠ¡æ—¶ï¼Œéœ€è¦è®°å½•äº‹åŠ¡ç›¸å…³æ•°æ®åˆ°æ•°æ®åº“ä¸­ï¼Œä½ éœ€è¦æå‰åˆ›å»ºå¥½è¿™äº›è¡¨ã€‚&lt;/p&gt;
&lt;p&gt;æ–°å»ºä¸€ä¸ªåä¸º seata çš„æ•°æ®åº“ï¼Œè¿è¡Œè¯¾å‰èµ„æ–™æä¾›çš„ sql æ–‡ä»¶ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310180750346.png&#34; alt=&#34;image-20210622204145159&#34;&gt;&lt;/p&gt;
&lt;p&gt;è¿™äº›è¡¨ä¸»è¦è®°å½•å…¨å±€äº‹åŠ¡ã€åˆ†æ”¯äº‹åŠ¡ã€å…¨å±€é”ä¿¡æ¯ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;
SET NAMES utf8mb4;
SET FOREIGN_KEY_CHECKS = 0;

-- ----------------------------
-- åˆ†æ”¯äº‹åŠ¡è¡¨
-- ----------------------------
DROP TABLE IF EXISTS `branch_table`;
CREATE TABLE `branch_table`  (
  `branch_id` bigint(20) NOT NULL,
  `xid` varchar(128) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL,
  `transaction_id` bigint(20) NULL DEFAULT NULL,
  `resource_group_id` varchar(32) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL,
  `resource_id` varchar(256) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL,
  `branch_type` varchar(8) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL,
  `status` tinyint(4) NULL DEFAULT NULL,
  `client_id` varchar(64) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL,
  `application_data` varchar(2000) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL,
  `gmt_create` datetime(6) NULL DEFAULT NULL,
  `gmt_modified` datetime(6) NULL DEFAULT NULL,
  PRIMARY KEY (`branch_id`) USING BTREE,
  INDEX `idx_xid`(`xid`) USING BTREE
) ENGINE = InnoDB CHARACTER SET = utf8 COLLATE = utf8_general_ci ROW_FORMAT = Compact;

-- ----------------------------
-- å…¨å±€äº‹åŠ¡è¡¨
-- ----------------------------
DROP TABLE IF EXISTS `global_table`;
CREATE TABLE `global_table`  (
  `xid` varchar(128) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL,
  `transaction_id` bigint(20) NULL DEFAULT NULL,
  `status` tinyint(4) NOT NULL,
  `application_id` varchar(32) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL,
  `transaction_service_group` varchar(32) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL,
  `transaction_name` varchar(128) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL,
  `timeout` int(11) NULL DEFAULT NULL,
  `begin_time` bigint(20) NULL DEFAULT NULL,
  `application_data` varchar(2000) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL,
  `gmt_create` datetime NULL DEFAULT NULL,
  `gmt_modified` datetime NULL DEFAULT NULL,
  PRIMARY KEY (`xid`) USING BTREE,
  INDEX `idx_gmt_modified_status`(`gmt_modified`, `status`) USING BTREE,
  INDEX `idx_transaction_id`(`transaction_id`) USING BTREE
) ENGINE = InnoDB CHARACTER SET = utf8 COLLATE = utf8_general_ci ROW_FORMAT = Compact;

SET FOREIGN_KEY_CHECKS = 1;
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;6å¯åŠ¨tcæœåŠ¡&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#6å¯åŠ¨tcæœåŠ¡&#34;&gt;#&lt;/a&gt; 6. å¯åŠ¨ TC æœåŠ¡&lt;/h2&gt;
&lt;p&gt;è¿›å…¥ bin ç›®å½•ï¼Œè¿è¡Œå…¶ä¸­çš„ seata-server.bat å³å¯ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310180750008.png&#34; alt=&#34;image-20210622205427318&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¯åŠ¨æˆåŠŸåï¼Œseata-server åº”è¯¥å·²ç»æ³¨å†Œåˆ° nacos æ³¨å†Œä¸­å¿ƒäº†ã€‚&lt;/p&gt;
&lt;p&gt;æ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—® nacos åœ°å€ï¼š&lt;a href=&#34;http://localhost:8848&#34;&gt;http://localhost:8848&lt;/a&gt;ï¼Œç„¶åè¿›å…¥æœåŠ¡åˆ—è¡¨é¡µé¢ï¼Œå¯ä»¥çœ‹åˆ° seata-tc-server çš„ä¿¡æ¯ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310180750053.png&#34; alt=&#34;image-20210622205901450&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;äºŒ-å¾®æœåŠ¡é›†æˆseata&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#äºŒ-å¾®æœåŠ¡é›†æˆseata&#34;&gt;#&lt;/a&gt; äºŒã€å¾®æœåŠ¡é›†æˆ seata&lt;/h1&gt;
&lt;h2 id=&#34;1å¼•å…¥ä¾èµ–&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1å¼•å…¥ä¾èµ–&#34;&gt;#&lt;/a&gt; 1. å¼•å…¥ä¾èµ–&lt;/h2&gt;
&lt;p&gt;é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åœ¨å¾®æœåŠ¡ä¸­å¼•å…¥ seata ä¾èµ–ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight xml&#34;&gt;&lt;figcaption data-lang=&#34;XML&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;dependency&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;groupId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;com.alibaba.cloud&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;/&lt;/span&gt;groupId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;artifactId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;spring-cloud-starter-alibaba-seata&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;/&lt;/span&gt;artifactId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;exclusions&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;&amp;lt;!-- ç‰ˆæœ¬è¾ƒä½ï¼Œ1.3.0ï¼Œå› æ­¤æ’é™¤ --&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;exclusion&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;artifactId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;seata-spring-boot-starter&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;/&lt;/span&gt;artifactId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;groupId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;io.seata&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;/&lt;/span&gt;groupId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;/&lt;/span&gt;exclusion&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;/&lt;/span&gt;exclusions&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;/&lt;/span&gt;dependency&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;&amp;lt;!--seata starter é‡‡ç”¨ 1.4.2 ç‰ˆæœ¬ --&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;dependency&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;groupId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;io.seata&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;/&lt;/span&gt;groupId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;artifactId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;seata-spring-boot-starter&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;/&lt;/span&gt;artifactId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;version&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;$&amp;#123;seata.version&amp;#125;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;/&lt;/span&gt;version&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;/&lt;/span&gt;dependency&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h2 id=&#34;2ä¿®æ”¹é…ç½®æ–‡ä»¶&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2ä¿®æ”¹é…ç½®æ–‡ä»¶&#34;&gt;#&lt;/a&gt; 2. ä¿®æ”¹é…ç½®æ–‡ä»¶&lt;/h2&gt;
&lt;p&gt;éœ€è¦ä¿®æ”¹ application.yml æ–‡ä»¶ï¼Œæ·»åŠ ä¸€äº›é…ç½®ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight yaml&#34;&gt;&lt;figcaption data-lang=&#34;YAML&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key atrule&#34;&gt;seata&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token key atrule&#34;&gt;registry&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# TC æœåŠ¡æ³¨å†Œä¸­å¿ƒçš„é…ç½®ï¼Œå¾®æœåŠ¡æ ¹æ®è¿™äº›ä¿¡æ¯å»æ³¨å†Œä¸­å¿ƒè·å– tc æœåŠ¡åœ°å€&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;# å‚è€ƒ tc æœåŠ¡è‡ªå·±çš„ registry.conf ä¸­çš„é…ç½®&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; nacos&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;nacos&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# tc&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;server-addr&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; 127.0.0.1&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;8848&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;group&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; DEFAULT_GROUP&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;application&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; seata&lt;span class=&#34;token punctuation&#34;&gt;-&lt;/span&gt;tc&lt;span class=&#34;token punctuation&#34;&gt;-&lt;/span&gt;server &lt;span class=&#34;token comment&#34;&gt;# tc æœåŠ¡åœ¨ nacos ä¸­çš„æœåŠ¡åç§°&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;cluster&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; SH&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token key atrule&#34;&gt;tx-service-group&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; seata&lt;span class=&#34;token punctuation&#34;&gt;-&lt;/span&gt;demo &lt;span class=&#34;token comment&#34;&gt;# äº‹åŠ¡ç»„ï¼Œæ ¹æ®è¿™ä¸ªè·å– tc æœåŠ¡çš„ cluster åç§°&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token key atrule&#34;&gt;service&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;vgroup-mapping&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# äº‹åŠ¡ç»„ä¸ TC æœåŠ¡ cluster çš„æ˜ å°„å…³ç³»&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;seata-demo&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; SH&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;è¦ä» nacos ä¸­æ‰¾åˆ°ä¸€ä¸ªæœåŠ¡ï¼Œæˆ‘éœ€è¦çŸ¥é“ä»€ä¹ˆä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ä» nacos æ‰¾åˆ°ä¸€ä¸ªæœåŠ¡è‡³å°‘éœ€è¦çŸ¥é“ namespaceï¼Œgroupï¼Œapplication-name å’Œ cluster&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310180945757.png&#34; alt=&#34;image-20231018094533567&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310180948844.png&#34; alt=&#34;image-20231018094851842&#34;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;æ€»ç»“&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;nacos æœåŠ¡åç§°ç»„æˆåŒ…æ‹¬ï¼Ÿ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;namespace + group + serviceName + cluster&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;seata å®¢æˆ·ç«¯è·å– tc çš„ cluster åç§°æ–¹å¼&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä»¥ tx-group-service çš„å€¼ä¸º key åˆ° vgroupMapping ä¸­æŸ¥æ‰¾&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h1 id=&#34;ä¸‰-tcæœåŠ¡çš„é«˜å¯ç”¨å’Œå¼‚åœ°å®¹ç¾&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä¸‰-tcæœåŠ¡çš„é«˜å¯ç”¨å’Œå¼‚åœ°å®¹ç¾&#34;&gt;#&lt;/a&gt; ä¸‰ã€TC æœåŠ¡çš„é«˜å¯ç”¨å’Œå¼‚åœ°å®¹ç¾&lt;/h1&gt;
&lt;h2 id=&#34;1æ¨¡æ‹Ÿå¼‚åœ°å®¹ç¾çš„tcé›†ç¾¤&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1æ¨¡æ‹Ÿå¼‚åœ°å®¹ç¾çš„tcé›†ç¾¤&#34;&gt;#&lt;/a&gt; 1. æ¨¡æ‹Ÿå¼‚åœ°å®¹ç¾çš„ TC é›†ç¾¤&lt;/h2&gt;
&lt;p&gt;è®¡åˆ’å¯åŠ¨ä¸¤å° seata çš„ tc æœåŠ¡èŠ‚ç‚¹ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;èŠ‚ç‚¹åç§°&lt;/th&gt;
&lt;th&gt;ip åœ°å€&lt;/th&gt;
&lt;th&gt;ç«¯å£å·&lt;/th&gt;
&lt;th&gt;é›†ç¾¤åç§°&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;seata&lt;/td&gt;
&lt;td&gt;127.0.0.1&lt;/td&gt;
&lt;td&gt;8091&lt;/td&gt;
&lt;td&gt;SH&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;seata2&lt;/td&gt;
&lt;td&gt;127.0.0.1&lt;/td&gt;
&lt;td&gt;8092&lt;/td&gt;
&lt;td&gt;HZ&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;ä¹‹å‰æˆ‘ä»¬å·²ç»å¯åŠ¨äº†ä¸€å° seata æœåŠ¡ï¼Œç«¯å£æ˜¯ 8091ï¼Œé›†ç¾¤åä¸º SHã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨ï¼Œå°† seata ç›®å½•å¤åˆ¶ä¸€ä»½ï¼Œèµ·åä¸º seata2&lt;/p&gt;
&lt;p&gt;ä¿®æ”¹ seata2/conf/registry.conf å†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight nginx&#34;&gt;&lt;figcaption data-lang=&#34;nginx&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;registry&lt;/span&gt;&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token comment&#34;&gt;# tc æœåŠ¡çš„æ³¨å†Œä¸­å¿ƒç±»ï¼Œè¿™é‡Œé€‰æ‹© nacosï¼Œä¹Ÿå¯ä»¥æ˜¯ eurekaã€zookeeper ç­‰&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;type&lt;/span&gt; = &lt;span class=&#34;token string&#34;&gt;&#34;nacos&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  nacos&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;# seata tc æœåŠ¡æ³¨å†Œåˆ° nacos çš„æœåŠ¡åç§°ï¼Œå¯ä»¥è‡ªå®šä¹‰&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    application = &#34;seata-tc-server&#34;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    serverAddr = &#34;127.0.0.1:8848&#34;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    group = &#34;DEFAULT_GROUP&#34;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    namespace = &#34;&#34;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    cluster = &#34;HZ&#34;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    username = &#34;nacos&#34;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    password = &#34;nacos&#34;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;config&lt;/span&gt;&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token comment&#34;&gt;# è¯»å– tc æœåŠ¡ç«¯çš„é…ç½®æ–‡ä»¶çš„æ–¹å¼ï¼Œè¿™é‡Œæ˜¯ä» nacos é…ç½®ä¸­å¿ƒè¯»å–ï¼Œè¿™æ ·å¦‚æœ tc æ˜¯é›†ç¾¤ï¼Œå¯ä»¥å…±äº«é…ç½®&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;type&lt;/span&gt; = &lt;span class=&#34;token string&#34;&gt;&#34;nacos&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token comment&#34;&gt;# é…ç½® nacos åœ°å€ç­‰ä¿¡æ¯&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;21&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  nacos&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;22&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    serverAddr = &#34;127.0.0.1:8848&#34;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;23&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    namespace = &#34;&#34;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;24&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    group = &#34;SEATA_GROUP&#34;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;25&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    username = &#34;nacos&#34;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;26&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    password = &#34;nacos&#34;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;27&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    dataId = &#34;seataServer.properties&#34;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;28&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;29&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;Seata-1.7.0 ç‰ˆæœ¬çš„é…ç½®å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;æ‰¾åˆ° yml é…ç½®æ–‡ä»¶&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310181958636.png&#34; alt=&#34;image-20231018092704361&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight yml&#34;&gt;&lt;figcaption data-lang=&#34;YAML&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key atrule&#34;&gt;server&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token key atrule&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;7091&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key atrule&#34;&gt;spring&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token key atrule&#34;&gt;application&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; seata&lt;span class=&#34;token punctuation&#34;&gt;-&lt;/span&gt;server&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key atrule&#34;&gt;logging&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token key atrule&#34;&gt;config&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; classpath&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;logback&lt;span class=&#34;token punctuation&#34;&gt;-&lt;/span&gt;spring.xml&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token key atrule&#34;&gt;file&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; $&lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;user.home&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;/logs/seata&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token key atrule&#34;&gt;extend&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;logstash-appender&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;destination&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; 127.0.0.1&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;4560&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;kafka-appender&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;bootstrap-servers&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; 127.0.0.1&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;9092&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;topic&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; logback_to_logstash&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key atrule&#34;&gt;console&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token key atrule&#34;&gt;user&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;21&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;username&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; seata&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;22&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;password&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; seata&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;23&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;24&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key atrule&#34;&gt;seata&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;25&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token key atrule&#34;&gt;config&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;26&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;# support: nacos, consul, apollo, zk, etcd3&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;27&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; nacos&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;28&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;nacos&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;29&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;server-addr&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; 127.0.0.1&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;8848&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;30&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;31&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token comment&#34;&gt;# æ”¹è¿™é‡Œä¼šæŠ¥é”™&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;32&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;group&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; SEATA_GROUP&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;33&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;username&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; nacos&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;34&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;password&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; nacos&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;35&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token comment&#34;&gt;##if use MSE Nacos with auth, mutex with username/password attribute&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;36&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token comment&#34;&gt;#access-key: &#34;&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;37&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token comment&#34;&gt;#secret-key: &#34;&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;38&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;data-id&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; seataServer.properties&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;39&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;40&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token key atrule&#34;&gt;registry&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;41&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;# support: nacos, eureka, redis, zk, consul, etcd3, sofa&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;42&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; nacos&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;43&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;preferred-networks&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; 30.240.*&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;44&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;nacos&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;45&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;application&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; seata&lt;span class=&#34;token punctuation&#34;&gt;-&lt;/span&gt;tc&lt;span class=&#34;token punctuation&#34;&gt;-&lt;/span&gt;server&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;46&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;server-addr&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; 127.0.0.1&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;8848&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;47&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;group&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; DEFAULT_GROUP&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;48&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;49&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;cluster&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; HZ &lt;span class=&#34;token comment&#34;&gt;# ä¿®æ”¹é›†ç¾¤åœ°å€&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;50&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;username&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; nacos&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;51&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;password&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; nacos&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;52&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token comment&#34;&gt;##if use MSE Nacos with auth, mutex with username/password attribute&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;53&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token comment&#34;&gt;#access-key: &#34;&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;54&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token comment&#34;&gt;#secret-key: &#34;&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;55&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;56&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token key atrule&#34;&gt;store&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;57&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;# support: file ã€ db ã€ redis&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;58&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;mode&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; db&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;59&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;db&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;60&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;datasource&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; druid&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;61&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;db-type&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; mysql&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;62&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;driver-class-name&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; com.mysql.cj.jdbc.Driver&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;63&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;url&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; jdbc&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;mysql&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;//127.0.0.1&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;13306/seata&lt;span class=&#34;token punctuation&#34;&gt;?&lt;/span&gt;useUnicode=true&lt;span class=&#34;token important&#34;&gt;&amp;amp;rewriteBatchedStatements=true&amp;amp;serverTimezone=GMT&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;64&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;user&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; root&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;65&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;password&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; dkx.&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;66&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;min-conn&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;5&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;67&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;max-conn&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;100&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;68&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;global-table&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; global_table&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;69&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;branch-table&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; branch_table&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;70&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;lock-table&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; lock_table&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;71&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;distributed-lock-table&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; distributed_lock&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;72&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;query-limit&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;100&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;73&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;max-wait&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;5000&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;74&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;#  server:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;75&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;#    service-port: 8091 #If not configured, the default is &#39;$&amp;#123;server.port&amp;#125; + 1000&#39;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;76&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token key atrule&#34;&gt;security&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;77&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;secretKey&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; SeataSecretKey0c382ef121d778043159209298fd40bf3850a017&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;78&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;tokenValidityInMilliseconds&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1800000&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;79&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;ignore&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;80&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;urls&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; /&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;/&lt;span class=&#34;token important&#34;&gt;**/*.css&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;/&lt;span class=&#34;token important&#34;&gt;**/*.js&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;/&lt;span class=&#34;token important&#34;&gt;**/*.html&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;/&lt;span class=&#34;token important&#34;&gt;**/*.map&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;/&lt;span class=&#34;token important&#34;&gt;**/*.svg&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;/&lt;span class=&#34;token important&#34;&gt;**/*.png&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;/&lt;span class=&#34;token important&#34;&gt;**/*.ico&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;/console&lt;span class=&#34;token punctuation&#34;&gt;-&lt;/span&gt;fe/public/&lt;span class=&#34;token important&#34;&gt;**&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;/api/v1/auth/login&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;è¿›å…¥ seata2/bin ç›®å½•ï¼Œç„¶åè¿è¡Œå‘½ä»¤ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight powershell&#34;&gt;&lt;figcaption data-lang=&#34;PowerShell&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;seata-server&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;bat &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;p 8092&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;1.7.0 ç‰ˆæœ¬å®åœ¨ä¸è¡Œå°±é…ç½®æ–‡ä»¶é‡Œä¿®æ”¹ç«¯å£å·&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310182005822.png&#34; alt=&#34;image-20231018200503303&#34;&gt;&lt;/p&gt;
&lt;p&gt;æ‰“å¼€ nacos æ§åˆ¶å°ï¼ŒæŸ¥çœ‹æœåŠ¡åˆ—è¡¨ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310180750772.png&#34; alt=&#34;image-20210624151150840&#34;&gt;&lt;/p&gt;
&lt;p&gt;ç‚¹è¿›è¯¦æƒ…æŸ¥çœ‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310180750333.png&#34; alt=&#34;image-20210624151221747&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;2å°†äº‹åŠ¡ç»„æ˜ å°„é…ç½®åˆ°nacos&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2å°†äº‹åŠ¡ç»„æ˜ å°„é…ç½®åˆ°nacos&#34;&gt;#&lt;/a&gt; 2. å°†äº‹åŠ¡ç»„æ˜ å°„é…ç½®åˆ° nacos&lt;/h2&gt;
&lt;p&gt;æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦å°† tx-service-group ä¸ cluster çš„æ˜ å°„å…³ç³»éƒ½é…ç½®åˆ° nacos é…ç½®ä¸­å¿ƒã€‚&lt;/p&gt;
&lt;p&gt;æ–°å»ºä¸€ä¸ªé…ç½®ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310180751774.png&#34; alt=&#34;image-20210624151507072&#34;&gt;&lt;/p&gt;
&lt;p&gt;é…ç½®çš„å†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight properties&#34;&gt;&lt;figcaption data-lang=&#34;.properties&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# äº‹åŠ¡ç»„æ˜ å°„å…³ç³»&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;service.vgroupMapping.seata-demo&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;SH&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;service.enableDegrade&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;false&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;service.disableGlobalTransaction&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;false&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# ä¸ TC æœåŠ¡çš„é€šä¿¡é…ç½®&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;transport.type&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;TCP&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;transport.server&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;NIO&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;transport.heartbeat&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;true&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;transport.enableClientBatchSendRequest&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;false&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;transport.threadFactory.bossThreadPrefix&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;NettyBoss&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;transport.threadFactory.workerThreadPrefix&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;NettyServerNIOWorker&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;transport.threadFactory.serverExecutorThreadPrefix&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;NettyServerBizHandler&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;transport.threadFactory.shareBossWorker&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;false&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;transport.threadFactory.clientSelectorThreadPrefix&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;NettyClientSelector&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;transport.threadFactory.clientSelectorThreadSize&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;1&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;transport.threadFactory.clientWorkerThreadPrefix&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;NettyClientWorkerThread&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;transport.threadFactory.bossThreadSize&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;1&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;transport.threadFactory.workerThreadSize&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;default&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;transport.shutdown.wait&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;3&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;21&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# RM é…ç½®&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;22&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;client.rm.asyncCommitBufferLimit&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;10000&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;23&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;client.rm.lock.retryInterval&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;10&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;24&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;client.rm.lock.retryTimes&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;30&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;25&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;client.rm.lock.retryPolicyBranchRollbackOnConflict&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;true&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;26&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;client.rm.reportRetryCount&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;5&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;27&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;client.rm.tableMetaCheckEnable&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;false&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;28&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;client.rm.tableMetaCheckerInterval&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;60000&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;29&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;client.rm.sqlParserType&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;druid&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;30&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;client.rm.reportSuccessEnable&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;false&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;31&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;client.rm.sagaBranchRegisterEnable&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;false&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;32&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# TM é…ç½®&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;33&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;client.tm.commitRetryCount&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;5&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;34&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;client.tm.rollbackRetryCount&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;5&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;35&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;client.tm.defaultGlobalTransactionTimeout&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;60000&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;36&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;client.tm.degradeCheck&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;false&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;37&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;client.tm.degradeCheckAllowTimes&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;10&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;38&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;client.tm.degradeCheckPeriod&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;2000&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;39&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;40&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# undo æ—¥å¿—é…ç½®&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;41&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;client.undo.dataValidation&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;true&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;42&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;client.undo.logSerialization&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;jackson&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;43&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;client.undo.onlyCareUpdateColumns&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;true&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;44&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;client.undo.logTable&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;undo_log&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;45&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;client.undo.compress.enable&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;true&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;46&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;client.undo.compress.type&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;zip&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;47&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;client.undo.compress.threshold&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;64k&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;48&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;client.log.exceptionRate&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;100&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h2 id=&#34;3å¾®æœåŠ¡è¯»å–nacosé…ç½®&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#3å¾®æœåŠ¡è¯»å–nacosé…ç½®&#34;&gt;#&lt;/a&gt; 3. å¾®æœåŠ¡è¯»å– nacos é…ç½®&lt;/h2&gt;
&lt;p&gt;æ¥ä¸‹æ¥ï¼Œéœ€è¦ä¿®æ”¹æ¯ä¸€ä¸ªå¾®æœåŠ¡çš„ application.yml æ–‡ä»¶ï¼Œè®©å¾®æœåŠ¡è¯»å– nacos ä¸­çš„ client.properties æ–‡ä»¶ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight yaml&#34;&gt;&lt;figcaption data-lang=&#34;YAML&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key atrule&#34;&gt;seata&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token key atrule&#34;&gt;config&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; nacos&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;nacos&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;server-addr&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; 127.0.0.1&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;8848&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;username&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; nacos&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;password&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; nacos&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;group&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; SEATA_GROUP &lt;span class=&#34;token comment&#34;&gt;# è¿™é‡Œå’Œ nacos æ·»åŠ é…ç½®æ–‡ä»¶ä¸­çš„ group è¦ä¸€è‡´&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;data-id&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; client.properties&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;é‡å¯å¾®æœåŠ¡ï¼Œç°åœ¨å¾®æœåŠ¡åˆ°åº•æ˜¯è¿æ¥ tc çš„ SH é›†ç¾¤ï¼Œè¿˜æ˜¯ tc çš„ HZ é›†ç¾¤ï¼Œéƒ½ç»Ÿä¸€ç”± nacos çš„ client.properties æ¥å†³å®šäº†ã€‚&lt;/p&gt;
&lt;p&gt;8092&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310182016810.png&#34; alt=&#34;image-20231018201640218&#34;&gt;&lt;/p&gt;
&lt;p&gt;7091&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310182017126.png&#34; alt=&#34;image-20231018201658572&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ° 8092 æ²¡æœ‰ä»»ä½•äººæ³¨å†Œï¼Œè€Œæ˜¯éƒ½æ³¨å†Œåˆ°äº† 7091 ä¸Šäº†&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å» nacos æ§åˆ¶å°ä¸­å¯¹åˆšæ‰åˆ›å»ºçš„é…ç½®æ–‡ä»¶çš„é›†ç¾¤åœ°å€è¿›è¡Œä¿®æ”¹ä¸ºï¼šHZ&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310182019284.png&#34; alt=&#34;image-20231018201902967&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310182019735.png&#34; alt=&#34;image-20231018201919714&#34;&gt;&lt;/p&gt;
&lt;p&gt;åœ¨ 8092 çš„ seata å¯åŠ¨çª—å£å°±å¯ä»¥çœ‹åˆ°å¦‚ä¸‹ä¿¡æ¯ï¼š&lt;/p&gt;
&lt;p&gt;æ­¤æ—¶æœåŠ¡å°±å…¨éƒ¨éƒ½åˆ‡æ¢åˆ°äº† 8092 è¿™ä¸ª seata æœåŠ¡ä¸Šäº†ï¼Œ7091 å°±æ²¡ç”¨äº†ç”šè‡³äºåœæ‰ä¹Ÿæ²¡æœ‰é—®é¢˜&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310182027851.png&#34; alt=&#34;image-20231018202705207&#34;&gt;&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://pigpigletsgo.github.io/homepage/2024/04/02/computer-science/java/spring/springcloud/springcloud-%E9%AB%98%E7%BA%A7/OpenResty/%E5%AE%89%E8%A3%85OpenResty/</guid>
            <title>å®‰è£…OpenResty</title>
            <link>https://pigpigletsgo.github.io/homepage/2024/04/02/computer-science/java/spring/springcloud/springcloud-%E9%AB%98%E7%BA%A7/OpenResty/%E5%AE%89%E8%A3%85OpenResty/</link>
            <category>è®¡ç®—æœºå­¦ç§‘</category>
            <category>springcloud</category>
            <category>OpenResty</category>
            <pubDate>Tue, 02 Apr 2024 14:23:31 +0800</pubDate>
            <description><![CDATA[ &lt;h1 id=&#34;å®‰è£…openresty&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#å®‰è£…openresty&#34;&gt;#&lt;/a&gt; å®‰è£… OpenResty&lt;/h1&gt;
&lt;h1 id=&#34;1å®‰è£…&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1å®‰è£…&#34;&gt;#&lt;/a&gt; 1. å®‰è£…&lt;/h1&gt;
&lt;p&gt;é¦–å…ˆä½ çš„ Linux è™šæ‹Ÿæœºå¿…é¡»è”ç½‘&lt;/p&gt;
&lt;h2 id=&#34;1å®‰è£…å¼€å‘åº“&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1å®‰è£…å¼€å‘åº“&#34;&gt;#&lt;/a&gt; &lt;strong&gt;1ï¼‰å®‰è£…å¼€å‘åº“&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;é¦–å…ˆè¦å®‰è£… OpenResty çš„ä¾èµ–å¼€å‘åº“ï¼Œæ‰§è¡Œå‘½ä»¤ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight sh&#34;&gt;&lt;figcaption data-lang=&#34;sh&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;yum &lt;span class=&#34;token function&#34;&gt;install&lt;/span&gt; &lt;span class=&#34;token parameter variable&#34;&gt;-y&lt;/span&gt; pcre-devel openssl-devel gcc --skip-broken&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h2 id=&#34;2å®‰è£…openrestyä»“åº“&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2å®‰è£…openrestyä»“åº“&#34;&gt;#&lt;/a&gt; &lt;strong&gt;2ï¼‰å®‰è£… OpenResty ä»“åº“&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;ä½ å¯ä»¥åœ¨ä½ çš„ CentOS ç³»ç»Ÿä¸­æ·»åŠ   &lt;code&gt;openresty&lt;/code&gt;  ä»“åº“ï¼Œè¿™æ ·å°±å¯ä»¥ä¾¿äºæœªæ¥å®‰è£…æˆ–æ›´æ–°æˆ‘ä»¬çš„è½¯ä»¶åŒ…ï¼ˆé€šè¿‡  &lt;code&gt;yum check-update&lt;/code&gt;  å‘½ä»¤ï¼‰ã€‚è¿è¡Œä¸‹é¢çš„å‘½ä»¤å°±å¯ä»¥æ·»åŠ æˆ‘ä»¬çš„ä»“åº“ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;yum-config-manager --add-repo https://openresty.org/package/centos/openresty.repo
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦‚æœæç¤ºè¯´å‘½ä»¤ä¸å­˜åœ¨ï¼Œåˆ™è¿è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;yum install -y yum-utils 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç„¶åå†é‡å¤ä¸Šé¢çš„å‘½ä»¤&lt;/p&gt;
&lt;h2 id=&#34;3å®‰è£…openresty&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#3å®‰è£…openresty&#34;&gt;#&lt;/a&gt; &lt;strong&gt;3ï¼‰å®‰è£… OpenResty&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;ç„¶åå°±å¯ä»¥åƒä¸‹é¢è¿™æ ·å®‰è£…è½¯ä»¶åŒ…ï¼Œæ¯”å¦‚  &lt;code&gt;openresty&lt;/code&gt; ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;figcaption data-lang=&#34;bash&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;yum &lt;span class=&#34;token function&#34;&gt;install&lt;/span&gt; &lt;span class=&#34;token parameter variable&#34;&gt;-y&lt;/span&gt; openresty&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h2 id=&#34;4å®‰è£…opmå·¥å…·&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#4å®‰è£…opmå·¥å…·&#34;&gt;#&lt;/a&gt; &lt;strong&gt;4ï¼‰å®‰è£… opm å·¥å…·&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;opm æ˜¯ OpenResty çš„ä¸€ä¸ªç®¡ç†å·¥å…·ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬å®‰è£…ä¸€ä¸ªç¬¬ä¸‰æ–¹çš„ Lua æ¨¡å—ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ æƒ³å®‰è£…å‘½ä»¤è¡Œå·¥å…·  &lt;code&gt;opm&lt;/code&gt; ï¼Œé‚£ä¹ˆå¯ä»¥åƒä¸‹é¢è¿™æ ·å®‰è£…  &lt;code&gt;openresty-opm&lt;/code&gt;  åŒ…ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;figcaption data-lang=&#34;bash&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;yum &lt;span class=&#34;token function&#34;&gt;install&lt;/span&gt; &lt;span class=&#34;token parameter variable&#34;&gt;-y&lt;/span&gt; openresty-opm&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h2 id=&#34;5ç›®å½•ç»“æ„&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#5ç›®å½•ç»“æ„&#34;&gt;#&lt;/a&gt; &lt;strong&gt;5ï¼‰ç›®å½•ç»“æ„&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;é»˜è®¤æƒ…å†µä¸‹ï¼ŒOpenResty å®‰è£…çš„ç›®å½•æ˜¯ï¼š/usr/local/openresty&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310200901485.png&#34; alt=&#34;image-20200310225539214&#34;&gt;&lt;/p&gt;
&lt;p&gt;çœ‹åˆ°é‡Œé¢çš„ nginx ç›®å½•äº†å—ï¼ŒOpenResty å°±æ˜¯åœ¨ Nginx åŸºç¡€ä¸Šé›†æˆäº†ä¸€äº› Lua æ¨¡å—ã€‚&lt;/p&gt;
&lt;h2 id=&#34;6é…ç½®nginxçš„ç¯å¢ƒå˜é‡&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#6é…ç½®nginxçš„ç¯å¢ƒå˜é‡&#34;&gt;#&lt;/a&gt; &lt;strong&gt;6ï¼‰é…ç½® nginx çš„ç¯å¢ƒå˜é‡&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;æ‰“å¼€é…ç½®æ–‡ä»¶ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight sh&#34;&gt;&lt;figcaption data-lang=&#34;sh&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token function&#34;&gt;vi&lt;/span&gt; /etc/profile&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;åœ¨æœ€ä¸‹é¢åŠ å…¥ä¸¤è¡Œï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight sh&#34;&gt;&lt;figcaption data-lang=&#34;sh&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token builtin class-name&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;token assign-left variable&#34;&gt;NGINX_HOME&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;/usr/local/openresty/nginx&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token builtin class-name&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;token assign-left variable&#34;&gt;&lt;span class=&#34;token environment constant&#34;&gt;PATH&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token variable&#34;&gt;$&amp;#123;NGINX_HOME&amp;#125;&lt;/span&gt;/sbin:&lt;span class=&#34;token environment constant&#34;&gt;$PATH&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;NGINX_HOMEï¼šåé¢æ˜¯ OpenResty å®‰è£…ç›®å½•ä¸‹çš„ nginx çš„ç›®å½•&lt;/p&gt;
&lt;p&gt;ç„¶åè®©é…ç½®ç”Ÿæ•ˆï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;source /etc/profile
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;2å¯åŠ¨å’Œè¿è¡Œ&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2å¯åŠ¨å’Œè¿è¡Œ&#34;&gt;#&lt;/a&gt; 2. å¯åŠ¨å’Œè¿è¡Œ&lt;/h1&gt;
&lt;p&gt;OpenResty åº•å±‚æ˜¯åŸºäº Nginx çš„ï¼ŒæŸ¥çœ‹ OpenResty ç›®å½•çš„ nginx ç›®å½•ï¼Œç»“æ„ä¸ windows ä¸­å®‰è£…çš„ nginx åŸºæœ¬ä¸€è‡´ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310200901105.png&#34; alt=&#34;image-20210811100653291&#34;&gt;&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥è¿è¡Œæ–¹å¼ä¸ nginx åŸºæœ¬ä¸€è‡´ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight sh&#34;&gt;&lt;figcaption data-lang=&#34;sh&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# å¯åŠ¨ nginx&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;nginx&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# é‡æ–°åŠ è½½é…ç½®&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;nginx &lt;span class=&#34;token parameter variable&#34;&gt;-s&lt;/span&gt; reload&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# åœæ­¢&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;nginx &lt;span class=&#34;token parameter variable&#34;&gt;-s&lt;/span&gt; stop&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;nginx çš„é»˜è®¤é…ç½®æ–‡ä»¶æ³¨é‡Šå¤ªå¤šï¼Œå½±å“åç»­æˆ‘ä»¬çš„ç¼–è¾‘ï¼Œè¿™é‡Œå°† nginx.conf ä¸­çš„æ³¨é‡Šéƒ¨åˆ†åˆ é™¤ï¼Œä¿ç•™æœ‰æ•ˆéƒ¨åˆ†ã€‚&lt;/p&gt;
&lt;p&gt;ä¿®æ”¹ &lt;code&gt;/usr/local/openresty/nginx/conf/nginx.conf&lt;/code&gt;  æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight nginx&#34;&gt;&lt;figcaption data-lang=&#34;nginx&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;#user  nobody;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;worker_processes&lt;/span&gt;  &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;error_log&lt;/span&gt;  logs/error.log&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;events&lt;/span&gt;&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;worker_connections&lt;/span&gt;  &lt;span class=&#34;token number&#34;&gt;1024&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;http&lt;/span&gt;&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;include&lt;/span&gt;       mime.types&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;default_type&lt;/span&gt;  application/octet-stream&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;sendfile&lt;/span&gt;        &lt;span class=&#34;token boolean&#34;&gt;on&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;keepalive_timeout&lt;/span&gt;  &lt;span class=&#34;token number&#34;&gt;65&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;server&lt;/span&gt;&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;listen&lt;/span&gt;       &lt;span class=&#34;token number&#34;&gt;8081&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;server_name&lt;/span&gt;  localhost&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;location&lt;/span&gt; /&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;root&lt;/span&gt;   html&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;index&lt;/span&gt;  index.html index.htm&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;21&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;22&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;error_page&lt;/span&gt;   &lt;span class=&#34;token number&#34;&gt;500&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;502&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;503&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;504&lt;/span&gt;  /50x.html&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;23&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;location&lt;/span&gt; = /50x.html&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;24&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;root&lt;/span&gt;   html&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;25&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;26&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;27&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;åœ¨ Linux çš„æ§åˆ¶å°è¾“å…¥å‘½ä»¤ä»¥å¯åŠ¨ nginxï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight sh&#34;&gt;&lt;figcaption data-lang=&#34;sh&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;nginx&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;ç„¶åè®¿é—®é¡µé¢ï¼š&lt;a href=&#34;http://192.168.150.101:8081&#34;&gt;http://192.168.150.101:8081&lt;/a&gt;ï¼Œæ³¨æ„ ip åœ°å€æ›¿æ¢ä¸ºä½ è‡ªå·±çš„è™šæ‹Ÿæœº IPï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310200910980.png&#34; alt=&#34;image-20231020091008283&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;3å¤‡æ³¨&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#3å¤‡æ³¨&#34;&gt;#&lt;/a&gt; 3. å¤‡æ³¨&lt;/h1&gt;
&lt;p&gt;åŠ è½½ OpenResty çš„ lua æ¨¡å—ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight nginx&#34;&gt;&lt;figcaption data-lang=&#34;nginx&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;#lua æ¨¡å—&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;lua_package_path&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;/usr/local/openresty/lualib/?.lua;;&#34;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;#c æ¨¡å—     &lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;lua_package_cpath&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;/usr/local/openresty/lualib/?.so;;&#34;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;ç›‘å¬æµè§ˆå™¨è¯·æ±‚&lt;/p&gt;
&lt;figure class=&#34;highlight nginx&#34;&gt;&lt;figcaption data-lang=&#34;nginx&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;server&lt;/span&gt;&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;listen&lt;/span&gt;       &lt;span class=&#34;token number&#34;&gt;8081&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;server_name&lt;/span&gt;  localhost&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;location&lt;/span&gt; /api/item&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;          &lt;span class=&#34;token comment&#34;&gt;# é»˜è®¤çš„å“åº”ç±»å‹&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;          &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;default_type&lt;/span&gt; application/json&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;          &lt;span class=&#34;token comment&#34;&gt;# å“åº”ç»“æœç”± lua/item.lua ä¸‹çš„æ–‡ä»¶å†³å®š&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;          &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;content_by_lua_file&lt;/span&gt; lua/item.lua&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;location&lt;/span&gt; /&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;root&lt;/span&gt;   html&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;index&lt;/span&gt;  index.html index.htm&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;error_page&lt;/span&gt;   &lt;span class=&#34;token number&#34;&gt;500&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;502&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;503&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;504&lt;/span&gt;  /50x.html&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;location&lt;/span&gt; = /50x.html&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;root&lt;/span&gt;   html&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;common.lua&lt;/p&gt;
&lt;figure class=&#34;highlight lua&#34;&gt;&lt;figcaption data-lang=&#34;lua&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- å°è£…å‡½æ•°ï¼Œå‘é€ http è¯·æ±‚ï¼Œå¹¶è§£æå“åº”&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;read_http&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;path&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; params&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; resp &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;location&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;capture&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;path&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        method &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;HTTP_GET&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        args &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; params&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;not&lt;/span&gt; resp &lt;span class=&#34;token keyword&#34;&gt;then&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;-- è®°å½•é”™è¯¯ä¿¡æ¯ï¼Œè¿”å› 404&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;ERR&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;http not found, path: &#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; path &lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;, args: &#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; args&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;exit&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;404&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;end&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; resp&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;body&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;end&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- å°†æ–¹æ³•å¯¼å‡º&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; _M &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;  &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    read_http &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; read_http&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;  &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; _M&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;é‡Šæ”¾ Redis è¿æ¥ APIï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight lua&#34;&gt;&lt;figcaption data-lang=&#34;lua&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- å…³é—­ redis è¿æ¥çš„å·¥å…·æ–¹æ³•ï¼Œå…¶å®æ˜¯æ”¾å…¥è¿æ¥æ± &lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;close_redis&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;red&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; pool_max_idle_time &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;10000&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;-- è¿æ¥çš„ç©ºé—²æ—¶é—´ï¼Œå•ä½æ˜¯æ¯«ç§’&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; pool_size &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;100&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;-- è¿æ¥æ± å¤§å°&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; ok&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; err &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; red&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;set_keepalive&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;pool_max_idle_time&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; pool_size&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;not&lt;/span&gt; ok &lt;span class=&#34;token keyword&#34;&gt;then&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;ERR&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;æ”¾å…¥redisè¿æ¥æ± å¤±è´¥: &#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; err&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;end&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;end&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;è¯»å– Redis æ•°æ®çš„ APIï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight lua&#34;&gt;&lt;figcaption data-lang=&#34;lua&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- æŸ¥è¯¢ redis çš„æ–¹æ³• ip å’Œ port æ˜¯ redis åœ°å€ï¼Œkey æ˜¯æŸ¥è¯¢çš„ key&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;read_redis&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;ip&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; port&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; key&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;-- è·å–ä¸€ä¸ªè¿æ¥&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; ok&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; err &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; red&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;connect&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;ip&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; port&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;not&lt;/span&gt; ok &lt;span class=&#34;token keyword&#34;&gt;then&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;ERR&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;è¿æ¥rediså¤±è´¥ : &#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; err&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;nil&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;end&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;-- æŸ¥è¯¢ redis&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; resp&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; err &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; red&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;key&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;-- æŸ¥è¯¢å¤±è´¥å¤„ç†&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;not&lt;/span&gt; resp &lt;span class=&#34;token keyword&#34;&gt;then&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;ERR&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;æŸ¥è¯¢Rediså¤±è´¥: &#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; err&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;, key = &#34;&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; key&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;end&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;-- å¾—åˆ°çš„æ•°æ®ä¸ºç©ºå¤„ç†&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; resp &lt;span class=&#34;token operator&#34;&gt;==&lt;/span&gt; ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;null &lt;span class=&#34;token keyword&#34;&gt;then&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        resp &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;nil&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;ERR&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;æŸ¥è¯¢Redisæ•°æ®ä¸ºç©º, key = &#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; key&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;end&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token function&#34;&gt;close_redis&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;red&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;21&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; resp&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;22&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;end&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;å¼€å¯å…±äº«è¯å…¸ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight nginx&#34;&gt;&lt;figcaption data-lang=&#34;nginx&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# å…±äº«å­—å…¸ï¼Œä¹Ÿå°±æ˜¯æœ¬åœ°ç¼“å­˜ï¼Œåç§°å«åšï¼šitem_cacheï¼Œå¤§å° 150m&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;lua_shared_dict&lt;/span&gt; item_cache &lt;span class=&#34;token number&#34;&gt;150m&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt; ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://pigpigletsgo.github.io/homepage/2024/04/02/computer-science/java/spring/springcloud/springcloud-%E9%AB%98%E7%BA%A7/canal/%E5%AE%89%E8%A3%85Canal/</guid>
            <title>å®‰è£…å’Œé…ç½®Canal</title>
            <link>https://pigpigletsgo.github.io/homepage/2024/04/02/computer-science/java/spring/springcloud/springcloud-%E9%AB%98%E7%BA%A7/canal/%E5%AE%89%E8%A3%85Canal/</link>
            <category>è®¡ç®—æœºå­¦ç§‘</category>
            <category>åŸºç¡€</category>
            <category>springcloud</category>
            <category>Canal</category>
            <pubDate>Tue, 02 Apr 2024 14:23:31 +0800</pubDate>
            <description><![CDATA[ &lt;h1 id=&#34;å®‰è£…å’Œé…ç½®canal&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#å®‰è£…å’Œé…ç½®canal&#34;&gt;#&lt;/a&gt; å®‰è£…å’Œé…ç½® Canal&lt;/h1&gt;
&lt;p&gt;ä¸‹é¢æˆ‘ä»¬å°±å¼€å¯ mysql çš„ä¸»ä»åŒæ­¥æœºåˆ¶ï¼Œè®© Canal æ¥æ¨¡æ‹Ÿ salve&lt;/p&gt;
&lt;h1 id=&#34;1å¼€å¯mysqlä¸»ä»&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1å¼€å¯mysqlä¸»ä»&#34;&gt;#&lt;/a&gt; 1. å¼€å¯ MySQL ä¸»ä»&lt;/h1&gt;
&lt;p&gt;Canal æ˜¯åŸºäº MySQL çš„ä¸»ä»åŒæ­¥åŠŸèƒ½ï¼Œå› æ­¤å¿…é¡»å…ˆå¼€å¯ MySQL çš„ä¸»ä»åŠŸèƒ½æ‰å¯ä»¥ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œä»¥ä¹‹å‰ç”¨ Docker è¿è¡Œçš„ mysql ä¸ºä¾‹ï¼š&lt;/p&gt;
&lt;h2 id=&#34;11å¼€å¯binlog&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#11å¼€å¯binlog&#34;&gt;#&lt;/a&gt; 1.1. å¼€å¯ binlog&lt;/h2&gt;
&lt;p&gt;æ‰“å¼€ mysql å®¹å™¨æŒ‚è½½çš„æ—¥å¿—æ–‡ä»¶ï¼Œæˆ‘çš„åœ¨ &lt;code&gt;/tmp/mysql/conf&lt;/code&gt;  ç›®å½•:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310210931806.png&#34; alt=&#34;image-20210813153241537&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä¿®æ”¹æ–‡ä»¶ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight sh&#34;&gt;&lt;figcaption data-lang=&#34;sh&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token function&#34;&gt;vi&lt;/span&gt; /tmp/mysql/conf/my.cnf&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;æ·»åŠ å†…å®¹ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight ini&#34;&gt;&lt;figcaption data-lang=&#34;ini&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;log-bin&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;/var/lib/mysql/mysql-bin&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# æ•°æ®åº“åç§°&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;binlog-do-db&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;dkx&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;é…ç½®è§£è¯»ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;log-bin=/var/lib/mysql/mysql-bin&lt;/code&gt; ï¼šè®¾ç½® binary log æ–‡ä»¶çš„å­˜æ”¾åœ°å€å’Œæ–‡ä»¶åï¼Œå«åš mysql-bin&lt;/li&gt;
&lt;li&gt;&lt;code&gt;binlog-do-db=dkx&lt;/code&gt; ï¼šæŒ‡å®šå¯¹å“ªä¸ª database è®°å½• binary log eventsï¼Œè¿™é‡Œè®°å½• heima è¿™ä¸ªåº“&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æœ€ç»ˆæ•ˆæœï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight ini&#34;&gt;&lt;figcaption data-lang=&#34;ini&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token section&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token section-name selector&#34;&gt;mysqld&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;skip-name-resolve&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;character_set_server&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;utf8&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;datadir&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;/var/lib/mysql&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;server-id&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;1000&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;log-bin&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;/var/lib/mysql/mysql-bin&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key attr-name&#34;&gt;binlog-do-db&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token value attr-value&#34;&gt;dkx&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;é‡å¯ mysql&lt;/p&gt;
&lt;figure class=&#34;highlight sh&#34;&gt;&lt;figcaption data-lang=&#34;sh&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token function&#34;&gt;docker&lt;/span&gt; restart mysql&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;å¯ä»¥çœ‹åˆ°å¦‚ä¸‹å›¾ä¸­å‡ºç°äº†æŒ‡å®šæ–‡ä»¶è¡¨ç¤ºæˆåŠŸï¼&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310211007103.png&#34; alt=&#34;image-20231021100731994&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;12è®¾ç½®ç”¨æˆ·æƒé™&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#12è®¾ç½®ç”¨æˆ·æƒé™&#34;&gt;#&lt;/a&gt; 1.2. è®¾ç½®ç”¨æˆ·æƒé™&lt;/h2&gt;
&lt;p&gt;æ¥ä¸‹æ¥æ·»åŠ ä¸€ä¸ªä»…ç”¨äºæ•°æ®åŒæ­¥çš„è´¦æˆ·ï¼Œå‡ºäºå®‰å…¨è€ƒè™‘ï¼Œè¿™é‡Œä»…æä¾›å¯¹ heima è¿™ä¸ªåº“çš„æ“ä½œæƒé™ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-mysql&#34;&gt;create user canal@&#39;%&#39; IDENTIFIED by &#39;canal&#39;;
GRANT SELECT, REPLICATION SLAVE, REPLICATION CLIENT,SUPER ON *.* TO &#39;canal&#39;@&#39;%&#39; identified by &#39;canal&#39;;
FLUSH PRIVILEGES;
&lt;/code&gt;&lt;/pre&gt;
&lt;figure class=&#34;highlight sql&#34;&gt;&lt;figcaption data-lang=&#34;SQL&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;CREATE&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;USER&lt;/span&gt; canal IDENTIFIED &lt;span class=&#34;token keyword&#34;&gt;BY&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;canal&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;GRANT&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;SELECT&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;REPLICATION&lt;/span&gt; SLAVE&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;REPLICATION&lt;/span&gt; CLIENT &lt;span class=&#34;token keyword&#34;&gt;ON&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;TO&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;canal&#39;&lt;/span&gt;&lt;span class=&#34;token variable&#34;&gt;@&#39;%&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;GRANT&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;ALL&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;PRIVILEGES&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;ON&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;TO&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;canal&#39;&lt;/span&gt;&lt;span class=&#34;token variable&#34;&gt;@&#39;%&#39;&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;FLUSH &lt;span class=&#34;token keyword&#34;&gt;PRIVILEGES&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;mysql 8.0.2 å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight sql&#34;&gt;&lt;figcaption data-lang=&#34;SQL&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;CREATE&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;USER&lt;/span&gt; canal IDENTIFIED &lt;span class=&#34;token keyword&#34;&gt;BY&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;canal&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;GRANT&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;SELECT&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;SHOW&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;VIEW&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;REPLICATION&lt;/span&gt; SLAVE&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;REPLICATION&lt;/span&gt; CLIENT &lt;span class=&#34;token keyword&#34;&gt;ON&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;TO&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;canal&#39;&lt;/span&gt;&lt;span class=&#34;token variable&#34;&gt;@&#39;%&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;FLUSH &lt;span class=&#34;token keyword&#34;&gt;PRIVILEGES&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;é‡å¯ mysql å®¹å™¨å³å¯&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;docker restart mysql
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æµ‹è¯•è®¾ç½®æ˜¯å¦æˆåŠŸï¼šåœ¨ mysql æ§åˆ¶å°ï¼Œæˆ–è€… Navicat ä¸­ï¼Œè¾“å…¥å‘½ä»¤ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;show master status;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310211015054.png&#34; alt=&#34;image-20231021101552134&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;2å®‰è£…canal&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2å®‰è£…canal&#34;&gt;#&lt;/a&gt; 2. å®‰è£… Canal&lt;/h1&gt;
&lt;h2 id=&#34;21åˆ›å»ºç½‘ç»œ&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#21åˆ›å»ºç½‘ç»œ&#34;&gt;#&lt;/a&gt; 2.1. åˆ›å»ºç½‘ç»œ&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªç½‘ç»œï¼Œå°† MySQLã€Canalã€MQ æ”¾åˆ°åŒä¸€ä¸ª Docker ç½‘ç»œä¸­ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight sh&#34;&gt;&lt;figcaption data-lang=&#34;sh&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token function&#34;&gt;docker&lt;/span&gt; network create dkx&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;è®© mysql åŠ å…¥è¿™ä¸ªç½‘ç»œï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight sh&#34;&gt;&lt;figcaption data-lang=&#34;sh&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token function&#34;&gt;docker&lt;/span&gt; network connect dkx mysql&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h2 id=&#34;23å®‰è£…canal&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#23å®‰è£…canal&#34;&gt;#&lt;/a&gt; 2.3. å®‰è£… Canal&lt;/h2&gt;
&lt;p&gt;è¯¾å‰èµ„æ–™ä¸­æä¾›äº† canal çš„é•œåƒå‹ç¼©åŒ…:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310211145229.png&#34; alt=&#34;image-20210813161804292&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¤§å®¶å¯ä»¥ä¸Šä¼ åˆ°è™šæ‹Ÿæœºï¼Œç„¶åé€šè¿‡å‘½ä»¤å¯¼å…¥ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;docker load -i canal.tar
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç„¶åè¿è¡Œå‘½ä»¤åˆ›å»º Canal å®¹å™¨ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight sh&#34;&gt;&lt;figcaption data-lang=&#34;sh&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token function&#34;&gt;docker&lt;/span&gt; run &lt;span class=&#34;token parameter variable&#34;&gt;-p&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;11111&lt;/span&gt;:11111 &lt;span class=&#34;token parameter variable&#34;&gt;--name&lt;/span&gt; canal &lt;span class=&#34;token punctuation&#34;&gt;\&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token parameter variable&#34;&gt;-e&lt;/span&gt; &lt;span class=&#34;token assign-left variable&#34;&gt;canal.destinations&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;dkx1 &lt;span class=&#34;token punctuation&#34;&gt;\&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token parameter variable&#34;&gt;-e&lt;/span&gt; &lt;span class=&#34;token assign-left variable&#34;&gt;canal.instance.master.address&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;192.168&lt;/span&gt;.249.128:3306  &lt;span class=&#34;token punctuation&#34;&gt;\&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token parameter variable&#34;&gt;-e&lt;/span&gt; &lt;span class=&#34;token assign-left variable&#34;&gt;canal.instance.dbUsername&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;canal  &lt;span class=&#34;token punctuation&#34;&gt;\&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token parameter variable&#34;&gt;-e&lt;/span&gt; &lt;span class=&#34;token assign-left variable&#34;&gt;canal.instance.dbPassword&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;canal  &lt;span class=&#34;token punctuation&#34;&gt;\&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token parameter variable&#34;&gt;-e&lt;/span&gt; &lt;span class=&#34;token assign-left variable&#34;&gt;canal.instance.connectionCharset&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;UTF-8 &lt;span class=&#34;token punctuation&#34;&gt;\&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token parameter variable&#34;&gt;-e&lt;/span&gt; &lt;span class=&#34;token assign-left variable&#34;&gt;canal.instance.tsdb.enable&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;true &lt;span class=&#34;token punctuation&#34;&gt;\&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token parameter variable&#34;&gt;-e&lt;/span&gt; &lt;span class=&#34;token assign-left variable&#34;&gt;canal.instance.gtidon&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;false  &lt;span class=&#34;token punctuation&#34;&gt;\&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token parameter variable&#34;&gt;-e&lt;/span&gt; &lt;span class=&#34;token assign-left variable&#34;&gt;canal.instance.filter.regex&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;dkx&lt;span class=&#34;token punctuation&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;..&lt;/span&gt;* &lt;span class=&#34;token punctuation&#34;&gt;\&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token parameter variable&#34;&gt;--network&lt;/span&gt; dkx1 &lt;span class=&#34;token punctuation&#34;&gt;\&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token parameter variable&#34;&gt;-d&lt;/span&gt; canal/canal-server:v1.1.5&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;è¯´æ˜:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-p 11111:11111&lt;/code&gt; ï¼šè¿™æ˜¯ canal çš„é»˜è®¤ç›‘å¬ç«¯å£&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-e canal.instance.master.address=mysql:3306&lt;/code&gt; ï¼šæ•°æ®åº“åœ°å€ (åŒä¸€ç½‘ç»œå¯ä»¥ä½¿ç”¨å®¹å™¨åäº’è”) å’Œç«¯å£ï¼Œå¦‚æœä¸çŸ¥é“ mysql å®¹å™¨åœ°å€ï¼Œå¯ä»¥é€šè¿‡ &lt;code&gt;docker inspect å®¹å™¨id&lt;/code&gt;  æ¥æŸ¥çœ‹&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-e canal.instance.dbUsername=canal&lt;/code&gt; ï¼šæ•°æ®åº“ç”¨æˆ·å&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-e canal.instance.dbPassword=canal&lt;/code&gt;  ï¼šæ•°æ®åº“å¯†ç &lt;/li&gt;
&lt;li&gt;&lt;code&gt;-e canal.instance.filter.regex=&lt;/code&gt; ï¼šè¦ç›‘å¬çš„è¡¨åç§°&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¡¨åç§°ç›‘å¬æ”¯æŒçš„è¯­æ³•ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysql æ•°æ®è§£æå…³æ³¨çš„è¡¨ï¼ŒPerlæ­£åˆ™è¡¨è¾¾å¼.
å¤šä¸ªæ­£åˆ™ä¹‹é—´ä»¥é€—å·(,)åˆ†éš”ï¼Œè½¬ä¹‰ç¬¦éœ€è¦åŒæ–œæ (\\) 
å¸¸è§ä¾‹å­ï¼š
1.  æ‰€æœ‰è¡¨ï¼š.*   or  .*\\..*
2.  canal schemaä¸‹æ‰€æœ‰è¡¨ï¼š canal\\..*
3.  canalä¸‹çš„ä»¥canalæ‰“å¤´çš„è¡¨ï¼šcanal\\.canal.*
4.  canal schemaä¸‹çš„ä¸€å¼ è¡¨ï¼šcanal.test1
5.  å¤šä¸ªè§„åˆ™ç»„åˆä½¿ç”¨ç„¶åä»¥é€—å·éš”å¼€ï¼šcanal\\..*,mysql.test1,mysql.test2 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æŸ¥çœ‹å¯åŠ¨æ—¥å¿—ï¼ŒæŸ¥çœ‹æ˜¯å¦å¯åŠ¨æˆåŠŸäº†ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-shÂ·&#34;&gt;[root@localhost tmp]# docker logs -f canal
DOCKER_DEPLOY_TYPE=VM
==&amp;gt; INIT /alidata/init/02init-sshd.sh
==&amp;gt; EXIT CODE: 0
==&amp;gt; INIT /alidata/init/fix-hosts.py
==&amp;gt; EXIT CODE: 0
==&amp;gt; INIT DEFAULT
Generating SSH1 RSA host key: [  OK  ]
Starting sshd: [  OK  ]
Starting crond: [  OK  ]
==&amp;gt; INIT DONE
==&amp;gt; RUN /home/admin/app.sh
==&amp;gt; START ...
start canal ...
start canal successful
==&amp;gt; START SUCCESSFUL ...
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æŸ¥çœ‹ canal æ˜¯å¦ä¸ mysql è¿›è¡Œå»ºç«‹è¿æ¥äº†&lt;/p&gt;
&lt;p&gt;æ­¥éª¤ï¼š&lt;/p&gt;
&lt;p&gt;1ã€è¿›å…¥ canal å†…éƒ¨&lt;/p&gt;
&lt;figure class=&#34;highlight sh&#34;&gt;&lt;figcaption data-lang=&#34;sh&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;root@localhost tmp&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token comment&#34;&gt;# docker exec -it canal bash&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;root@a02803287608 admin&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token comment&#34;&gt;#&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;2ã€ä½¿ç”¨å‘½ä»¤ç›‘æ§ canal çš„æ—¥å¿—ä¿¡æ¯&lt;/p&gt;
&lt;figure class=&#34;highlight sh&#34;&gt;&lt;figcaption data-lang=&#34;sh&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;root@a02803287608 admin&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token comment&#34;&gt;# ll&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;total &lt;span class=&#34;token number&#34;&gt;8&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;-rwxr-xr-x. &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt; admin admin &lt;span class=&#34;token number&#34;&gt;3941&lt;/span&gt; Apr &lt;span class=&#34;token number&#34;&gt;19&lt;/span&gt;  &lt;span class=&#34;token number&#34;&gt;2021&lt;/span&gt; app.sh&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;drwxr-xr-x. &lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt; admin admin   &lt;span class=&#34;token number&#34;&gt;43&lt;/span&gt; Apr &lt;span class=&#34;token number&#34;&gt;19&lt;/span&gt;  &lt;span class=&#34;token number&#34;&gt;2021&lt;/span&gt; bin&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;drwxr-xr-x. &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt; admin admin   &lt;span class=&#34;token number&#34;&gt;66&lt;/span&gt; Apr &lt;span class=&#34;token number&#34;&gt;19&lt;/span&gt;  &lt;span class=&#34;token number&#34;&gt;2021&lt;/span&gt; canal-server&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;-rwxr-xr-x. &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt; admin admin  &lt;span class=&#34;token number&#34;&gt;670&lt;/span&gt; Apr &lt;span class=&#34;token number&#34;&gt;19&lt;/span&gt;  &lt;span class=&#34;token number&#34;&gt;2021&lt;/span&gt; health.sh&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;lrwxrwxrwx. &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt; admin admin   &lt;span class=&#34;token number&#34;&gt;44&lt;/span&gt; Apr &lt;span class=&#34;token number&#34;&gt;19&lt;/span&gt;  &lt;span class=&#34;token number&#34;&gt;2021&lt;/span&gt; node_exporter -&lt;span class=&#34;token operator&#34;&gt;&gt;&lt;/span&gt; /home/admin/node_exporter-0.18.1.linux-arm64&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;drwxr-xr-x. &lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt; admin admin   &lt;span class=&#34;token number&#34;&gt;56&lt;/span&gt; Jun  &lt;span class=&#34;token number&#34;&gt;5&lt;/span&gt;  &lt;span class=&#34;token number&#34;&gt;2019&lt;/span&gt; node_exporter-0.18.1.linux-arm64&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;root@a02803287608 admin&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token comment&#34;&gt;# tail -f canal-server/logs/canal/canal.log&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;æ‰“å°æ—¥å¿—å¦‚ä¸‹&lt;/p&gt;
&lt;figure class=&#34;highlight sh&#34;&gt;&lt;figcaption data-lang=&#34;sh&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;2023&lt;/span&gt;-10-21 &lt;span class=&#34;token number&#34;&gt;10&lt;/span&gt;:31:37.324 &lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;main&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; INFO  com.alibaba.otter.canal.deployer.CanalLauncher - &lt;span class=&#34;token comment&#34;&gt;## set default uncaught exception handler&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;2023&lt;/span&gt;-10-21 &lt;span class=&#34;token number&#34;&gt;10&lt;/span&gt;:31:37.376 &lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;main&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; INFO  com.alibaba.otter.canal.deployer.CanalLauncher - &lt;span class=&#34;token comment&#34;&gt;## load canal configurations&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;2023&lt;/span&gt;-10-21 &lt;span class=&#34;token number&#34;&gt;10&lt;/span&gt;:31:37.392 &lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;main&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; INFO  com.alibaba.otter.canal.deployer.CanalStarter - &lt;span class=&#34;token comment&#34;&gt;## start the canal server.&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;2023&lt;/span&gt;-10-21 &lt;span class=&#34;token number&#34;&gt;10&lt;/span&gt;:31:37.466 &lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;main&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; INFO  com.alibaba.otter.canal.deployer.CanalController - &lt;span class=&#34;token comment&#34;&gt;## start the canal server[172.22.0.3(172.22.0.3):11111]&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;2023&lt;/span&gt;-10-21 &lt;span class=&#34;token number&#34;&gt;10&lt;/span&gt;:31:39.126 &lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;main&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; INFO  com.alibaba.otter.canal.deployer.CanalStarter - &lt;span class=&#34;token comment&#34;&gt;## the canal server is running now ......&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;å¯ä»¥çœ‹åˆ°å¯åŠ¨æ²¡ä»€ä¹ˆé—®é¢˜&lt;/p&gt;
&lt;p&gt;æŸ¥çœ‹ mysql è¿æ¥çš„æ—¥å¿—&lt;/p&gt;
&lt;figure class=&#34;highlight sh&#34;&gt;&lt;figcaption data-lang=&#34;sh&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;root@a02803287608 admin&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token comment&#34;&gt;# tail -f canal-server/logs/dkx1/dkx1.log&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token function&#34;&gt;find&lt;/span&gt; start position successfully, EntryPosition&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;included&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;false,journalName&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;mysql-bin.000006,position&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;4&lt;/span&gt;,serverId&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1000&lt;/span&gt;,gtid&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;&amp;lt;&lt;/span&gt;null&lt;span class=&#34;token operator&#34;&gt;&gt;&lt;/span&gt;,timestamp&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1697857809000&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; cost &lt;span class=&#34;token builtin class-name&#34;&gt;:&lt;/span&gt; 521ms , the next step is binlog dump&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt; ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://pigpigletsgo.github.io/homepage/2024/04/02/computer-science/java/spring/springcloud/springcloud-%E9%AB%98%E7%BA%A7/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%AB%98%E7%BA%A7%E7%AF%87/</guid>
            <title>SpringCloudé«˜çº§ç¯‡</title>
            <link>https://pigpigletsgo.github.io/homepage/2024/04/02/computer-science/java/spring/springcloud/springcloud-%E9%AB%98%E7%BA%A7/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%AB%98%E7%BA%A7%E7%AF%87/</link>
            <category>è®¡ç®—æœºå­¦ç§‘</category>
            <category>springcloud</category>
            <pubDate>Tue, 02 Apr 2024 14:23:31 +0800</pubDate>
            <description><![CDATA[ &lt;h1 id=&#34;ä¸€-å¾®æœåŠ¡ä¿æŠ¤&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä¸€-å¾®æœåŠ¡ä¿æŠ¤&#34;&gt;#&lt;/a&gt; ä¸€ã€å¾®æœåŠ¡ä¿æŠ¤ğŸ„&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Sentinel&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å­¦ä¹ å†…å®¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åˆå§‹ Sentinel&lt;/li&gt;
&lt;li&gt;æµé‡æ§åˆ¶&lt;/li&gt;
&lt;li&gt;éš”ç¦»å’Œé™çº§&lt;/li&gt;
&lt;li&gt;æˆæƒè§„åˆ™&lt;/li&gt;
&lt;li&gt;è§„åˆ™æŒä¹…åŒ–&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;11-åˆå§‹sentinel&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#11-åˆå§‹sentinel&#34;&gt;#&lt;/a&gt; 1.1ã€åˆå§‹ SentinelğŸŒ³&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;é›ªå´©é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ&lt;/li&gt;
&lt;li&gt;æœåŠ¡ä¿æŠ¤æŠ€æœ¯å¯¹æ¯”&lt;/li&gt;
&lt;li&gt;Sentinel ä»‹ç»å’Œå®‰è£…&lt;/li&gt;
&lt;li&gt;å¾®æœåŠ¡æ•´åˆ Sentinel&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;111-é›ªå´©é—®é¢˜&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#111-é›ªå´©é—®é¢˜&#34;&gt;#&lt;/a&gt; 1.1.1ã€é›ªå´©é—®é¢˜ğŸŒ²&lt;/h3&gt;
&lt;p&gt;å¾®æœåŠ¡è°ƒç”¨é“¾è·¯ä¸­çš„æŸä¸ªæœåŠ¡æ•…éšœï¼Œå¼•èµ·æ•´ä¸ªé“¾è·¯ä¸­çš„æ‰€æœ‰å¾®æœåŠ¡éƒ½ä¸å¯ç”¨ï¼Œè¿™å°±æ˜¯é›ªå´©ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;æ¯”æ–¹è¯´åœ¨æœåŠ¡ A å†…éƒ¨ä¾èµ–äºæœåŠ¡ Bï¼Œè€ŒæœåŠ¡ A å†…éƒ¨å¯èƒ½è¿˜æœ‰ä¸€äº›å…¶å®ƒçš„ä¸šåŠ¡æ¯”å¦‚è¯´å®ƒä¾èµ–äºæœåŠ¡ C æˆ–è€…æ˜¯ä¾èµ–äºæœåŠ¡ D&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310161531964.png&#34; alt=&#34;image-20231016153100257&#34;&gt;&lt;/p&gt;
&lt;p&gt;ç°åœ¨å‡è®¾è¯´æœåŠ¡ D å‡ºç°äº†æ•…éšœï¼Œé‚£æœåŠ¡ A å†…éƒ¨ä¾èµ–ä¸æœåŠ¡ D çš„ä¸šåŠ¡è¯·æ±‚å°±ä¸èƒ½æ­£å¸¸è®¿é—®äº†&lt;/p&gt;
&lt;p&gt;å› ä¸ºæœåŠ¡ A è®¿é—®æœåŠ¡ D å°±å¿…ç„¶è¦ç­‰å¾…æœåŠ¡ D çš„å“åº”ç»“æœï¼Œè€Œå› ä¸ºæœåŠ¡ D å‡ºç°äº†æ•…éšœä¸å¯èƒ½è¿”å›ç»“æœå®ƒä¼šé˜»å¡ï¼Œé‚£å°±å¯¼è‡´äº†æœåŠ¡ A å†…éƒ¨ä¸šåŠ¡ä¹Ÿä¼šé˜»å¡ï¼Œé˜»å¡ å®ƒå°±ä¸ä¼šé‡Šæ”¾ tomcat çš„é“¾æ¥ã€‚å½“ç„¶å…¶å®ƒä¸šåŠ¡è¯·æ±‚ä¸å—å½±å“è¿˜å¯ä»¥æ­£å¸¸å·¥ä½œã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310161532119.png&#34; alt=&#34;image-20231016153207881&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯æ—¢ç„¶æœ‰ç¬¬ä¸€ä¸ªä¾èµ–äºæœåŠ¡ D è¿™æ ·çš„è¯·æ±‚ï¼Œé‚£ä¸€å®šè¿˜ä¼šæœ‰ç¬¬äºŒä¸ªç”šè‡³ç¬¬ä¸‰ä¸ªã€‚è¿™æ ·ä¾èµ–äºæœåŠ¡ D çš„ä¸šåŠ¡è¯·æ±‚è¶Šæ¥è¶Šå¤šï¼Œè€Œå®ƒä»¬éƒ½ä¸ä¼šé‡Šæ”¾è¿æ¥ï¼Œé‚£ä¹ˆæ—¶ä¹…ä¸€å®šä¼šæŠŠæœåŠ¡ A å†…éƒ¨æ‰€æœ‰çš„é“¾æ¥éƒ½ç»™å ç”¨äº†&lt;/p&gt;
&lt;p&gt;ä¹Ÿå°±æ˜¯è¯´ tomcat èµ„æºè€—å°½äº†&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310161537530.png&#34; alt=&#34;image-20231016153714784&#34;&gt;&lt;/p&gt;
&lt;p&gt;æ­¤æ—¶å†æœ‰æœåŠ¡è¿›æ¥å“ªæ€•ä¸æ˜¯ä¾èµ–äºæœåŠ¡ D çš„è€Œæ˜¯æœåŠ¡ B çš„ï¼Œæ˜¯ä¸æ˜¯ä¹Ÿè¿›ä¸æ¥äº†ã€‚é‚£å°±å¯ä»¥è®¤ä¸ºæœåŠ¡ A ä¹Ÿå‡ºç°äº†æ•…éšœ&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310161539417.png&#34; alt=&#34;image-20231016153923278&#34;&gt;&lt;/p&gt;
&lt;p&gt;è¿™å°±é€ æˆäº†ä¸€ä¸ªæœåŠ¡çš„æ•…éšœå¯¼è‡´äº†ä¾èµ–äºå®ƒçš„æœåŠ¡æœ€ç»ˆä¹Ÿå‡ºç°äº†æ•…éšœã€‚åœ¨å¾®æœåŠ¡é‡Œè¿™ç§è°ƒç”¨å…³ç³»å¯ä¸æ­¢è¿™ä¹ˆç®€å•&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆæœåŠ¡ A ä¾èµ–äºæœåŠ¡ D å¯¼è‡´æœ€åç»™æœåŠ¡ D æ‹–å®äº†ï¼Œé‚£è‚¯å®šè¿˜ä¼šæœ‰å…¶å®ƒçš„æœåŠ¡ä¹Ÿä¾èµ–äºæœåŠ¡ Dï¼Œæœ€ç»ˆä¹Ÿä¼šè¢«æ‹–å®ï¼Œå°†æ¥å…¶å®ƒä¾èµ–äºæœåŠ¡ A çš„ä¹Ÿä¼šå‡ºç°æ•…éšœï¼Œæœ€ç»ˆæ•…éšœçš„æœåŠ¡è¶Šæ¥è¶Šå¤šé‚£ä¹ˆæ•´ä¸ªå¾®æœåŠ¡ç¾¤å°±ä¸å¯ç”¨äº†ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸å°±æ˜¯é›ªå´©äº†å—ï¼&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310161541181.png&#34; alt=&#34;image-20231016154142767&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;112-è§£å†³é›ªå´©é—®é¢˜&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#112-è§£å†³é›ªå´©é—®é¢˜&#34;&gt;#&lt;/a&gt; 1.1.2ã€è§£å†³é›ªå´©é—®é¢˜ğŸŒ²&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;è§£å†³é›ªå´©é—®é¢˜çš„å¸¸è§æ–¹å¼æœ‰å››ç§&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;1ã€&lt;mark&gt;è¶…æ—¶å¤„ç†&lt;/mark&gt;ï¼šè®¾å®šè¶…æ—¶æ—¶é—´ï¼Œè¯·æ±‚è¶…è¿‡ä¸€å®šæ—¶é—´æ²¡æœ‰å“åº”ç»“æœå°±è¿”å›é”™è¯¯ä¿¡æ¯ï¼Œä¸ä¼šæ— ä¼‘æ­¢ç­‰å¾…&lt;/p&gt;
&lt;p&gt;ä¼šåœ¨è°ƒç”¨ä¸šåŠ¡æ—¶åŠ ä¸Šä¸€ä¸ªè¶…æ—¶æ—¶é—´æ¯”å¦‚è¯´ 1 ç§’é’Ÿï¼Œå½“æœåŠ¡ A ä¾èµ–äºæœåŠ¡ C æ—¶è¯·æ±‚æœ€å¤šç­‰å¾… 1 ç§’é’Ÿï¼Œå¦‚æœè¯·æ±‚è¶…è¿‡ 1 ç§’é’Ÿå°±ä¼šç«‹å³ç»“æŸè¿™ä¸ªè¯·æ±‚ï¼Œä¸å†ç­‰å¾…ï¼Œè¿”å›ç»™ç”¨æˆ·æç¤ºä¿¡æ¯ (ä¸å¥½æ„æ€å¤±è´¥äº†)&lt;/p&gt;
&lt;p&gt;ç¼ºç‚¹ï¼šåªèƒ½èµ·åˆ°ç¼“è§£ä½œç”¨ï¼Œä¸èƒ½è§£å†³æ ¹æœ¬é—®é¢˜ï¼Œå› ä¸ºè¯·æ±‚é€Ÿåº¦å¤§äºç­‰å¾…æ—¶é—´å°±ä¼šå‡ºç°é—®é¢˜&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310161546216.png&#34; alt=&#34;image-20231016154632246&#34;&gt;&lt;/p&gt;
&lt;p&gt;2ã€&lt;mark&gt;èˆ±å£æ¨¡å¼&lt;/mark&gt;ï¼šé™å®šæ¯ä¸ªä¸šåŠ¡èƒ½ä½¿ç”¨çš„çº¿ç¨‹æ•°ï¼Œé¿å…è€—å°½æ•´ä¸ª tomcat çš„èµ„æºï¼Œå› æ­¤ä¹Ÿå«çº¿ç¨‹éš”ç¦»ã€‚&lt;/p&gt;
&lt;p&gt;èˆ±å£æ¨¡å¼æ˜¯æ¥è‡ªäºç°å®ç”Ÿæ´»ä¸­çš„èˆ¹èˆ±çš„è®¾è®¡ï¼Œä¸€äº›å¤§å‹çš„è½®èˆ¹å®ƒéƒ½ä¼šæŠŠèˆ¹ä½“åˆ©ç”¨éš”æ¿åˆ†éš”æˆç‹¬ç«‹çš„å°çš„ç©ºé—´è¿™æ ·çš„éš”æ¿å°±å«åšèˆ±å£ã€‚å› ä¸ºè¿™äº›ç©ºé—´ä¹‹é—´æ˜¯ç›¸äº’éš”ç¦»çš„ï¼Œå‡è®¾è¯´èˆ¹ä½“çš„æŸä¸ªéƒ¨ä½æ’ä¸Šäº†å†°å±±æ¼æ°´äº†ã€‚é‚£ä¹ˆæœ€å¤šåªæ˜¯æŠŠéƒ¨åˆ†èˆ¹èˆ±å¡«æ»¡æ°´ï¼Œå› ä¸ºæ˜¯éš”ç¦»çš„æ‰€ä»¥å…¶å®ƒèˆ¹èˆ±ä¸å—å½±å“ã€‚è¿™æ ·å°±æé«˜äº†æ•´è‰˜èˆ¹çš„å®¹ç¾èƒ½åŠ›&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310161550959.png&#34; alt=&#34;image-20231016155024959&#34;&gt;&lt;/p&gt;
&lt;p&gt;è¿™ç§æ¨¡å¼å»¶ç»­åˆ°ç¨‹åºè®¾è®¡é‡Œè¾¹æ˜¯æ€ä¹ˆåšçš„å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯æœåŠ¡ A é‡Œé¢çš„èµ„æºä¹Ÿå°±æ˜¯ tomcat å°±å¯ä»¥çœ‹åšæˆæ•´è‰˜èˆ¹ã€‚æˆ‘ä»¬å¯ä»¥æŠŠ tomcat é‡Œé¢çš„èµ„æº (çº¿ç¨‹) åˆ’åˆ†æˆä¸€ä¸ªä¸€ä¸ªç‹¬ç«‹çš„çº¿ç¨‹æ± ã€‚ç»™æ¯ä¸ªä¸šåŠ¡åˆ†é…ä¸€ä¸ªçº¿ç¨‹æ± ã€‚ç°åœ¨ä¸šåŠ¡ 1 è¿›æ¥åå®ƒä¾èµ–äºæœåŠ¡ Bï¼Œå®ƒæœ€å¤šä½¿ç”¨åä¸ªé™åˆ¶ï¼Œè®¿é—®ä¸šåŠ¡ 2 æ¯”æ–¹è¯´å®ƒä¾èµ–äºæœåŠ¡ Cï¼Œå®ƒä¹Ÿæœ€å¤šä½¿ç”¨åçº¿ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨å‡è®¾è¯´æœåŠ¡ C å‡ºç°æ•…éšœäº†ï¼Œè¿™ä¸ªä¸šåŠ¡ 2 å°±ä¼šé˜»å¡å ç”¨çº¿ç¨‹ï¼Œä½†æ˜¯å®ƒæœ€å¤šå ç”¨åä¸ªï¼Œè¿™æ—¶å®ƒèƒ½å¤Ÿä½¿ç”¨ tomcat çš„èµ„æºæ˜¯æœ‰é™çš„ï¼Œè¿™æ ·å°±æŠŠæ•…éšœéš”ç¦»åˆ°åä¸ªçº¿ç¨‹å†…äº†ï¼Œå› æ­¤ä¹Ÿå«çº¿ç¨‹éš”ç¦»ã€‚å› æ­¤å°±é¿å…äº†æ•´ä¸ª tomcat è¢«è€—å°½çš„æƒ…å†µ&lt;/p&gt;
&lt;p&gt;ç¼ºç‚¹ï¼šèµ„æºæœ‰ä¸€å®šçš„æµªè´¹ï¼Œæ¯”å¦‚è¯´æœåŠ¡ C çœŸçš„å®•æœºäº†ï¼Œç°åœ¨æ¯æ¬¡è¯·æ±‚æ¥è¿˜è®©å®ƒå°è¯•ç€å»è®¿é—®ä¸€ä¸‹æœåŠ¡ C è¿˜è¦å ç”¨åä¸ªçº¿ç¨‹ä¹Ÿæ˜¯ä¸€ç§æµªè´¹&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310161558553.png&#34; alt=&#34;image-20231016155848381&#34;&gt;&lt;/p&gt;
&lt;p&gt;3ã€&lt;mark&gt;ç†”æ–­é™çº§&lt;/mark&gt;ï¼šç”±&lt;mark&gt;æ–­è·¯å™¨&lt;/mark&gt;ç»Ÿè®¡ä¸šåŠ¡æ‰§è¡Œçš„å¼‚å¸¸æ¯”ä¾‹ï¼Œå¦‚æœè¶…å‡ºé˜ˆå€¼åˆ™ä¼š&lt;mark&gt;ç†”æ–­&lt;/mark&gt;è¯¥ä¸šåŠ¡ï¼Œæ‹¦æˆªè®¿é—®è¯¥ä¸šåŠ¡çš„ä¸€åˆ‡è¯·æ±‚ã€‚&lt;/p&gt;
&lt;p&gt;ç»Ÿè®¡æœåŠ¡ A é‡Œé¢çš„ä¸šåŠ¡ï¼Œæ¯”æ–¹è¯´æœåŠ¡ A é‡Œç¬¬ä¸€æ¬¡ä¸šåŠ¡è®¿é—®æ˜¯æ­£å¸¸çš„ï¼Œç»“æœåé¢ä¸¤æ¬¡éƒ½å‡ºç°äº†æ•…éšœã€‚è¿™æ—¶æ–­è·¯å™¨å°±ä¼šç»Ÿè®¡æ¯”ä¾‹ï¼Œä¸‰ä¸ªè¯·æ±‚ä¸€ä¸ªæ­£å¸¸ä¸¤ä¸ªæ•…éšœï¼Œæ•…éšœæ¯”ä¾‹é«˜è¾¾ 60%ã€‚å‡è®¾è¯´é˜ˆå€¼æ˜¯ 50% è¶…å‡ºäº†é˜ˆå€¼ï¼Œæ­¤æ—¶å°±ä¼šå‡ºç°ç†”æ–­ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€æ—¦è¢«ç†”æ–­å¦‚æœåœ¨æœåŠ¡ A å†…éƒ¨è¿˜æƒ³è¦è®¿é—®æœåŠ¡ D çš„ä¸šåŠ¡å°±æ— æ³•å†å»è®¿é—®æœåŠ¡ D äº†ï¼Œåªè¦æ˜¯è®¿é—®æœåŠ¡ D çš„ä¸šåŠ¡å°±ä¼šè¢«æ‹¦æˆª&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310161606208.png&#34; alt=&#34;image-20231016160627109&#34;&gt;&lt;/p&gt;
&lt;p&gt;4ã€&lt;mark&gt;æµé‡æ§åˆ¶&lt;/mark&gt;ï¼šé™åˆ¶ä¸šåŠ¡è®¿é—® QPSï¼Œé¿å…æœåŠ¡å› æµé‡çš„çªå¢è€Œæ•…éšœã€‚&lt;/p&gt;
&lt;p&gt;QPSï¼šæ¯ç§’é’Ÿå¤„ç†çš„è¯·æ±‚æ•°é‡&lt;/p&gt;
&lt;p&gt;æ¯”æ–¹è¯´æœ‰ä¸€ä¸ªå¾®æœåŠ¡ï¼Œå®ƒèƒ½æ‰¿å—çš„æœ€å¤§ QPS ä¸º 2ï¼Œä¹Ÿå°±æ˜¯æ¯ç§’é’Ÿæœ€å¤šå¤„ç†ä¸¤ä¸ªè¯·æ±‚ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ç°åœ¨æœ‰æ— æ•°ä¸ªè¯·æ±‚æ¶Œè¿‡æ¥ï¼Œå°±ä¼šå‡ºç°æ•…éšœï¼Œä¸€æ—¦è¿™ä¸ªæœåŠ¡å‡ºç°æ•…éšœï¼Œè€Œä¾èµ–äºè¿™ä¸ªæœåŠ¡çš„å…¶å®ƒæœåŠ¡ä¹Ÿå°±è·Ÿç€å‡ºç°æ•…éšœå°±ä¼šå‡ºç°é›ªå´©é—®é¢˜&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬è¦é¿å…æœåŠ¡å› ä¸ºæµé‡è¿‡é«˜è€Œå¼•èµ·æ•…éšœï¼Œè¿™æ—¶å°±éœ€è¦ç”¨åˆ° Sentinel äº†&lt;/p&gt;
&lt;p&gt;ç°åœ¨å‡è®¾è¯´æœ‰æ— æ•°ä¸ªè¯·æ±‚è¿‡æ¥è€Œ Sentinel å¯ä»¥æŒ‰ç…§è¿™ä¸ªæœåŠ¡æ‰€èƒ½å¤Ÿæ‰¿å—çš„é¢‘ç‡å»é‡Šæ”¾è¯·æ±‚ï¼Œè¿™æ—¶å¾®æœåŠ¡å°±èƒ½ä»å®¹åº”å¯¹è¿™äº›è¯·æ±‚äº†å°±é¿å…äº†å‡ºç°æ•…éšœ&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310161613445.png&#34; alt=&#34;image-20231016161314587&#34;&gt;&lt;/p&gt;
&lt;p&gt;æµé‡æ§åˆ¶æ˜¯é¢„é˜²é›ªå´©ï¼Œå‰é¢ä¸‰ç§æ˜¯å·²ç»æœ‰æœåŠ¡æ•…éšœäº†æˆ‘æ€ä¹ˆæ ·å»é¿å…è¿™ä¸ªæ•…éšœä¼ é€’ç»™å…¶å®ƒæœåŠ¡&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ä¹Ÿä¸èƒ½è¯´ï¼Œé‚£æˆ‘å°±åªç”¨ æµé‡æ§åˆ¶å‘—ï¼Œå…¶å®ƒçš„æˆ‘å°±ä¸ç”¨äº†ï¼Œè¿™æ ·æ˜¾ç„¶æ˜¯ä¸å¯¹çš„ã€‚&lt;/p&gt;
&lt;p&gt;å› ä¸ºé«˜å¹¶å‘å¼•èµ·çš„æœåŠ¡æ•…éšœåªæ˜¯æ•…éšœçš„åŸå› ä¹‹ä¸€ï¼Œå¾€å¾€æœåŠ¡è¿˜ä¼šå› ä¸ºå…¶å®ƒé—®é¢˜è€Œå‡ºç°æ•…éšœã€‚æ¯”æ–¹è¯´ç½‘ç»œé—®é¢˜æˆ–è€…è¯´ fgc å¼•èµ·çš„å‡æ­»é—®é¢˜ï¼Œè¿™æ—¶æˆ‘ä»¬å°±éœ€è¦ç”¨åˆ°å…¶å®ƒçš„è§£å†³æ–¹æ¡ˆäº†&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;æ€»ç»“&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;ä»€ä¹ˆæ˜¯é›ªå´©é—®é¢˜ï¼Ÿ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¾®æœåŠ¡ä¹‹é—´ç›¸äº’è°ƒç”¨ï¼Œå› ä¸ºè°ƒç”¨é“¾ä¸­ä¸€ä¸ªæœåŠ¡æ•…éšœï¼Œå¼•èµ·æ•´ä¸ªé“¾è·¯éƒ½æ— æ³•è®¿é—®çš„æƒ…å†µ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¦‚ä½•é¿å…å› ç¬é—´é«˜å¹¶å‘æµé‡è€Œå¯¼è‡´æœåŠ¡æ•…éšœï¼Ÿ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æµé‡æ§åˆ¶&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¦‚ä½•é¿å…å› æœåŠ¡æ•…éšœå¼•èµ·çš„é›ªå´©é—®é¢˜ï¼Ÿ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è¶…æ—¶å¤„ç†&lt;/li&gt;
&lt;li&gt;çº¿ç¨‹éš”ç¦»&lt;/li&gt;
&lt;li&gt;é™çº§ç†”æ–­&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;113-æœåŠ¡ä¿æŠ¤æŠ€æœ¯å¯¹æ¯”&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#113-æœåŠ¡ä¿æŠ¤æŠ€æœ¯å¯¹æ¯”&#34;&gt;#&lt;/a&gt; 1.1.3ã€æœåŠ¡ä¿æŠ¤æŠ€æœ¯å¯¹æ¯”ğŸŒ²&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;Sentinel&lt;/th&gt;
&lt;th&gt;Hystrix&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;éš”ç¦»ç­–ç•¥&lt;/td&gt;
&lt;td&gt;ä¿¡å·é‡éš”ç¦»&lt;/td&gt;
&lt;td&gt;çº¿ç¨‹æ± éš”ç¦» / ä¿¡å·é‡éš”ç¦»&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ç†”æ–­é™çº§ç­–ç•¥&lt;/td&gt;
&lt;td&gt;åŸºäºæ…¢è°ƒç”¨æ¯”ä¾‹æˆ–å¼‚å¸¸æ¯”ä¾‹&lt;/td&gt;
&lt;td&gt;åŸºäºå¤±è´¥æ¯”ä¾‹&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å®æ—¶æŒ‡æ ‡å®ç°&lt;/td&gt;
&lt;td&gt;æ»‘åŠ¨çª—å£&lt;/td&gt;
&lt;td&gt;æ»‘åŠ¨çª—å£ (åŸºäº RxJava)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;è§„åˆ™é…ç½®&lt;/td&gt;
&lt;td&gt;æ”¯æŒå¤šç§æ•°æ®æº&lt;/td&gt;
&lt;td&gt;æ”¯æŒå¤šç§æ•°æ®æº&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æ‰©å±•æ€§&lt;/td&gt;
&lt;td&gt;å¤šä¸ªæ‰©å±•ç‚¹&lt;/td&gt;
&lt;td&gt;æ’ä»¶çš„å½¢å¼&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;åŸºäºæ³¨è§£çš„æ”¯æŒ&lt;/td&gt;
&lt;td&gt;æ”¯æŒ&lt;/td&gt;
&lt;td&gt;æ”¯æŒ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;é™æµ&lt;/td&gt;
&lt;td&gt;åŸºäº QPSï¼Œæ”¯æŒåŸºäºè°ƒç”¨å…³ç³»çš„é™æµ&lt;/td&gt;
&lt;td&gt;æœ‰é™çš„æ”¯æŒ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æµé‡æ•´å½¢&lt;/td&gt;
&lt;td&gt;æ”¯æŒæ…¢å¯åŠ¨ï¼ŒåŒ€é€Ÿæ’é˜Ÿæ¨¡å¼&lt;/td&gt;
&lt;td&gt;ä¸æ”¯æŒ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ç³»ç»Ÿè‡ªé€‚åº”ä¿æŠ¤&lt;/td&gt;
&lt;td&gt;æ”¯æŒ&lt;/td&gt;
&lt;td&gt;ä¸æ”¯æŒ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æ§åˆ¶å°&lt;/td&gt;
&lt;td&gt;å¼€ç®±å³ç”¨ï¼Œå¯é…ç½®è§„åˆ™ï¼ŒæŸ¥çœ‹ç§’çº§ç›‘æ§ï¼Œæœºå™¨å‘ç°ç­‰&lt;/td&gt;
&lt;td&gt;ä¸å®Œå–„&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å¸¸è§æ¡†æ¶çš„é€‚é…&lt;/td&gt;
&lt;td&gt;Servletï¼ŒSpring Cloudï¼ŒDubboï¼ŒgRPC ç­‰&lt;/td&gt;
&lt;td&gt;Servletï¼ŒSpring Cloud Netflix&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;12-è®¤è¯†sentinel&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#12-è®¤è¯†sentinel&#34;&gt;#&lt;/a&gt; 1.2ã€è®¤è¯† SentinelğŸŒ³&lt;/h2&gt;
&lt;p&gt;Sentinel æ˜¯é˜¿é‡Œå·´å·´å¼€æºçš„ä¸€æ¬¾å¾®æœåŠ¡æµé‡æ§åˆ¶ç»„ä»¶ã€‚å®˜ç½‘åœ°å€ï¼š&lt;a href=&#34;https://sentinelguard.io/zh-cn/&#34;&gt;https://sentinelguard.io/zh-cn/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Sentinel å…·æœ‰ä»¥ä¸‹ç‰¹å¾&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;1ã€&lt;mark&gt;ä¸°å¯Œçš„åº”ç”¨åœºæ™¯&lt;/mark&gt;ï¼šSentinel æ‰¿æ¥äº†é˜¿é‡Œå·´å·´è¿› 10 å¹´çš„åŒåä¸€å¤§ä¿ƒæµé‡çš„æ ¸å¿ƒåœºæ™¯ï¼Œä¾‹å¦‚ç§’æ€ (å³çªå‘æµé‡æ§åˆ¶åœ¨ç³»ç»Ÿå®¹é‡å¯ä»¥æ‰¿å—çš„èŒƒå›´)ï¼Œæ¶ˆæ¯å‰Šå³°æ·»è°·ï¼Œé›†ç¾¤æµé‡æ§åˆ¶ï¼Œå®æ—¶ç†”æ–­ä¸‹æ¸¸ä¸å¯ç”¨åº”ç”¨ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;2ã€&lt;mark&gt;å®Œå¤‡çš„å®æ—¶ç›‘æ§&lt;/mark&gt;ï¼šSentinel åŒæ—¶æä¾›å®æ—¶çš„ç›‘æ§åŠŸèƒ½ã€‚æ‚¨å¯ä»¥åœ¨æ§åˆ¶å°ä¸­çœ‹åˆ°æ¥å…¥åº”ç”¨çš„å•å°é›†ç¾¤ç§’çº§æ•°æ®ï¼Œç”šè‡³ 500 å°ä»¥ä¸‹è§„æ¨¡çš„é›†ç¾¤çš„æ±‡æ€»è¿è¡Œæƒ…å†µ&lt;/p&gt;
&lt;p&gt;3ã€&lt;mark&gt;å¹¿æ³›çš„å¼€æºç”Ÿæ€&lt;/mark&gt;ï¼šSentinel æä¾›å¼€ç®±å³ç”¨çš„ä¸å…¶å®ƒå¼€æºæ¡†æ¶ / åº“çš„æ•´åˆæ¨¡å—ï¼Œä¾‹å¦‚ä¸ Spring cloudï¼ŒDubboï¼ŒgRPC çš„æ•´åˆã€‚æ‚¨åªéœ€è¦å¼•å…¥ç›¸åº”çš„ä¾èµ–å¹¶è¿è¡Œç®€å•çš„é…ç½®å³å¯å¿«é€Ÿçš„æ¥å…¥ Sentinel&lt;/p&gt;
&lt;p&gt;4ã€&lt;mark&gt;å®Œå–„çš„ SPI æ‰©å±•ç‚¹&lt;/mark&gt;ï¼šSentinel æä¾›ç®€å•æ˜“ç”¨ï¼Œå®Œå–„çš„ SPI æ‰©å±•æ¥å£ã€‚æ‚¨å¯ä»¥é€šè¿‡å®ç°æ‰©å±•æ¥å£æ¥å¿«é€Ÿçš„å®šåˆ¶é€»è¾‘ã€‚ä¾‹å¦‚å®šåˆ¶è§„åˆ™ç®¡ç†ï¼Œé€‚é…åŠ¨æ€æ•°æ®æºç­‰ã€‚&lt;/p&gt;
&lt;h3 id=&#34;121-å®‰è£…sentinelæ§åˆ¶å°&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#121-å®‰è£…sentinelæ§åˆ¶å°&#34;&gt;#&lt;/a&gt; 1.2.1ã€å®‰è£… Sentinel æ§åˆ¶å°ğŸŒ²&lt;/h3&gt;
&lt;p&gt;sentinel å®˜æ–¹æä¾›äº† UI æ§åˆ¶å°ï¼Œæ–¹ä¾¿æˆ‘ä»¬å¯¹ç³»ç»Ÿåšé™æµè®¾ç½®ã€‚å¤§å®¶å¯ä»¥åœ¨&lt;a href=&#34;https://github.com/alibaba/Sentinel&#34;&gt; Github&lt;/a&gt; ä¸‹è½½ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310161747500.png&#34; alt=&#34;image-20231016174714403&#34;&gt;&lt;/p&gt;
&lt;p&gt;1ã€å°†å…¶æ‹·è´åˆ°ä¸€ä¸ªéä¸­æ–‡ç›®å½•ï¼Œç„¶åè¿è¡Œå‘½ä»¤&lt;/p&gt;
&lt;figure class=&#34;highlight sh&#34;&gt;&lt;figcaption data-lang=&#34;sh&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token function&#34;&gt;java&lt;/span&gt; &lt;span class=&#34;token parameter variable&#34;&gt;-jar&lt;/span&gt; sentinel-dashboard-1.8.6.jar&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;2ã€ç„¶åè®¿é—®ï¼šlocalhost:8080 å³å¯çœ‹åˆ°æ§åˆ¶å°é¡µé¢ï¼Œé»˜è®¤çš„è´¦å·å’Œå¯†ç éƒ½æ˜¯ sentinel&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310161747766.png&#34; alt=&#34;image-20231016174746831&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;13-å®‰è£…sentinelæ§åˆ¶å°&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#13-å®‰è£…sentinelæ§åˆ¶å°&#34;&gt;#&lt;/a&gt; 1.3ã€å®‰è£… Sentinel æ§åˆ¶å°ğŸŒ³&lt;/h2&gt;
&lt;p&gt;å¦‚æœè¦ä¿®æ”¹ Sentinel çš„é»˜è®¤ç«¯å£ï¼Œè´¦å·ï¼Œå¯†ç ï¼Œå¯ä»¥é€šè¿‡ä¸‹åˆ—é…ç½®ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;é…ç½®é¡¹&lt;/th&gt;
&lt;th&gt;é»˜è®¤å€¼&lt;/th&gt;
&lt;th&gt;è¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;server.port&lt;/td&gt;
&lt;td&gt;8080&lt;/td&gt;
&lt;td&gt;æœåŠ¡ç«¯å£&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;sentinel.dashboard.auth.username&lt;/td&gt;
&lt;td&gt;sentinel&lt;/td&gt;
&lt;td&gt;é»˜è®¤ç”¨æˆ·å&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;sentinel.dashboard.auth.password&lt;/td&gt;
&lt;td&gt;sentinel&lt;/td&gt;
&lt;td&gt;é»˜è®¤å¯†ç &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;ä½†æ˜¯å®ƒå·²ç»æ˜¯ä¸€ä¸ª jar åŒ…äº†æ€ä¹ˆæ”¹å®ƒçš„é…ç½®æ–‡ä»¶å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ä¿®æ”¹é…ç½®æ–¹å¼ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸¾ä¾‹è¯´æ˜ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight sh&#34;&gt;&lt;figcaption data-lang=&#34;sh&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;sentinel-dashboard-1.8.6.jar &lt;span class=&#34;token parameter variable&#34;&gt;-Dserver.port&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;8090&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/blockquote&gt;
&lt;h2 id=&#34;14-å¾®æœåŠ¡ä¸sentinelæ•´åˆ&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#14-å¾®æœåŠ¡ä¸sentinelæ•´åˆ&#34;&gt;#&lt;/a&gt; 1.4ã€å¾®æœåŠ¡ä¸ Sentinel æ•´åˆğŸŒ³&lt;/h2&gt;
&lt;h3 id=&#34;141-å¼•å…¥cloud-demo&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#141-å¼•å…¥cloud-demo&#34;&gt;#&lt;/a&gt; 1.4.1ã€å¼•å…¥ cloud-demoğŸŒ²&lt;/h3&gt;
&lt;p&gt;è¦ä½¿ç”¨ Sentinel è‚¯å®šè¦ç»“åˆå¾®æœåŠ¡ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ SpringCloud å·¥ç¨‹ï¼Œé¡¹ç›®åœ°å€ï¼š&lt;a href=&#34;https://gitee.com/doukaixin/typora.git&#34;&gt;https://gitee.com/doukaixin/typora.git&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310161754232.png&#34; alt=&#34;image-20231016175423216&#34;&gt;&lt;/p&gt;
&lt;p&gt;é¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310161755797.png&#34; alt=&#34;image-20231016175537988&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¯åŠ¨é¡¹ç›®è¿›è¡Œæµ‹è¯•çœ‹çœ‹æ˜¯å¦è¿˜å¯ä»¥æ­£å¸¸ä½¿ç”¨ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310161939226.png&#34; alt=&#34;image-20231016193950393&#34;&gt;&lt;/p&gt;
&lt;p&gt;è®¿é—®é¡µé¢&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310161939102.png&#34; alt=&#34;image-20231016193935669&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä¸€åˆ‡æ­£å¸¸åæˆ‘ä»¬å°±å¼€å§‹æ•´åˆ&lt;/p&gt;
&lt;h3 id=&#34;142-å¾®æœåŠ¡æ•´åˆsentinel&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#142-å¾®æœåŠ¡æ•´åˆsentinel&#34;&gt;#&lt;/a&gt; 1.4.2ã€å¾®æœåŠ¡æ•´åˆ SentinelğŸŒ²&lt;/h3&gt;
&lt;p&gt;æˆ‘ä»¬åœ¨ order-service ä¸­æ•´åˆ Sentinelï¼Œå¹¶ä¸”é“¾æ¥ Sentinel çš„æ§åˆ¶å°ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;1ã€å¼•å…¥ Sentinel ä¾èµ–ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight xml&#34;&gt;&lt;figcaption data-lang=&#34;XML&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;dependency&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;groupId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;com.alibaba.cloud&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;/&lt;/span&gt;groupId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;artifactId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;spring-cloud-starter-alibaba-sentinel&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;/&lt;/span&gt;artifactId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;/&lt;/span&gt;dependency&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;2ã€é…ç½®æ§åˆ¶å°åœ°å€&lt;/p&gt;
&lt;figure class=&#34;highlight yml&#34;&gt;&lt;figcaption data-lang=&#34;YAML&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key atrule&#34;&gt;spring&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token key atrule&#34;&gt;cloud&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;sentinel&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;transport&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token key atrule&#34;&gt;dashboard&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; localhost&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;8080&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;3ã€è®¿é—®å¾®æœåŠ¡çš„ä»»æ„ç«¯ç‚¹ï¼Œè§¦å‘ Sentinel ç›‘æ§&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310161955434.png&#34; alt=&#34;image-20231016195535390&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;15-é™æµè§„åˆ™&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#15-é™æµè§„åˆ™&#34;&gt;#&lt;/a&gt; 1.5ã€é™æµè§„åˆ™ğŸŒ³&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;å¿«é€Ÿå…¥é—¨&lt;/li&gt;
&lt;li&gt;æµæ§æ¨¡å¼&lt;/li&gt;
&lt;li&gt;æµæ§æ•ˆæœ&lt;/li&gt;
&lt;li&gt;çƒ­ç‚¹å‚æ•°é™æµ&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;151-è”Ÿç‚¹é“¾è·¯&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#151-è”Ÿç‚¹é“¾è·¯&#34;&gt;#&lt;/a&gt; 1.5.1ã€è”Ÿç‚¹é“¾è·¯ğŸŒ²&lt;/h3&gt;
&lt;p&gt;è”Ÿç‚¹é“¾è·¯ï¼šå°±æ˜¯é¡¹ç›®å†…çš„è°ƒç”¨é“¾è·¯ï¼Œé“¾è·¯ä¸­&lt;mark&gt;è¢«ç›‘æ§&lt;/mark&gt;çš„æ¯ä¸ªæ¥å£å°±æ˜¯ä¸€ä¸ªèµ„æºã€‚é»˜è®¤æƒ…å†µä¸‹ Sentinel ä¼šç›‘æ§ SpringMVC çš„æ¯ä¸€ä¸ªç«¯ç‚¹ (Endpoint)ï¼Œå› æ­¤ SpringMVC çš„æ¯ä¸€ä¸ªç«¯ç‚¹ (Endpoint)ï¼Œå°±æ˜¯è°ƒç”¨é“¾è·¯ä¸­çš„ä¸€ä¸ªèµ„æºã€‚&lt;/p&gt;
&lt;p&gt;æµæ§ï¼Œç†”æ–­ç­‰éƒ½æ˜¯&lt;mark&gt;é’ˆå¯¹è”Ÿç‚¹é“¾è·¯ä¸­çš„èµ„æº&lt;/mark&gt;æ¥è®¾ç½®çš„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç‚¹å‡»å¯¹åº”èµ„æºåé¢çš„æŒ‰é’®æ¥è®¾ç½®è§„åˆ™ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310162003730.png&#34; alt=&#34;image-20231016200306361&#34;&gt;&lt;/p&gt;
&lt;p&gt;ç‚¹å‡»èµ„æº /order/{orderId} åé¢çš„æµæ§æŒ‰é’®ï¼Œå°±å¯ä»¥å¼¹å‡ºè¡¨å•ã€‚è¡¨å•ä¸­å¯ä»¥æ·»åŠ æµæ§è§„åˆ™ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310162009637.png&#34; alt=&#34;image-20231016200951539&#34;&gt;&lt;/p&gt;
&lt;p&gt;å…¶å«ä¹‰æ˜¯é™åˆ¶ /order/{orderId} è¿™ä¸ªèµ„æºçš„å•å‡» QPS ä¸º 1ï¼Œå³æ¯ç§’åªå…è®¸ 1 æ¬¡è¯·æ±‚ï¼Œè¶…å‡ºçš„è¯·æ±‚ä¼šè¢«æ‹¦æˆªå¹¶æŠ¥é”™ã€‚&lt;/p&gt;
&lt;p&gt;é’ˆå¯¹æ¥æºä¸­ defalt è¡¨ç¤ºä¸€åˆ‡è¯·æ±‚éƒ½é™æµ&lt;/p&gt;
&lt;h4 id=&#34;1511-æ¡ˆä¾‹æµæ§è§„åˆ™å…¥é—¨æ¡ˆä¾‹&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1511-æ¡ˆä¾‹æµæ§è§„åˆ™å…¥é—¨æ¡ˆä¾‹&#34;&gt;#&lt;/a&gt; 1.5.1.1ã€æ¡ˆä¾‹ï¼Œæµæ§è§„åˆ™å…¥é—¨æ¡ˆä¾‹ğŸŒ´&lt;/h4&gt;
&lt;p&gt;&lt;strong&gt;éœ€æ±‚&lt;/strong&gt;ï¼šç»™ /order/{orderId} è¿™ä¸ªèµ„æºè®¾ç½®æµæ§è§„åˆ™ï¼ŒQPS ä¸èƒ½è¶…è¿‡ 5ã€‚ç„¶ååˆ©ç”¨ jmeter æµ‹è¯•ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310162014028.png&#34; alt=&#34;image-20231016201450102&#34;&gt;&lt;/p&gt;
&lt;p&gt;è¿™é‡Œä½¿ç”¨ jemeter è¿›è¡Œå¹¶å‘çš„æµ‹è¯•å·¥å…·å®‰è£…æ–‡ç« ï¼š&lt;a href=&#34;../Jmeter/Jmeter%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8.md&#34;&gt;jmeter å®‰è£…åŠä½¿ç”¨&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;æµ‹è¯•æ–‡ä»¶æ–‡ç« åœ°å€ï¼š&lt;a href=&#34;../%E6%B5%8B%E8%AF%95%E6%96%87%E4%BB%B6/sentinel%E6%B5%8B%E8%AF%95.jmx&#34;&gt;sentinel æµ‹è¯•.jmx&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;å¯¼å…¥åˆ° jmeter ä¸­&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310162035976.png&#34; alt=&#34;image-20231016203528848&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœç‚¹å‡»æ²¡æœ‰ååº”å°±ç›´æ¥å°† jmx æ–‡ä»¶æ‹–åˆ°è“ç“¶å­é‡Œé¢å°±ç®—å¯¼å…¥äº†&lt;/p&gt;
&lt;p&gt;å³é”®ï¼Œæµæ§å…¥é—¨ï¼Œç‚¹å‡»å¯åŠ¨ï¼Œä¹‹åå¯ä»¥ç‚¹å‡»æŸ¥çœ‹ç»“æœæ ‘æ¥æŸ¥çœ‹è¯·æ±‚çš„æƒ…å†µ&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310162036099.png&#34; alt=&#34;image-20231016203617798&#34;&gt;&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯è®¾ç½® QPS åçš„è¯·æ±‚æƒ…å†µï¼Œæ²¡æœ‰é™æµçš„æ—¶å€™å…¨æ˜¯é€šè¿‡çš„&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310162037652.png&#34; alt=&#34;image-20231016203706692&#34;&gt;&lt;/p&gt;
&lt;p&gt;æŸ¥çœ‹æ§åˆ¶å°çš„æƒ…å†µ&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310162032402.png&#34; alt=&#34;image-20231016203257242&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;152-æµæ§æ¨¡å¼&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#152-æµæ§æ¨¡å¼&#34;&gt;#&lt;/a&gt; 1.5.2ã€æµæ§æ¨¡å¼ğŸŒ²&lt;/h3&gt;
&lt;p&gt;åœ¨æ·»åŠ é™æµè§„åˆ™æ—¶ï¼Œç‚¹å‡»é«˜çº§é€‰é¡¹ï¼Œå¯ä»¥é€‰æ‹©ä¸‰ç§æµæ§æ¨¡å¼ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;ç›´æ¥ï¼šç»Ÿè®¡å½“å‰èµ„æºçš„è¯·æ±‚ï¼Œè§¦å‘é˜ˆå€¼æ—¶å¯¹å½“å‰èµ„æºç›´æ¥é™æµï¼Œä¹Ÿæ˜¯é»˜è®¤çš„æ¨¡å¼&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å…³è”ï¼šç»Ÿè®¡ä¸å½“å‰èµ„æºç›¸å…³çš„å¦ä¸€ä¸ªèµ„æºï¼Œè§¦å‘é˜ˆå€¼æ—¶ï¼Œå¯¹å½“å‰èµ„æºé™æµ&lt;/p&gt;
&lt;p&gt;ä¸¤ä¸ªèµ„æºï¼ŒA è§¦å‘äº†é˜ˆå€¼ï¼Œä½†æˆ‘å´å¯¹ B åšäº†é™æµ&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;é“¾è·¯ï¼šç»Ÿè®¡ä»æŒ‡å®šé“¾è·¯è®¿é—®åˆ°æœ¬èµ„æºçš„è¯·æ±‚ï¼Œè§¦å‘é˜ˆå€¼æ—¶ï¼Œå¯¹æŒ‡å®šé“¾è·¯é™æµ&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310162041214.png&#34; alt=&#34;image-20231016204109075&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;1521-æµæ§æ¨¡å¼-å…³è”&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1521-æµæ§æ¨¡å¼-å…³è”&#34;&gt;#&lt;/a&gt; 1.5.2.1ã€æµæ§æ¨¡å¼ - å…³è”ğŸŒ´&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;å…³è”æ¨¡å¼ï¼šç»Ÿè®¡ä¸å½“å‰èµ„æºç›¸å…³çš„å¦ä¸€ä¸ªèµ„æºï¼Œè§¦å‘é˜ˆå€¼æ—¶ï¼Œå¯¹å½“å‰èµ„æºé™æµ&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨åœºæ™¯ï¼šæ¯”å¦‚ç”¨æˆ·æ”¯ä»˜æ—¶éœ€è¦ä¿®æ”¹è®¢å•çŠ¶æ€ï¼ŒåŒæ—¶ç”¨æˆ·è¦æŸ¥è¯¢è®¢å•ã€‚æŸ¥è¯¢å’Œä¿®æ”¹æ“ä½œä¼šäº‰æŠ¢æ•°æ®åº“é”ï¼Œäº§ç”Ÿç«äº‰ã€‚ä¸šåŠ¡éœ€æ±‚æ˜¯æœ‰é™æ”¯ä»˜å’Œæ›´æ–°è®¢å•çš„ä¸šåŠ¡ï¼Œå› æ­¤å½“ä¿®æ”¹è®¢å•ä¸šåŠ¡è§¦å‘é˜ˆå€¼æ—¶ï¼Œéœ€è¦å¯¹æŸ¥è¯¢è®¢å•ä¸šåŠ¡é™æµã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310162047957.png&#34; alt=&#34;image-20231016204748747&#34;&gt;&lt;/p&gt;
&lt;p&gt;å½“ /write èµ„æºè®¿é—®é‡è§¦å‘é˜ˆå€¼æ—¶ï¼Œå°±ä¼šå¯¹ /read èµ„æºé™æµï¼Œé¿å…å½±å“ /write èµ„æºã€‚&lt;/p&gt;
&lt;h5 id=&#34;15211-æ¡ˆä¾‹æµæ§æ¨¡å¼-å…³è”&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#15211-æ¡ˆä¾‹æµæ§æ¨¡å¼-å…³è”&#34;&gt;#&lt;/a&gt; 1.5.2.1.1ã€æ¡ˆä¾‹ï¼Œæµæ§æ¨¡å¼ - å…³è”ğŸ‹&lt;/h5&gt;
&lt;p&gt;éœ€æ±‚ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åœ¨ OrderController æ–°å»ºä¸¤ä¸ªç«¯ç‚¹ï¼š/order/query å’Œ /order/updateï¼Œæ— éœ€å®ç°ä¸šåŠ¡&lt;/li&gt;
&lt;li&gt;é…ç½®æµæ§è§„åˆ™ï¼Œå½“ /order/update èµ„æºè¢«è®¿é—®çš„ QPS è¶…è¿‡ 5 ä¸ªæ—¶ï¼Œå¯¹ /order/query è¯·æ±‚é™æµ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é‡å¯æœåŠ¡åè”Ÿç‚¹é“¾è·¯é‡Œé¢å°±ä¼šè¢«æ¸…ç©ºäº†ï¼Œæˆ‘ä»¬éœ€è¦é‡æ–°å»è¯·æ±‚ä¸€ä¸‹&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310162054136.png&#34; alt=&#34;image-20231016205436554&#34;&gt;&lt;/p&gt;
&lt;p&gt;åˆ†åˆ«è¯·æ±‚ä¸€ä¸‹ query å’Œ update çš„æ¥å£&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310162055490.png&#34; alt=&#34;image-20231016205532378&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310162055118.png&#34; alt=&#34;image-20231016205543133&#34;&gt;&lt;/p&gt;
&lt;p&gt;å†å»æŸ¥çœ‹è”Ÿç‚¹é“¾è·¯å°±å¯ä»¥çœ‹åˆ°æœ‰ä¿¡æ¯äº†&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310162056790.png&#34; alt=&#34;image-20231016205631141&#34;&gt;&lt;/p&gt;
&lt;p&gt;é…ç½®æµæ§è§„åˆ™ï¼Œå½“ /order/update èµ„æºè¢«è®¿é—®çš„ QPS è¶…è¿‡ 5 ä¸ªæ—¶ï¼Œå¯¹ /order/query è¯·æ±‚é™æµã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬è¦å¯¹è°è¿›è¡Œé™æµå°±å¯¹è°è¿›è¡Œæµæ§è§„åˆ™&lt;/p&gt;
&lt;p&gt;ç‚¹å‡» query çš„æµæ§&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310162058104.png&#34; alt=&#34;image-20231016205856014&#34;&gt;&lt;/p&gt;
&lt;p&gt;é€šè¿‡ jmeter è¿›è¡Œæµ‹è¯•ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310162101233.png&#34; alt=&#34;image-20231016210113073&#34;&gt;&lt;/p&gt;
&lt;p&gt;è¯·æ±‚çš„åœ°å€å°±æ˜¯ /order/update&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310162101101.png&#34; alt=&#34;image-20231016210145527&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°è¿™ä¸ªè¯·æ±‚ä¸ä¼šå—åˆ°ä»»ä½•å½±å“&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310162102511.png&#34; alt=&#34;image-20231016210228553&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä½†ï¼Œå½“è®¿é—® /order/query æ—¶&lt;/p&gt;
&lt;p&gt;å°±å‘ç”Ÿäº†å¼‚å¸¸ï¼Œupdate è§¦å‘é˜ˆå€¼æ—¶å¯¹ query é™æµå°±å®ç°äº†è¿™æ ·ä¸€ç§å…³è”æ¨¡å¼äº†&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310162103557.png&#34; alt=&#34;image-20231016210318424&#34;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;å°ç»“&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;æ»¡è¶³ä¸‹é¢æ¡ä»¶å¯ä»¥ä½¿ç”¨å…³è”æ¨¡å¼ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸¤ä¸ªæœ‰ç«äº‰å…³ç³»çš„èµ„æº&lt;/li&gt;
&lt;li&gt;ä¸€ä¸ªä¼˜å…ˆçº§è¾ƒé«˜ï¼Œä¸€ä¸ªä¼˜å…ˆçº§è¾ƒä½&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;1523-æµæ§æ¨¡å¼-é“¾è·¯&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1523-æµæ§æ¨¡å¼-é“¾è·¯&#34;&gt;#&lt;/a&gt; 1.5.2.3ã€æµæ§æ¨¡å¼ - é“¾è·¯ğŸŒ´&lt;/h4&gt;
&lt;p&gt;é“¾è·¯æ¨¡å¼ï¼šåªé’ˆå¯¹ä»æŒ‡å®šé“¾è·¯è®¿é—®åˆ°æœ¬èµ„æºçš„è¯·æ±‚åšç»Ÿè®¡ï¼Œåˆ¤æ–­æ˜¯å¦è¶…è¿‡é˜ˆå€¼ã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼šæœ‰ä¸¤æ¡è¯·æ±‚é“¾è·¯ä¸€ä¸ªæ˜¯ä» test1 è®¿é—® common èµ„æºå¦ä¸€ä¸ªæ˜¯ä» test2 è®¿é—® common èµ„æºï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;/test1 -&amp;gt; /common&lt;/li&gt;
&lt;li&gt;/test2 -&amp;gt; /common&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¦‚æœå¸Œæœ›ç»Ÿè®¡ä» /test2 è¿›å…¥åˆ° /common çš„è¯·æ±‚ï¼Œåˆ™å¯ä»¥è¿™æ ·é…ç½®ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310162107107.png&#34; alt=&#34;image-20231016210716025&#34;&gt;&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªé…ç½®çš„æ„æ€ï¼š&lt;/p&gt;
&lt;p&gt;åœ¨åšé™æµç»Ÿè®¡æ—¶ï¼Œåªç»Ÿè®¡ä» test2 è¿›å…¥ common çš„è¯·æ±‚ï¼Œtest1 è¿›æ¥çš„ä¸ç®¡ã€‚æ‰€ä»¥è¿™ç§ç»Ÿè®¡æ˜¯å¯¹è¯·æ±‚æ¥æºçš„ä¸€ç§ç»Ÿè®¡&lt;/p&gt;
&lt;p&gt;ä»€ä¹ˆæƒ…å†µä¸‹æˆ‘ä»¬ä¼šç”¨åˆ°è¿™æ ·çš„æ¨¡å¼å‘¢ï¼Ÿé€šè¿‡å¦‚ä¸‹æ¡ˆä¾‹äº†è§£&lt;/p&gt;
&lt;h5 id=&#34;15231-æ¡ˆä¾‹æµæ§æ¨¡å¼-é“¾è·¯&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#15231-æ¡ˆä¾‹æµæ§æ¨¡å¼-é“¾è·¯&#34;&gt;#&lt;/a&gt; 1.5.2.3.1ã€æ¡ˆä¾‹ï¼Œæµæ§æ¨¡å¼ - é“¾è·¯ğŸ‹&lt;/h5&gt;
&lt;p&gt;éœ€æ±‚ï¼šæœ‰æŸ¥è¯¢è®¢å•å’Œåˆ›å»ºè®¢å•ä¸šåŠ¡ï¼Œä¸¤è€…éœ€è¦æŸ¥è¯¢å•†å“ã€‚é’ˆå¯¹ä»æŸ¥è¯¢è®¢å•è¿›å…¥åˆ°æŸ¥è¯¢å•†å“çš„è¯·æ±‚ç»Ÿè®¡ï¼Œå¹¶è®¾ç½®é™æµã€‚&lt;/p&gt;
&lt;p&gt;æ­¥éª¤ï¼š&lt;/p&gt;
&lt;p&gt;1ã€åœ¨ OrderService ä¸­æ·»åŠ ä¸€ä¸ª queryGoods æ–¹æ³•ï¼Œä¸ç”¨å®ç°ä¸šåŠ¡&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@Service&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;OrderService&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;	&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@SentinelResource&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;goods&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;queryGoods&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;out&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;æŸ¥è¯¢å•†å“&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;2ã€åœ¨ OrderController ä¸­ï¼Œæ”¹é€  /order/query ç«¯ç‚¹ï¼Œè°ƒç”¨ OrderService ä¸­çš„ queryGoods æ–¹æ³•&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@GetMapping&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;query&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;queryOrder&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;// æŸ¥è¯¢å•†å“&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   orderService&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;queryGoods&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;// æŸ¥è¯¢è®¢å•&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;out&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;æŸ¥è¯¢è®¢å•&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;æŸ¥è¯¢è®¢å•æˆåŠŸ&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;3ã€åœ¨ OrderController ä¸­æ·»åŠ ä¸€ä¸ª /order/save çš„ç«¯ç‚¹ï¼Œè°ƒç”¨ OrderService çš„ queryGoods æ–¹æ³•&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@GetMapping&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;save&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;saveOrder&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   orderService&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;queryGoods&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;out&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;æ–°å¢è®¢å•&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;æ–°å¢è®¢å•æˆåŠŸ&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;4ã€ç»™ queryGoods è®¾ç½®é™æµè§„åˆ™ï¼Œä» /order/query è¿›å…¥ queryGoods çš„æ–¹æ³•é™åˆ¶ QPS å¿…é¡»å°äº 2&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310170741307.png&#34; alt=&#34;image-20231017074152072&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Sentinel é»˜è®¤åªæ ‡è®° Controller ä¸­çš„æ–¹æ³•ä¸ºèµ„æºï¼Œå¦‚æœè¦æ ‡è®°å…¶å®ƒæ–¹æ³•ï¼Œéœ€è¦åˆ©ç”¨ @SentinelResource æ³¨è§£ï¼Œç¤ºä¾‹ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@SentinelResource&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;goods&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;queryGoods&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;out&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;æŸ¥è¯¢å•†å“&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Sentinel é»˜è®¤ä¼šå°† Controller æ–¹æ³•åš context æ•´åˆï¼Œå¯¼è‡´é“¾è·¯æ¨¡å¼çš„æµæ§å¤±è´¥ï¼Œéœ€è¦ä¿®æ”¹ application.ymlï¼Œæ·»åŠ é…ç½®ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight yml&#34;&gt;&lt;figcaption data-lang=&#34;YAML&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key atrule&#34;&gt;spring&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token key atrule&#34;&gt;cloud&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;sentinel&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;transport&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token key atrule&#34;&gt;dashboard&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; localhost&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;8080&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;web-context-unify&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; false // å…³é—­contextæ•´åˆ&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è®¿é—® order/query å’Œ order/save&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310162148402.png&#34; alt=&#34;image-20231016214825324&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310162148432.png&#34; alt=&#34;image-20231016214834464&#34;&gt;&lt;/p&gt;
&lt;p&gt;æŸ¥çœ‹ sentinel çš„è”Ÿç‚¹é“¾è·¯ä¿¡æ¯&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ° /order/query ä¸ /order/save å˜æˆäº†ä¸¤ä¸ªç‹¬ç«‹çš„é“¾è·¯äº†ï¼Œåœ¨ä¹‹å‰æ²¡æœ‰å…³é—­ context æ•´åˆæ—¶å®ƒä¿©æ˜¯åŒä¸€ä¸ªè·Ÿé“¾è·¯ä¸‹çš„å­é“¾è·¯&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310162149544.png&#34; alt=&#34;image-20231016214905203&#34;&gt;&lt;/p&gt;
&lt;p&gt;ç°åœ¨æˆ‘ä»¬å°±å¯ä»¥å¯¹ goods æ·»åŠ æµæ§è§„åˆ™äº†ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢çš„ç¬¬ 4 æ­¥&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310170741307.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310170755887.png&#34; alt=&#34;image-20231017075526647&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ jmeter è¿›è¡Œæµ‹è¯•&lt;/p&gt;
&lt;p&gt;å‘èµ· 200 ä¸ªè¯·æ±‚æ¯ç§’å‘èµ· 4 ä¸ª ï¼Œè€Œä¸”åŒæ—¶å‘èµ·ä¸¤ä¸ªè¯·æ±‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310170802306.png&#34; alt=&#34;image-20231017080217215&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°è¯·æ±‚ save æ²¡é—®é¢˜&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310170806261.png&#34; alt=&#34;image-20231017080631501&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°è¯·æ±‚ query æ—¶æ˜¯ä¸¤ä¸ªä¸¤ä¸ªçš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310170806763.png&#34; alt=&#34;image-20231017080641204&#34;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;æ€»ç»“&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;æµæ§æ¨¡å¼æœ‰å“ªäº›ï¼Ÿ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç›´æ¥ï¼šå¯¹å½“å‰èµ„æºé™æµ&lt;/li&gt;
&lt;li&gt;å…³è”ï¼šé«˜ä¼˜å…ˆçº§èµ„æºè§¦å‘é˜ˆå€¼ï¼Œå¯¹ä½ä¼˜å…ˆçº§èµ„æºé™æµ&lt;/li&gt;
&lt;li&gt;é“¾è·¯ï¼šé˜ˆå€¼ç»Ÿè®¡æ—¶ï¼Œåªç»Ÿè®¡ä»æŒ‡å®šèµ„æºè¿›å…¥å½“å‰èµ„æºçš„è¯·æ±‚ï¼Œæ˜¯å¯¹è¯·æ±‚æ¥æºçš„é™æµ&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;1524-æµæ§æ•ˆæœ&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1524-æµæ§æ•ˆæœ&#34;&gt;#&lt;/a&gt; 1.5.2.4ã€æµæ§æ•ˆæœğŸŒ²&lt;/h4&gt;
&lt;p&gt;æµæ§æ•ˆæœæ˜¯æŒ‡è¯·æ±‚è¾¾åˆ°æµæ§é˜ˆå€¼æ—¶åº”è¯¥é‡‡å–çš„æªæ–½ï¼ŒåŒ…æ‹¬ä¸‰ç§ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¿«é€Ÿå¤±è´¥ï¼šè¾¾åˆ°é˜ˆå€¼åï¼Œæ–°çš„è¯·æ±‚ä¼šè¢«ç«‹å³æ‹’ç»å¹¶æŠ›å‡º FlowException å¼‚å¸¸ã€‚æ˜¯é»˜è®¤çš„å¤„ç†æ–¹å¼ã€‚&lt;/li&gt;
&lt;li&gt;warm upï¼šé¢„çƒ­æ¨¡å¼ï¼Œå¯¹è¶…å‡ºé˜ˆå€¼çš„è¯·æ±‚åŒæ ·æ˜¯æ‹’ç»å¹¶æŠ›å‡ºå¼‚å¸¸ã€‚ä½†è¿™ç§æ¨¡å¼é˜ˆå€¼ä¼šåŠ¨æ€å˜åŒ–ï¼Œä»ä¸€ä¸ªè¾ƒå°å€¼é€æ¸å¢åŠ åˆ°æœ€å¤§é˜ˆå€¼&lt;/li&gt;
&lt;li&gt;æ’é˜Ÿç­‰å¾…ï¼šè®©æ‰€æœ‰çš„è¯·æ±‚æŒ‰ç…§å…ˆåæ¬¡åºæ’é˜Ÿæ‰§è¡Œï¼Œä¸¤ä¸ªè¯·æ±‚çš„å‰ªä¸ªä¸èƒ½å°äºæŒ‡å®šæ—¶é•¿&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310170813160.png&#34; alt=&#34;image-20231017081328807&#34;&gt;&lt;/p&gt;
&lt;h5 id=&#34;15241-æµæ§æ•ˆæœ-warm-up&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#15241-æµæ§æ•ˆæœ-warm-up&#34;&gt;#&lt;/a&gt; 1.5.2.4.1ã€æµæ§æ•ˆæœ - warm upğŸŒ´&lt;/h5&gt;
&lt;p&gt;warm up ä¹Ÿå«é¢„çƒ­æ¨¡å¼ï¼Œæ˜¯åº”å¯¹æœåŠ¡å†·å¯åŠ¨çš„ä¸€ç§æ–¹æ¡ˆã€‚è¯·æ±‚é˜ˆå€¼åˆå§‹å€¼æ˜¯ threshold é™¤ä»¥ coldFactorï¼ŒæŒç»­æŒ‡å®šæ—¶é•¿åï¼Œé€æ¸æé«˜åˆ° threshold å€¼ã€‚è€Œ clodFactor çš„é»˜è®¤å€¼æ˜¯ 3.&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œæˆ‘è®¾ç½® QPS çš„ threshold ä¸º 10ï¼Œé¢„çƒ­æ—¶é—´ä¸º 5 ç§’ï¼Œé‚£ä¹ˆåˆå§‹é˜ˆå€¼å°±æ˜¯ 10 / 3ï¼Œä¹Ÿå°±æ˜¯ 3ï¼Œç„¶ååœ¨ 5 ç§’åé€æ¸å¢é•¿åˆ° 10&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310170818338.png&#34; alt=&#34;image-20231017081845114&#34;&gt;&lt;/p&gt;
&lt;h6 id=&#34;152411-æ¡ˆä¾‹æµæ§æ•ˆæœ-warm-up&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#152411-æ¡ˆä¾‹æµæ§æ•ˆæœ-warm-up&#34;&gt;#&lt;/a&gt; 1.5.2.4.1.1ã€æ¡ˆä¾‹ï¼Œæµæ§æ•ˆæœ - warm upğŸ‹&lt;/h6&gt;
&lt;p&gt;éœ€æ±‚ï¼šç»™ /order/{orderId} è¿™ä¸ªèµ„æºè®¾ç½®é™æµï¼Œæœ€å¤§ QPS ä¸º 10ï¼Œåˆ©ç”¨ warm up æ•ˆæœï¼Œé¢„çƒ­æ—¶é•¿ä¸º 5 ç§’&lt;/p&gt;
&lt;p&gt;è¯·æ±‚ä¸€ä¸‹é€šè¿‡ id æŸ¥è¯¢çš„ uriï¼š&lt;a href=&#34;http://localhost:8088/order/101&#34;&gt;http://localhost:8088/order/101&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ç„¶åå›åˆ° Sentinel åˆ·æ–°é¡µé¢ï¼Œå°±å¯ä»¥çœ‹åˆ° orderId äº†&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310170823021.png&#34; alt=&#34;image-20231017082330841&#34;&gt;&lt;/p&gt;
&lt;p&gt;ç»™ orderId æ·»åŠ ä¸€ä¸ªæµæ§è§„åˆ™&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310170827278.png&#34; alt=&#34;image-20231017082705193&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310170827270.png&#34; alt=&#34;image-20231017082714223&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ jmeter è¿›è¡Œæµ‹è¯•ï¼š&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°é€šè¿‡çš„ QPS è¶Šæ¥è¶Šå¤š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310170829082.png&#34; alt=&#34;image-20231017082949095&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310170830693.png&#34; alt=&#34;image-20231017083005138&#34;&gt;&lt;/p&gt;
&lt;h5 id=&#34;15242-æµæ§æ•ˆæœ-æ’é˜Ÿç­‰å¾…&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#15242-æµæ§æ•ˆæœ-æ’é˜Ÿç­‰å¾…&#34;&gt;#&lt;/a&gt; 1.5.2.4.2ã€æµæ§æ•ˆæœ - æ’é˜Ÿç­‰å¾…ğŸŒ´&lt;/h5&gt;
&lt;p&gt;å½“è¯·æ±‚è¶…è¿‡ QPS é˜ˆå€¼æ—¶ï¼Œå¿«é€Ÿå¤±è´¥å’Œ warm up ä¼šæ‹’ç»æ–°çš„è¯·æ±‚å¹¶æŠ›å‡ºå¼‚å¸¸ã€‚è€Œæ’é˜Ÿç­‰å¾…åˆ™æ˜¯è®©æ‰€æœ‰è¯·æ±‚è¿›å…¥ä¸€ä¸ªé˜Ÿåˆ—ä¸­ï¼Œç„¶åæŒ‰ç…§é˜ˆå€¼å…è®¸çš„æ—¶é—´é—´éš”ä¾æ¬¡æ‰§è¡Œã€‚åæ¥çš„è¯·æ±‚å¿…é¡»ç­‰å¾…å‰é¢æ‰§è¡Œå®Œæˆã€‚å¦‚æœè¯·æ±‚é¢„æœŸçš„ç­‰å¾…æ—¶é—´è¶…å‡ºæœ€å¤§æ—¶é•¿ï¼Œåˆ™ä¼šè¢«æ‹’ç»ã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼šQPS=5ï¼Œæ„å‘³ç€æ¯ 200ms å¤„ç†ä¸€ä¸ªé˜Ÿåˆ—ä¸­çš„è¯·æ±‚ï¼›timeout=2000ï¼Œæ„å‘³ç€é¢„æœŸç­‰å¾…è¶…è¿‡ 2000ms çš„è¯·æ±‚ä¼šè¢«æ‹’ç»å¹¶æŠ›å‡ºå¼‚å¸¸&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚ä¸‹é¢çš„æ—¶é—´çº¿ï¼Œæœ‰æ— æ•°ä¸ªè¯·æ±‚è¦è¿›å…¥é˜Ÿåˆ—æ‰§è¡Œï¼Œé‚£ç¬¬ä¸€ä¸ªè¿›å…¥é˜Ÿåˆ—çš„è¯·æ±‚å®ƒçš„ç­‰å¾…æ—¶é—´ä¸€å®šæ˜¯ 0msã€‚ä½†æ˜¯åŒä¸€æ—¶åˆ»åˆæ¥äº†ä¸€ä¸ªè¯·æ±‚é‚£ä¹ˆç¬¬äºŒä¸ªè¯·æ±‚å®ƒä¸€å®šè¦ç­‰å¾…è‡³å°‘ 200msï¼Œæ‰€ä»¥å®ƒçš„é¢„æœŸç­‰å¾…æ—¶é—´å°±æ˜¯ 2 ç§’ï¼Œåé¢çš„è¯·æ±‚ä»¥æ­¤ç±»æ¨ã€‚ç›´åˆ°ç­‰åˆ°æ—¶é—´æœ€å¤šä¸º 2000ms æ—¶ï¼Œå†æ¥ä¸€ä¸ªè¯·æ±‚å®ƒçš„ç­‰å¾…æ—¶é—´å°±æ˜¯è¶…å‡ºè¿™ 2000ms çš„æ—¶é—´äº†ï¼Œè€Œè¶…å‡ºçš„è¯·æ±‚å°±ä¼šè¢«æ‹’ç»&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310170838123.png&#34; alt=&#34;image-20231017083846925&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¥½å¤„ï¼šå‡è®¾è¯´è¯·æ±‚ QPS æ˜¯æ³¢åŠ¨å‹çš„ï¼Œæ¯”å¦‚è¯´ç¬¬ä¸€ç§’é’Ÿä¸€ä¸ªè¯·æ±‚ä¹Ÿæ²¡æ¥ï¼Œè¿™æ—¶é˜Ÿåˆ—æ˜¯ç©ºçš„ã€‚ç»“æœç¬¬äºŒç§’ä¸€ä¸‹æ¥äº† 10 ä¸ªè¯·æ±‚ï¼Œæ”¾åˆ°é˜Ÿåˆ—é‡Œç„¶åæ¯ 200ms æ”¾è¡Œä¸€ä¸ªæ¢ç®—æˆ QPS å°±æ˜¯ 5ï¼Œæ‰€ä»¥ä¸ç®¡è¿›å…¥çš„ QPS æ˜¯æ€æ ·æ³¢åŠ¨çš„å‡ºå»çš„ QPS ä¸€å®šæ˜¯ç¨³å®šçš„æŒ‰ç…§ 200ms ä¸€ä¸ªçš„é€Ÿåº¦å»æ”¾ã€‚æ‰€ä»¥å°±èµ·åˆ°äº†æµé‡æ•´å½¢çš„ä½œç”¨&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310170854889.png&#34; alt=&#34;image-20231017085359679&#34;&gt;&lt;/p&gt;
&lt;h6 id=&#34;152421-æ¡ˆä¾‹æµæ§æ•ˆæœ-æ’é˜Ÿç­‰å¾…&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#152421-æ¡ˆä¾‹æµæ§æ•ˆæœ-æ’é˜Ÿç­‰å¾…&#34;&gt;#&lt;/a&gt; 1.5.2.4.2.1ã€æ¡ˆä¾‹ï¼Œæµæ§æ•ˆæœ - æ’é˜Ÿç­‰å¾…ğŸ‹&lt;/h6&gt;
&lt;p&gt;éœ€æ±‚ï¼šç»™ /order/{orderId} è¿™ä¸ªèµ„æºè®¾ç½®é™æµï¼Œæœ€å¤§ QPS ä¸º 10ï¼Œåˆ©ç”¨æ’é˜Ÿçš„æµæ§æ•ˆæœï¼Œè¶…æ—¶æ—¶é•¿è®¾ç½®ä¸º 5ss&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310170859614.png&#34; alt=&#34;image-20231017085932633&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310170901195.png&#34; alt=&#34;image-20231017090152352&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ jmeter è¿›è¡Œæµ‹è¯•ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310170908478.png&#34; alt=&#34;image-20231017090853567&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310170909192.png&#34; alt=&#34;image-20231017090906285&#34;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;æ€»ç»“&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;æµæ§æ•ˆæœæœ‰å“ªäº›ï¼Ÿ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¿«é€Ÿå¤±è´¥ï¼šQPS è¶…è¿‡é˜ˆå€¼æ—¶ï¼Œæ‹’ç»æ–°çš„è¯·æ±‚&lt;/li&gt;
&lt;li&gt;warm upï¼šQPS è¶…è¿‡é˜ˆå€¼æ—¶ï¼Œæ‹’ç»æ–°çš„è¯·æ±‚ï¼›QPS é˜ˆå€¼æ˜¯é€æ¸æå‡çš„ï¼Œå¯ä»¥é¿å…å†·å¯åŠ¨æ—¶é«˜å¹¶å‘å¯¼è‡´æœåŠ¡å®•æœºã€‚&lt;/li&gt;
&lt;li&gt;æ’é˜Ÿç­‰å¾…ï¼šè¯·æ±‚ä¼šè¿›å…¥é˜Ÿåˆ—ï¼ŒæŒ‰ç…§é˜ˆå€¼å…è®¸çš„æ—¶é—´é—´éš”ä¾æ¬¡æ‰§è¡Œè¯·æ±‚ï¼›å¦‚æœè¯·æ±‚é¢„æœŸç­‰å¾…æ—¶é•¿å¤§äºè¶…æ—¶æ—¶é—´ï¼Œç›´æ¥æ‹’ç»&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;153-çƒ­ç‚¹å‚æ•°é™æµ&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#153-çƒ­ç‚¹å‚æ•°é™æµ&#34;&gt;#&lt;/a&gt; 1.5.3ã€çƒ­ç‚¹å‚æ•°é™æµğŸŒ²&lt;/h3&gt;
&lt;p&gt;ä¹‹å‰çš„é™æµæ˜¯ç»Ÿè®¡è®¿é—®æŸä¸ªèµ„æºçš„æ‰€æœ‰è¯·æ±‚ï¼Œåˆ¤æ–­æ˜¯å¦è¶…è¿‡ QPS é˜ˆå€¼ã€‚è€Œçƒ­ç‚¹å‚æ•°é™æµæ˜¯åˆ†åˆ«ç»Ÿè®¡&lt;mark&gt;å‚æ•°å€¼ç›¸åŒ&lt;/mark&gt;çš„è¯·æ±‚ï¼Œåˆ¤è¯»æ˜¯å¦è¶…è¿‡ QPS é˜ˆå€¼ã€‚&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚è¯´ï¼šæœ‰ä¸€ä¸ªèµ„æºæ˜¯æ ¹æ® id æŸ¥è¯¢å•†å“ï¼Œå…±æœ‰ 4 ä¸ªè¯·æ±‚ã€‚å¦‚æœæŒ‰ç…§åŸæ¥çš„ç»Ÿè®¡æ–¹å¼é‚£ QPS å°±æ˜¯ 4ã€‚è€ŒæŒ‰ç…§çƒ­ç‚¹å‚æ•°å®ƒä¼šæ ¹æ®å‚æ•°å€¼æ¥åˆ¤æ–­ï¼Œå‰ä¸‰ä¸ªè¯·æ±‚ä¼ é€’çš„ id ä¸º 1ï¼Œè€Œæœ€åä¸€ä¸ªä¼ é€’çš„ id ä¸º 2ã€‚æ‰€ä»¥ QPS ç»Ÿè®¡å°±ä¼šåˆ†å¼€ç»Ÿè®¡äº†ï¼Œid ä¸º 1 çš„ç»Ÿè®¡ä¸º 3 ä¸ª QPS å°±ä¸º 3ï¼Œid ä¸º 2 çš„ç»Ÿè®¡ä¸º 1 ä¸ª QPS å°±ä¸º 1&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310170919488.png&#34; alt=&#34;image-20231017091910421&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;1531-é…ç½®çƒ­ç‚¹é™æµ&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1531-é…ç½®çƒ­ç‚¹é™æµ&#34;&gt;#&lt;/a&gt; 1.5.3.1ã€é…ç½®çƒ­ç‚¹é™æµğŸŒ´&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310170920122.png&#34; alt=&#34;image-20231017092015196&#34;&gt;&lt;/p&gt;
&lt;p&gt;å‚æ•°ç´¢å¼•ï¼šä»£è¡¨å½“å‰åˆ—è¡¨ä¸­ç´¢å¼•ä¸º 0 çš„å‚æ•°ä¹Ÿå°±æ˜¯ç¬¬ä¸€ä¸ª&lt;/p&gt;
&lt;p&gt;å•æœºé˜ˆå€¼ + ç»Ÿè®¡çª—å£æ—¶é•¿ = n ç§’é’Ÿæœ€å¤šå¤„ç† 5 ä¸ªè¯·æ±‚&lt;/p&gt;
&lt;p&gt;ä»£è¡¨çš„å«ä¹‰æ˜¯ï¼šå¯¹ hot è¿™ä¸ªèµ„æºçš„ 0 å·å‚æ•° (ç¬¬ä¸€ä¸ªå‚æ•°) åšç»Ÿè®¡ï¼Œæ¯ 1 ç§’&lt;strong&gt;ç›¸åŒå‚æ•°å€¼&lt;/strong&gt;çš„è¯·æ±‚æ•°ä¸èƒ½è¶…è¿‡ 5&lt;/p&gt;
&lt;h4 id=&#34;1532-é…ç½®çƒ­ç‚¹é™æµé«˜çº§é¡¹&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1532-é…ç½®çƒ­ç‚¹é™æµé«˜çº§é¡¹&#34;&gt;#&lt;/a&gt; 1.5.3.2ã€é…ç½®çƒ­ç‚¹é™æµé«˜çº§é¡¹ğŸŒ´&lt;/h4&gt;
&lt;p&gt;åœ¨çƒ­ç‚¹å‚æ•°é™æµçš„é«˜çº§é€‰é¡¹ä¸­ï¼Œå¯ä»¥å¯¹éƒ¨åˆ†å‚æ•°è®¾ç½®ä¾‹å¤–é…ç½®ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310170924654.png&#34; alt=&#34;image-20231017092441509&#34;&gt;&lt;/p&gt;
&lt;p&gt;ç»“åˆä¸Šä¸€ä¸ªé…ç½®ï¼Œè¿™é‡Œçš„å«ä¹‰æ˜¯å¯¹ 0 å·çš„ long ç±»å‹å‚æ•°é™æµï¼Œæ¯ 1 ç§’ç›¸åŒå‚æ•°çš„ QPS ä¸èƒ½è¶…è¿‡ 5ï¼Œæœ‰ä¸¤ä¸ªä¾‹å¤–ï¼š&lt;/p&gt;
&lt;p&gt;1ã€å¦‚æœå‚æ•°å€¼æ˜¯ 100ï¼Œåˆ™æ¯ 1 ç§’å…è®¸çš„ QPS ä¸º 10&lt;/p&gt;
&lt;p&gt;2ã€å¦‚æœå‚æ•°å€¼æ˜¯ 101ï¼Œåˆ™æ¯ 1 ç§’å…è®¸çš„ QPS ä¸º 15&lt;/p&gt;
&lt;h4 id=&#34;1533-æ¡ˆä¾‹çƒ­ç‚¹å‚æ•°é™æµ&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1533-æ¡ˆä¾‹çƒ­ç‚¹å‚æ•°é™æµ&#34;&gt;#&lt;/a&gt; 1.5.3.3ã€æ¡ˆä¾‹ï¼Œçƒ­ç‚¹å‚æ•°é™æµğŸŒ´&lt;/h4&gt;
&lt;p&gt;ç»™ /order/{orderId} è¿™ä¸ªèµ„æºæ·»åŠ çƒ­ç‚¹å‚æ•°é™æµï¼Œè§„åˆ™å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é»˜è®¤çš„çƒ­ç‚¹å‚æ•°è§„åˆ™æ˜¯æ¯ 1 ç§’è¯·æ±‚é‡ä¸è¶…è¿‡ 2&lt;/li&gt;
&lt;li&gt;ç»™ 102 è¿™ä¸ªå‚æ•°è®¾ç½®ä¾‹å¤–ï¼šæ¯ 1 ç§’è¯·æ±‚é‡ä¸è¶…è¿‡ 4&lt;/li&gt;
&lt;li&gt;ç»™ 103 è¿™ä¸ªå‚æ•°è®¾ç½®ä¾‹å¤–ï¼šæ¯ 1 ç§’è¯·æ±‚é‡ä¸è¶…è¿‡ 10&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;font color=&#39;red&#39;&gt;æ³¨æ„&lt;/font&gt;ï¼š&lt;/p&gt;
&lt;p&gt;çƒ­ç‚¹å‚æ•°é™æµå¯¹é»˜è®¤çš„ SpringMVC èµ„æºæ— æ•ˆ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ­¥éª¤ï¼š&lt;/p&gt;
&lt;p&gt;1ã€çƒ­ç‚¹å‚æ•°é™æµå¯¹é»˜è®¤çš„ SpringMVC èµ„æºæ— æ•ˆï¼Œæˆ‘ä»¬ order/{orderId} è¿™ä¸ªèµ„æºæ°å¥½å°±æ˜¯ Sentinel é»˜è®¤å¯¹ SpringMVC ç›‘æ§çš„ä¸€ä¸ªèµ„æºï¼Œæ‰€ä»¥å³ä¾¿é…ç½®äº†çƒ­ç‚¹å‚æ•°ä¹Ÿä¸ä¼šç”Ÿæ•ˆï¼Œåªæœ‰é€šè¿‡ @SentinelResource å»å£°æ˜çš„èµ„æºæ‰å¯ä»¥é…ç½®çƒ­ç‚¹å‚æ•°é™æµ&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@SentinelResource&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;hot&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@GetMapping&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;&amp;#123;orderId&amp;#125;&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Order&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;queryOrderByUserId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@PathVariable&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;orderId&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Long&lt;/span&gt; orderId&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;// æ ¹æ® id æŸ¥è¯¢è®¢å•å¹¶è¿”å›&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; orderService&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;queryOrderById&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;orderId&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;è¿™æ—¶èµ„æºå°±åŒæ—¶å…·å¤‡äº†ä¸¤ä¸ªåç§°äº†ï¼Œä¸€ä¸ªæ˜¯ order/{orderId} è¿™æ˜¯é»˜è®¤çš„ SpringMVC èµ„æºåç§°ã€‚&lt;/p&gt;
&lt;p&gt;å¦å¤–ä¸€ä¸ªå°±æ˜¯æˆ‘ä»¬è‡ªå·±èµ·çš„ hot&lt;/p&gt;
&lt;p&gt;é‡å¯ orderService æœåŠ¡åè®¿é—®é¡µé¢ uriï¼š&lt;a href=&#34;http://localhost:8088/order/101&#34;&gt;http://localhost:8088/order/101&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è¿™æ ·å°±å¯ä»¥çœ‹åˆ°è”Ÿç‚¹é“¾è·¯äº†&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171009407.png&#34; alt=&#34;image-20231017100944355&#34;&gt;&lt;/p&gt;
&lt;p&gt;2ã€é…ç½®çƒ­ç‚¹é™æµï¼Œä¸è¦ç‚¹å‡»æ ‘å½¢åˆ—è¡¨ä¸­çš„çƒ­ç‚¹è¿™ä¸ªè¡¨å•é‡Œé¢æ²¡æœ‰é«˜çº§é…ç½®&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ç‚¹å‡»å·¦è¾¹çš„é€‰é¡¹æ ä¸­çš„çƒ­ç‚¹è§„åˆ™ï¼Œè¿›è¡Œé…ç½®&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171011792.png&#34; alt=&#34;image-20231017101141197&#34;&gt;&lt;/p&gt;
&lt;p&gt;ç‚¹å‡»æ–°å¢çƒ­ç‚¹é™æµè§„åˆ™å°±ä¼šå¼¹å‡ºä¸€ä¸ªè¡¨å•è¿›è¡Œé…ç½®&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171015751.png&#34; alt=&#34;image-20231017101511501&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171017813.gif&#34; alt=&#34;test&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ jmeter è¿›è¡Œæµ‹è¯•ï¼š&lt;/p&gt;
&lt;p&gt;order/101 çš„è¯·æ±‚ç»“æœ&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171021326.png&#34; alt=&#34;image-20231017102157624&#34;&gt;&lt;/p&gt;
&lt;p&gt;order/102 è¯·æ±‚çš„ç»“æœ&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171022007.png&#34; alt=&#34;image-20231017102216489&#34;&gt;&lt;/p&gt;
&lt;p&gt;order/103 è¯·æ±‚ç»“æœ&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171022759.png&#34; alt=&#34;image-20231017102239351&#34;&gt;&lt;/p&gt;
&lt;p&gt;Sentinel çš„æ§åˆ¶å°æƒ…å†µ&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171022389.png&#34; alt=&#34;image-20231017102256408&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;16-éš”ç¦»å’Œé™çº§&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#16-éš”ç¦»å’Œé™çº§&#34;&gt;#&lt;/a&gt; 1.6ã€éš”ç¦»å’Œé™çº§ğŸŒ³&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;FeignClient æ•´åˆ Sentinel&lt;/li&gt;
&lt;li&gt;çº¿ç¨‹éš”ç¦» (èˆ±å£æ¨¡å¼)&lt;/li&gt;
&lt;li&gt;ç†”æ–­é™çº§&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;å›é¡¾ï¼Œéš”ç¦»å’Œé™çº§çš„åŸç†&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è™½ç„¶é™æµå¯ä»¥å°½é‡é¿å…å› é«˜å¹¶å‘è€Œå¼•èµ·çš„æœåŠ¡æ•…éšœï¼Œä½†æœåŠ¡è¿˜ä¼šå› ä¸ºå…¶å®ƒåŸå› è€Œæ•…éšœã€‚è€Œè¦å°†è¿™äº›æ•…éšœæ§åˆ¶åœ¨ä¸€å®šèŒƒå›´ï¼Œé¿å…é›ªå´©ï¼Œå°±è¦é çº¿ç¨‹éš”ç¦» (èˆ±å£æ¨¡å¼) å’Œç†”æ–­é™çº§æ‰‹æ®µäº†ã€‚&lt;/p&gt;
&lt;p&gt;ç»™æ¯ä¸ªä¸šåŠ¡åˆ’åˆ†çº¿ç¨‹æ± ï¼Œå½“æœ‰è¯·æ±‚è®¿é—®ä¸šåŠ¡ 1 æ—¶æœ€å¤šä½¿ç”¨åä¸ªçº¿ç¨‹ï¼Œè™½ç„¶æœåŠ¡ C æ•…éšœäº†è¯·æ±‚è¿‡ç¨‹ä¸­ä¼šé˜»å¡ä½†æ˜¯æœ€å¤šåªå ç”¨ 10 ä¸ªçº¿ç¨‹èµ„æº&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171031862.png&#34; alt=&#34;image-20231017103151291&#34;&gt;&lt;/p&gt;
&lt;p&gt;ç†”æ–­é™çº§ä¼šç»Ÿè®¡æ•…éšœæœåŠ¡çš„æ¯”ä¾‹ï¼Œæ¯”å¦‚è¯´æœåŠ¡ A è®¿é—®æœåŠ¡ D æˆåŠŸçš„åªæœ‰ä¸€ä¸ªï¼Œæ•…éšœçš„æœ‰ä¸¤ä¸ªè¿™æ—¶çš„æ¯”ä¾‹å°±æ˜¯ 60%ã€‚æ­¤æ—¶ æ–­è·¯å™¨å°±ä¼šç†”æ–­ä¸šåŠ¡ï¼Œå†æœ‰è¦è¯·æ±‚æœåŠ¡ D çš„ä¸šåŠ¡å°±ä¼šå¿«é€Ÿå¤±è´¥&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171033093.png&#34; alt=&#34;image-20231017103347716&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä¸ç®¡æ˜¯çº¿ç¨‹éš”ç¦»è¿˜æ˜¯ç†”æ–­é™çº§ï¼Œéƒ½æ˜¯å¯¹ &lt;font color=&#39;red&#39;&gt;å®¢æˆ·ç«¯ (è°ƒç”¨æ–¹) &lt;/font&gt;. çš„ä¿æŠ¤&lt;/p&gt;
&lt;h3 id=&#34;161-feignæ•´åˆsentinel&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#161-feignæ•´åˆsentinel&#34;&gt;#&lt;/a&gt; 1.6.1ã€Feign æ•´åˆ SentinelğŸŒ²&lt;/h3&gt;
&lt;p&gt;SpringCloud ä¸­ï¼Œå¾®æœåŠ¡è°ƒç”¨éƒ½æ˜¯é€šè¿‡ Feign æ¥å®ç°çš„ï¼Œå› æ­¤åšå®¢æˆ·ç«¯ä¿æŠ¤å¿…é¡»æ•´åˆ Feign å’Œ Sentinel&lt;/p&gt;
&lt;p&gt;1ã€ä¿®æ”¹ OrderService çš„ applicaiton.yml æ–‡ä»¶ï¼Œå¼€å¯ Feign çš„ Sentinel åŠŸèƒ½&lt;/p&gt;
&lt;figure class=&#34;highlight yml&#34;&gt;&lt;figcaption data-lang=&#34;YAML&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key atrule&#34;&gt;feign&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt; &lt;span class=&#34;token key atrule&#34;&gt;sentinel&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token key atrule&#34;&gt;enabled&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;token boolean important&#34;&gt;true&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# å¼€å¯ feign å¯¹ sentinel çš„æ”¯æŒ&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;2ã€ç»™ FeignClient ç¼–å†™å¤±è´¥åçš„é™çº§é€»è¾‘&lt;/p&gt;
&lt;p&gt;2.1ã€æ–¹å¼ä¸€ï¼šFallbackClassï¼Œæ— æ³•å¯¹è¿œç¨‹è°ƒç”¨çš„å¼‚å¸¸åšå¤„ç†&lt;/p&gt;
&lt;p&gt;2.2ã€æ–¹å¼äºŒï¼šFallbackFactoryï¼Œå¯ä»¥å¯¹è¿œç¨‹è°ƒç”¨çš„å¼‚å¸¸åšå¤„ç†ï¼Œæˆ‘ä»¬é€‰æ‹©è¿™ç§&lt;/p&gt;
&lt;p&gt;2.2.1ã€åœ¨ feign-api é¡¹ç›®ä¸­å®šä¹‰ç±»ï¼Œå®ç° FallbackFactoryï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@Slf4j&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;UserClientFallbackFactory&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;implements&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;FallbackFactory&lt;/span&gt;&lt;span class=&#34;token generics&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;UserClient&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@Override&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;UserClient&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;create&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;Throwable&lt;/span&gt; throwable&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// åˆ›å»º UserClient æ¥å£å®ç°ç±»ï¼Œå®ç°å…¶ä¸­çš„æ–¹æ³•ï¼Œç¼–å†™å¤±è´¥é™çº§çš„å¤„ç†é€»è¾‘&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;UserClient&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token annotation punctuation&#34;&gt;@Override&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;User&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;findById&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;Long&lt;/span&gt; id&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token comment&#34;&gt;// è®°å½•å¼‚å¸¸ä¿¡æ¯&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                log&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;error&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;æŸ¥è¯¢ç”¨æˆ·å¼‚å¸¸&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; throwable&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token comment&#34;&gt;// æ ¹æ®ä¸šåŠ¡éœ€æ±‚è¿”å›é»˜è®¤çš„æ•°æ®ï¼Œè¿™é‡Œæ˜¯ç©ºç”¨æˆ·&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;User&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;2.2.2ã€åœ¨ feign-api é¡¹ç›®ä¸­çš„ DefaultFeignConfigration ç±»ä¸­å°† UserClientFallbackFactory æ³¨å†Œä¸ºä¸€ä¸ª Beanï¼š&lt;/p&gt;
&lt;p&gt;å£°æ˜ Bean å¾ˆç®€å•ï¼Œå®šä¹‰å‡½æ•°è¿”å› new å‡ºæ¥çš„å¯¹è±¡å¹¶æ³¨å†Œ Bean å°±è¡Œäº†&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@Bean&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;UserClientFallbackFactory&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;userClientFallbackFactory&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;UserClientFallbackFactory&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;2.2.3ã€åœ¨ feign-api é¡¹ç›®ä¸­çš„ UserClient æ¥å£ä¸­ä½¿ç”¨ UserClientFallbackFactoryï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@FeignClient&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;value &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;userservice&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; fallbackFactory &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;UserClientFallbackFactory&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;interface&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;UserClient&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@GetMapping&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;user/&amp;#123;id&amp;#125;&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token class-name&#34;&gt;User&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;findById&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@PathVariable&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Long&lt;/span&gt; id&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;3ã€é‡å¯ orderService æœåŠ¡&lt;/p&gt;
&lt;p&gt;é‡å¤å®ŒæˆåæŸ¥çœ‹ Sentinel çš„è”Ÿç‚¹é“¾è·¯æƒ…å†µï¼Œä¸‹é¢çš„æƒ…å†µè¯´æ˜å®Œæˆäº† Feign ä¸ Sentinel çš„æ•´åˆäº†&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171304966.png&#34; alt=&#34;image-20231017130442973&#34;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;æ€»ç»“&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;Sentinel æ”¯æŒçš„é›ªå´©è§£å†³æ–¹æ¡ˆï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;çº¿ç¨‹éš”ç¦» (ä»“å£æ¨¡å¼)&lt;/li&gt;
&lt;li&gt;é™çº§ç†”æ–­&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Feign æ•´åˆ Sentinel çš„æ­¥éª¤ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åœ¨ application.yml ä¸­é…ç½®ï¼šfeign.sentinel.enable = true&lt;/li&gt;
&lt;li&gt;ç»™ FeignClient ç¼–å†™ FallbackFactory å¹¶æ³¨å†Œä¸º Bean&lt;/li&gt;
&lt;li&gt;å°† FallbackFactory é…ç½®åˆ° FeignClient&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;162-çº¿ç¨‹éš”ç¦»&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#162-çº¿ç¨‹éš”ç¦»&#34;&gt;#&lt;/a&gt; 1.6.2ã€çº¿ç¨‹éš”ç¦»ğŸŒ²&lt;/h3&gt;
&lt;p&gt;çº¿ç¨‹éš”ç¦»æœ‰ä¸¤ç§æ–¹å¼å®ç°ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;çº¿ç¨‹æ± éš”ç¦»&lt;/li&gt;
&lt;li&gt;ä¿¡å·é‡éš”ç¦» (Sentinel é»˜è®¤é‡‡ç”¨)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é€šè¿‡æ¡ˆä¾‹æ¥æŸ¥çœ‹ä¸¤ä¸ªçº¿ç¨‹éš”ç¦»çš„å·®åˆ«ï¼š&lt;/p&gt;
&lt;p&gt;å‡è®¾è¯´æœ‰å››ä¸ªæœåŠ¡ iï¼Œaï¼Œbï¼Œc ã€‚æœåŠ¡ i é‡Œé¢çš„ä¸šåŠ¡ä¾èµ–äºæœåŠ¡ aï¼Œbï¼Œcã€‚æ¯”æ–¹è¯´æ¥äº†ä¸€ä¸ªè¯·æ±‚ï¼Œå®ƒçš„ä¸šåŠ¡ä¾èµ–äºæœåŠ¡ aï¼Œbã€‚å¦‚æœè¯´æˆ‘ä»¬ç°åœ¨ç”¨çš„æ˜¯çº¿ç¨‹æ± éš”ç¦»é‚£ä¹ˆå®ƒå°±ä¼šç»™è¿™ä¸ªä¸šåŠ¡æ‰€ä¾èµ–çš„æ¯ä¸ªæœåŠ¡éƒ½åˆ›å»ºçº¿ç¨‹æ± ï¼Œè¯·æ±‚æ¥äº†ä»¥åä¸ä¼šä½¿ç”¨è¯·æ±‚æœ¬èº«çš„çº¿ç¨‹ï¼Œè€Œæ˜¯å»åˆ›å»ºçš„çº¿ç¨‹æ± ä¸­åˆ†åˆ«å–ä¸€ä¸ªçº¿ç¨‹è€Œç”¨è¿™ä¸ªçº¿ç¨‹å»è°ƒç”¨ Feign çš„å®¢æˆ·ç«¯ï¼Œå‘èµ·è¿œç¨‹è°ƒç”¨ã€‚è¿™æ ·å‘¢å°±æŠŠä¸¤ä¸ªæœåŠ¡éš”ç¦»äº†&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171315936.png&#34; alt=&#34;image-20231017131457045&#34;&gt;&lt;/p&gt;
&lt;p&gt;è€Œå¦‚æœé‡‡ç”¨çš„æ˜¯ä¿¡å·é‡çš„æ¨¡å¼å°±ç®€å•å¤šäº†ã€‚æ¯”å¦‚è¯´æ¥äº†ä¸€ä¸ªè¯·æ±‚ï¼Œè¦è®¿é—®æœåŠ¡ cã€‚å®ƒä¼šä½¿ç”¨è¯·æ±‚æœ¬èº«çš„çº¿ç¨‹ç›´æ¥å»è°ƒç”¨ Feign çš„å®¢æˆ·ç«¯å»è°ƒç”¨æœåŠ¡ cã€‚é‚£å®ƒæ€ä¹ˆåšéš”ç¦»å‘¢ï¼Ÿå®ƒä¼šåœ¨è¯·æ±‚è¿›å…¥æ—¶åšä¸€ä¸ªåˆ¤æ–­ï¼Œç»´æŒäº†ä¸€ä¸ªè®¡æ•°å™¨ã€‚åˆ¤æ–­ç°åœ¨è®¡æ•°å™¨è¿˜æœ‰æ²¡æœ‰ã€‚æ¯”å¦‚è¯´è®¡æ•°å™¨æ€»æ•°ä¸º 10 æ¯è¿›å…¥ä¸€ä¸ªè¯·æ±‚è®¡æ•°å™¨å°±ä¼šå‡ 1ï¼Œç„¶åå°±å¯ä»¥å»è®¿é—®æœåŠ¡ c äº†ã€‚å½“æ¥äº†åä¸ªè¯·æ±‚è®¡æ•°å™¨è¢«å–å®Œåå†æ¥æ–°è¯·æ±‚å°±ä¼šè¢«æ‹’ç»ã€‚è¿™æ ·å°±ç­‰äºåˆ©ç”¨è®¡æ•°å™¨é™åˆ¶äº†æœ€ç»ˆçº¿ç¨‹çš„æ•°é‡äº†ã€‚å¦‚æœå¤„ç†å®Œè¯·æ±‚è®¡æ•°å™¨è¿˜æ˜¯è¦è¿˜å›å»çš„&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171319389.png&#34; alt=&#34;image-20231017131940276&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;1621-ä¸¤è€…çš„ä¼˜ç¼ºç‚¹&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1621-ä¸¤è€…çš„ä¼˜ç¼ºç‚¹&#34;&gt;#&lt;/a&gt; 1.6.2.1ã€ä¸¤è€…çš„ä¼˜ç¼ºç‚¹ï¼š&lt;/h4&gt;
&lt;h5 id=&#34;çº¿ç¨‹æ± éš”ç¦»&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#çº¿ç¨‹æ± éš”ç¦»&#34;&gt;#&lt;/a&gt; çº¿ç¨‹æ± éš”ç¦»&lt;/h5&gt;
&lt;p&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;1ã€æ”¯æŒä¸»åŠ¨è¶…æ—¶&lt;/p&gt;
&lt;p&gt;å¦‚æœå‘ç°è¯·æ±‚æœ‰ç‚¹ä¹…äº†å¯ä»¥æ‰‹åŠ¨çš„ç»ˆæ­¢çº¿ç¨‹&lt;/p&gt;
&lt;p&gt;2ã€æ”¯æŒå¼‚æ­¥è°ƒç”¨&lt;/p&gt;
&lt;p&gt;æ¯ä¸€æ¬¡è¯·æ±‚éƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„çº¿ç¨‹è€Œä¸æ˜¯ tomcat è¯·æ±‚çš„çº¿ç¨‹&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;1ã€çº¿ç¨‹çš„é¢å¤–å¼€é”€æ¯”è¾ƒå¤§&lt;/p&gt;
&lt;p&gt;åœºæ™¯ï¼š&lt;/p&gt;
&lt;p&gt;1ã€ä½æ‰‡å‡º&lt;/p&gt;
&lt;p&gt;æ‰‡å‡ºï¼šæ¯”æ–¹è¯´è¯·æ±‚åˆ°æˆ‘è¿™ä¸ªæœåŠ¡ï¼Œè€Œæˆ‘è¿™ä¸ªæœåŠ¡ä¾èµ–äºå…¶å®ƒçš„ n ä¸ªæœåŠ¡ã€‚å°±æ˜¯ä»æˆ‘è¿™æ¥äº†ï¼Œæ¥äº†ä¸€ä¸ªè€Œåæˆ‘æ‰‡å‡ºäº†å¥½å‡ ä¸ªã€‚å¦‚æœä¾èµ–çš„æœåŠ¡è¶Šå¤šï¼Œé‚£æ‰‡å‡ºä¹Ÿå°±è¶Šé«˜ï¼Œè€Œæ‰‡å‡ºè¶Šé«˜è°ƒç”¨çš„è¶Šå¤šæˆ‘éœ€è¦å¼€å¯çš„çº¿ç¨‹ä¹Ÿè¶Šå¤šï¼Œæ¶ˆè€—ä¹Ÿå°±è¶Šå¤§ã€‚æ‰€ä»¥å®ƒä¸é€‚ç”¨äºé«˜æ‰‡å‡ºçš„åœºæ™¯ï¼&lt;/p&gt;
&lt;h5 id=&#34;ä¿¡å·é‡éš”ç¦»&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä¿¡å·é‡éš”ç¦»&#34;&gt;#&lt;/a&gt; ä¿¡å·é‡éš”ç¦»&lt;/h5&gt;
&lt;p&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;1ã€è½»é‡çº§ï¼Œæ— é¢å¤–å¼€é”€&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;1ã€ä¸æ”¯æŒä¸»åŠ¨è¶…æ—¶&lt;/p&gt;
&lt;p&gt;2ã€ä¸æ”¯æŒå¼‚æ­¥è°ƒç”¨&lt;/p&gt;
&lt;p&gt;åœºæ™¯ï¼š&lt;/p&gt;
&lt;p&gt;1ã€é«˜é¢‘è°ƒç”¨&lt;/p&gt;
&lt;p&gt;2ã€é«˜æ‰‡å‡º&lt;/p&gt;
&lt;h4 id=&#34;1622-çº¿ç¨‹éš”ç¦»-èˆ±å£æ¨¡å¼&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1622-çº¿ç¨‹éš”ç¦»-èˆ±å£æ¨¡å¼&#34;&gt;#&lt;/a&gt; 1.6.2.2ã€çº¿ç¨‹éš”ç¦» (èˆ±å£æ¨¡å¼)ğŸŒ´&lt;/h4&gt;
&lt;p&gt;åœ¨æ·»åŠ é™æµè§„åˆ™æ—¶ï¼Œå¯ä»¥é€‰æ‹©ä¸¤ç§é˜ˆå€¼ç±»å‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171332558.png&#34; alt=&#34;image-20231017133257502&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;QPSï¼šå°±æ˜¯æ¯ç§’çš„è¯·æ±‚æ•°ï¼Œåœ¨å¿«é€Ÿå…¥é—¨ä¸­å·²ç»æ¼”ç¤ºè¿‡&lt;/li&gt;
&lt;li&gt;çº¿ç¨‹æ•°ï¼šæ˜¯è¯¥èµ„æºèƒ½ä½¿ç”¨çš„ tomcat çº¿ç¨‹æ•°çš„æœ€å¤§å€¼ã€‚ä¹Ÿå°±æ˜¯é€šè¿‡é™åˆ¶çº¿ç¨‹æ•°é‡ï¼Œå®ç°&lt;font color=&#39;red&#39;&gt;èˆ±å£æ¨¡å¼&lt;/font&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;h5 id=&#34;16221-æ¡ˆä¾‹çº¿ç¨‹éš”ç¦»-èˆ±å£æ¨¡å¼&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#16221-æ¡ˆä¾‹çº¿ç¨‹éš”ç¦»-èˆ±å£æ¨¡å¼&#34;&gt;#&lt;/a&gt; 1.6.2.2.1ã€æ¡ˆä¾‹ï¼Œçº¿ç¨‹éš”ç¦» (èˆ±å£æ¨¡å¼)ğŸ‹&lt;/h5&gt;
&lt;p&gt;éœ€æ±‚ï¼šç»™ UserClient çš„æŸ¥è¯¢ç”¨æˆ·æ¥å£è®¾ç½®æµæ§è§„åˆ™ï¼Œçº¿ç¨‹æ•°ä¸èƒ½è¶…è¿‡ 2ã€‚ç„¶ååˆ©ç”¨ jmeter æµ‹è¯•ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171336102.png&#34; alt=&#34;image-20231017133620881&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171336135.png&#34; alt=&#34;image-20231017133657213&#34;&gt;&lt;/p&gt;
&lt;p&gt;é…ç½®å®Œæˆï¼ä½¿ç”¨ jmeter è¿›è¡Œé«˜å¹¶å‘æµ‹è¯•ï¼š&lt;/p&gt;
&lt;p&gt;å…¶ä¸­çš„çº¿ç¨‹æ•°ä¸º 10ï¼Œæ—¶é—´ä¸º 0ã€‚è¡¨ç¤ºä¸€ç¬é—´å‘ 10 ä¸ªçº¿ç¨‹è¯·æ±‚ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171337544.png&#34; alt=&#34;image-20231017133755763&#34;&gt;&lt;/p&gt;
&lt;p&gt;æµ‹è¯•ç»“æœï¼š&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯æ€ä¹ˆæ²¡æœ‰çœ‹åˆ°è¢«æ‹’ç»çš„è¯·æ±‚å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171341275.png&#34; alt=&#34;image-20231017134110845&#34;&gt;&lt;/p&gt;
&lt;p&gt;å…¶å®æˆ‘ä»¬åšäº†é™çº§ç­–ç•¥äº†&lt;/p&gt;
&lt;p&gt;åœ¨ FeignClient æ³¨è§£ä¸­åŠ äº† fallbackFactory&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@FeignClient&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;value &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;userservice&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; fallbackFactory &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;UserClientFallbackFactory&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;interface&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;UserClient&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@GetMapping&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;user/&amp;#123;id&amp;#125;&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token class-name&#34;&gt;User&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;findById&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@PathVariable&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Long&lt;/span&gt; id&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;æ‰€ä»¥å½“çº¿ç¨‹éš”ç¦»è¢«é™çº§ä»¥åå®ƒä¸æ˜¯æŠ¥é”™ï¼Œè€Œæ˜¯ä¼šèµ°è¿™ä¸ªé™çº§é€»è¾‘è¿”å›ä¸€ä¸ªç©ºå¯¹è±¡&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@Slf4j&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;UserClientFallbackFactory&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;implements&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;FallbackFactory&lt;/span&gt;&lt;span class=&#34;token generics&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;UserClient&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@Override&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;UserClient&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;create&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;Throwable&lt;/span&gt; throwable&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// åˆ›å»º UserClient æ¥å£å®ç°ç±»ï¼Œå®ç°å…¶ä¸­çš„æ–¹æ³•ï¼Œç¼–å†™å¤±è´¥é™çº§çš„å¤„ç†é€»è¾‘&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;UserClient&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token annotation punctuation&#34;&gt;@Override&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;User&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;findById&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;Long&lt;/span&gt; id&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token comment&#34;&gt;// è®°å½•å¼‚å¸¸ä¿¡æ¯&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                log&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;error&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;æŸ¥è¯¢ç”¨æˆ·å¼‚å¸¸&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; throwable&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token comment&#34;&gt;// æ ¹æ®ä¸šåŠ¡éœ€æ±‚è¿”å›é»˜è®¤çš„æ•°æ®ï¼Œè¿™é‡Œæ˜¯ç©ºç”¨æˆ·&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;User&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;ä½†æ˜¯åœ¨ idea çš„æ§åˆ¶å°ä¼šæ‰“å°å¼‚å¸¸çš„ä¿¡æ¯&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;10-17 13:40:38:046 ERROR 1804 --- [nio-8088-exec-3] c.i.f.c.f.UserClientFallbackFactory : æŸ¥è¯¢ç”¨æˆ·å¼‚å¸¸
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æˆ‘ä»¬åœ¨å›åˆ° jmeter ç‚¹å‡»è¯·æ±‚æŸ¥çœ‹è¯¦ç»†æƒ…å†µï¼Œæœ‰çš„è·å–çš„æ•°æ®æ˜¯ç©ºçš„&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171347804.png&#34; alt=&#34;image-20231017134731646&#34;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;æ€»ç»“&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;çº¿ç¨‹éš”ç¦»çš„ä¸¤ç§æ‰‹æ®µæ˜¯ï¼Ÿ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¿¡å·éš”ç¦»&lt;/li&gt;
&lt;li&gt;çº¿ç¨‹æ± éš”ç¦»&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¿¡å·é‡éš”ç¦»çš„ç‰¹ç‚¹æ˜¯ï¼Ÿ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åŸºäºè®¡æ•°å™¨æ¨¡å¼ï¼Œç®€å•ï¼Œå¼€é”€å°&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;çº¿ç¨‹æ± éš”ç¦»çš„ç‰¹ç‚¹æ˜¯ï¼Ÿ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åŸºäºçº¿ç¨‹æ± æ¨¡å¼ï¼Œæœ‰é¢å¤–å¼€é”€ï¼Œä½†éš”ç¦»æ§åˆ¶æ›´å¼º&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;163-ç†”æ–­é™çº§&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#163-ç†”æ–­é™çº§&#34;&gt;#&lt;/a&gt; 1.6.3ã€ç†”æ–­é™çº§ğŸŒ²&lt;/h3&gt;
&lt;p&gt;ç†”æ–­é™çº§æ˜¯è§£å†³é›ªå´©é—®é¢˜çš„é‡è¦æ‰‹æ®µã€‚å…¶æ€è·¯æ˜¯ç”±&lt;font color=&#39;red&#39;&gt;æ–­è·¯å™¨&lt;/font&gt;ç»Ÿè®¡æœåŠ¡è°ƒç”¨çš„å¼‚å¸¸æ¯”ä¾‹ï¼Œæ…¢è¯·æ±‚æ¯”ä¾‹ï¼Œå¦‚æœè¶…å‡ºé˜ˆå€¼åˆ™ä¼š&lt;font color=&#39;red&#39;&gt;ç†”æ–­&lt;/font&gt;è¯¥æœåŠ¡ã€‚å³æ‹¦æˆªè®¿é—®è¯¥æœåŠ¡çš„ä¸€åˆ‡è¯·æ±‚ï¼›è€Œå½“è¯·æ±‚æ¢å¤æ—¶ï¼Œæ–­è·¯å™¨ä¼šæ”¾è¡Œè®¿é—®è¯¥æœåŠ¡çš„è¯·æ±‚ã€‚&lt;/p&gt;
&lt;p&gt;æ–­è·¯å™¨å†…éƒ¨ç”±ä¸€ä¸ªçŠ¶æ€æœºæ¥å®ç°çš„ï¼Œè¿™ä¸ªçŠ¶æ€æœºåŒ…å«ä¸‰ç§çŠ¶æ€ï¼Œåˆ†åˆ«æ˜¯ï¼šclosedï¼Œopenï¼ŒHalf-Open&lt;/p&gt;
&lt;p&gt;closed çŠ¶æ€ä¸‹ï¼Œæ–­è·¯å™¨ä¸ä¼šæ‹¦æˆªä»»ä½•è¯·æ±‚ã€‚ä¸ç®¡è¯·æ±‚æ˜¯æ­£å¸¸çš„è¿˜æ˜¯å¼‚å¸¸çš„éƒ½å¯ä»¥è®¿é—®ï¼Œå®ƒä¼šå»ç»Ÿè®¡è°ƒç”¨å¼‚å¸¸çš„æ¯”ä¾‹ï¼Œå¦‚æœç»Ÿè®¡è¿‡ç¨‹ä¸­å‘ç°å¼‚å¸¸æ¯”ä¾‹è¿‡é«˜è¾¾åˆ°äº†é˜ˆå€¼å°±ä¼šä» closed çŠ¶æ€åˆ‡æ¢åˆ° open çŠ¶æ€ã€è¿™æ—¶å°±ä¼šæ‹¦æˆªè¿›å…¥è¯¥æœåŠ¡çš„ä¸€äº›è¯·æ±‚äº†ä¹Ÿå°±ç›¸å½“äºæ˜¯ç†”æ–­äº†ã€‚ç†”æ–­æœ‰ä¸€ä¸ªæŒç»­çš„æ—¶é—´ï¼Œå½“ç†”æ–­æ—¶é—´ç»“æŸå°±ä¼šä» open çŠ¶æ€åˆ‡æ¢åˆ° half-open çŠ¶æ€ (åŠå¼€çŠ¶æ€)ã€‚half-open çŠ¶æ€ä¼šæ”¾è¡Œä¸€æ¬¡è¯·æ±‚ï¼Œç„¶åæ ¹æ®è¿™æ¬¡è¯·æ±‚çš„ç»“æœæ¥åˆ¤æ–­ä¸‹ä¸€æ­¥ã€‚&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚è¯´æ”¾è¡Œä¸€æ¬¡è¯·æ±‚å‘ç°è¿™ä¸ªè¯·æ±‚ä¾èµ–æ˜¯å¤±è´¥çš„é‚£ä¹ˆå°±ä¼šå†æ¬¡è¿›å…¥ open çŠ¶æ€&lt;/p&gt;
&lt;p&gt;å¦‚æœæ”¾è¡Œä¸€æ¬¡è¯·æ±‚æ‰§è¡Œå®Œäº†å‘ç°æ˜¯æˆåŠŸçš„é‚£ä¹ˆå°±ä¼šä» half-open åˆ‡æ¢åˆ° closed çŠ¶æ€&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171422210.png&#34; alt=&#34;image-20231017142215093&#34;&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬çŸ¥é“æ–­è·¯å™¨è¦æƒ³ä» closed çŠ¶æ€è¿›å…¥åˆ° open çŠ¶æ€éœ€è¦åˆ¤æ–­æœåŠ¡æœ‰æ²¡æœ‰è§¦å‘ç†”æ–­çš„æ¡ä»¶ã€‚è€Œç†”æ–­åˆ¤æ–­çš„æ¡ä»¶å°±æ˜¯ä¾æ®ç†”æ–­ç­–ç•¥æ¥å®Œæˆçš„ï¼Œè€Œåœ¨ Sentinel é‡Œç†”æ–­çš„ç­–ç•¥æœ‰ä¸‰ç§ï¼šæ…¢è°ƒç”¨ï¼Œå¼‚å¸¸æ¯”ä¾‹ï¼Œå¼‚å¸¸æ•°&lt;/p&gt;
&lt;h4 id=&#34;1631-ç†”æ–­ç­–ç•¥-æ…¢è°ƒç”¨&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1631-ç†”æ–­ç­–ç•¥-æ…¢è°ƒç”¨&#34;&gt;#&lt;/a&gt; 1.6.3.1ã€ç†”æ–­ç­–ç•¥ - æ…¢è°ƒç”¨ğŸŒ´&lt;/h4&gt;
&lt;p&gt;&lt;mark&gt;æ…¢è°ƒç”¨&lt;/mark&gt;ï¼šä¸šåŠ¡çš„å“åº”æ—¶é•¿ (RT) å¤§äºæŒ‡å®šæ—¶é•¿çš„è¯·æ±‚è®¤å®šä¸ºæ…¢è°ƒç”¨è¯·æ±‚ã€‚åœ¨æŒ‡å®šæ—¶é—´å†…ï¼Œå¦‚æœè¯·æ±‚æ•°é‡è¶…è¿‡è®¾å®šçš„æœ€å°æ•°é‡ï¼Œæ…¢è°ƒç”¨æ¯”ä¾‹å¤§äºè®¾å®šçš„é˜ˆå€¼ï¼Œåˆ™è§¦å‘ç†”æ–­ã€‚ä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171428040.png&#34; alt=&#34;image-20231017142805647&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;è§£è¯»&lt;/strong&gt;ï¼šRT è¶…è¿‡ 500ms çš„è°ƒç”¨æ˜¯æ…¢è°ƒç”¨ï¼Œç»Ÿè®¡æœ€è¿‘ 10000ms å†…çš„è¯·æ±‚ï¼Œå¦‚æœè¯·æ±‚é‡è¶…è¿‡ 10 æ¬¡ï¼Œå¹¶ä¸”æ…¢è°ƒç”¨æ¯”ä¾‹ä¸ä½äº 0.5ï¼Œåˆ™è§¦å‘ç†”æ–­ï¼Œç†”æ–­æ—¶é•¿ä¸º 5 ç§’ã€‚ç„¶åè¿›å…¥ half-open çŠ¶æ€ï¼Œæ”¾è¡Œä¸€æ¬¡è¯·æ±‚åšæµ‹è¯•ã€‚&lt;/p&gt;
&lt;h5 id=&#34;16311-æ¡ˆä¾‹ç†”æ–­ç­–ç•¥-æ…¢è°ƒç”¨&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#16311-æ¡ˆä¾‹ç†”æ–­ç­–ç•¥-æ…¢è°ƒç”¨&#34;&gt;#&lt;/a&gt; 1.6.3.1.1ã€æ¡ˆä¾‹ï¼Œç†”æ–­ç­–ç•¥ - æ…¢è°ƒç”¨ğŸ‹&lt;/h5&gt;
&lt;p&gt;éœ€æ±‚ï¼šç»™ UserClient çš„æŸ¥è¯¢ç”¨æˆ·æ¥å£è®¾ç½®é™çº§è§„åˆ™ï¼Œæ…¢è°ƒç”¨çš„ RT é˜ˆå€¼ä¸º 50msï¼Œç»Ÿè®¡æ—¶é—´ä¸º 1 ç§’ï¼Œ æœ€å°è¯·æ±‚æ•°é‡ä¸º 5ï¼Œå¤±è´¥é˜ˆå€¼æ¯”ä¾‹ä¸º 0.4ï¼Œç†”æ–­æ—¶é•¿ä¸º 5&lt;/p&gt;
&lt;p&gt;é—®é¢˜ï¼šæœ¬åœ°è°ƒç”¨æ—¶é—´ä¸å¯èƒ½é‚£ä¹ˆé•¿æ‰€ä»¥ä¸ºäº†èƒ½å¤Ÿè§¦å‘æ…¢è°ƒç”¨éœ€è¦ä¿®æ”¹ä¸€ä¸‹ä¸šåŠ¡ä»£ç è®©å…¶è¶…è¿‡å“åº”æ—¶é—´&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@GetMapping&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;/&amp;#123;id&amp;#125;&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;User&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;queryById&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@PathVariable&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;id&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Long&lt;/span&gt; id&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token annotation punctuation&#34;&gt;@RequestHeader&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;value &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;Truth&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; required &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token boolean&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;String&lt;/span&gt; truth&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;id &lt;span class=&#34;token operator&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token comment&#34;&gt;// ä¼‘çœ ï¼Œè§¦å‘ç†”æ–­&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token keyword&#34;&gt;try&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;         &lt;span class=&#34;token class-name&#34;&gt;Thread&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;sleep&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;60&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;catch&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;InterruptedException&lt;/span&gt; e&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;         &lt;span class=&#34;token keyword&#34;&gt;throw&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;RuntimeException&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;e&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;out&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;truth: &#34;&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; truth&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; userService&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;queryById&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;id&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;é‡å¯ userService æœåŠ¡&lt;/p&gt;
&lt;p&gt;è®¿é—® order/101 æ—¶å°±ä¼šå»è¯·æ±‚ userId ä¸º 1 çš„ç”¨æˆ·&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171439770.png&#34; alt=&#34;image-20231017143949635&#34;&gt;&lt;/p&gt;
&lt;p&gt;order/102&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171441135.png&#34; alt=&#34;image-20231017144136736&#34;&gt;&lt;/p&gt;
&lt;p&gt;order/101&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171441279.png&#34; alt=&#34;image-20231017144150302&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ° 102 è¯·æ±‚æ—¶é•¿åŸºæœ¬ä¸è¶…è¿‡ 10 æ¯«ç§’ï¼Œè€Œ 101 è¯·æ±‚æ—¶é•¿åŸºæœ¬ä¸ä¸‹ 70 æ¯«ç§’ã€‚è¿™æ ·å°±èƒ½æ»¡è¶³æˆ‘ä»¬è§¦å‘é˜ˆå€¼çš„æƒ…å†µäº†&lt;/p&gt;
&lt;p&gt;ç„¶åå°±å¯ä»¥å»é…ç½®ç†”æ–­é™çº§ç­–ç•¥äº†ï¼Œå» Sentinel æ§åˆ¶å°ä¸­&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171445150.png&#34; alt=&#34;image-20231017144506913&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171445998.png&#34; alt=&#34;image-20231017144515744&#34;&gt;&lt;/p&gt;
&lt;p&gt;ç„¶åæˆ‘ä»¬å°±å¯ä»¥å»è¿›è¡Œæµ‹è¯•äº†ï¼š&lt;/p&gt;
&lt;p&gt;è¿™æ¬¡çš„æµ‹è¯•å¯ä»¥ä¸ç”¨ jmeter äº†ï¼Œå› ä¸ºéœ€è¦ä¸€ç§’å†… 5 æ¬¡è¯·æ±‚ï¼Œæœ‰ 2 æ¬¡è§¦å‘å°±è¡Œäº†å¾ˆå®¹æ˜“å¯ä»¥å»åˆ·æ–° order/{orderId} çš„è¯·æ±‚é¡µé¢&lt;/p&gt;
&lt;p&gt;ç°åœ¨è®¿é—® order/102ï¼Œæ˜¯æ­£å¸¸å¯ä»¥è®¿é—®çš„&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171448397.png&#34; alt=&#34;image-20231017144804306&#34;&gt;&lt;/p&gt;
&lt;p&gt;è¿ç»­è¯·æ±‚ 5 æ¬¡ order/101ï¼Œä¹Ÿå°±æ˜¯åˆ·æ–° 5 æ¬¡é¡µé¢&lt;/p&gt;
&lt;p&gt;å†å»è®¿é—® order/102 å°±ä¼šå‘ç° user ä¸­æ²¡æœ‰æ•°æ®äº†ï¼Œå½“ order å»æŸ¥ user çš„é‚£ä¸€åˆ»ç›´æ¥è¢«ç†”æ–­äº†ï¼Œå‹æ ¹æ²¡æœ‰å»æŸ¥ç›´æ¥èµ°é™çº§é€»è¾‘è¿”å› null äº†&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171449564.png&#34; alt=&#34;image-20231017144859133&#34;&gt;&lt;/p&gt;
&lt;p&gt;ç­‰å¾… 5 ç§’åå†å»åˆ·æ–°ä¸€ä¸ª order/102 é¡µé¢ï¼Œç†”æ–­å°±å–æ¶ˆäº†å¯ä»¥è¯·æ±‚åˆ° user çš„æ•°æ®äº†&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171451453.png&#34; alt=&#34;image-20231017145103496&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;1632-ç†”æ–­ç­–ç•¥-å¼‚å¸¸æ¯”ä¾‹å¼‚å¸¸æ•°&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1632-ç†”æ–­ç­–ç•¥-å¼‚å¸¸æ¯”ä¾‹å¼‚å¸¸æ•°&#34;&gt;#&lt;/a&gt; 1.6.3.2ã€ç†”æ–­ç­–ç•¥ - å¼‚å¸¸æ¯”ä¾‹ï¼Œå¼‚å¸¸æ•°ğŸŒ´&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;&lt;mark&gt;å¼‚å¸¸æ¯”ä¾‹æˆ–å¼‚å¸¸æ•°&lt;/mark&gt;ï¼šç»Ÿè®¡æŒ‡å®šæ—¶é—´å†…çš„ è°ƒç”¨ï¼Œå¦‚æœè°ƒç”¨æ¬¡æ•°è¶…è¿‡æŒ‡å®šçš„è¯·æ±‚æ•°ï¼Œå¹¶ä¸”å‡ºç°å¼‚å¸¸çš„æ¯”ä¾‹è¾¾åˆ°è®¾å®šçš„æ¯”ä¾‹é˜ˆå€¼ (æˆ–è¶…è¿‡æŒ‡å®šå¼‚å¸¸æ•°) ï¼Œåˆ™è§¦å‘ç†”æ–­ã€‚ä¾‹å¦‚ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æŒ‰ç…§å¼‚å¸¸çš„æ¯”ä¾‹ç†”æ–­&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171454750.png&#34; alt=&#34;image-20231017145414614&#34;&gt;&lt;/p&gt;
&lt;p&gt;è¾¾åˆ°å¼‚å¸¸æ•°é‡ç†”æ–­&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171456985.png&#34; alt=&#34;image-20231017145619743&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;è§£è¯»&lt;/strong&gt;ï¼šç»Ÿè®¡æœ€è¿‘ 1000ms å†…çš„è¯·æ±‚ï¼Œå¦‚æœè¯·æ±‚é‡è¶…è¿‡ 10 æ¬¡ï¼Œå¹¶ä¸”å¼‚å¸¸æ¯”ä¾‹ä¸ä½äº 0.5ï¼Œåˆ™è§¦å‘ç†”æ–­ï¼Œç†”æ–­æ—¶é•¿ä¸º 5 ç§’ã€‚ç„¶åè¿›å…¥ half-open çŠ¶æ€ï¼Œæ”¾è¡Œä¸€æ¬¡è¯·æ±‚åšæµ‹è¯•ã€‚&lt;/p&gt;
&lt;h5 id=&#34;16321-æ¡ˆä¾‹ç†”æ–­ç­–ç•¥-å¼‚å¸¸æ¯”ä¾‹&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#16321-æ¡ˆä¾‹ç†”æ–­ç­–ç•¥-å¼‚å¸¸æ¯”ä¾‹&#34;&gt;#&lt;/a&gt; 1.6.3.2.1ã€æ¡ˆä¾‹ï¼Œç†”æ–­ç­–ç•¥ - å¼‚å¸¸æ¯”ä¾‹ğŸ‹&lt;/h5&gt;
&lt;p&gt;&lt;strong&gt;éœ€æ±‚&lt;/strong&gt;ï¼šç»™ UserClient çš„æŸ¥è¯¢ç”¨æˆ·æ¥å£è®¾ç½®é™çº§è§„åˆ™ï¼Œç»Ÿè®¡æ—¶é—´ä¸º 1 ç§’ï¼Œæœ€å°è¯·æ±‚æ•°é‡ä¸º 5ï¼Œå¤±è´¥é˜ˆå€¼æ¯”ä¾‹ä¸º 0.4ï¼Œç†”æ–­æ—¶é•¿ä¸º 5&lt;/p&gt;
&lt;p&gt;&lt;font color=&#39;red&#39;&gt;æç¤º&lt;/font&gt;ï¼šä¸ºäº†è§¦å‘å¼‚å¸¸ç»Ÿè®¡ï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹ UserService ä¸­çš„ä¸šåŠ¡ï¼ŒæŠ›å‡ºå¼‚å¸¸å¦‚ä¸‹ä»£ç ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@GetMapping&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;/&amp;#123;id&amp;#125;&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;User&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;queryById&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@PathVariable&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;id&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Long&lt;/span&gt; id&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token annotation punctuation&#34;&gt;@RequestHeader&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;value &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;Truth&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; required &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token boolean&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;String&lt;/span&gt; truth&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;id &lt;span class=&#34;token operator&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token keyword&#34;&gt;throw&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;RuntimeException&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;æ•…æ„æŠ›å‡ºå¼‚å¸¸ï¼Œè§¦å‘å¼‚å¸¸æ¯”ä¾‹ç†”æ–­&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;out&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;truth: &#34;&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; truth&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; userService&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;queryById&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;id&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;ç»™ UserClient æŸ¥è¯¢ç”¨æˆ·æ¥å£è®¾ç½®é™çº§è§„åˆ™&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171511550.png&#34; alt=&#34;image-20231017151144666&#34;&gt;&lt;/p&gt;
&lt;p&gt;è®¿é—® order/102&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171512960.png&#34; alt=&#34;image-20231017151235103&#34;&gt;&lt;/p&gt;
&lt;p&gt;ç„¶åè¿ç»­è®¿é—® n æ¬¡ order/101&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171516133.png&#34; alt=&#34;image-20231017151605944&#34;&gt;&lt;/p&gt;
&lt;p&gt;åœ¨è®¿é—® order/102 å°±å‘ç°è¢«ç†”æ–­äº†&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171515798.png&#34; alt=&#34;image-20231017151556049&#34;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;æ€»ç»“&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;Sentinel ç†”æ–­é™çº§çš„ç­–ç•¥æœ‰å“ªäº›ï¼Ÿ&lt;/p&gt;
&lt;p&gt;1ã€æ…¢è°ƒç”¨æ¯”ä¾‹ï¼šè¶…è¿‡æŒ‡å®šæ—¶é•¿çš„è°ƒç”¨ä¸ºæ…¢è°ƒç”¨ï¼Œç»Ÿè®¡å•ä½æ—¶é•¿å†…æ…¢è°ƒç”¨çš„æ¯”ä¾‹ï¼Œè¶…è¿‡é˜ˆå€¼åˆ™ç†”æ–­&lt;/p&gt;
&lt;p&gt;2ã€å¼‚å¸¸æ¯”ä¾‹ï¼šç»Ÿè®¡å•ä½æ—¶é•¿å†…å¼‚å¸¸è°ƒç”¨çš„æ¯”ä¾‹ï¼Œè¶…è¿‡é˜ˆå€¼åˆ™ç†”æ–­&lt;/p&gt;
&lt;p&gt;3ã€å¼‚å¸¸æ•°ï¼šç»Ÿè®¡å•ä½æ—¶é•¿å†…å¼‚å¸¸è°ƒç”¨çš„æ¬¡æ•°ï¼Œè¶…è¿‡é˜ˆå€¼åˆ™ç†”æ–­&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;17-æˆæƒè§„åˆ™&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#17-æˆæƒè§„åˆ™&#34;&gt;#&lt;/a&gt; 1.7ã€æˆæƒè§„åˆ™ğŸŒ³&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;æˆæƒè§„åˆ™&lt;/li&gt;
&lt;li&gt;è‡ªå®šä¹‰å¼‚å¸¸ç»“æœ&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;171-æˆæƒè§„åˆ™&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#171-æˆæƒè§„åˆ™&#34;&gt;#&lt;/a&gt; 1.7.1ã€æˆæƒè§„åˆ™ğŸŒ²&lt;/h3&gt;
&lt;p&gt;æˆæƒè§„åˆ™å¯ä»¥å¯¹è°ƒç”¨æ–¹çš„æ¥æºåšæ§åˆ¶ï¼Œæœ‰ç™½åå•å’Œé»‘åå•ä¸¤ç§æ–¹å¼ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æˆ‘ä»¬å­¦ä¹ ç½‘å…³çš„æ—¶å€™è®²è¿‡ï¼Œgateway å®ƒä¸å°±æ˜¯æŠŠé—¨çš„å—ã€‚æ‰€æœ‰è¯·æ±‚éƒ½è¦ç»è¿‡ç½‘å…³å»åšèº«ä»½çš„è®¤è¯ï¼Œæ€ä¹ˆåˆ°è¿™å„¿åˆè¦æ•´ä¸€ä¸ªå‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ä¸‡ä¸€å…¬å¸å‡ºäº†ä¸€ä¸ªå†…é¬¼ï¼Œå®ƒæŠŠå¾®æœåŠ¡åœ°å€æ³„éœ²ç»™äº†å¤–è¾¹å“ªäº›ä¸æ€€å¥½æ„çš„äººï¼Œé‚£è¿™äº›å“¥ä»¬å°±å¯ä»¥ç»•è¿‡ç½‘å…³ç›´æ¥è®¿é—®å¾®æœåŠ¡äº†ã€‚é‚£ç½‘å…³é‡Œåšçš„å†ä¸¥å¯†ä¹Ÿéƒ½æ²¡ç”¨äº†ï¼Œæ‰€ä»¥ Sentinel æˆæƒè§„åˆ™å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æˆæƒè§„åˆ™ä¼šå»éªŒè¯ä½ è¯·æ±‚ä»å“ªæ¥çš„ã€‚å¦‚æœè¯´ä½ æ˜¯ä»ç½‘å…³è¿‡æ¥çš„é‚£å°±æ”¾è¡Œï¼Œå¦‚æœè¯´ä½ ä»åˆ«çš„åœ°æ–¹æ¥çš„å°±æ‹¦æˆª&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;ç™½åå•ï¼šæ¥æº (origin) åœ¨ç™½åå•å†…çš„è°ƒç”¨è€…å…è®¸è®¿é—®&lt;/li&gt;
&lt;li&gt;é»‘åå•ï¼šæ¥æº (origin) åœ¨é»‘åå•å†…çš„è°ƒç”¨è€…ä¸å…è®¸è®¿é—®&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171530129.png&#34; alt=&#34;image-20231017153026632&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œæˆ‘ä»¬é™å®šåªå…è®¸ä»ç½‘å…³æ¥çš„è¯·æ±‚è®¿é—® order-serviceï¼Œé‚£ä¹ˆæµæ§åº”ç”¨ä¸­å°±å¡«å†™ç½‘å…³çš„åç§°&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆè¿™æ—¶&lt;/p&gt;
&lt;p orderId=&#34;&#34;&gt;èµ„æºåå¡«çš„å°±æ˜¯ï¼šorder-service é‡Œé¢çš„å—ä¿æŠ¤èµ„æºï¼Œæ¯”æ–¹è¯´ order/&lt;/p&gt;
&lt;p&gt;æµæ§åº”ç”¨å¡«çš„å°±æ˜¯ï¼šå…è®¸çš„è°ƒç”¨è€…çš„åå­— originï¼Œè¯·æ±‚æ¥æºåç§°ï¼Œé‚£ä¹ˆè¯·æ±‚æ¥æºåç§°æ˜¯æ€ä¹ˆå¾—åˆ°çš„å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171531533.png&#34; alt=&#34;image-20231017153153844&#34;&gt;&lt;/p&gt;
&lt;p&gt;Sentinel æ˜¯é€šè¿‡ RequestOriginParser è¿™ä¸ªæ¥å£çš„ parseOrigin æ¥è·å–è¯·æ±‚çš„æ¥æºçš„ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯è¿™ä¸ªæ–¹æ³•çš„è¿”å›ç»“æœåªèƒ½æ˜¯ defaultï¼Œä¹Ÿå°±æ˜¯è¯´æ— è®ºæ˜¯ä»ç½‘å…³è¿‡æ¥è¿˜æ˜¯æµè§ˆå™¨è¿‡æ¥å®ƒçš„æ¥æºåç§°éƒ½å« default&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;interface&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;RequestOriginParser&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;/**&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   * ä»è¯·æ±‚ request å¯¹è±¡ä¸­è·å– originï¼Œè·å–æ–¹å¼è‡ªå®šä¹‰&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   */&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token class-name&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;parseOrigin&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;HttpServletRequest&lt;/span&gt; request&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬å¿…é¡»è‡ªå·±æƒ³åŠæ³•å®ç°è¿™ä¸ªæ¥å£ç¼–å†™å®ƒçš„ä¸šåŠ¡é€»è¾‘ï¼Œè®©ä»ç½‘å…³è¿‡æ¥çš„è¯·æ±‚å’Œä»æµè§ˆå™¨è¿‡æ¥çš„è¯·æ±‚è¿”å›ä¸åŒçš„ç»“æœï¼Œè¿™æ ·æ¥æºåç§°ä¸åŒå°±å¯ä»¥ç¼–å†™æˆæƒè§„åˆ™äº†&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œæˆ‘ä»¬å°è¯•ä» reqeust ä¸­è·å–ä¸€ä¸ªåä¸º origin çš„è¯·æ±‚å¤´ï¼Œä½œä¸º origin çš„å€¼ï¼š&lt;/p&gt;
&lt;p&gt;è¿™é‡Œ gateway è®¿é—®æ¶ˆè´¹è€…ä¹Ÿå°±æ˜¯ orderservice æœåŠ¡æ‰€ä»¥ä¸‹é¢ä¸šåŠ¡ä»£ç æ˜¯å†™åˆ° order æœåŠ¡ä¸­çš„&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@Component&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;HeaderOriginParser&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;implements&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;RequestOriginParser&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@Override&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;parseOrigin&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;HttpServletRequest&lt;/span&gt; request&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// 1. è·å–è¯·æ±‚å¤´&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token class-name&#34;&gt;String&lt;/span&gt; header &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; request&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;getHeader&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;origin&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// 2. éç©ºåˆ¤æ–­&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;StringUtils&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;isEmpty&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;header&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            header &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;blank&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; header&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;æˆ‘ä»¬è¿˜éœ€è¦åœ¨ gateway æœåŠ¡ä¸­ï¼Œåˆ©ç”¨ç½‘å…³çš„è¿‡æ»¤å™¨æ·»åŠ åä¸º gateway çš„ origin å¤´&lt;/p&gt;
&lt;figure class=&#34;highlight yml&#34;&gt;&lt;figcaption data-lang=&#34;YAML&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key atrule&#34;&gt;spring&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token key atrule&#34;&gt;cloud&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;gateway&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;default-filters&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;-&lt;/span&gt; AddRequestHeader=origin&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;gateway &lt;span class=&#34;token comment&#34;&gt;# æ·»åŠ åä¸º origin çš„è¯·æ±‚å¤´ï¼Œå€¼ä¸º gateway&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;é‡å¯ orderservice æœåŠ¡å’Œ gateway æœåŠ¡&lt;/p&gt;
&lt;p&gt;éšä¾¿è®¿é—®ä¸€ä¸ª uriï¼š&lt;a href=&#34;http://localhost:8088/order/101&#34;&gt;http://localhost:8088/order/101&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ç„¶åæŸ¥çœ‹ Sentinel æ§åˆ¶å°ä¸­çš„è”Ÿç‚¹é“¾è·¯&lt;/p&gt;
&lt;p&gt;ç„¶åæˆ‘ä»¬å°±å¯ä»¥ç»™ /order/{orderId} é…ç½®æˆæƒè§„åˆ™ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171605527.png&#34; alt=&#34;image-20231017160506456&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171605725.png&#34; alt=&#34;image-20231017160532751&#34;&gt;&lt;/p&gt;
&lt;p&gt;æ­¤æ—¶æˆ‘ä»¬å†å»è®¿é—® order/101 æœåŠ¡&lt;/p&gt;
&lt;p&gt;æ³¨æ„ï¼šè¿™é‡Œ order/101 æ˜¯ç»•è¿‡äº†ç½‘å…³çš„&lt;/p&gt;
&lt;p&gt;è®¿é—®æ˜¯ä¸æˆåŠŸçš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171605535.png&#34; alt=&#34;image-20231017160543084&#34;&gt;&lt;/p&gt;
&lt;p&gt;é‚£æˆ‘ä»¬ä½¿ç”¨ç½‘å…³è¿›è¡Œè®¿é—®çš„&lt;/p&gt;
&lt;p&gt;å¯ä»¥æ­£å¸¸è®¿é—®&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171606887.png&#34; alt=&#34;image-20231017160611726&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ç”±äºä¸Šé¢ç›´æ¥è·³è¿‡ç½‘å…³è®¿é—® order/101 çš„æ—¶å€™å°±ä¼šæŠ¥é”™ï¼Œé¡µé¢çš„æŠ¥é”™æç¤ºå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;è¯´æ˜¯é™æµå¼‚å¸¸è¿™å°±ä¸åˆç†äº†ï¼Œæ˜æ˜æ˜¯æˆæƒå¼‚å¸¸æ€ä¹ˆå°±é™æµå¼‚å¸¸äº†å‘¢&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171609433.png&#34; alt=&#34;image-20231017160543084&#34;&gt;&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¯¹å…¶è¿›è¡Œè‡ªå®šä¹‰å¼‚å¸¸ï¼š&lt;/p&gt;
&lt;h3 id=&#34;172-è‡ªå®šä¹‰å¼‚å¸¸ç»“æœ&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#172-è‡ªå®šä¹‰å¼‚å¸¸ç»“æœ&#34;&gt;#&lt;/a&gt; 1.7.2ã€è‡ªå®šä¹‰å¼‚å¸¸ç»“æœğŸŒ²&lt;/h3&gt;
&lt;p&gt;é»˜è®¤æƒ…å†µä¸‹ï¼Œå‘ç”Ÿé™æµï¼Œé™çº§ï¼Œæˆæƒæ‹¦æˆªæ—¶ï¼Œéƒ½ä¼šæŠ›å‡ºå¼‚å¸¸åˆ°è°ƒç”¨æ–¹ã€‚å¦‚æœè¦è‡ªå®šä¹‰å¼‚å¸¸æ—¶çš„è¿”å›ç»“æœï¼Œéœ€è¦å®ç° BlockExceptionHanlder æ¥å£ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;interface&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;BlockExcpetionHandler&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;/**&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   * å¤„ç†è¯·æ±‚è¢«é™æµï¼Œé™çº§ï¼Œæˆæƒæ‹¦æˆªæ—¶æŠ›å‡ºçš„å¼‚å¸¸ï¼šBlockException&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   */&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;handle&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;HttpServletRequest&lt;/span&gt; request&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;HttpServletResponse&lt;/span&gt; response&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;BlockExcpetion&lt;/span&gt; e&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;throws&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Exception&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;è€Œ BlockException åŒ…å«å¾ˆå¤šä¸ªå­ç±»ï¼Œåˆ†åˆ«å¯¹åº”ä¸åŒçš„åœºæ™¯ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;å¼‚å¸¸&lt;/th&gt;
&lt;th&gt;è¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;FlowException&lt;/td&gt;
&lt;td&gt;é™æµå¼‚å¸¸&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ParamFlowException&lt;/td&gt;
&lt;td&gt;çƒ­ç‚¹å‚æ•°é™æµçš„å¼‚å¸¸&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;DegradeException&lt;/td&gt;
&lt;td&gt;é™çº§å¼‚å¸¸&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;AuthorityException&lt;/td&gt;
&lt;td&gt;æˆæƒè§„åˆ™å¼‚å¸¸&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;SystemBlockException&lt;/td&gt;
&lt;td&gt;ç³»ç»Ÿè§„åˆ™å¼‚å¸¸&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;æˆ‘ä»¬åœ¨ order-service ä¸­å®šä¹‰ç±»ï¼Œå®ç° BlockExceptionHandler æ¥å£ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@Component&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;SentinelBlockHandler&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;implements&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;BlockExceptionHandler&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@Override&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;handle&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;HttpServletRequest&lt;/span&gt; httpServletRequest&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;HttpServletResponse&lt;/span&gt; response&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;BlockException&lt;/span&gt; e&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;throws&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Exception&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token class-name&#34;&gt;String&lt;/span&gt; msg &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;æœªçŸ¥å¼‚å¸¸&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;int&lt;/span&gt; status &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;429&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;e &lt;span class=&#34;token keyword&#34;&gt;instanceof&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;FlowException&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            msg &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;è¯·æ±‚è¢«é™æµäº† !&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;e &lt;span class=&#34;token keyword&#34;&gt;instanceof&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;DegradeException&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            msg &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;è¯·æ±‚è¢«é™çº§äº† !&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;e &lt;span class=&#34;token keyword&#34;&gt;instanceof&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;ParamFlowException&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            msg &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;çƒ­ç‚¹å‚æ•°é™æµ !&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;e &lt;span class=&#34;token keyword&#34;&gt;instanceof&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;AuthorityException&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            msg &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;è¯·æ±‚æ²¡æœ‰æƒé™ !&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            status &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;401&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;21&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        response&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;setContentType&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;application/json;charset=utf-8&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;22&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        response&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;setStatus&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;status&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;23&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        response&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;getWriter&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;&amp;#123;\&#34;message\&#34;: \&#34;&#34;&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; msg &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;\&#34;,\&#34;status\&#34;: &#34;&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; status &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;&amp;#125;&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;24&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;25&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;é‡å¯ orderservice æœåŠ¡ï¼Œç„¶åè®¿é—®ä¸€ä¸‹ order/101ã€‚å†å» Sentinel æ§åˆ¶å°æŸ¥çœ‹è”Ÿç‚¹é“¾è·¯å¹¶æ·»åŠ æˆæƒè§„åˆ™ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171629649.png&#34; alt=&#34;image-20231017162948414&#34;&gt;&lt;/p&gt;
&lt;p&gt;ç„¶åå†å¯¹ order/101 è¿›è¡Œç›´æ¥è®¿é—®&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°è‡ªå®šä¹‰å¼‚å¸¸æˆåŠŸäº†ï¼&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171630717.png&#34; alt=&#34;image-20231017163007309&#34;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;æ€»ç»“&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;è·å–è¯·æ±‚æ¥æºçš„æ¥å£æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;RequestOriginParser&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¤„ç† BlockException çš„æ¥å£æ˜¯ä»€ä¹ˆ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;BlockExcpetionHandler&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;18-è§„åˆ™æŒä¹…åŒ–&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#18-è§„åˆ™æŒä¹…åŒ–&#34;&gt;#&lt;/a&gt; 1.8ã€è§„åˆ™æŒä¹…åŒ–ğŸŒ³&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;è§„åˆ™ç®¡ç†æ¨¡å¼&lt;/li&gt;
&lt;li&gt;å®ç° push æ¨¡å¼&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Sentinel çš„æ§åˆ¶å°è§„åˆ™ç®¡ç†æœ‰ä¸‰ç§æ¨¡å¼ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åŸå§‹æ¨¡å¼ï¼šSentinel çš„é»˜è®¤æ¨¡å¼ï¼Œå°†è§„åˆ™ä¿å­˜åœ¨å†…å­˜ï¼Œé‡å¯æœåŠ¡ä¼šä¸¢å¤±ã€‚&lt;/li&gt;
&lt;li&gt;pull æ¨¡å¼&lt;/li&gt;
&lt;li&gt;push æ¨¡å¼&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;181-è§„åˆ™ç®¡ç†æ¨¡å¼-pullæ¨¡å¼&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#181-è§„åˆ™ç®¡ç†æ¨¡å¼-pullæ¨¡å¼&#34;&gt;#&lt;/a&gt; 1.8.1ã€è§„åˆ™ç®¡ç†æ¨¡å¼ - pull æ¨¡å¼ğŸŒ²&lt;/h3&gt;
&lt;p&gt;pull æ¨¡å¼ï¼šæ§åˆ¶å°å°†é…ç½®çš„è§„åˆ™æ¨é€åˆ° Sentinel å®¢æˆ·ç«¯ï¼Œè€Œå®¢æˆ·ç«¯ä¼šå°†é…ç½®è§„åˆ™ä¿å­˜åœ¨æœ¬åœ°æ–‡ä»¶æˆ–æ•°æ®åº“ä¸­ã€‚ä»¥åä¼šå®šæ—¶å»æœ¬åœ°æ–‡ä»¶æˆ–æ•°æ®åº“ä¸­æŸ¥è¯¢ï¼Œæ›´æ–°æœ¬åœ°è§„åˆ™ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171635037.png&#34; alt=&#34;image-20231017163548813&#34;&gt;&lt;/p&gt;
&lt;p&gt;ç¼ºç‚¹ï¼šå­˜åœ¨æ—¶æ•ˆæ€§é—®é¢˜ï¼Œä»è€Œå¯¼è‡´æ•°æ®çš„ä¸ä¸€è‡´é—®é¢˜&lt;/p&gt;
&lt;h3 id=&#34;182-è§„åˆ™ç®¡ç†æ¨¡å¼-pushæ¨¡å¼&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#182-è§„åˆ™ç®¡ç†æ¨¡å¼-pushæ¨¡å¼&#34;&gt;#&lt;/a&gt; 1.8.2ã€è§„åˆ™ç®¡ç†æ¨¡å¼ - push æ¨¡å¼ğŸŒ²&lt;/h3&gt;
&lt;p&gt;push æ¨¡å¼ï¼šæ§åˆ¶å°å°†é…ç½®è§„åˆ™æ¨é€åˆ°è¿œç¨‹é…ç½®ä¸­å¿ƒï¼Œä¾‹å¦‚ Nacosã€‚Sentinel å®¢æˆ·ç«¯ç›‘å¬ Nacosï¼Œè·å–é…ç½®å˜æ›´çš„æ¨é€æ¶ˆæ¯ï¼Œå®Œæˆæœ¬åœ°é…ç½®æ›´æ–°&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171639844.png&#34; alt=&#34;image-20231017163912849&#34;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;æ€»ç»“&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;Sentinel çš„ä¸‰ç§é…ç½®ç®¡ç†æ¨¡å¼æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;åŸå§‹æ¨¡å¼ï¼šä¿å­˜åœ¨å†…å­˜&lt;/p&gt;
&lt;p&gt;ä¸æ”¯æŒæŒä¹…åŒ–&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;pull æ¨¡å¼ï¼šä¿å­˜åœ¨æœ¬åœ°æ–‡ä»¶æˆ–æ•°æ®åº“ï¼Œå®šæ—¶å»è¯»å–&lt;/p&gt;
&lt;p&gt;å®šæ—¶è½®è¯¢å­˜åœ¨æ—¶æ•ˆæ€§é—®é¢˜ï¼Œå¯¼è‡´æ•°æ®ä¸ä¸€è‡´&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;push æ¨¡å¼ï¼šä¿å­˜åœ¨ Nacosï¼Œç›‘å¬å˜æ›´å®æ—¶æ›´æ–°&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;183-å®ç°pushæ¨¡å¼&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#183-å®ç°pushæ¨¡å¼&#34;&gt;#&lt;/a&gt; 1.8.3ã€å®ç° push æ¨¡å¼ğŸŒ²&lt;/h3&gt;
&lt;p&gt;push æ¨¡å¼å®ç°æœ€ä¸ºå¤æ‚ï¼Œä¾èµ–äº Nacosï¼Œå¹¶ä¸”éœ€è¦ä¿®æ”¹ Sentinel æ§åˆ¶å°æºç ã€‚&lt;/p&gt;
&lt;p&gt;è¯¦ç»†æ­¥éª¤å¯ä»¥å‚è€ƒæ–‡ç« &lt;a href=&#34;../sentinel%E6%8C%81%E4%B9%85%E5%8C%96/sentinel%E8%A7%84%E5%88%99%E6%8C%81%E4%B9%85%E5%8C%96.md&#34;&gt; sentinel è§„åˆ™æŒä¹…åŒ–&lt;/a&gt;.&lt;/p&gt;
&lt;h1 id=&#34;äºŒ-åˆ†å¸ƒå¼äº‹åŠ¡&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#äºŒ-åˆ†å¸ƒå¼äº‹åŠ¡&#34;&gt;#&lt;/a&gt; äºŒã€åˆ†å¸ƒå¼äº‹åŠ¡ğŸ„&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;seata&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;äº‹åŠ¡çš„ ACID åŸåˆ™&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171718973.png&#34; alt=&#34;image-20231017171810630&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;21-åˆ†å¸ƒå¼æœåŠ¡æ¡ˆä¾‹&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#21-åˆ†å¸ƒå¼æœåŠ¡æ¡ˆä¾‹&#34;&gt;#&lt;/a&gt; 2.1ã€åˆ†å¸ƒå¼æœåŠ¡æ¡ˆä¾‹ğŸŒ³&lt;/h2&gt;
&lt;p&gt;å¾®æœåŠ¡ä¸‹å•ä¸šåŠ¡ï¼Œåœ¨ä¸‹å•æ—¶ä¼šè°ƒç”¨è®¢å•æœåŠ¡ï¼Œåˆ›å»ºè®¢å•å¹¶å†™å…¥æ•°æ®åº“ã€‚ç„¶åè®¢å•æœåŠ¡è°ƒç”¨è´¦æˆ·æœåŠ¡å’Œåº“å­˜æœåŠ¡ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è´¦æˆ·æœåŠ¡è´Ÿè´£æ‰£å‡ç”¨æˆ·ä½™é¢&lt;/li&gt;
&lt;li&gt;åº“å­˜æœåŠ¡è´Ÿè´£æ‰£å‡å•†å“åº“å­˜&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ¯”æ–¹è¯´ä»¥ä¸‹å¾®æœåŠ¡ï¼šé‡Œé¢åŒ…å«ä¸‰ä¸ªæœåŠ¡ è®¢å•æœåŠ¡ï¼Œè´¦æˆ·æœåŠ¡ï¼Œåº“å­˜æœåŠ¡ã€‚ç°åœ¨æœ‰ä¸€ä¸ªç”¨æˆ·ä¸‹å•çš„ä¸šåŠ¡ï¼Œç”¨æˆ·ä¸‹å•æ—¶æˆ‘å¸Œæœ›è®¢å•æœåŠ¡å»åˆ›å»ºè®¢å•å¹¶ä¸”å†™å…¥æ•°æ®åº“ï¼Œè€Œåå®ƒå†å»è°ƒç”¨è´¦æˆ·æœåŠ¡å’Œåº“å­˜æœåŠ¡ã€‚è´¦æˆ·æœåŠ¡å»æ‰£å‡ç”¨æˆ·çš„ä½™é¢ï¼Œè€Œåº“å­˜æœåŠ¡åˆ™å»æ‰£å‡å•†å“åº“å­˜ã€‚é‡Œé¢å°±åŒ…å«äº†ä¸‰ä¸ªä¸åŒçš„å¾®æœåŠ¡è°ƒç”¨ï¼Œè€Œæ¯ä¸ªå¾®æœåŠ¡éƒ½æœ‰è‡ªå·±ç‹¬ç«‹çš„æ•°æ®åº“ï¼Œä¹Ÿå°±æ˜¯ç‹¬ç«‹çš„äº‹åŠ¡ã€‚æœ€ç»ˆå¸Œæœ›çš„è‚¯å®šæ˜¯ä¸‹å•ä¸šåŠ¡ä¸€æ—¦æ‰§è¡Œæ¯ä¸€ä¸ªæœåŠ¡éƒ½è¦æˆåŠŸï¼Œå¦‚æœå¤±è´¥éƒ½å¤±è´¥ã€‚ä½†æ˜¯èƒ½ä¸èƒ½è¾¾åˆ°è¿™æ ·çš„ç»“æœå‘¢ä¸‹é¢è¿›è¡ŒéªŒè¯&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171720793.png&#34; alt=&#34;image-20231017172030706&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;22-æ¼”ç¤ºåˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#22-æ¼”ç¤ºåˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜&#34;&gt;#&lt;/a&gt; 2.2ã€æ¼”ç¤ºåˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜ ğŸŒ³&lt;/h2&gt;
&lt;p&gt;åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸‹ï¼Œä¸€ä¸ªä¸šåŠ¡è·¨è¶Šå¤šä¸ªæœåŠ¡æˆ–æ•°æ®æºï¼Œæ¯ä¸ªæœåŠ¡éƒ½æ˜¯ä¸€ä¸ªåˆ†æ”¯äº‹åŠ¡ï¼Œè¦ä¿è¯æ‰€æœ‰åˆ†æ”¯äº‹åŠ¡æœ€ç»ˆçŠ¶æ€ä¸€è‡´è¿™æ ·çš„äº‹åŠ¡å°±æ˜¯&lt;font color=&#39;red&#39;&gt;åˆ†å¸ƒå¼äº‹åŠ¡&lt;/font&gt;.&lt;/p&gt;
&lt;p&gt;1ã€å¯¼å…¥å¾®æœåŠ¡é¡¹ç›®ï¼š&lt;a href=&#34;https://gitee.com/doukaixin/typora.git&#34;&gt;https://gitee.com/doukaixin/typora.git&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171737590.png&#34; alt=&#34;image-20231017173700559&#34;&gt;&lt;/p&gt;
&lt;p&gt;2ã€åˆ›å»ºæ•°æ®åº“ï¼Œåä¸º seata_demoï¼Œç„¶åå¯¼å…¥ SQL æ–‡ä»¶ï¼Œæ”¹ SQL æ–‡ä»¶åœ¨ seata-demo é¡¹ç›®ä¸­çš„ SQL æ–‡ä»¶å¤¹ä¸­&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171737039.png&#34; alt=&#34;image-20231017173733114&#34;&gt;&lt;/p&gt;
&lt;p&gt;3ã€å¯åŠ¨ nacosï¼Œæ‰€æœ‰å¾®æœåŠ¡&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171955624.png&#34; alt=&#34;image-20231017195536248&#34;&gt;&lt;/p&gt;
&lt;p&gt;4ã€æµ‹è¯•ä¸‹å•åŠŸèƒ½ï¼Œå‘é€ Post è¯·æ±‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171956965.png&#34; alt=&#34;image-20231017195605740&#34;&gt;&lt;/p&gt;
&lt;p&gt;å‘é€è¯·æ±‚åæŸ¥çœ‹æ•°æ®åº“&lt;/p&gt;
&lt;p&gt;è´¦æˆ·è¡¨&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171956775.png&#34; alt=&#34;image-20231017195643886&#34;&gt;&lt;/p&gt;
&lt;p&gt;åº“å­˜è¡¨&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171957799.png&#34; alt=&#34;image-20231017195701407&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥å‘ç°ï¼Œè´¦æˆ·ä½™é¢æ‰£äº† 200 å˜æˆäº† 800ï¼Œè€Œåº“å­˜æ‰£äº† 2 å˜æˆäº† 8&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆæˆ‘ä»¬è®©æ‰£é™¤åº“å­˜çš„æ—¶å€™æŠ¥é”™çœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨åº“å­˜ä¸å¤Ÿ 10 ä¸ªäº†æˆ‘è¯·æ±‚æ‰£ 10 ä¸ªå°±ä¼šå‘ç”ŸæŠ¥é”™ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171958176.png&#34; alt=&#34;image-20231017195804119&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°å“åº”ç»“æœ 500 äº†&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171958776.png&#34; alt=&#34;image-20231017195845362&#34;&gt;&lt;/p&gt;
&lt;p&gt;æ­¤æ—¶æˆ‘ä»¬å†æŸ¥çœ‹æ•°æ®åº“çš„æƒ…å†µ&lt;/p&gt;
&lt;p&gt;è´¦æˆ·è¡¨&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171959625.png&#34; alt=&#34;image-20231017195918162&#34;&gt;&lt;/p&gt;
&lt;p&gt;åº“å­˜è¡¨&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310171959448.png&#34; alt=&#34;image-20231017195930412&#34;&gt;&lt;/p&gt;
&lt;p&gt;è´¦æˆ·è¡¨çš„ä½™é¢è¢«æ‰£äº† 200ï¼Œä½†æ˜¯åº“å­˜è¡¨çš„æ•°é‡å´æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œè¿™æ ·æ˜¾ç„¶æ˜¯ä¸åˆç†çš„ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢æˆ‘ä»¬æ¥åˆ†æä¸‹è¿™ä»¶äº‹å„¿ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ä¸Šé¢çš„ä¸šåŠ¡ä¸­ï¼Œè®¢å•æœåŠ¡å»åˆ›å»ºäº†è®¢å•ç„¶åå»è°ƒç”¨äº†è´¦æˆ·æœåŠ¡å’Œåº“å­˜æœåŠ¡å®Œæˆä½™é¢æ‰£å‡å’Œåº“å­˜æ‰£å‡ï¼Œå…¶ä¸­è®¢å•æœåŠ¡å’Œè´¦æˆ·æœåŠ¡éƒ½åˆ›å»ºæˆåŠŸäº†ã€‚è€Œåº“å­˜æœåŠ¡åœ¨æ‰§è¡Œçš„æ—¶å€™å´å› ä¸ºåº“å­˜ä¸è¶³è€Œå¤±è´¥äº†ã€‚é‚£æŒ‰ç…§ç†è®ºä¸Šè®²è¿™é‡ŒæŠ¥é”™å‰é¢éƒ½åº”è¯¥è·Ÿç€å›æ»š&lt;/p&gt;
&lt;p&gt;åŸå› ï¼š&lt;/p&gt;
&lt;p&gt;1ã€æ¯ä¸ªæœåŠ¡éƒ½æ˜¯ç‹¬ç«‹çš„åº“å­˜æœåŠ¡æŠ›å‡ºå¼‚å¸¸å…¶å®ƒæœåŠ¡ä¹Ÿä¸çŸ¥é“&lt;/p&gt;
&lt;p&gt;2ã€æ¯ä¸ªæœåŠ¡éƒ½æ˜¯ç‹¬ç«‹çš„æ‰€ä»¥å®ƒä»¬çš„äº‹åŠ¡ä¹Ÿæ˜¯ç‹¬ç«‹çš„&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310172023838.png&#34; alt=&#34;image-20231017202319388&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœè¦è§£å†³åˆ†å¸ƒå¼äº‹åŠ¡çš„é—®é¢˜ï¼Œé¦–å…ˆè¦è€ƒè™‘å››ç‚¹ï¼š&lt;/p&gt;
&lt;p&gt;é¦–å…ˆç¬¬ä¸€ç‚¹ï¼šåˆ†å¸ƒå¼äº‹åŠ¡äº§ç”Ÿçš„åŸå› ï¼Œè¿™ä¸ªä¸Šè¿°åˆ†æè¿‡äº†ã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬äºŒç‚¹ï¼šç†è§£ç†è®ºåŸºç¡€&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸‰ç‚¹ï¼šå¼„æ¸… seata åŸç†&lt;/p&gt;
&lt;p&gt;ç¬¬å››ç‚¹ï¼šåˆ©ç”¨ seata æ‰‹åŠ¨å®è·µï¼Œè§£å†³åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310172032081.png&#34; alt=&#34;image-20231017203228913&#34;&gt;&lt;/p&gt;
&lt;p&gt;å­¦ä¹ å†…å®¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç†è®ºåŸºç¡€&lt;/li&gt;
&lt;li&gt;åˆå§‹ Seata&lt;/li&gt;
&lt;li&gt;æ‰‹åŠ¨å®è·µ&lt;/li&gt;
&lt;li&gt;é«˜å¯ç”¨&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;23-ç†è®ºåŸºç¡€&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#23-ç†è®ºåŸºç¡€&#34;&gt;#&lt;/a&gt; 2.3ã€ç†è®ºåŸºç¡€ğŸŒ³&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;CAP å®šç†&lt;/li&gt;
&lt;li&gt;BASE ç†è®º&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;231-capå®šç†&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#231-capå®šç†&#34;&gt;#&lt;/a&gt; 2.3.1ã€CAP å®šç†ğŸŒ²&lt;/h3&gt;
&lt;p&gt;1998 å¹´ï¼ŒåŠ å·å¤§å­¦çš„è®¡ç®—æœºç§‘å­¦ Eric Brewer æå‡ºï¼Œåˆ†å¸ƒå¼ç³»ç»Ÿæœ‰ä¸‰ä¸ªæŒ‡æ ‡ï¼š&lt;/p&gt;
&lt;p&gt;1ã€Consistency (ä¸€è‡´æ€§)&lt;/p&gt;
&lt;p&gt;2ã€Availability (å¯ç”¨æ€§)&lt;/p&gt;
&lt;p&gt;3ã€Partition tolerance (åˆ†åŒºå®¹é”™æ€§)&lt;/p&gt;
&lt;p&gt;Eric Brewer è¯´ï¼Œåˆ†å¸ƒå¼ç³»ç»Ÿæ— æ³•åŒæ—¶æ»¡è¶³è¿™ä¸‰ä¸ªæŒ‡æ ‡ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªç»“è®ºå°±å«åš CAP å®šç†ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‰ä¸ªåœ†ä¸ä¼šåŒæ—¶é‡å ï¼Œæœ€å¤šä¸¤ä¸¤é‡å ï¼Œä¹Ÿå°±æ˜¯è¯´åŒæ—¶æ»¡è¶³ä¸¤ä¸ª&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310172037268.png&#34; alt=&#34;image-20231017203753986&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;2311-capå®šç†-consistency&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2311-capå®šç†-consistency&#34;&gt;#&lt;/a&gt; 2.3.1.1ã€CAP å®šç† - ConsistencyğŸŒ´&lt;/h4&gt;
&lt;p&gt;Consistency (ä¸€è‡´æ€§) ï¼šç”¨æˆ·è®¿é—®åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„ä»»æ„èŠ‚ç‚¹ï¼Œå¾—åˆ°çš„æ•°æ®å¿…é¡»ä¸€è‡´&lt;/p&gt;
&lt;p&gt;æ¯”æ–¹è¯´æœ‰ä¸¤ä¸ªèŠ‚ç‚¹ï¼Œç¬¬ä¸€ä¸ªèŠ‚ç‚¹ä¸Šæœ‰ä¸ªæ•°æ®å« data å€¼ä¸º 0ï¼Œç¬¬äºŒä¸ªèŠ‚ç‚¹ä¹Ÿæ˜¯å¦‚æ­¤ã€‚ç°åœ¨ç”¨æˆ·ä¸ç®¡æ˜¯è®¿é—®å“ªä¸ªèŠ‚ç‚¹ï¼Œç»“æœéƒ½æ˜¯ä¸€æ ·çš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310172043065.png&#34; alt=&#34;image-20231017204312228&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ï¼Œå¦‚æœæˆ‘å¯¹èŠ‚ç‚¹ node1 çš„æ•°æ®è¿›è¡Œäº†ä¿®æ”¹ï¼Œè¿™æ—¶ä¸¤ä¸ªèŠ‚ç‚¹çš„æ•°æ®å°±ä¸ä¸€æ ·äº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310172044702.png&#34; alt=&#34;image-20231017204437374&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä¸ºäº†æ»¡è¶³ä¸€è‡´æ€§å°±ä¸€å®šè¦æŠŠ node1 çš„æ•°æ®åŒæ­¥åˆ° node2 ä¸­ï¼Œä¸€æ—¦æ•°æ®åŒæ­¥å®Œæˆï¼Œæ•°æ®å°±å†æ­¤ä¸€è‡´äº†&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310172044179.png&#34; alt=&#34;image-20231017204454104&#34;&gt;&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œä½œä¸ºä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿåœ¨åšæ•°æ®å¤‡ä»½çš„æ—¶å€™ä¸€å®šè¦åŠæ—¶å®Œæˆæ•°æ®åŒæ­¥è¿™æ ·æ‰èƒ½æ»¡è¶³ä¸€è‡´æ€§&lt;/p&gt;
&lt;h4 id=&#34;2312-capå®šç†-availability&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2312-capå®šç†-availability&#34;&gt;#&lt;/a&gt; 2.3.1.2ã€CAP å®šç† - AvailabilityğŸŒ´&lt;/h4&gt;
&lt;p&gt;Availability (å¯ç”¨æ€§) ï¼šç”¨æˆ·è®¿é—®é›†ç¾¤ä¸­çš„ä»»æ„å¥åº·èŠ‚ç‚¹ï¼Œå¿…é¡»èƒ½å¾—åˆ°å“åº”ï¼Œè€Œä¸æ˜¯è¶…æ—¶æˆ–æ‹’ç»&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚è¯´ node3 çš„è¯·æ±‚è¢«é˜»å¡æˆ–è€…æ‹’ç»äº†ï¼Œé‚£æ‰€æœ‰çš„è¯·æ±‚è¿›æ¥æ— æ³•è®¿é—®äº†ï¼Œè¿™æ—¶ node3 å°±æ˜¯ä¸å¯ç”¨äº†&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥å¯ç”¨æ€§æ˜¯æŒ‡è¿™ä¸ªèŠ‚ç‚¹èƒ½ä¸èƒ½è¢«æ­£å¸¸çš„è®¿é—®&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310172048465.png&#34; alt=&#34;image-20231017204818409&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;2313-capå®šç†-partition-tolerance&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2313-capå®šç†-partition-tolerance&#34;&gt;#&lt;/a&gt; 2.3.1.3ã€CAP å®šç† - Partition toleranceğŸŒ´&lt;/h4&gt;
&lt;p&gt;Partition (åˆ†åŒº) ï¼šå› ä¸ºç½‘ç»œæ•…éšœæˆ–å…¶å®ƒåŸå› å¯¼è‡´åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„éƒ¨åˆ†èŠ‚ç‚¹ä¸å…¶å®ƒèŠ‚ç‚¹å¤±å»è¿æ¥ï¼Œå½¢æˆç‹¬ç«‹åˆ†åŒºã€‚&lt;/p&gt;
&lt;p&gt;Tolerance (å®¹é”™) ï¼šåœ¨é›†ç¾¤å‡ºç°åˆ†åŒºæ—¶ï¼Œæ•´ä¸ªç³»ç»Ÿä¹Ÿè¦æŒç»­å¯¹å¤–æä¾›æœåŠ¡&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚è¯´ node3 å› ä¸ºç½‘ç»œæ•…éšœä¸ node1 ä¸ node2 æ–­å¼€äº†è¿æ¥ã€‚node1 ä¸ node2 ä¹‹é—´æ­£å¸¸è®¿é—®ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310172052718.png&#34; alt=&#34;image-20231017205201677&#34;&gt;&lt;/p&gt;
&lt;p&gt;æ­¤æ—¶æ•´ä¸ªé›†ç¾¤å°±ä¼šè¢«åˆ’åˆ†æˆä¸¤ä¸ªåŒºäº†ã€‚node1 å’Œ node2 å®ƒä¿©æ˜¯ä¸€ä¸ªåŒºï¼Œnode3 è‡ªå·±æ˜¯ä¸€ä¸ªåŒºï¼Œè¿™æ—¶å¦‚æœæœ‰ç”¨æˆ·å‘ node2 å†™å…¥äº†ä¸€ä¸ªæ•°æ®ï¼Œnode2 å¯ä»¥æŠŠæ•°æ®åŒæ­¥ç»™ node1 çš„ä½†æ˜¯ node3 ä¸Šä¸èƒ½åŒæ­¥åˆ°æ•°æ®ï¼Œå› æ­¤è¿™ä¸¤ä¸ªåŒºçš„æ•°æ®å°±ä¸ä¸€è‡´äº†&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310172055775.png&#34; alt=&#34;image-20231017205544452&#34;&gt;&lt;/p&gt;
&lt;p&gt;é‚£å¦‚æœæˆ‘ä¸€å®šè¦æ»¡è¶³æ•°æ®çš„ä¸€è‡´æ€§å‘¢ï¼Œé‚£æˆ‘æ˜¯ä¸æ˜¯å¯ä»¥è®© node3 ç­‰å¾… node2 ç½‘ç»œçš„æ¢å¤å’Œæ•°æ®çš„åŒæ­¥ï¼Œåœ¨æ¢å¤ä¹‹å‰æ‰€æœ‰æ¥è®¿é—®æˆ‘çš„è¯·æ±‚æˆ‘éƒ½é˜»å¡åœ¨è¿™é‡Œã€‚å¦‚æœè¿™ä¹ˆåšå¯èƒ½ä¼šæ»¡è¶³æ•°æ®çš„ä¸€è‡´æ€§ï¼Œä½†æ˜¯ node3 æ˜æ˜æ˜¯ä¸€ä¸ªå¥åº·çš„èŠ‚ç‚¹ç»“æœè¿›æ¥çš„è¯·æ±‚ä½ éƒ½å¡åœ¨è¿™é‡Œä¸è®©äººå®¶è®¿é—®ï¼Œé‚£ node3 ä¸å°±æ˜¯ä¸å¯ç”¨äº†å—ï¼Œæ‰€ä»¥å®ƒå°±ä¸æ»¡è¶³ å¯ç”¨æ€§äº†ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘è¦æƒ³æ»¡è¶³å¯ç”¨æ€§ï¼Œæˆ‘å°±æ²¡åŠæ³•ä¿è¯ä¸€è‡´æ€§ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘è¦ä¿è¯æ•°æ®ä¸€è‡´æ€§ï¼Œæˆ‘å°±æ²¡åŠæ³•è®© node3 æ˜¯å¯ç”¨æ€§çš„&lt;/p&gt;
&lt;p&gt;å½“ç½‘ç»œå‡ºç°åˆ†åŒºæ—¶ï¼Œå¯ç”¨æ€§å’Œä¸€è‡´æ€§æ²¡æœ‰åŠæ³•åŒæ—¶æ»¡è¶³ã€‚ä½†æ˜¯ç½‘ç»œåˆ†åŒºä¹Ÿæ˜¯ä¸å¯é¿å…çš„ã€‚&lt;/p&gt;
&lt;p&gt;å½“ p ä¸€å®šè¦å®ç°ï¼Œé‚£ä¹ˆè¿™æ—¶ c å’Œ a ä¹‹é—´å°±è¦åšå‡ºæŠ‰æ‹©äº†ã€‚è¦ä¹ˆ c è¦ä¹ˆ a æ²¡æœ‰åŠæ³•åŒæ—¶æ»¡è¶³ã€‚è¿™å°±æ˜¯ CAP å®šç†äº†çš„åŸå› äº†&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;æ€»ç»“&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;ç®€è¿° CAP å®šç†å†…å®¹ï¼Ÿ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åˆ†å¸ƒå¼ç³»ç»ŸèŠ‚ç‚¹é€šè¿‡ç½‘ç»œè¿æ¥ï¼Œä¸€å®šä¼šå‡ºç°åˆ†åŒºé—®é¢˜ Â§&lt;/li&gt;
&lt;li&gt;å½“åˆ†åŒºå‡ºç°æ—¶ï¼Œç³»ç»Ÿçš„ä¸€è‡´æ€§ Â© å’Œå¯ç”¨æ€§ (A) å°±æ— æ³•åŒæ—¶æ»¡è¶³&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ€è€ƒï¼šelasticsearch é›†ç¾¤æ˜¯ CP è¿˜æ˜¯ APï¼Ÿ&lt;/p&gt;
&lt;p&gt;ç­”ï¼šES é›†ç¾¤å½“ç½‘ç»œå‡ºç°æ•…éšœæ—¶ï¼Œæœ‰èŠ‚ç‚¹ä¸å…¶å®ƒèŠ‚ç‚¹æ–­å¼€è¿æ¥çš„æ—¶å€™ã€‚es é›†ç¾¤å¤„äºä¸€ä¸ªè­¦å‘ŠçŠ¶æ€ï¼Œå‡ºç°æ•…éšœçš„èŠ‚ç‚¹è¿‡äº†ä¸€æ®µæ—¶é—´åå°±ä¼šä»é›†ç¾¤ä¸­å‰”é™¤ï¼Œè€Œè¿™ä¸ªèŠ‚ç‚¹ä¸ŠåŸæ¥çš„æ•°æ®åˆ†ç‰‡ã€‚ä¼šåˆ†æ•£åˆ°å…¶å®ƒå¥åº·çš„èŠ‚ç‚¹ä¸Šï¼Œè€Œæ•…éšœèŠ‚ç‚¹ä»é›†ç¾¤ä¸­å‰”é™¤ç”¨æˆ·æ— æ³•è®¿é—®äº†å› æ­¤å°±ç‰ºç‰²äº† å¯ç”¨æ€§äº†ã€‚è€Œæ•°æ®ä¼šè´Ÿè´£å…¶å®ƒèŠ‚ç‚¹æ•°æ®åŒæ­¥å¯ä»¥æ­£å¸¸è¿›è¡Œä¿è¯äº†æ•°æ®çš„ä¸€è‡´æ€§ã€‚&lt;/p&gt;
&lt;p&gt;å› æ­¤ es é›†ç¾¤æ˜¾ç„¶æ˜¯ä¸€ä¸ª CPã€‚æ»¡è¶³é«˜ä¸€è‡´æ€§ä½å¯ç”¨æ€§&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æˆ‘ä»¬çŸ¥é“åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸‹ç½‘ç»œåˆ†åŒºæ˜¯ä¸å¯é¿å…çš„ï¼Œæ‰€ä»¥ä¸å¾—ä¸åœ¨ä¸€è‡´æ€§å’Œå¯ç”¨æ€§ä¹‹é—´åšå‡ºä¸€ä¸ªé€‰æ‹©ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯è¿™ä¸¤ä¸ªç‰¹æ€§éƒ½å¾ˆé‡è¦æˆ‘ä¸€ä¸ªéƒ½ä¸æƒ³æ”¾å¼ƒæˆ‘è¯¥æ€ä¹ˆåŠå‘¢ï¼ŸBase ç†è®ºæ­£å¥½å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜&lt;/p&gt;
&lt;h3 id=&#34;232-baseç†è®º&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#232-baseç†è®º&#34;&gt;#&lt;/a&gt; 2.3.2ã€BASE ç†è®ºğŸŒ²&lt;/h3&gt;
&lt;p&gt;BASE ç†è®ºæ˜¯å¯¹ CAP çš„ä¸€ç§è§£å†³æ€è·¯ï¼ŒåŒ…å«ä¸‰ä¸ªæ€æƒ³ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Basically Available (åŸºæœ¬å¯ç”¨)ï¼šåˆ†å¸ƒå¼ç³»ç»Ÿåœ¨å‡ºç°æ•…éšœæ—¶ï¼Œå…è®¸æŸå¤±éƒ¨åˆ†å¯ç”¨æ€§ï¼Œå³ä¿è¯æ ¸å¿ƒå¯ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;Soft State (è½¯çŠ¶æ€)ï¼šåœ¨ä¸€å®šæ—¶é—´å†…ï¼Œå…è®¸å‡ºç°ä¸­é—´çŠ¶æ€ï¼Œæ¯”å¦‚ä¸´æ—¶çš„ä¸ä¸€è‡´çŠ¶æ€ã€‚&lt;/li&gt;
&lt;li&gt;Eventually Consistent (æœ€ç»ˆä¸€è‡´æ€§)ï¼šè™½ç„¶æ— æ³•ä¿è¯å¼ºä¸€è‡´æ€§ï¼Œä½†æ˜¯åœ¨è½¯çŠ¶æ€ç»“æŸåï¼Œæœ€ç»ˆè¾¾åˆ°æ•°æ®ä¸€è‡´ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è€Œåˆ†å¸ƒå¼äº‹åŠ¡æœ€å¤§çš„é—®é¢˜æ˜¯å„ä¸ªå­äº‹åŠ¡çš„ä¸€è‡´æ€§é—®é¢˜ï¼Œå› æ­¤å¯ä»¥å€Ÿç­¾ CAP å®šç†çš„ BASE ç†è®ºï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;AP æ¨¡å¼ï¼šå„å­äº‹åŠ¡åˆ†åˆ«æ‰§è¡Œå’Œæäº¤ï¼Œå…è®¸å‡ºç°ç»“æœä¸ä¸€è‡´ï¼Œç„¶åé‡‡ç”¨å¼¥è¡¥æªæ–½æ¢å¤æ•°æ®å³å¯ï¼Œå®ç°&lt;font color=&#39;red&#39;&gt;æœ€ç»ˆä¸€è‡´&lt;/font&gt;.&lt;/li&gt;
&lt;li&gt;CP æ¨¡å¼ï¼šå„ä¸ªå­äº‹åŠ¡æ‰§è¡Œåäº’ç›¸ç­‰å¾…ï¼ŒåŒæ—¶æäº¤ï¼ŒåŒæ—¶å›æ»šï¼Œè¾¾æˆ&lt;font color=&#39;red&#39;&gt;å¼ºä¸€è‡´&lt;/font&gt;ã€‚ä½†äº‹åŠ¡ç­‰å¾…è¿‡ç¨‹ä¸­ï¼Œå¤„äºå¼±å¯ç”¨çŠ¶æ€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;2321-åˆ†å¸ƒå¼äº‹åŠ¡æ¨¡å‹&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2321-åˆ†å¸ƒå¼äº‹åŠ¡æ¨¡å‹&#34;&gt;#&lt;/a&gt; 2.3.2.1ã€åˆ†å¸ƒå¼äº‹åŠ¡æ¨¡å‹ğŸŒ´&lt;/h4&gt;
&lt;p&gt;è§£å†³åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œå„ä¸ªå­ç³»ç»Ÿä¹‹é—´å¿…é¡»èƒ½æ„ŸçŸ¥åˆ°å½¼æ­¤çš„äº‹åŠ¡çŠ¶æ€ï¼Œæ‰èƒ½ä¿è¯çŠ¶æ€ä¸€è‡´ï¼Œå› æ­¤éœ€è¦ä¸€ä¸ªäº‹åŠ¡åè°ƒè€…æ¥åè°ƒæ¯ä¸€ä¸ªäº‹åŠ¡çš„å‚ä¸è€… (å­ç³»ç»Ÿäº‹åŠ¡)ã€‚&lt;/p&gt;
&lt;p&gt;ç”¨æˆ·ä¸‹å•è°ƒç”¨è®¢å•æœåŠ¡ï¼Œç„¶åå»è°ƒç”¨è´¦æˆ·æœåŠ¡å’Œåº“å­˜æœåŠ¡ã€‚é‚£è¿™ä¸ªåœ°æ–¹æˆ‘ä»¬å°±éœ€è¦ä¸€ä¸ªäº‹åŠ¡çš„åè°ƒè€…äº†ï¼Œæ¯ä¸ªå¾®æœåŠ¡éƒ½è·Ÿäº‹åŠ¡åè°ƒè€…ä¿æŒè”ç³»ï¼Œå¦‚æœä½ ç°åœ¨è¦åšå¼ºä¸€è‡´ã€‚è®¢å•æœåŠ¡æ‰§è¡Œçš„æ—¶å€™ä¸è¦æäº¤ï¼Œæ‰£æ¬¾æœåŠ¡ï¼Œæ‰£åº“å­˜æœåŠ¡ï¼Œä½†æ˜¯åº“å­˜æœåŠ¡æ‰§è¡Œå®Œåå‘ç°å¤±è´¥äº†ã€‚æ€ä¹ˆçŸ¥é“çš„ã€‚å®ƒä»¬è¦æŠŠè‡ªå·±çš„æ‰§è¡Œç»“æœå‘ŠçŸ¥ç»™åè°ƒè€…ï¼Œç„¶ååè°ƒè€…ä¸€çœ‹æœ‰äººå¤±è´¥äº†å°†æ¥å†é€šçŸ¥å…¶å®ƒæœåŠ¡è®©å®ƒä»¬åšå›æ»šï¼Œè¿™æ ·å¤§å®¶å°±èƒ½ä¿æŒä¸€è‡´äº†&lt;/p&gt;
&lt;p&gt;æ¯ä¸€ä¸ªäº‹åŠ¡çš„å‚ä¸è€… (å­ç³»ç»Ÿäº‹åŠ¡)ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œçš„å­ç³»ç»Ÿäº‹åŠ¡ï¼Œç§°ä¸º&lt;font color=&#39;red&#39;&gt; åˆ†æ”¯äº‹åŠ¡&lt;/font&gt;.ï¼›æœ‰å…³è”çš„å„ä¸ªåˆ†æ”¯äº‹åŠ¡ åœ¨ä¸€èµ·ç§°ä¸º &lt;font color=&#39;red&#39;&gt;å…¨å±€äº‹åŠ¡&lt;/font&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310172141933.png&#34; alt=&#34;image-20231017214146879&#34;&gt;&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥äº‹åŠ¡åè°ƒè€…ï¼Œå°±æ˜¯å»åè°ƒå„ä¸ªåˆ†æ”¯äº‹ç‰©çš„çŠ¶æ€è®©å®ƒä»¬è¾¾æˆä¸€è‡´&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;æ€»ç»“&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;ç®€è¿° BASE ç†è®ºä¸‰ä¸ªæ€æƒ³ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åŸºæœ¬å¯ç”¨&lt;/li&gt;
&lt;li&gt;è½¯çŠ¶æ€&lt;/li&gt;
&lt;li&gt;æœ€ç»ˆä¸€è‡´&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è§£å†³åˆ†å¸ƒå¼äº‹åŠ¡çš„æ€æƒ³å’Œæ¨¡å‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å…¨å±€äº‹åŠ¡ï¼šæ•´ä¸ªåˆ†å¸ƒå¼äº‹åŠ¡&lt;/li&gt;
&lt;li&gt;åˆ†æ”¯äº‹åŠ¡ï¼šåˆ†å¸ƒå¼äº‹åŠ¡ä¸­åŒ…å«çš„æ¯ä¸ªå­ç³»ç»Ÿçš„äº‹åŠ¡&lt;/li&gt;
&lt;li&gt;æœ€ç»ˆä¸€è‡´æ€æƒ³ï¼šå„åˆ†æ”¯äº‹åŠ¡åˆ†åˆ«æ‰§è¡Œå¹¶æäº¤ï¼Œå¦‚æœæœ‰ä¸ä¸€è‡´çš„æƒ…å†µï¼Œå†æƒ³åŠæ³•æ¢å¤æ•°æ®&lt;/li&gt;
&lt;li&gt;å¼ºä¸€è‡´æ€æƒ³ï¼šå„åˆ†æ”¯äº‹åŠ¡æ‰§è¡Œå®Œä¸šåŠ¡ä¸è¦æäº¤ï¼Œç­‰å¾…å½¼æ­¤ç»“æœã€‚è€Œåç»Ÿä¸€æäº¤æˆ–å›æ»š&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;24-åˆå§‹seata&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#24-åˆå§‹seata&#34;&gt;#&lt;/a&gt; 2.4ã€åˆå§‹ SeatağŸŒ³&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Seata çš„æ¶æ„&lt;/li&gt;
&lt;li&gt;éƒ¨ç½² TC æœåŠ¡&lt;/li&gt;
&lt;li&gt;å¾®æœåŠ¡é›†æˆ Seata&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Seata æ˜¯ 2019 å¹´ 1 æœˆä»½èš‚èšé‡‘æœå’Œé˜¿é‡Œå·´å·´å…±åŒå¼€æºçš„åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆã€‚è‡´åŠ›äºæä¾›é«˜æ€§èƒ½å’Œç®€å•æ˜“ç”¨çš„åˆ†å¸ƒå¼äº‹åŠ¡æœåŠ¡ï¼Œä¸ºç”¨æˆ·æ‰“é€ ä¸€ç«™å¼çš„åˆ†å¸ƒå¼è§£å†³æ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;å®˜ç½‘åœ°å€ï¼š&lt;a href=&#34;https://seata.io/zh-cn/&#34;&gt;https://seata.io/zh-cn/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Seata äº‹åŠ¡ç®¡ç†ä¸­æœ‰ä¸‰ä¸ªé‡è¦çš„è§’è‰²&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;1ã€TC (Transaction Coordinator) - äº‹åŠ¡åè°ƒè€…ï¼šç»´æŠ¤å…¨å±€å’Œåˆ†å¸ƒå¼äº‹åŠ¡çš„çŠ¶æ€ï¼Œåè°ƒå…¨å±€äº‹åŠ¡æäº¤å’Œå›æ»šã€‚&lt;/p&gt;
&lt;p&gt;2ã€TM (Transaction Manager) - äº‹åŠ¡ç®¡ç†å™¨ï¼šå®šä¹‰å…¨å±€äº‹åŠ¡çš„èŒƒå›´ï¼Œå¼€å§‹å…¨å±€äº‹åŠ¡ï¼Œæäº¤æˆ–å›æ»šå…¨å±€äº‹åŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;3ã€RM (Resource Manager) - èµ„æºç®¡ç†å™¨ï¼šç®¡ç†åˆ†æ”¯äº‹åŠ¡å¤„ç†çš„èµ„æºï¼Œä¸ TC äº¤è°ˆä»¥æ³¨å†Œåˆ†æ”¯äº‹åŠ¡å’ŒæŠ¥å‘Šåˆ†æ”¯äº‹åŠ¡çš„çŠ¶æ€ï¼Œå¹¶é©±åŠ¨åˆ†æ”¯äº‹åŠ¡æäº¤æˆ–å›æ»šã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310180745437.png&#34; alt=&#34;image-20231018074554248&#34;&gt;&lt;/p&gt;
&lt;p&gt;Seata æ ¹æ®è¦åšå¼ºä¸€è‡´è¿˜æ˜¯æœ€ç»ˆä¸€è‡´åˆå»¶ä¼¸å‡ºäº†å¥½å‡ ç§ä¸åŒçš„è§£å†³æ–¹æ¡ˆï¼š&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Seata æä¾›äº†å››ä¸ªä¸åŒçš„åˆ†å¸ƒå¼è§£å†³æ–¹æ¡ˆ&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;1ã€XA æ¨¡å¼ï¼šå¼ºä¸€è‡´æ€§åˆ†é˜¶æ®µäº‹åŠ¡æ¨¡å¼ï¼Œç‰ºç‰²äº†ä¸€å®šçš„å¯ç”¨æ€§ï¼Œæ— ä¸šåŠ¡ä¾µå…¥&lt;/p&gt;
&lt;p&gt;2ã€TCC æ¨¡å¼ï¼šæœ€ç»ˆä¸€è‡´çš„åˆ†é˜¶æ®µäº‹åŠ¡æ¨¡å¼ï¼Œæœ‰ä¸šåŠ¡ä¾µå…¥&lt;/p&gt;
&lt;p&gt;3ã€AT æ¨¡å¼ï¼šæœ€ç»ˆä¸€è‡´çš„åˆ†é˜¶æ®µäº‹åŠ¡æ¨¡å¼ï¼Œæ— ä¸šåŠ¡ä¾µå…¥ï¼Œä¹Ÿæ˜¯ Seata çš„é»˜è®¤æ¨¡å¼&lt;/p&gt;
&lt;p&gt;4ã€SAGA æ¨¡å¼ï¼šé•¿äº‹åŠ¡æ¨¡å¼ï¼Œæœ‰ä¸šåŠ¡ä¾µå…¥&lt;/p&gt;
&lt;h3 id=&#34;241-éƒ¨ç½²tcæœåŠ¡&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#241-éƒ¨ç½²tcæœåŠ¡&#34;&gt;#&lt;/a&gt; 2.4.1ã€éƒ¨ç½² TC æœåŠ¡ğŸŒ²&lt;/h3&gt;
&lt;p&gt;å‚è€ƒæ–‡ç« ï¼š&lt;a href=&#34;../Seata/seata%E7%9A%84%E9%83%A8%E7%BD%B2%E5%92%8C%E9%9B%86%E6%88%90.md&#34;&gt;seata çš„éƒ¨ç½²å’Œé›†æˆ&lt;/a&gt;.&lt;/p&gt;
&lt;h3 id=&#34;242-æ‰‹åŠ¨å®è·µ&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#242-æ‰‹åŠ¨å®è·µ&#34;&gt;#&lt;/a&gt; 2.4.2ã€æ‰‹åŠ¨å®è·µğŸŒ²&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;XA æ¨¡å¼&lt;/li&gt;
&lt;li&gt;AT æ¨¡å¼&lt;/li&gt;
&lt;li&gt;TCC æ¨¡å¼&lt;/li&gt;
&lt;li&gt;SAGA æ¨¡å¼&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;2421-xaæ¨¡å¼åŸç†&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2421-xaæ¨¡å¼åŸç†&#34;&gt;#&lt;/a&gt; 2.4.2.1ã€XA æ¨¡å¼åŸç†ğŸŒ´&lt;/h4&gt;
&lt;p&gt;XA è§„åˆ™ æ˜¯ X/Open ç»„ç»‡å®šä¹‰çš„åˆ†å¸ƒå¼äº‹åŠ¡å¤„ç† (DTPï¼ŒDistributed Transaction Processing) æ ‡å‡†ï¼ŒXA è§„èŒƒ æè¿°äº†å…¨å±€çš„ TM ä¸å±€éƒ¨çš„ RM ä¹‹é—´çš„æ¥å£ï¼Œå‡ ä¹æ‰€æœ‰ä¸»æµçš„æ•°æ®åº“éƒ½å¯¹ XA è§„èŒƒ æä¾›äº†æ”¯æŒã€‚&lt;/p&gt;
&lt;p&gt;è¿™ç§æ¨¡å¼ï¼Œå®ƒæŠŠåˆ†å¸ƒå¼äº‹åŠ¡å®šä¹‰æˆäº†ä¸¤ä¸ªé˜¶æ®µã€‚ç¬¬ä¸€é˜¶æ®µä¸º â€œå‡†å¤‡é˜¶æ®µâ€ åœ¨æ­¤é˜¶æ®µä¸­å®ç‰©åè°ƒè€…ä¼šå‘äº‹åŠ¡å‚ä¸è€… (RM) å»å‘èµ·ä¸€ä¸ªå‡†å¤‡çš„è¯·æ±‚ï¼Œåœ¨ä¸Šé¢è®²è¿°ä¸­ RM æ˜¯èµ„æºç®¡ç†å™¨ï¼Œä½†æ˜¯åœ¨ XA æ ‡å‡†ä¸­è¿™ä¸ª RM å…¶å®éƒ½æ˜¯ç”±æ•°æ®åŒºå®ç°çš„ã€‚ä¹Ÿå°±æ˜¯è¯´æ•°æ®åº“æœ¬èº«å®ç°äº† RM åŠŸèƒ½ã€‚äº‹åŠ¡åè°ƒè€…é€šçŸ¥è¿™äº›æ•°æ®åº“å»æ‰§è¡Œè‡ªå·±çš„ä¸šåŠ¡ï¼Œä½†æ˜¯æ‰§è¡Œå®Œä¸è¦æäº¤ï¼Œç„¶åæŠŠæ‰§è¡Œç»“æœå‘ŠçŸ¥äº‹åŠ¡åè°ƒè€…&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310181016731.png&#34; alt=&#34;Snipaste_2023-10-18_10-16-42&#34;&gt;&lt;/p&gt;
&lt;p&gt;ç„¶åè¿›è¡Œ â€œç¬¬äºŒé˜¶æ®µâ€ äº‹åŠ¡åè°ƒè€…é€šçŸ¥ RM å¯ä»¥æäº¤äº†ã€‚äº‹åŠ¡ç»“æŸ&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310181017816.png&#34; alt=&#34;image-20231018101741714&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœ ç¬¬ä¸€é˜¶æ®µ æœ‰ä»»æ„ä¸€ä¸ªæœåŠ¡å¤±è´¥äº†&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310181018842.png&#34; alt=&#34;image-20231018101839751&#34;&gt;&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆç¬¬äºŒé˜¶æ®µï¼Œäº‹åŠ¡åè°ƒè€…å°±ä¼šé€šçŸ¥æ‰€æœ‰çš„ RM è¿›è¡Œå›æ»š&lt;/p&gt;
&lt;p&gt;XA æ¨¡å¼ï¼Œå…¶å®å°±æ˜¯åŸºäºæ•°æ®åº“æœ¬èº«çš„ç‰¹æ€§å»å®ç°çš„ä¸€ç§åˆ†å¸ƒå¼äº‹åŠ¡&lt;/p&gt;
&lt;h4 id=&#34;2422-seataçš„xaæ¨¡å¼&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2422-seataçš„xaæ¨¡å¼&#34;&gt;#&lt;/a&gt; 2.4.2.2ã€seata çš„ XA æ¨¡å¼ğŸŒ´&lt;/h4&gt;
&lt;p&gt;seata çš„ XA æ¨¡å¼åšäº†ä¸€äº›è°ƒæ•´ï¼Œä½†å¤§ä½“ç›¸ä¼¼ï¼š&lt;/p&gt;
&lt;p&gt;TM æ³¨å†Œå…¨å±€äº‹åŠ¡ï¼ŒTM ä½œä¸ºåˆ†å¸ƒå¼å…¥å£è‡ªç„¶å»è°ƒç”¨å¾®æœåŠ¡ï¼Œè°ƒç”¨å¾®æœåŠ¡é‡Œé¢çš„ RM æ‹¦æˆªè¯·æ±‚ï¼Œseata é‡Œé¢ä¹Ÿå®ç°äº† RMï¼Œæ•°æ®åº“ä¹Ÿæœ‰ RMï¼Œåœ¨è¿™ä¸ªæƒ…å†µä¸‹ seata çš„ RM ä»…ä»…æ˜¯ä»£ç†ä½ çš„è¯·æ±‚ã€‚ç„¶ååšä¸€ä¸‹åˆ†æ”¯äº‹åŠ¡çš„æ³¨å†Œï¼Œæ¥ä¸‹æ¥çš„äº‹å°±æ˜¯ç›´æ¥è°ƒç”¨æ•°æ®åº“äº†æ‰§è¡Œä¸šåŠ¡ SQLï¼Œä½†æ˜¯æ‰§è¡Œå®Œä¸æäº¤ï¼Œå»æŠ¥å‘Šä¸€ä¸‹äº‹åŠ¡çš„çŠ¶æ€åˆ° TC å°±è¡Œäº†ã€‚æ‰€ä»¥ TC æ­¤æ—¶å°±å†²å½“äº†äº‹åŠ¡åè°ƒçš„ä½œç”¨äº†&lt;/p&gt;
&lt;p&gt;è‡³æ­¤ï¼Œç¬¬ä¸€é˜¶æ®µç»“æŸ&lt;/p&gt;
&lt;p&gt;ç¬¬äºŒé˜¶æ®µ TM å‘ç°ä¸šåŠ¡ç»“æŸäº†å°±å»é€šçŸ¥ TCï¼Œç„¶å TC å»æ£€æŸ¥äº‹åŠ¡çš„çŠ¶æ€ï¼Œéƒ½æˆåŠŸå°±æˆåŠŸã€‚æœ‰ä¸€ä¸ªå¤±è´¥å°±è¦å›æ»š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310181126968.png&#34; alt=&#34;image-20231018112632854&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœæˆ‘ä»¬åªçœ‹æ ¸å¿ƒéƒ¨åˆ†å°±å’Œ XA æ²¡æœ‰ä»€ä¹ˆå¤ªå¤§çš„åŒºåˆ«äº†&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;RM ä¸€é˜¶æ®µçš„å·¥ä½œ&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;1ã€æ³¨å†Œåˆ†æ”¯å®ç‰©åˆ° TC&lt;/p&gt;
&lt;p&gt;2ã€æ‰§è¡Œåˆ†æ”¯ä¸šåŠ¡ sql ä½†ä¸æäº¤&lt;/p&gt;
&lt;p&gt;3ã€æŠ¥å‘Šæ‰§è¡ŒçŠ¶æ€åˆ° TC&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;TC äºŒé˜¶æ®µçš„å·¥ä½œ&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;TC æ£€æµ‹å„åˆ†æ”¯äº‹åŠ¡æ‰§è¡ŒçŠ¶æ€
&lt;ul&gt;
&lt;li&gt;å¦‚æœéƒ½æˆåŠŸï¼Œé€šè¿‡æ‰€æœ‰ RM æäº¤äº‹åŠ¡&lt;/li&gt;
&lt;li&gt;å¦‚æœæœ‰å¤±è´¥ï¼Œé€šè¿‡æ‰€æœ‰ RM å›æ»šäº‹åŠ¡&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;RM äºŒé˜¶æ®µçš„å·¥ä½œ&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ¥æ”¶ TC æŒ‡ä»¤ï¼Œæäº¤æˆ–å›æ»šäº‹åŠ¡&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310181128704.png&#34; alt=&#34;image-20231018112758938&#34;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;æ€»ç»“&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;XA æ¨¡å¼çš„ä¼˜ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;äº‹åŠ¡çš„å¼ºä¸€è‡´æ€§ï¼Œæ»¡è¶³ ACID åŸåˆ™&lt;/li&gt;
&lt;li&gt;å¸¸ç”¨æ•°æ®åº“éƒ½æ”¯æŒï¼Œå®ç°ç®€å•ï¼Œå¹¶ä¸”æ²¡æœ‰ä»£ç ä¾µå…¥&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;XA æ¨¡å¼çš„ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å› ä¸ºä¸€é˜¶æ®µéœ€è¦é”å®šæ•°æ®åº“èµ„æºï¼Œç­‰å¾…äºŒé˜¶æ®µç»“æŸæ‰é‡Šæ”¾ï¼Œæ€§èƒ½è¾ƒå·®&lt;/li&gt;
&lt;li&gt;ä¾èµ–å…³ç³»å‹æ•°æ®åº“å®ç°äº‹åŠ¡&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;2423-å®ç°xaæ¨¡å¼&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2423-å®ç°xaæ¨¡å¼&#34;&gt;#&lt;/a&gt; 2.4.2.3ã€å®ç° XA æ¨¡å¼ğŸŒ´&lt;/h4&gt;
&lt;p&gt;Seata çš„ starter å·²ç»å®Œæˆäº† XA æ¨¡å¼çš„è‡ªåŠ¨è£…é…ï¼Œå®ç°éå¸¸ç®€å•ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;1ã€ä¿®æ”¹ application.yml æ–‡ä»¶ (æ¯ä¸ªå‚ä¸äº‹åŠ¡çš„å¾®æœåŠ¡)ï¼Œå¼€å¯ XA æ¨¡å¼&lt;/p&gt;
&lt;figure class=&#34;highlight yml&#34;&gt;&lt;figcaption data-lang=&#34;YAML&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key atrule&#34;&gt;seata&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token key atrule&#34;&gt;data-source-proxy-mode&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; XA &lt;span class=&#34;token comment&#34;&gt;# å¼€å¯æ•°æ®æºä»£ç†çš„ XA æ¨¡å¼&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;2ã€ç»™å‘èµ·å…¨å±€äº‹åŠ¡çš„å…¥å£æ–¹æ³•æ·»åŠ  @GlobalTransactional æ³¨è§£ï¼Œæœ¬ä¾‹ä¸­æ˜¯ OrderServiceImpl ä¸­çš„ create æ–¹æ³•ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@Override&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@GlobalTransactional&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Long&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;create&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;Order&lt;/span&gt; order&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;// åˆ›å»ºè®¢å•&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   orderMapper&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;insert&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;order&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token keyword&#34;&gt;try&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token comment&#34;&gt;// æ‰£ç”¨æˆ·ä½™é¢&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      accountClient&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;deduct&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;order&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;getUserId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; order&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;getMoney&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token comment&#34;&gt;// æ‰£åº“å­˜&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      storageClient&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;deduct&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;order&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;getCommodityCode&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; order&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;getCount&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;catch&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;FeignException&lt;/span&gt; e&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      log&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;error&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;ä¸‹å•å¤±è´¥ï¼ŒåŸå› :&amp;#123;&amp;#125;&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; e&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;contentUTF8&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; e&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token keyword&#34;&gt;throw&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;RuntimeException&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;e&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;contentUTF8&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; e&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; order&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;getId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;3ã€é‡å¯æœåŠ¡å¹¶æµ‹è¯•&lt;/p&gt;
&lt;p&gt;ç›®å‰çš„ account_tbl è¡¨å•ä¿¡æ¯&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310181144973.png&#34; alt=&#34;image-20231018114458627&#34;&gt;&lt;/p&gt;
&lt;p&gt;ç›®å‰ storage_tbl è¡¨å•ä¿¡æ¯&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310181145948.png&#34; alt=&#34;image-20231018114522634&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ postman è¿›è¡Œå‘é€è¯·æ±‚æµ‹è¯•&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310181146511.png&#34; alt=&#34;image-20231018114629170&#34;&gt;&lt;/p&gt;
&lt;p&gt;æµ‹è¯•å account_tbl è¡¨å•ä¿¡æ¯&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310181146234.png&#34; alt=&#34;image-20231018114658167&#34;&gt;&lt;/p&gt;
&lt;p&gt;æµ‹è¯•å storage_tbl è¡¨å•ä¿¡æ¯&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310181147047.png&#34; alt=&#34;image-20231018114715998&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°æ²¡æœ‰é—®é¢˜ï¼Œä¸‹é¢æµ‹è¯• å¼‚å¸¸ çš„æƒ…å†µ&lt;/p&gt;
&lt;p&gt;postman æµ‹è¯•å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;å°†å­˜åº“æ•°é‡æ”¹ä¸º 10ï¼Œå½“å‰çš„åº“å­˜æ•°æ®æ˜¯ä¸è¶³ 10 ä¸ªçš„å› æ­¤æ‰§è¡Œå°±ä¼šå‡ºé—®é¢˜å¯ä»¥çœ‹åˆ°çŠ¶æ€ç  500 å·²ç»å¼‚å¸¸äº†&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310181148645.png&#34; alt=&#34;image-20231018114814272&#34;&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬çœ‹ä¸‹æ•°æ®åº“æœ‰æ²¡æœ‰å›æ»šå•Š&lt;/p&gt;
&lt;p&gt;æµ‹è¯•å account_tbl è¡¨å•ä¿¡æ¯&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310181149371.png&#34; alt=&#34;image-20231018114937327&#34;&gt;&lt;/p&gt;
&lt;p&gt;æµ‹è¯•å storage_tbl è¡¨å•ä¿¡æ¯&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310181149916.png&#34; alt=&#34;image-20231018114955744&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°æ²¡æœ‰ä»»ä½•å˜åŒ–&lt;/p&gt;
&lt;p&gt;çœ‹ä¸‹ idea çš„æ§åˆ¶å°çš„æ‰“å°ä¿¡æ¯ï¼š&lt;/p&gt;
&lt;p&gt;accountApplication æ‰“å°å‡ºäº†äº‹åŠ¡å›æ»šçš„ä¿¡æ¯ï¼Œå…¶å®ƒçš„æ˜¯æŠ¥é”™çš„ä¿¡æ¯ï¼Œå› ä¸ºæŠ¥é”™æœ¬èº«å°±æ²¡æœ‰æ‰§è¡ŒæˆåŠŸ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;10-18 11:48:06:076  INFO 18016 --- [h_RMROLE_1_2_16] i.s.c.r.p.c.RmBranchRollbackProcessor    : rm handle branch rollback process:xid=192.168.45.1:8091:4251845158843265029,branchId=4251845158843265031,branchType=XA,resourceId=jdbc:mysql:///seata_demo,applicationData=null
10-18 11:48:06:080  INFO 18016 --- [h_RMROLE_1_2_16] io.seata.rm.AbstractRMHandler            : Branch Rollbacking: 192.168.45.1:8091:4251845158843265029 4251845158843265031 jdbc:mysql:///seata_demo
10-18 11:48:06:083  INFO 18016 --- [h_RMROLE_1_2_16] i.s.rm.datasource.xa.ResourceManagerXA   : 192.168.45.1:8091:4251845158843265029-4251845158843265031 was rollbacked
10-18 11:48:06:084  INFO 18016 --- [h_RMROLE_1_2_16] io.seata.rm.AbstractRMHandler            : Branch Rollbacked result: PhaseTwo_Rollbacked
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;2424-atæ¨¡å¼åŸç†&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2424-atæ¨¡å¼åŸç†&#34;&gt;#&lt;/a&gt; 2.4.2.4ã€AT æ¨¡å¼åŸç†ğŸŒ´&lt;/h4&gt;
&lt;p&gt;AT æ¨¡å¼åŒæ ·æ˜¯åˆ†é˜¶æ®µæäº¤çš„äº‹åŠ¡æ¨¡å‹ï¼Œä¸è¿‡å´å¼¥è¡¥äº† XA æ¨¡å‹ä¸­èµ„æºé”å®šå‘¨æœŸè¿‡é•¿çš„ç¼ºé™·ã€‚&lt;/p&gt;
&lt;p&gt;AT æ¨¡å¼æ‰§è¡Œå®Œä¸šåŠ¡ sql åä¼šç›´æ¥æäº¤äº‹åŠ¡ï¼Œè€Œä¸æ˜¯ç­‰å¾…å¯¹æ–¹çš„æ‰§è¡Œã€‚åœ¨æ‰§è¡Œä¸šåŠ¡ sql çš„æ—¶å€™ç”± RM æ‹¦æˆªè¿™æ¬¡çš„æ‰§è¡Œå¹¶ä¸”ç»™æ•°æ®å½¢æˆä¸€ä¸ªå¿«ç…§ï¼Œå¿«ç…§åä¸ºï¼šundo logï¼Œå¦‚æœå¤±è´¥äº†å°±å¯ä»¥æ ¹æ®å¿«ç…§è¿›è¡Œæ¢å¤äº†ã€‚åœ¨ç¬¬ä¸€é˜¶æ®µå°±å·²ç»æäº¤äº†ï¼Œç¬¬äºŒé˜¶æ®µå°† log ç»™åˆ é™¤&lt;/p&gt;
&lt;p&gt;é˜¶æ®µä¸€ RM çš„å·¥ä½œï¼š&lt;/p&gt;
&lt;p&gt;1ã€æ³¨å†Œåˆ†æ”¯äº‹åŠ¡&lt;/p&gt;
&lt;p&gt;2ã€&lt;font color=&#39;red&#39;&gt;è®°å½• undo-log (æ•°æ®å¿«ç…§)&lt;/font&gt;.&lt;/p&gt;
&lt;p&gt;3ã€æ‰§è¡Œä¸šåŠ¡ sql å¹¶&lt;font color=&#39;red&#39;&gt;æäº¤&lt;/font&gt;.&lt;/p&gt;
&lt;p&gt;4ã€æŠ¥å‘Šäº‹åŠ¡çŠ¶æ€&lt;/p&gt;
&lt;p&gt;é˜¶æ®µäºŒæäº¤æ—¶ RM çš„å·¥ä½œï¼š&lt;/p&gt;
&lt;p&gt;1ã€åˆ é™¤ undo-log å³å¯&lt;/p&gt;
&lt;p&gt;é˜¶æ®µäºŒå›æ»šæ—¶ RM çš„å·¥ä½œï¼š&lt;/p&gt;
&lt;p&gt;1ã€æ ¹æ® undo-log æ¢å¤æ•°æ®åˆ°æ›´æ–°å‰&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310181329271.png&#34; alt=&#34;image-20231018132921268&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä¸‹é¢é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥è¿›è¡Œæ¯”å–»ï¼š&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œä¸€ä¸ªåˆ†æ”¯ä¸šåŠ¡çš„ SQL æ˜¯è¿™æ ·çš„ï¼šupdate tb_account set money = money - 10 where id = 1&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310181333976.png&#34; alt=&#34;image-20231018133322819&#34;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;æ€»ç»“&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;ç®€è¿° AT æ¨¡å¼ä¸ XA æ¨¡å¼æœ€å¤§çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;XA æ¨¡å¼ä¸€é˜¶æ®µä¸æäº¤äº‹åŠ¡ï¼Œé”å®šèµ„æºï¼›AT æ¨¡å¼ä¸€é˜¶æ®µç›´æ¥æäº¤ï¼Œä¸é”å®šèµ„æº&lt;/li&gt;
&lt;li&gt;XA æ¨¡å¼ä¾èµ–æ•°æ®åº“æœºåˆ¶å®ç°å›æ»šï¼›AT æ¨¡å¼åˆ©ç”¨æ•°æ®å¿«ç…§å®ç°æ•°æ®å›æ»š&lt;/li&gt;
&lt;li&gt;XA æ¨¡å¼å¼ºä¸€è‡´ï¼›AT æ¨¡å¼æœ€ç»ˆä¸€è‡´&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h5 id=&#34;24241-atæ¨¡å¼çš„è„å†™é—®é¢˜&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#24241-atæ¨¡å¼çš„è„å†™é—®é¢˜&#34;&gt;#&lt;/a&gt; 2.4.2.4.1ã€AT æ¨¡å¼çš„è„å†™é—®é¢˜ğŸ‹&lt;/h5&gt;
&lt;p&gt;ä¸Šè¿°å¾—çŸ¥ï¼ŒAT æ¨¡å¼ç›¸å¯¹äº XA æ¨¡å¼æ¥è®²ï¼Œæ€§èƒ½å¾—åˆ°äº†ä¸€äº›æå‡ï¼Œå› ä¸º AT æ¨¡å¼åœ¨ç¬¬ä¸€é˜¶æ®µçš„æ—¶å€™æ‰§è¡Œäº‹åŠ¡ä¼šç›´æ¥æäº¤ã€‚è€Œä¸æ˜¯ç­‰å¾…å„ä¸ªåˆ†æ”¯ä¸€èµ·æ‰§è¡Œå®Œï¼Œå› æ­¤èµ„æºé”å®šå‘¨æœŸçŸ­ æ€§èƒ½å°±æ¯”è¾ƒå¥½äº†ã€‚ä½†æ˜¯ä¹Ÿæ­£æ˜¯å› ä¸ºå®ƒæå‰é‡Šæ”¾äº†èµ„æºæ²¡æœ‰å»åšé”ï¼Œè¿™å°±å¯¼è‡´äº†åœ¨å¹¶å‘è®¿é—®æƒ…å†µä¸‹ä¼šå­˜åœ¨ä¸€äº›å®‰å…¨é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚è¯´æœ‰ä¸ª account è¡¨ï¼Œä¸šåŠ¡æ˜¯ä¿®æ”¹ money å­—æ®µè®©å…¶å‡ 10ï¼Œé‚£ä¹ˆæœ‰ä¸€ä¸ªçº¿ç¨‹å¼€å¯äº†è¿™ä¸ªæ ·äº‹åŠ¡ã€‚äº‹åŠ¡å¼€å¯ç¬¬ä¸€ä»¶äº‹å°±æ˜¯è·å–æ•°æ®åº“é”ï¼Œå¹¶ç”Ÿæˆä¸€ä¸ªå¿«ç…§ã€‚ç„¶åæ‰§è¡Œ sql ä» 100 æ”¹ä¸º 90ï¼Œç„¶åæäº¤äº‹åŠ¡ï¼Œäº‹åŠ¡ä¸€æ—¦æäº¤é”å°±é‡Šæ”¾äº†ï¼Œæ•°æ®ä¹Ÿå°±æ”¹äº†ã€‚ç¬¬ä¸€é˜¶æ®µå®Œæˆå°±è½®åˆ°ç¬¬äºŒé˜¶æ®µï¼Œä½†åŒä¸€æ—¶åˆ»å› ä¸ºæ˜¯å¹¶å‘ç°åœ¨æœ‰å¦å¤–ä¸€ä¸ªçº¿ç¨‹ä¹Ÿå¼€å¯äº†äº‹åŠ¡æ‰§è¡Œè¿™ä¸ªä¸šåŠ¡ã€‚äº‹åŠ¡ 2 ç­‰å¾…äº‹åŠ¡ 1 é‡Šæ”¾é”äº†ï¼Œç„¶åæ‹¿åˆ°é”æ‰èƒ½å»ä¿å­˜å¿«ç…§å¹¶æ‰§è¡Œä¸šåŠ¡ sql å°† 90 æ”¹ ä¸º 80ï¼Œç„¶åæäº¤äº‹åŠ¡å¹¶é‡Šæ”¾é”ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœè¿™æ—¶äº‹åŠ¡ 1 æ‹¿åˆ°é”åå®ƒè¦åšå›æ»šï¼Œå› ä¸ºäº‹åŠ¡ 1 çš„ç¬¬äºŒé˜¶æ®µè¿˜æ²¡åšå®Œï¼Œè¿™æ—¶äº‹åŠ¡ 1 çš„å¿«ç…§æ•°æ®ä¸º money=100 è¿™æ˜¯å›æ»šå°±å‡ºé—®é¢˜äº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310181351685.png&#34; alt=&#34;image-20231018135124412&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ AT æ¨¡å¼å¼•å…¥äº†ä¸€ä¸ªå« â€œå…¨å±€é”â€ çš„ä¸œè¥¿&lt;/p&gt;
&lt;p&gt;&lt;mark&gt;å…¨å±€é”&lt;/mark&gt;ï¼šç”± TC è®°å½•å½“å‰æ­£åœ¨æ“ä½œæŸè¡Œæ•°æ®çš„äº‹åŠ¡ï¼Œæ”¹äº‹åŠ¡æŒæœ‰å…¨å±€é”ï¼Œå…·å¤‡æ‰§è¡Œæƒã€‚&lt;/p&gt;
&lt;p&gt;TC é€šè¿‡ä¸€å¼ è¡¨æ¥è¿›è¡Œè®°å½•ï¼Œåˆ†åˆ«è®°å½•ï¼šå½“å‰ç”±å“ªä¸ªäº‹åŠ¡åœ¨æ“ä½œï¼Œæ“ä½œçš„å“ªå¼ è¡¨ï¼Œä¸»é”® æ“ä½œè¿™å¼ è¡¨çš„å“ªä¸€è¡Œæ•°æ®ã€‚é€šè¿‡è®°å½•æŸ¥çœ‹è¿™ä¸ªè¡¨çš„è¿™è¡Œæ•°æ®å°±åªèƒ½è¢«è¿™ä¸ªäº‹åŠ¡è¿›è¡Œæ“ä½œï¼Œå…¶å®ƒäº‹åŠ¡ä¸èƒ½æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310181402045.png&#34; alt=&#34;image-20231018140242928&#34;&gt;&lt;/p&gt;
&lt;p&gt;å°½ç®¡å¦‚æ­¤ï¼Œäº‹åŠ¡ 1 åœ¨æ“ä½œ money å­—æ®µçš„æ—¶å€™ä¹Ÿå¯èƒ½ä¼šæœ‰ä¸€ä¸ªæ²¡æœ‰è¢« seata ç®¡ç†çš„ä¸šåŠ¡æ¥æ“ä½œ money å­—æ®µæ­¤æ—¶å°±ä¼šäº§ç”Ÿè„å†™çš„é—®é¢˜äº†ã€‚åˆ†å¸ƒå¼äº‹åŠ¡æˆ‘ä»¬åº”è¯¥å°½é‡çš„é¿å…ä¸¤ä¸ªæ“ä½œåŒä¸€ä¸ªå­—æ®µã€‚ä½†æ˜¯å†æ€ä¹ˆé¿å…ä¹Ÿä¸æ˜¯ä¸å¯èƒ½çš„æƒ…å†µ&lt;/p&gt;
&lt;p&gt;AT æ¨¡å¼ä¹Ÿå¯¹è¿™ç§æ–¹å¼åšäº†ä¸€äº›å¤„ç†ã€‚&lt;/p&gt;
&lt;p&gt;å½“äº‹åŠ¡ 1 ç¬¬äºŒé˜¶æ®µè¿›è¡Œå›æ»šæ—¶ï¼Œä¼šæ‹¿åˆ° æ›´æ–°å‰çš„å¿«ç…§å’Œæ›´æ–°åçš„å¿«ç…§ã€‚ç„¶åç”¨æ›´æ–°åçš„å¿«ç…§æ•°æ®å»å¯¹å½“å‰çš„æ•°æ®åº“æ•°æ®åšå¯¹æ¯”ï¼Œåˆ¤æ–­æ˜¯å¦ä¸€è‡´ï¼Œå¦‚æœä¸ä¸€è‡´å°±ä¼šè®°å½•å¼‚å¸¸ï¼Œå‘é€è­¦å‘Šï¼Œäººå·¥ä»‹å…¥&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310181414617.png&#34; alt=&#34;image-20231018141424667&#34;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;æ€»ç»“&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;AT æ¨¡å¼çš„ä¼˜ç‚¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸€é˜¶æ®µå®Œæˆç›´æ¥æäº¤äº‹åŠ¡ï¼Œé‡Šæ”¾æ•°æ®åº“èµ„æºï¼Œæ€§èƒ½æ¯”è¾ƒå¥½&lt;/li&gt;
&lt;li&gt;åˆ©ç”¨å…¨å±€é”å®ç°è¯»å†™éš”ç¦»&lt;/li&gt;
&lt;li&gt;æ²¡æœ‰ä»£ç ä¾µå…¥ï¼Œæ¡†æ¶è‡ªåŠ¨å®Œæˆå›æ»šå’Œæäº¤&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;AT æ¨¡å¼çš„ç¼ºç‚¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸¤é˜¶æ®µä¹‹é—´å±äºè½¯çŠ¶æ€ï¼Œå±äºæœ€ç»ˆä¸€è‡´&lt;/li&gt;
&lt;li&gt;æ¡†æ¶çš„å¿«ç…§åŠŸèƒ½ä¼šå½±å“æ€§èƒ½ï¼Œä½†æ¯” XA æ¨¡å¼å¥½å¾ˆå¤š&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;2425-å®ç°atæ¨¡å¼&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2425-å®ç°atæ¨¡å¼&#34;&gt;#&lt;/a&gt; 2.4.2.5ã€å®ç° AT æ¨¡å¼ğŸŒ´&lt;/h4&gt;
&lt;p&gt;AT æ¨¡å¼ä¸­çš„å¿«ç…§ç”Ÿæˆï¼Œå›æ»šç­‰åŠ¨ä½œéƒ½æ˜¯ç”±æ¡†æ¶è‡ªåŠ¨å®Œæˆï¼Œæ²¡æœ‰ä»»ä½•ä»£ç ä¾µå…¥ï¼Œå› æ­¤å®ç°éå¸¸ç®€å•ã€‚&lt;/p&gt;
&lt;p&gt;1ã€å¯¼å…¥ SQL æ–‡ä»¶ï¼šseata-at.sqlã€‚æ‰“å¼€ sql æ–‡ä»¶å…¶ä¸­ lock_table å¯¼å…¥åˆ° TC æœåŠ¡å…³è”çš„æ•°æ®åº“ï¼Œundo_log è¡¨å¯¼å…¥åˆ°å¾®æœåŠ¡ç®¡ç†çš„æ•°æ®åº“ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310181426661.png&#34; alt=&#34;image-20231018142639716&#34;&gt;&lt;/p&gt;
&lt;p&gt;2ã€ä¿®æ”¹ application.yml æ–‡ä»¶ï¼Œå°†äº‹åŠ¡æ¨¡å¼ä¿®æ”¹ä¸º AT æ¨¡å¼å³å¯ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight yml&#34;&gt;&lt;figcaption data-lang=&#34;YAML&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key atrule&#34;&gt;seata&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token key atrule&#34;&gt;data-source-proxy-mode&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; AT &lt;span class=&#34;token comment&#34;&gt;# å¼€å¯æ•°æ®æºä»£ç†çš„ AT æ¨¡å¼&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;3ã€é‡å¯æœåŠ¡å¹¶æµ‹è¯•&lt;/p&gt;
&lt;p&gt;ç›®å‰çš„æ•°æ®åº“æ•°æ®&lt;/p&gt;
&lt;p&gt;account_tbl è¡¨çš„æ•°æ®&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310181429533.png&#34; alt=&#34;image-20231018142929459&#34;&gt;&lt;/p&gt;
&lt;p&gt;storage_tbl è¡¨çš„æ•°æ®&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310181429518.png&#34; alt=&#34;image-20231018142946308&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ postman è¿›è¡Œæµ‹è¯•&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310181430146.png&#34; alt=&#34;image-20231018143051522&#34;&gt;&lt;/p&gt;
&lt;p&gt;æµ‹è¯•åçš„ account_tbl è¡¨çš„æ•°æ®&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310181431746.png&#34; alt=&#34;image-20231018143114523&#34;&gt;&lt;/p&gt;
&lt;p&gt;æµ‹è¯•åçš„ storage_tbl è¡¨çš„æ•°æ®&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310181431267.png&#34; alt=&#34;image-20231018143133064&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ postman è¿›è¡Œä¸€æ¬¡å¤±è´¥çš„æµ‹è¯•ï¼š&lt;/p&gt;
&lt;p&gt;åº“å­˜æ•°æ®ç°åœ¨ä¸å¤Ÿ 10 ä¸ªæˆ‘ä»¬æ‰£å‡ 10 ä¸ªæ­¤æ—¶å°±ä¼šäº§ç”Ÿå¼‚å¸¸&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310181432899.png&#34; alt=&#34;image-20231018143222278&#34;&gt;&lt;/p&gt;
&lt;p&gt;æµ‹è¯•åçš„ account_tbl è¡¨çš„æ•°æ®&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310181432696.png&#34; alt=&#34;image-20231018143252735&#34;&gt;&lt;/p&gt;
&lt;p&gt;æµ‹è¯•åçš„ storage_tbl è¡¨çš„æ•°æ®&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310181433130.png&#34; alt=&#34;image-20231018143302062&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥å‘ç°æ²¡æœ‰å‘ç”Ÿä»»ä½•çš„å˜åŒ–å•Šã€‚è¯´æ˜äº‹åŠ¡ç”Ÿæ•ˆäº†ï¼Œæ•´ä¸ªåˆ†å¸ƒå¼äº‹åŠ¡éƒ½å›æ»šäº†&lt;/p&gt;
&lt;p&gt;accountApplication æœåŠ¡åœ¨ idea æ§åˆ¶å°ä¸­æ‰“å°çš„ä¿¡æ¯å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°æœ€ç»ˆåˆ é™¤äº†ä¸€ä¸ªå« undo_log çš„è¡¨çš„æ•°æ®ä¹Ÿå°±æ˜¯å¿«ç…§æ•°æ®&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;10-18 14:32:15:309  INFO 19080 --- [h_RMROLE_1_2_16] i.s.c.r.p.c.RmBranchRollbackProcessor    : rm handle branch rollback process:xid=192.168.45.1:8091:4251845158843265037,branchId=4251845158843265039,branchType=AT,resourceId=jdbc:mysql:///seata_demo,applicationData=null
10-18 14:32:15:310  INFO 19080 --- [h_RMROLE_1_2_16] io.seata.rm.AbstractRMHandler            : Branch Rollbacking: 192.168.45.1:8091:4251845158843265037 4251845158843265039 jdbc:mysql:///seata_demo
10-18 14:32:15:347  INFO 19080 --- [h_RMROLE_1_2_16] i.s.r.d.undo.AbstractUndoLogManager      : xid 192.168.45.1:8091:4251845158843265037 branch 4251845158843265039, undo_log deleted with GlobalFinished
10-18 14:32:15:348  INFO 19080 --- [h_RMROLE_1_2_16] io.seata.rm.AbstractRMHandler            : Branch Rollbacked result: PhaseTwo_Rollbacked
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;2426-tccæ¨¡å¼åŸç†&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2426-tccæ¨¡å¼åŸç†&#34;&gt;#&lt;/a&gt; 2.4.2.6ã€TCC æ¨¡å¼åŸç†ğŸŒ´&lt;/h4&gt;
&lt;p&gt;TCC æ¨¡å¼ä¸ AT æ¨¡å¼éå¸¸ç›¸ä¼¼ï¼Œæ¯é˜¶æ®µéƒ½æ˜¯ç‹¬ç«‹äº‹åŠ¡ï¼Œä¸åŒçš„æ˜¯ TCC é€šè¿‡äººå·¥ç¼–ç æ¥å®ç°æ•°æ®æ¢å¤ã€‚éœ€è¦å®ç°ä¸‰ä¸ªæ–¹æ³•ï¼š&lt;/p&gt;
&lt;p&gt;1ã€Tryï¼šèµ„æºçš„æ£€æµ‹å’Œé¢„ç•™&lt;/p&gt;
&lt;p&gt;2ã€Confirmï¼šå®Œæˆèµ„æºæ“ä½œä¸šåŠ¡ï¼›è¦æ±‚ Try æˆåŠŸ Confirm ä¸€å®šè¦èƒ½æˆåŠŸ&lt;/p&gt;
&lt;p&gt;3ã€Cancelï¼šé¢„ç•™èµ„æºé‡Šæ”¾ï¼Œå¯ä»¥ç†è§£ä¸º try çš„åå‘æ“ä½œ&lt;/p&gt;
&lt;p&gt;ä¸¾ä¾‹ï¼Œä¸€ä¸ªæ‰£å‡ç”¨æˆ·ä½™é¢çš„ä¸šåŠ¡ã€‚å‡è®¾è´¦æˆ· A åŸæ¥ä½™é¢æ˜¯ 100ï¼Œéœ€è¦ä½™é¢æ‰£å‡ 30 å…ƒ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;é˜¶æ®µä¸€ (Try)ï¼šæ£€æŸ¥ä½™é¢æ˜¯å¦å……è¶³ï¼Œå¦‚æœå……è¶³åˆ™å†»ç»“é‡‘é¢å¢åŠ  30 å…ƒï¼Œå¯ç”¨ä½™é¢æ‰£é™¤ 30&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310181448987.png&#34; alt=&#34;image-20231018144806649&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;é˜¶æ®µäºŒ (Confirm)ï¼šå‡å¦‚è¦æäº¤ï¼Œåˆ™å†»ç»“é‡‘é¢æ‰£å‡ 30&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310181448879.png&#34; alt=&#34;image-20231018144815748&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;é˜¶æ®µäºŒ (Cancel)ï¼šå¦‚æœè¦å›æ»šï¼Œåˆ™å†»ç»“é‡‘é¢æ‰£å‡ 30ï¼Œå¯ç”¨ä½™é¢å¢åŠ  30&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310181448428.png&#34; alt=&#34;image-20231018144824406&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;TCC çš„å·¥ä½œæ¨¡å‹å›¾ï¼š&lt;/p&gt;
&lt;p&gt;ç”± TM å¼€å¯å¹¶æ³¨å†Œå…¨å±€äº‹åŠ¡åˆ° TC ä¸Šï¼Œç„¶å TM é€šçŸ¥æ¯ä¸€ä¸ªåˆ†æ”¯äº‹åŠ¡å»æ‰§è¡Œï¼Œåˆ†æ”¯äº‹åŠ¡è¢« RM åšæ‹¦æˆªï¼ŒRM å…ˆå»æ³¨å†Œä¸€ä¸‹åˆ†æ”¯äº‹åŠ¡ã€‚ç„¶åå†æ‰§è¡Œæ“ä½œï¼Œç¬¬ä¸€é˜¶æ®µè¿›è¡Œ Tryã€‚Try æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„èµ„æºä¼šç›´æ¥æäº¤ï¼Œæäº¤åæŠ¥å‘Šäº‹åŠ¡çš„çŠ¶æ€ã€‚äºŒé˜¶æ®µï¼šTM é€šçŸ¥ TC äº‹åŠ¡ç»“æŸäº†ï¼Œç„¶å TC åšäº‹åŠ¡çŠ¶æ€çš„åˆ¤æ–­ï¼Œçœ‹çœ‹åˆ†æ”¯èµ„æºå¤Ÿä¸å¤Ÿã€‚å¦‚æœå¤Ÿç›´æ¥ Confirm æäº¤ï¼Œå¦‚æœä¸å¤Ÿå°±æ‰§è¡Œ Cancel é€»è¾‘è¿›è¡Œå›æ»šã€‚&lt;/p&gt;
&lt;p&gt;è€Œè¿™ä¸‰ä¸ª Tryï¼ŒConfirmï¼ŒCancel éƒ½æ˜¯éœ€è¦äººå·¥ç¼–å†™çš„&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310181456139.png&#34; alt=&#34;image-20231018145621001&#34;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;æ€»ç»“&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;TCC æ¨¡å¼çš„æ¯ä¸ªé˜¶æ®µæ˜¯åšä»€ä¹ˆçš„ï¼Ÿ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Tryï¼šèµ„æºæ£€æŸ¥å’Œé¢„ç•™&lt;/li&gt;
&lt;li&gt;Confirmï¼šä¸šåŠ¡æ‰§è¡Œå’Œæäº¤&lt;/li&gt;
&lt;li&gt;Cancelï¼šé¢„ç•™èµ„æºçš„é‡Šæ”¾&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;TCC çš„ä¼˜ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸€é˜¶æ®µå®Œæˆç›´æ¥æäº¤äº‹åŠ¡ï¼Œé‡Šæ”¾æ•°æ®åº“èµ„æºï¼Œæ€§èƒ½å¥½&lt;/li&gt;
&lt;li&gt;ç›¸æ¯” AT æ¨¡å‹ï¼Œæ— éœ€ç”Ÿæˆå¿«ç…§ï¼Œæ— éœ€ä½¿ç”¨å…¨å±€é”ï¼Œæ€§èƒ½æœ€å¼º&lt;/li&gt;
&lt;li&gt;ä¸ä¾èµ–æ•°æ®åº“äº‹åŠ¡ï¼Œè€Œæ˜¯ä¾èµ–è¡¥å¿æ“ä½œï¼Œå¯ä»¥ç”¨äºéäº‹åŠ¡å‹æ•°æ®åº“æ¯”å¦‚ï¼šredis&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;TCC çš„ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æœ‰ä»£ç ä¾µå…¥ï¼Œéœ€è¦è®¤ä¸ºç¼–å†™ Tryï¼ŒConfirm å’Œ Cancel æ¥å£ï¼Œå¤ªéº»çƒ¦&lt;/li&gt;
&lt;li&gt;è½¯çŠ¶æ€ï¼Œäº‹åŠ¡æ˜¯æœ€ç»ˆä¸€è‡´&lt;/li&gt;
&lt;li&gt;éœ€è¦è€ƒè™‘ Confirm å’Œ Cancel çš„å¤±è´¥æƒ…å†µï¼Œåšå¥½å¹‚ç­‰å¤„ç†&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h5 id=&#34;24261-æ¡ˆä¾‹æ”¹é€ account-serviceæœåŠ¡åˆ©ç”¨tccå®ç°åˆ†å¸ƒå¼äº‹åŠ¡&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#24261-æ¡ˆä¾‹æ”¹é€ account-serviceæœåŠ¡åˆ©ç”¨tccå®ç°åˆ†å¸ƒå¼äº‹åŠ¡&#34;&gt;#&lt;/a&gt; 2.4.2.6.1ã€æ¡ˆä¾‹ï¼Œæ”¹é€  account-service æœåŠ¡ï¼Œåˆ©ç”¨ TCC å®ç°åˆ†å¸ƒå¼äº‹åŠ¡ğŸ‹&lt;/h5&gt;
&lt;p&gt;éœ€æ±‚å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;1ã€ä¿®æ”¹ acoount-serviceï¼Œç¼–å†™ Tryï¼ŒConfirmï¼ŒCancel é€»è¾‘&lt;/p&gt;
&lt;p&gt;2ã€Try ä¸šåŠ¡ï¼šæ·»åŠ å†»ç»“é‡‘é¢ï¼Œæ‰£å‡å¯ç”¨é‡‘é¢&lt;/p&gt;
&lt;p&gt;3ã€Confirm ä¸šåŠ¡ï¼šåˆ é™¤å†»ç»“é‡‘é¢&lt;/p&gt;
&lt;p&gt;4ã€Cancel ä¸šåŠ¡ï¼šåˆ é™¤å†»ç»“é‡‘é¢ï¼Œæ¢å¤å¯ç”¨é‡‘é¢&lt;/p&gt;
&lt;p&gt;5ã€ä¿è¯ Confirmï¼ŒCancel æ¥å£çš„&lt;font color=&#39;red&#39;&gt;å¹‚ç­‰æ€§&lt;/font&gt;.&lt;/p&gt;
&lt;p&gt;6ã€å…è®¸&lt;font color=&#39;red&#39;&gt;ç©ºå›æ»š&lt;/font&gt;.&lt;/p&gt;
&lt;p&gt;7ã€æ‹’ç»&lt;font color=&#39;red&#39;&gt;ä¸šåŠ¡æ‚¬æŒ‚&lt;/font&gt;.&lt;/p&gt;
&lt;h5 id=&#34;24262-tccçš„ç©ºå›æ»šå’Œä¸šåŠ¡æ‚¬æŒ‚&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#24262-tccçš„ç©ºå›æ»šå’Œä¸šåŠ¡æ‚¬æŒ‚&#34;&gt;#&lt;/a&gt; 2.4.2.6.2ã€TCC çš„ç©ºå›æ»šå’Œä¸šåŠ¡æ‚¬æŒ‚ğŸ‹&lt;/h5&gt;
&lt;blockquote&gt;
&lt;p&gt;å½“æŸåˆ†æ”¯äº‹åŠ¡çš„ try é˜¶æ®µé˜»å¡æ—¶ï¼Œå¯èƒ½å¯¼è‡´å…¨å±€äº‹åŠ¡è¶…æ—¶è€Œè§¦å‘äºŒé˜¶æ®µçš„ cancel æ“ä½œã€‚åœ¨æœªæ‰§è¡Œ try æ“ä½œæ—¶å…ˆæ‰§è¡Œäº† cancel æ“ä½œï¼Œè¿™æ—¶ cancel ä¸èƒ½åšå›æ»šï¼Œå°±æ˜¯&lt;font color=&#39;red&#39;&gt;ç©ºå›æ»š&lt;/font&gt;.&lt;/p&gt;
&lt;p&gt;å› æ­¤ä¹Ÿä¸èƒ½æŠ¥é”™ã€‚æŠ¥é”™å°±ä¼šé‡è¯•å°±ä¼šé™·å…¥ä¸€ä¸ªæ­»å¾ªç¯ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºå·²ç»ç©ºå›æ»šçš„ä¸šåŠ¡ï¼Œå¦‚æœä»¥åç»§ç»­æ‰§è¡Œ tryï¼Œå°±æ°¸è¿œä¸å¯èƒ½ Confirm æˆ– Cancelï¼Œè¿™å°±æ˜¯&lt;font color=&#39;red&#39;&gt;ä¸šåŠ¡æ‚¬æŒ‚&lt;/font&gt;ã€‚åº”å½“é˜»æ­¢æ‰§è¡Œç©ºå›æ»šåçš„ try æ“ä½œï¼Œé¿å…æ‚¬æŒ‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å½“ç¬¬äºŒä¸ªäº‹åŠ¡å»æ‰§è¡Œçš„æ—¶å€™å°±ä¼šè¢«é˜»å¡ï¼Œé˜»å¡åå¾—ä¸åˆ°æ‰§è¡Œ TM å°±ä¼šå¡åœ¨è¿™é‡Œï¼Œç­‰å¾…è¶…æ—¶åå°±ä¼šæŠ¥ä¸€ä¸ªé”™è¯¯ç»™ TC äº†ï¼ŒTC æ­¤æ—¶å°±ä¼šè¿”å›ä¸€ä¸ªå›æ»šçš„é€šçŸ¥äºæ˜¯ RM å°±ä¼šæ‰§è¡Œ Cancel çš„é€»è¾‘äº†ã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸€ä¸ªåˆ†æ”¯æ‰§è¡Œ Cancel æ²¡é—®é¢˜å› ä¸ºå®ƒå·²ç» Try äº†ï¼Œä½†æ˜¯ç¬¬äºŒä¸ªåˆ†æ”¯å°±å‡ºé—®é¢˜äº† è¿˜æ²¡å†»ç»“é‡‘é¢å°±å»æ¢å¤é‡‘é¢å»äº†&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310181514887.png&#34; alt=&#34;image-20231018151440530&#34;&gt;&lt;/p&gt;
&lt;p&gt;â€‹&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä¸šåŠ¡åˆ†æ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä¸ºäº†å®ç°ç©ºå›æ»šï¼Œé˜²æ­¢ä¸šåŠ¡æ‚¬æŒ‚ï¼Œä»¥åŠå¹‚ç­‰æ€§è¦æ±‚ã€‚æˆ‘ä»¬å¿…é¡»åœ¨æ•°æ®åº“è®°å½•å†»ç»“é‡‘é¢çš„åŒæ—¶ï¼Œè®°å½•å½“å‰äº‹åŠ¡ id å’Œæ‰§è¡ŒçŠ¶æ€ï¼Œä¸ºæ­¤æˆ‘ä»¬è®¾è®¡äº†ä¸€å¼ è¡¨ (account_freeze_tbl è¿™ä¸ªè¡¨åœ¨é¡¹ç›®ä¸­ sql æ–‡ä»¶å¤¹å·²ç»æä¾›äº†)ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310181702525.png&#34; alt=&#34;image-20231018170230443&#34;&gt;&lt;/p&gt;
&lt;p&gt;æœ‰äº†è¡¨åæˆ‘ä»¬è¿˜éœ€è¦åˆ›å»ºå®ä½“ç±»å’Œ mapper&lt;/p&gt;
&lt;p&gt;å®ä½“ç±»&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@Data&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@TableName&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;account_freeze_tbl&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;AccountFreeze&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@TableId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;type &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;IdType&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token constant&#34;&gt;INPUT&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;String&lt;/span&gt; xid&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;String&lt;/span&gt; userId&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Integer&lt;/span&gt; freezeMoney&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Integer&lt;/span&gt; state&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;abstract&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;State&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;token constant&#34;&gt;TRY&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;token constant&#34;&gt;CONFIRM&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;token constant&#34;&gt;CANCEL&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;mapper&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;interface&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;AccountFreezeMapper&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;BaseMapper&lt;/span&gt;&lt;span class=&#34;token generics&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;AccountFreeze&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h5 id=&#34;24263-å£°æ˜tccæ¥å£&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#24263-å£°æ˜tccæ¥å£&#34;&gt;#&lt;/a&gt; 2.4.2.6.3ã€å£°æ˜ TCC æ¥å£ï¼š&lt;/h5&gt;
&lt;p&gt;TCC çš„ Tryï¼ŒConfirmï¼ŒCancel æ–¹æ³•éƒ½éœ€è¦åœ¨æ¥å£ä¸­åŸºäºæ³¨è§£æ¥å£°æ˜ï¼Œè¯­æ³•å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@LocalTCC&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;interface&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;AccountTCCService&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;// Try é€»è¾‘ï¼Œ@TwoPhaseBusinessAction ä¸­çš„ name å±æ€§è¦ä¸å½“å‰æ–¹æ³•åä¸€è‡´ï¼Œç”¨äºæŒ‡å®š Try é€»è¾‘å¯¹åº”æ–¹æ³•&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@TwoPhaseBusinessAction&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;name &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;deduct&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            commitMethod &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;confirm&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; rollbackMethod &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;cancel&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;deduct&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@BusinessActionContextParameter&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;paramName &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;userId&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;String&lt;/span&gt; userId&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token annotation punctuation&#34;&gt;@BusinessActionContextParameter&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;paramName &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;money&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;int&lt;/span&gt; money&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;// äºŒé˜¶æ®µ confirm ç¡®è®¤æ–¹æ³•ï¼Œå¯ä»¥å¦å‘½åï¼Œä½†è¦ä¿è¯ä¸ commitMethod ä¸€è‡´&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;// @Param context ä¸Šä¸‹æ–‡ï¼Œå¯ä»¥ä¼ é€’ Try æ–¹æ³•çš„å‚æ•°&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;// @return boolean æ‰§è¡Œæ˜¯å¦æˆåŠŸ&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token keyword&#34;&gt;boolean&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;confirm&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;BusinessActionContext&lt;/span&gt; ctx&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;// äºŒé˜¶æ®µå›æ»šæ–¹æ³•ï¼Œè¦ä¿è¯ä¸ rollbackMethod ä¸€è‡´&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;boolean&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;cancel&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;BusinessActionContext&lt;/span&gt; ctx&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;å®ç°ç±»ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@Slf4j&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@Service&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;AccountTccServiceImpl&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;implements&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;AccountTCCService&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;AccountMapper&lt;/span&gt; mapper&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;AccountFreezeMapper&lt;/span&gt; freezeMapper&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;AccountTccServiceImpl&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;AccountMapper&lt;/span&gt; mapper&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                                 &lt;span class=&#34;token class-name&#34;&gt;AccountFreezeMapper&lt;/span&gt; freezeMapper&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;mapper &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; mapper&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;freezeMapper &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; freezeMapper&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@Override&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@Transactional&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;deduct&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;String&lt;/span&gt; userId&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;int&lt;/span&gt; money&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// 1. è·å–äº‹åŠ¡ id&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token class-name&#34;&gt;String&lt;/span&gt; xid &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;RootContext&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;getXID&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;21&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// 1.1. åˆ¤æ–­ freeze ä¸­æ˜¯å¦æœ‰å†»ç»“è®°å½•ï¼Œå¦‚æœæœ‰ï¼Œä¸€å®šæ˜¯ CANCEL æ‰§è¡Œè¿‡ï¼Œè¦æ‹’ç»ä¸šåŠ¡&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;22&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token class-name&#34;&gt;AccountFreeze&lt;/span&gt; freeze1 &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; freezeMapper&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;selectById&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;xid&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;23&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;freeze1 &lt;span class=&#34;token operator&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;null&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;24&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;25&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token comment&#34;&gt;// CANCEL æ‰§è¡Œè¿‡ï¼Œè¦æ‹’ç»ä¸šåŠ¡&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;26&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;27&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;28&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// 2. æ‰£å‡å¯ç”¨ä½™é¢&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;29&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        mapper&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;deduct&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;userId&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; money&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;30&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// 3. è®°å½•å†»ç»“é‡‘é¢ï¼Œäº‹åŠ¡çŠ¶æ€&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;31&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token class-name&#34;&gt;AccountFreeze&lt;/span&gt; freeze &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;AccountFreeze&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;32&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        freeze&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;setUserId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;userId&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;33&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        freeze&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;setFreezeMoney&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;money&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;34&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        freeze&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;setState&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;AccountFreeze&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;State&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token constant&#34;&gt;TRY&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;35&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        freeze&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;setXid&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;xid&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;36&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        freezeMapper&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;insert&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;freeze&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;37&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;38&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;39&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@Override&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;40&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;boolean&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;confirm&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;BusinessActionContext&lt;/span&gt; ctx&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;41&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// 1. è·å–äº‹åŠ¡ id&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;42&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token class-name&#34;&gt;String&lt;/span&gt; xid &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; ctx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;getXid&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;43&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// 2. æ ¹æ® id åˆ é™¤å†»ç»“è®°å½•&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;44&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;int&lt;/span&gt; count &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; freezeMapper&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;deleteById&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;xid&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;45&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; count &lt;span class=&#34;token operator&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;46&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;47&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;48&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@Override&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;49&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;boolean&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;cancel&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;BusinessActionContext&lt;/span&gt; ctx&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;50&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// 1. ä»ä¸Šä¸‹æ–‡ä¸­è·å– ç”¨æˆ·çš„ id å’Œä½™é¢&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;51&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token class-name&#34;&gt;String&lt;/span&gt; xid &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; ctx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;getXid&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;52&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token class-name&#34;&gt;String&lt;/span&gt; userId &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; ctx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;getActionContext&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;userId&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;toString&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;53&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token class-name&#34;&gt;AccountFreeze&lt;/span&gt; freeze &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; freezeMapper&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;selectById&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;xid&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;54&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// 1.1. ç©ºå›æ»šçš„åˆ¤æ–­ï¼Œåˆ¤æ–­ freeze æ˜¯å¦ä¸º nullï¼Œä¸º null è¯æ˜ try æ²¡æœ‰æ‰§è¡Œï¼Œéœ€è¦ç©ºå›æ»š&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;55&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;freeze &lt;span class=&#34;token operator&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;null&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;56&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;57&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token comment&#34;&gt;// è¯æ˜ try æ²¡æœ‰æ‰§è¡Œï¼Œéœ€è¦å›æ»š&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;58&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            freeze &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;AccountFreeze&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;59&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            freeze&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;setUserId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;userId&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;60&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            freeze&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;setFreezeMoney&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;61&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            freeze&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;setState&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;AccountFreeze&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;State&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token constant&#34;&gt;CANCEL&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;62&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            freeze&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;setXid&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;xid&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;63&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            freezeMapper&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;insert&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;freeze&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;64&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;token boolean&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;65&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;66&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// 1.2. å¹‚ç­‰åˆ¤æ–­&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;67&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;freeze&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;getState&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;AccountFreeze&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;State&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token constant&#34;&gt;CANCEL&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;68&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;69&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token comment&#34;&gt;// å·²ç»å¤„ç†è¿‡ä¸€æ¬¡ CANCEL äº†ï¼Œæ— éœ€é‡å¤å¤„ç†&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;70&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;token boolean&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;71&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;72&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// 2. æ¢å¤å¯ç”¨ä½™é¢&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;73&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        mapper&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;refund&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;freeze&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;getUserId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; freeze&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;getFreezeMoney&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;74&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// 3. å°†å†»ç»“é‡‘é¢æ¸…é›¶ï¼ŒçŠ¶æ€æ”¹ä¸º CANCEL&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;75&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        freeze&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;setFreezeMoney&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;76&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        freeze&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;setState&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;AccountFreeze&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;State&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token constant&#34;&gt;CANCEL&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;77&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;int&lt;/span&gt; count &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; freezeMapper&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;updateById&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;freeze&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;78&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; count &lt;span class=&#34;token operator&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;79&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;80&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;ç›®å‰çš„æ•°æ®åº“æ•°æ®&lt;/p&gt;
&lt;p&gt;account_tbl è¡¨çš„æ•°æ®&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310181752228.png&#34; alt=&#34;image-20231018175239070&#34;&gt;&lt;/p&gt;
&lt;p&gt;storage_tbl è¡¨çš„æ•°æ®&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310181752894.png&#34; alt=&#34;image-20231018175252816&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ postman è¿›è¡Œæµ‹è¯•&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310181753247.png&#34; alt=&#34;image-20231018175315999&#34;&gt;&lt;/p&gt;
&lt;p&gt;è¯·æ±‚å®ŒåæŸ¥çœ‹æ•°æ®åº“çš„æ•°æ®&lt;/p&gt;
&lt;p&gt;account_tbl è¡¨çš„æ•°æ®&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310181753982.png&#34; alt=&#34;image-20231018175345921&#34;&gt;&lt;/p&gt;
&lt;p&gt;storage_tbl è¡¨çš„æ•°æ®&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310181754323.png&#34; alt=&#34;image-20231018175359525&#34;&gt;&lt;/p&gt;
&lt;p&gt;æµ‹è¯•å¤±è´¥çš„ postman è¯·æ±‚&lt;/p&gt;
&lt;p&gt;å› ä¸ºæ­¤æ—¶åº“å­˜çš„æ•°é‡ä¸å¤Ÿ 10 ä¸ªï¼Œæˆ‘ä»¬å‡å» 10 ä¸ªå°±ä¼šäº§ç”Ÿå¼‚å¸¸&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310181754231.png&#34; alt=&#34;image-20231018175428861&#34;&gt;&lt;/p&gt;
&lt;p&gt;æŸ¥çœ‹æ•°æ®åº“çš„æ•°æ®æƒ…å†µ&lt;/p&gt;
&lt;p&gt;æµ‹è¯•åçš„ account_tbl è¡¨çš„æ•°æ®&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310181932222.png&#34; alt=&#34;image-20231018193221241&#34;&gt;&lt;/p&gt;
&lt;p&gt;æµ‹è¯•åçš„ storage_tbl è¡¨çš„æ•°æ®&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310181932553.png&#34; alt=&#34;image-20231018193242522&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°å®Œæˆäº†æ•°æ®çš„å›æ»š&lt;/p&gt;
&lt;h4 id=&#34;2427-sagaæ¨¡å¼&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2427-sagaæ¨¡å¼&#34;&gt;#&lt;/a&gt; 2.4.2.7ã€Saga æ¨¡å¼ğŸŒ´&lt;/h4&gt;
&lt;p&gt;Saga æ¨¡å¼æ˜¯ SEATA æä¾›çš„é•¿äº‹åŠ¡è§£å†³æ–¹æ¡ˆã€‚ä¹Ÿåˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸€é˜¶æ®µï¼šç›´æ¥æäº¤æœ¬åœ°äº‹åŠ¡&lt;/li&gt;
&lt;li&gt;äºŒé˜¶æ®µï¼šæˆåŠŸåˆ™ä»€ä¹ˆéƒ½ä¸åšï¼Œå¤±è´¥åˆ™é€šè¿‡ç¼–å†™è¡¥å¿ä¸šåŠ¡æ¥å›æ»š&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310181938269.png&#34; alt=&#34;image-20231018193808535&#34;&gt;&lt;/p&gt;
&lt;p&gt;Saga æ¨¡å¼ä¼˜ç‚¹ï¼š&lt;/p&gt;
&lt;p&gt;1ã€äº‹åŠ¡å‚ä¸è€…å¯ä»¥åŸºäºäº‹åŠ¡é©±åŠ¨å®ç°å¼‚æ­¥è°ƒç”¨ï¼Œååé«˜&lt;/p&gt;
&lt;p&gt;2ã€ä¸€é˜¶æ®µç›´æ¥æäº¤äº‹åŠ¡ï¼Œæ— é”ï¼Œæ€§èƒ½å¥½&lt;/p&gt;
&lt;p&gt;3ã€ä¸ç”¨ç¼–å†™ TCC ä¸­çš„ä¸‰ä¸ªé˜¶æ®µï¼Œå®ç°ç®€å•&lt;/p&gt;
&lt;p&gt;ç¼ºç‚¹ï¼š&lt;/p&gt;
&lt;p&gt;1ã€è½¯çŠ¶æ€æ”¯æŒæ—¶é—´ä¸ç¡®å®šï¼Œæ—¶æ•ˆæ€§å·®&lt;/p&gt;
&lt;p&gt;2ã€æ²¡æœ‰é”ï¼Œæ²¡æœ‰äº‹åŠ¡éš”ç¦»ï¼Œä¼šæœ‰è„å†™&lt;/p&gt;
&lt;h4 id=&#34;2428-å››ç§æ¨¡å¼å¯¹æ¯”&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2428-å››ç§æ¨¡å¼å¯¹æ¯”&#34;&gt;#&lt;/a&gt; 2.4.2.8ã€å››ç§æ¨¡å¼å¯¹æ¯”ğŸŒ´&lt;/h4&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;XA&lt;/th&gt;
&lt;th&gt;AT&lt;/th&gt;
&lt;th&gt;TCC&lt;/th&gt;
&lt;th&gt;SAGA&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;ä¸€è‡´æ€§&lt;/td&gt;
&lt;td&gt;å¼ºä¸€è‡´&lt;/td&gt;
&lt;td&gt;å¼±ä¸€è‡´&lt;/td&gt;
&lt;td&gt;å¼±ä¸€è‡´&lt;/td&gt;
&lt;td&gt;æœ€ç»ˆä¸€è‡´&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;éš”ç¦»æ€§&lt;/td&gt;
&lt;td&gt;å®Œå…¨éš”ç¦»&lt;/td&gt;
&lt;td&gt;åŸºäºå…¨å±€é”éš”ç¦»&lt;/td&gt;
&lt;td&gt;åŸºäºèµ„æºé¢„ç•™éš”ç¦»&lt;/td&gt;
&lt;td&gt;æ— éš”ç¦»&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ä»£ç ä¾µå…¥&lt;/td&gt;
&lt;td&gt;æ— &lt;/td&gt;
&lt;td&gt;æ— &lt;/td&gt;
&lt;td&gt;æœ‰ï¼Œè¦ç¼–å†™ä¸‰ä¸ªæ¥å£&lt;/td&gt;
&lt;td&gt;æœ‰ï¼Œè¦ç¼–å†™çŠ¶æ€æœºå’Œè¡¥å¿ä¸šåŠ¡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æ€§èƒ½&lt;/td&gt;
&lt;td&gt;å·®&lt;/td&gt;
&lt;td&gt;å¥½&lt;/td&gt;
&lt;td&gt;éå¸¸å¥½&lt;/td&gt;
&lt;td&gt;éå¸¸å¥½&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;åœºæ™¯&lt;/td&gt;
&lt;td&gt;å¯¹ä¸€è‡´æ€§ï¼Œéš”ç¦»æ€§æœ‰é«˜è¦æ±‚çš„ä¸šåŠ¡&lt;/td&gt;
&lt;td&gt;åŸºäºå…³ç³»å‹æ•°æ®åº“çš„å¤§å¤šæ•°åˆ†å¸ƒå¼åœºæ™¯éƒ½å¯ä»¥&lt;/td&gt;
&lt;td&gt;å¯¹æ€§èƒ½è¦æ±‚è¾ƒé«˜çš„äº‹åŠ¡&lt;br /&gt;æœ‰éå…³ç³»å‹æ•°æ®åº“è¦å‚ä¸çš„äº‹åŠ¡&lt;/td&gt;
&lt;td&gt;ä¸šåŠ¡æµç¨‹é•¿ï¼Œä¸šåŠ¡æµç¨‹å¤š&lt;br /&gt;å‚ä¸è€…åŒ…å«å…¶å®ƒå…¬å¸æˆ–é—ç•™ç³»ç»ŸæœåŠ¡ï¼Œæ— æ³•æä¾› TCC æ¨¡å¼è¦æ±‚çš„ä¸‰ä¸ªæ¥å£&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;ä¸‰-é«˜å¯ç”¨&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä¸‰-é«˜å¯ç”¨&#34;&gt;#&lt;/a&gt; ä¸‰ã€é«˜å¯ç”¨ğŸ„&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;é«˜å¯ç”¨é›†ç¾¤ç»“æ„&lt;/li&gt;
&lt;li&gt;å®ç°é«˜å¯ç”¨é›†ç¾¤&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;TC çš„å¼‚åœ°å¤šæœºæˆ¿å®¹ç¾æ¶æ„&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;TC æœåŠ¡ä½œä¸º Seata çš„æ ¸å¿ƒæœåŠ¡ï¼Œä¸€å®šè¦ä¿è¯&lt;mark&gt;é«˜å¯ç”¨&lt;/mark&gt;å’Œ&lt;mark&gt;å¼‚åœ°å®¹ç¾&lt;/mark&gt;.&lt;/p&gt;
&lt;p&gt;å…·ä½“å®ç°æŸ¥çœ‹æ–‡ç« ï¼š&lt;a href=&#34;../Seata/seata%E7%9A%84%E9%83%A8%E7%BD%B2%E5%92%8C%E9%9B%86%E6%88%90.md&#34;&gt;seata çš„éƒ¨ç½²å’Œé›†æˆ.md&lt;/a&gt;.&lt;/p&gt;
&lt;h1 id=&#34;å››å¤šçº§ç¼“å­˜&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#å››å¤šçº§ç¼“å­˜&#34;&gt;#&lt;/a&gt; å››ï¼Œå¤šçº§ç¼“å­˜ğŸ„&lt;/h1&gt;
&lt;p&gt;äº¿çº§æµé‡çš„ç¼“å­˜æ–¹æ¡ˆ&lt;/p&gt;
&lt;h2 id=&#34;41-ä¼ ç»Ÿç¼“å­˜çš„é—®é¢˜&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#41-ä¼ ç»Ÿç¼“å­˜çš„é—®é¢˜&#34;&gt;#&lt;/a&gt; 4.1ã€ä¼ ç»Ÿç¼“å­˜çš„é—®é¢˜ğŸŒ³&lt;/h2&gt;
&lt;p&gt;ä¼ ç»Ÿçš„ç¼“å­˜ç­–ç•¥ä¸€èˆ¬æ˜¯è¯·æ±‚åˆ°è¾¾ Tomcat åï¼Œå…ˆæŸ¥è¯¢ redisï¼Œå¦‚æœæœªå‘½ä¸­åˆ™æŸ¥è¯¢æ•°æ®åº“ï¼Œå­˜åœ¨ä¸‹é¢çš„é—®é¢˜ï¼š&lt;/p&gt;
&lt;p&gt;1ã€è¯·æ±‚è¦ç»è¿‡ Tomcat å¤„ç†ï¼ŒTomcat çš„æ€§èƒ½æˆä¸ºæ•´ä¸ªç³»ç»Ÿçš„ç“¶é¢ˆ&lt;/p&gt;
&lt;p&gt;2ã€Redis ç¼“å­˜å¤±æ•ˆæ—¶ï¼Œä¼šå¯¹æ•°æ®åº“äº§ç”Ÿå†²å‡»&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310191526124.png&#34; alt=&#34;image-20231019152653849&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;42-å¤šçº§ç¼“å­˜æ–¹æ¡ˆ&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#42-å¤šçº§ç¼“å­˜æ–¹æ¡ˆ&#34;&gt;#&lt;/a&gt; 4.2ã€å¤šçº§ç¼“å­˜æ–¹æ¡ˆğŸŒ³&lt;/h2&gt;
&lt;p&gt;å¤šçº§ç¼“å­˜å°±æ˜¯å……åˆ†åˆ©ç”¨è¯·æ±‚å¤„ç†çš„æ¯ä¸ªç¯èŠ‚ï¼Œåˆ†åˆ«æ·»åŠ ç¼“å­˜ï¼Œå‡è½» Tomcat å‹åŠ›ï¼Œæå‡æœåŠ¡æ€§èƒ½ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310191532661.png&#34; alt=&#34;image-20231019153224519&#34;&gt;&lt;/p&gt;
&lt;p&gt;ç”¨ä½œç¼“å­˜çš„ Nginx æ˜¯ä¸šåŠ¡ Nginxï¼Œéœ€è¦éƒ¨ç½²ä¸ºé›†ç¾¤ï¼Œå†æœ‰ä¸“é—¨çš„ Nginx ç”¨æ¥åšåå‘ä»£ç†ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310191534434.png&#34; alt=&#34;image-20231019153411071&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;43-jvmè¿›ç¨‹ç¼“å­˜&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#43-jvmè¿›ç¨‹ç¼“å­˜&#34;&gt;#&lt;/a&gt; 4.3ã€JVM è¿›ç¨‹ç¼“å­˜ğŸŒ³&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;å¯¼å…¥å•†å“æ¡ˆä¾‹&lt;/li&gt;
&lt;li&gt;åˆå§‹ Caffeine&lt;/li&gt;
&lt;li&gt;å®ç°è¿›ç¨‹ç¼“å­˜&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;431-å¯¼å…¥å•†å“æ¡ˆä¾‹&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#431-å¯¼å…¥å•†å“æ¡ˆä¾‹&#34;&gt;#&lt;/a&gt; 4.3.1ã€å¯¼å…¥å•†å“æ¡ˆä¾‹ğŸŒ²&lt;/h3&gt;
&lt;p&gt;æŸ¥çœ‹æ–‡ç« ï¼š&lt;a href=&#34;./%E6%A1%88%E4%BE%8B%E5%AF%BC%E5%85%A5%E8%AF%B4%E6%98%8E/%E6%A1%88%E4%BE%8B%E5%AF%BC%E5%85%A5%E8%AF%B4%E6%98%8E.md&#34;&gt;æ¡ˆä¾‹å¯¼å…¥è¯´æ˜&lt;/a&gt;.&lt;/p&gt;
&lt;h3 id=&#34;432-åˆå§‹caffeine&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#432-åˆå§‹caffeine&#34;&gt;#&lt;/a&gt; 4.3.2ã€åˆå§‹ CaffeineğŸŒ²&lt;/h3&gt;
&lt;h4 id=&#34;4321-æœ¬åœ°è¿›ç¨‹ç¼“å­˜&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#4321-æœ¬åœ°è¿›ç¨‹ç¼“å­˜&#34;&gt;#&lt;/a&gt; 4.3.2.1ã€æœ¬åœ°è¿›ç¨‹ç¼“å­˜ğŸŒ´&lt;/h4&gt;
&lt;p&gt;ç¼“å­˜åœ¨æ—¥å¸¸å¼€å‘ä¸­èµ·åˆ°è‡³å…³é‡è¦çš„ä½œç”¨ã€‚ç”±äºæ˜¯å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œæ•°æ®çš„è¯»å–é€Ÿåº¦æ˜¯éå¸¸å¿«çš„ï¼Œèƒ½å¤§é‡å‡å°‘å¯¹æ•°æ®åº“çš„è®¿é—®ï¼Œå‡å°‘æ•°æ®åº“çš„å‹åŠ›ã€‚æˆ‘ä»¬å§ç¼“å­˜åˆ†ä¸ºä¸¤ç±»ï¼š&lt;/p&gt;
&lt;p&gt;1ã€åˆ†å¸ƒå¼ç¼“å­˜ï¼Œä¾‹å¦‚ Redisï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¼˜ç‚¹ï¼šå­˜å‚¨å®¹é‡æ›´å¤§ï¼Œå¯é æ€§æ›´å¥½ï¼Œå¯ä»¥åœ¨é›†ç¾¤é—´å…±äº«&lt;/li&gt;
&lt;li&gt;ç¼ºç‚¹ï¼šè®¿é—®ç¼“å­˜æœ‰ç½‘ç»œå¼€é”€&lt;/li&gt;
&lt;li&gt;åœºæ™¯ï¼šç¼“å­˜æ•°æ®é‡è¾ƒå¤§ï¼Œå¯é æ€§è¦æ±‚è¾ƒé«˜ï¼Œéœ€è¦åœ¨é›†ç¾¤é—´å…±äº«&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;2ã€è¿›ç¨‹æœ¬åœ°ç¼“å­˜ï¼Œä¾‹å¦‚ HashMapï¼ŒGuavaCacheï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¼˜ç‚¹ï¼šè¯»å–æœ¬åœ°å†…å­˜ï¼Œæ²¡æœ‰ç½‘ç»œå¼€é”€ï¼Œé€Ÿåº¦æ›´å¿«&lt;/li&gt;
&lt;li&gt;ç¼ºç‚¹ï¼šå­˜å‚¨å®¹é‡æœ‰é™ï¼Œå¯é æ€§è¾ƒä½ï¼Œæ— æ³•å…±äº«&lt;/li&gt;
&lt;li&gt;åœºæ™¯ï¼šæ€§èƒ½è¦æ±‚è¾ƒé«˜ï¼Œç¼“å­˜æ•°æ®é‡è¾ƒå°&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Caffeine æ˜¯ä¸€ä¸ªåŸºäº java8 å¼€å‘çš„ï¼Œæä¾›äº†è¿‘ä¹æœ€ä½³å‘½ä¸­ç‡çš„é«˜æ€§èƒ½çš„æœ¬åœ°ç¼“å­˜åº“ã€‚ç›®å‰ Spring å†…éƒ¨çš„ç¼“å­˜ä½¿ç”¨çš„å°±æ˜¯ Caffeineã€‚Github åœ°å€ï¼š&lt;a href=&#34;https://github.com/ben-manes/caffeine&#34;&gt;https://github.com/ben-manes/caffeine&lt;/a&gt;&lt;/p&gt;
&lt;h5 id=&#34;43211-caffeineç¤ºä¾‹&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#43211-caffeineç¤ºä¾‹&#34;&gt;#&lt;/a&gt; 4.3.2.1.1ã€Caffeine ç¤ºä¾‹ğŸ‹&lt;/h5&gt;
&lt;p&gt;å¯ä»¥é€šè¿‡ item-service é¡¹ç›®ä¸­çš„å•å…ƒæµ‹è¯•æ¥å­¦ä¹  Caffeine çš„ä½¿ç”¨ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@Test&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;testBasicOpsTwo&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;// 1. æ„å»º cache å¯¹è±¡&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token class-name&#34;&gt;Cache&lt;/span&gt;&lt;span class=&#34;token generics&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;String&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;String&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt; cache &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Caffeine&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;newBuilder&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;build&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;// 2. å­˜æ•°æ®&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   cache&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;put&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;gf&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;éƒ­æ˜ç„¶&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;// 3. å–æ•°æ®&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token class-name&#34;&gt;String&lt;/span&gt; gf &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; cache&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;getIfPresent&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;gf&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;out&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;gf = &#34;&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; gf&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;// 4. å–æ•°æ®ï¼Œå¦‚æœæœªå‘½ä¸­ï¼Œåˆ™æŸ¥è¯¢æ•°æ®åº“&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token class-name&#34;&gt;String&lt;/span&gt; defaultGF &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; cache&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;defaultGF&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; key &lt;span class=&#34;token operator&#34;&gt;-&gt;&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token comment&#34;&gt;// 4.1. æ ¹æ® key å»æŸ¥è¯¢æ•°æ®åº“&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;æ˜¯ä¸ªå‚»å­&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;out&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;defaultGF = &#34;&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; defaultGF&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;//------------------ æ‰§è¡Œç»“æœ ------------------&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;gf &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; éƒ­æ˜ç„¶&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;defaultGF &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; æ˜¯ä¸ªå‚»å­&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;Caffeine æä¾›äº†ä¸‰ç§ç¼“å­˜é©±é€ç­–ç•¥ï¼š&lt;/p&gt;
&lt;p&gt;1ã€åŸºäºå®¹é‡ï¼šè®¾ç½®ç¼“å­˜çš„æ•°é‡ä¸Šé™&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@Test&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;testBasicOpsTwo&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;// 1. æ„å»º cache å¯¹è±¡&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token class-name&#34;&gt;Cache&lt;/span&gt;&lt;span class=&#34;token generics&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;String&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;String&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt; cache &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Caffeine&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;newBuilder&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;maximumSize&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;// è®¾ç½®ç¼“å­˜å¤§å°ä¸Šé™ä¸º 1&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;build&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;// 2. å­˜æ•°æ®&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   cache&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;put&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;gf&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;éƒ­æ˜ç„¶&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   cache&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;put&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;gf1&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;éƒ­æ˜ç„¶1&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   cache&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;put&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;gf2&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;éƒ­æ˜ç„¶2&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;//        try &amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;//            // å»¶è¿Ÿ 10msï¼Œç»™æ¸…ç†çº¿ç¨‹ä¸€ç‚¹æ—¶é—´&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;//            Thread.sleep(100);&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;//        &amp;#125; catch (InterruptedException e) &amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;//            throw new RuntimeException(e);&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;//        &amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;// 3. å–æ•°æ®&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;out&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;cache&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;getIfPresent&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;gf&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;out&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;cache&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;getIfPresent&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;gf1&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;21&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;out&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;cache&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;getIfPresent&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;gf2&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;22&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;23&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;//---------------- æ‰“å°ç»“æœ ----------------&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;24&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;éƒ­æ˜ç„¶&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;25&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;éƒ­æ˜ç„¶&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;26&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;éƒ­æ˜ç„¶&lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;ä½¿ç”¨çº¿ç¨‹ç¡çœ è®©å…¶ç­‰å¾… 10ms ç»™æ¸…ç†çº¿ç¨‹ä¸€ç‚¹æ—¶é—´&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@Test&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;testBasicOpsTwo&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;// 1. æ„å»º cache å¯¹è±¡&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token class-name&#34;&gt;Cache&lt;/span&gt;&lt;span class=&#34;token generics&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;String&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;String&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt; cache &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Caffeine&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;newBuilder&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;maximumSize&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;// è®¾ç½®ç¼“å­˜å¤§å°ä¸Šé™ä¸º 1&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;build&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;// 2. å­˜æ•°æ®&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   cache&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;put&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;gf&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;éƒ­æ˜ç„¶&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   cache&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;put&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;gf1&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;éƒ­æ˜ç„¶1&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   cache&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;put&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;gf2&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;éƒ­æ˜ç„¶2&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token keyword&#34;&gt;try&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;       &lt;span class=&#34;token comment&#34;&gt;// å»¶è¿Ÿ 10msï¼Œç»™æ¸…ç†çº¿ç¨‹ä¸€ç‚¹æ—¶é—´&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;       &lt;span class=&#34;token class-name&#34;&gt;Thread&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;sleep&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;10l&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;catch&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;InterruptedException&lt;/span&gt; e&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;       &lt;span class=&#34;token keyword&#34;&gt;throw&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;RuntimeException&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;e&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;// 3. å–æ•°æ®&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;out&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;cache&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;getIfPresent&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;gf&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;out&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;cache&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;getIfPresent&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;gf1&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;21&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;out&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;cache&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;getIfPresent&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;gf2&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;22&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;23&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;//---------------- æ‰“å°ç»“æœ ----------------&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;24&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;null&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;25&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;null&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;26&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;éƒ­æ˜ç„¶&lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;2ã€åŸºäºæ—¶é—´ï¼šè®¾ç½®ç¼“å­˜çš„æœ‰æ•ˆæ—¶é—´&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@Test&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;testBasicOpsTwo&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;// 1. æ„å»º cache å¯¹è±¡&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token class-name&#34;&gt;Cache&lt;/span&gt;&lt;span class=&#34;token generics&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;String&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;String&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt; cache &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Caffeine&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;newBuilder&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;expireAfterWrite&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;Duration&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;ofSeconds&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;// è®¾ç½®ç¼“å­˜æœ‰æ•ˆæœŸä¸º 10 ç§’ï¼Œä»æœ€åä¸€æ¬¡å†™å…¥å¼€å§‹è®¡æ—¶&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;build&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;// 2. å­˜æ•°æ®&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   cache&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;put&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;gf&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;éƒ­æ˜ç„¶&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   cache&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;put&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;gf1&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;éƒ­æ˜ç„¶1&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   cache&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;put&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;gf2&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;éƒ­æ˜ç„¶2&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;// 3. å–æ•°æ®&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;out&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;cache&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;getIfPresent&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;gf&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token keyword&#34;&gt;try&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token comment&#34;&gt;// å»¶è¿Ÿ 10msï¼Œç»™æ¸…ç†çº¿ç¨‹ä¸€ç‚¹æ—¶é—´&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token class-name&#34;&gt;Thread&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;sleep&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;11000&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;catch&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;InterruptedException&lt;/span&gt; e&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token keyword&#34;&gt;throw&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;RuntimeException&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;e&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;out&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;cache&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;getIfPresent&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;gf1&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;21&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;out&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;cache&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;getIfPresent&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;gf2&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;22&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;23&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;//------------------- æ‰“å°ç»“æœ -------------------&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;24&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;éƒ­æ˜ç„¶&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;25&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;null&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;26&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;null&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;3ã€åŸºäºå¼•ç”¨ï¼šè®¾ç½®ç¼“å­˜ä¸ºè½¯å¼•ç”¨æˆ–å¼±å¼•ç”¨ï¼Œåˆ©ç”¨ GC æ¥å›æ”¶ç¼“å­˜æ•°æ®ã€‚æ€§èƒ½è¾ƒå·®ï¼Œä¸å»ºè®®ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;&lt;mark&gt;è½¯å¼•ç”¨&lt;/mark&gt;ï¼šå†…å­˜ä¸è¶³æ—¶æ‰ä¼šå›æ”¶ï¼›       &lt;mark&gt;å¼±å¼•ç”¨&lt;/mark&gt;ï¼šå°±ç®—å†…å­˜å……è¶³æ—¶ä¹Ÿä¼šå›æ”¶ï¼›&lt;/p&gt;
&lt;p&gt;åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“ä¸€ä¸ªç¼“å­˜å…ƒç´ è¿‡æœŸçš„æ—¶å€™ï¼ŒCaffeine ä¸ä¼šè‡ªåŠ¨ç«‹å³å°†å…¶æ¸…ç†å’Œé©±é€ã€‚è€Œæ˜¯åœ¨ä¸€æ¬¡è¯»æˆ–å†™æ“ä½œåï¼Œæˆ–è€…åœ¨ç©ºé—²æ—¶é—´å®Œæˆå¯¹å¤±æ•ˆæ•°æ®çš„é©±é€ã€‚&lt;/p&gt;
&lt;h3 id=&#34;433-å®ç°è¿›ç¨‹ç¼“å­˜&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#433-å®ç°è¿›ç¨‹ç¼“å­˜&#34;&gt;#&lt;/a&gt; 4.3.3ã€å®ç°è¿›ç¨‹ç¼“å­˜ğŸŒ²&lt;/h3&gt;
&lt;h4 id=&#34;4331-æ¡ˆä¾‹å®ç°å•†å“çš„æŸ¥è¯¢çš„æœ¬åœ°è¿›ç¨‹ç¼“å­˜&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#4331-æ¡ˆä¾‹å®ç°å•†å“çš„æŸ¥è¯¢çš„æœ¬åœ°è¿›ç¨‹ç¼“å­˜&#34;&gt;#&lt;/a&gt; 4.3.3.1ã€æ¡ˆä¾‹ï¼Œå®ç°å•†å“çš„æŸ¥è¯¢çš„æœ¬åœ°è¿›ç¨‹ç¼“å­˜ğŸŒ´&lt;/h4&gt;
&lt;p&gt;åˆ©ç”¨ Caffeine å®ç°ä¸‹åˆ—éœ€æ±‚ï¼š&lt;/p&gt;
&lt;p&gt;1ã€ç»™æ ¹æ® id æŸ¥è¯¢å•†å“çš„ä¸šåŠ¡æ·»åŠ ç¼“å­˜ï¼Œç¼“å­˜æœªå‘½ä¸­æ—¶æŸ¥è¯¢æ•°æ®åº“&lt;/p&gt;
&lt;p&gt;2ã€ç»™æ ¹æ® id æŸ¥è¯¢å•†å“å­˜åº“çš„ä¸šåŠ¡æ·»åŠ ç¼“å­˜ï¼Œç¼“å­˜æœªå‘½ä¸­æ—¶æŸ¥è¯¢æ•°æ®åº“&lt;/p&gt;
&lt;p&gt;3ã€ç¼“å­˜åˆå§‹å¤§å°ä¸º 100&lt;/p&gt;
&lt;p&gt;4ã€ç¼“å­˜ä¸Šé™ä¸º 10000&lt;/p&gt;
&lt;p&gt;æ­¥éª¤ï¼š&lt;/p&gt;
&lt;p&gt;1ã€ç»™æ ¹æ® id æŸ¥è¯¢å•†å“çš„ä¸šåŠ¡æ·»åŠ ç¼“å­˜ï¼Œç¼“å­˜æœªå‘½ä¸­æ—¶æŸ¥è¯¢æ•°æ®åº“&lt;/p&gt;
&lt;p&gt;2ã€ç»™æ ¹æ® id æŸ¥è¯¢å•†å“å­˜åº“çš„ä¸šåŠ¡æ·»åŠ ç¼“å­˜ï¼Œç¼“å­˜æœªå‘½ä¸­æ—¶æŸ¥è¯¢æ•°æ®åº“&lt;/p&gt;
&lt;p&gt;3ã€ç¼“å­˜åˆå§‹å¤§å°ä¸º 100&lt;/p&gt;
&lt;p&gt;4ã€ç¼“å­˜ä¸Šé™ä¸º 10000&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@Configuration&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;CaffeineConfig&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@Bean&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Cache&lt;/span&gt;&lt;span class=&#34;token generics&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;Long&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Item&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;itemCache&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Caffeine&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;newBuilder&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;initialCapacity&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;100&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;// è®¾ç½®ç¼“å­˜åˆå§‹åŒ–å¤§å°&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;maximumSize&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;10_000&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;// è®¾ç½®ç¼“å­˜æœ€å¤§ä¸Šé™å€¼&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;build&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@Bean&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Cache&lt;/span&gt;&lt;span class=&#34;token generics&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;Long&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;ItemStock&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;itemStockCache&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Caffeine&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;newBuilder&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;initialCapacity&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;100&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;// è®¾ç½®ç¼“å­˜åˆå§‹åŒ–å¤§å°&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;maximumSize&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;10_000&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;// è®¾ç½®ç¼“å­˜æœ€å¤§ä¸Šé™å€¼&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;build&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;5ã€åœ¨ controller å±‚è¿›è¡Œä¸¤ä¸ªç¼“å­˜å¯¹è±¡çš„è‡ªåŠ¨è£…é…&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@Autowired&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Cache&lt;/span&gt;&lt;span class=&#34;token generics&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;Long&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Item&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt; itemCache&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@Autowired&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Cache&lt;/span&gt;&lt;span class=&#34;token generics&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;Long&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;ItemStock&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt; itemStockCache&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;6ã€ç¼–å†™ç¼“å­˜ä»£ç &lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@GetMapping&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;/&amp;#123;id&amp;#125;&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Item&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;findById&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@PathVariable&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;id&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Long&lt;/span&gt; id&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;// ä¼˜å…ˆæ ¹æ®ç¼“å­˜æŸ¥ï¼Œå¦‚æœæœªå‘½ä¸­åˆ™æŸ¥è¯¢æ•°æ®åº“&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; itemCache&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;id&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; key &lt;span class=&#34;token operator&#34;&gt;-&gt;&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; itemService&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;query&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;         &lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;ne&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;status&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;eq&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;id&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; key&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;         &lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;one&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@GetMapping&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;/stock/&amp;#123;id&amp;#125;&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;ItemStock&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;findStockById&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@PathVariable&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;id&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Long&lt;/span&gt; id&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; itemStockCache&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;id&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; key &lt;span class=&#34;token operator&#34;&gt;-&gt;&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; stockService&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;getById&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;id&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;è¯·æ±‚æ¥å£è¿›è¡Œæµ‹è¯•ï¼š&lt;a href=&#34;http://localhost:8081/item/10001&#34;&gt;http://localhost:8081/item/10001&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310191732546.png&#34; alt=&#34;image-20231019173236082&#34;&gt;&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸€æ¬¡è¯·æ±‚æˆ‘ä»¬å¯ä»¥åœ¨ idea æ§åˆ¶å°ä¸­çœ‹åˆ°æ‰“å°äº†ä¸€æ®µæ‰§è¡Œ SQL çš„æ—¥å¿—ï¼Œè¯´æ˜æŸ¥äº†ä¸€ä¸‹æ•°æ®åº“&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;17:31:53:355 DEBUG 5692 --- [nio-8081-exec-1] c.h.item.mapper.ItemMapper.selectOne     : ==&amp;gt;  Preparing: SELECT id,name,title,price,image,category,brand,spec,status,create_time,update_time FROM tb_item WHERE (status &amp;lt;&amp;gt; ? AND id = ?)
17:31:53:383 DEBUG 5692 --- [nio-8081-exec-1] c.h.item.mapper.ItemMapper.selectOne     : ==&amp;gt; Parameters: 3(Integer), 10001(Long)
17:31:53:405 DEBUG 5692 --- [nio-8081-exec-1] c.h.item.mapper.ItemMapper.selectOne     : &amp;lt;==      Total: 1
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ¸…ç©º idea æ§åˆ¶å°å†å¯¹è¯¥é¡µé¢è¿›è¡Œä¸€æ¬¡è®¿é—®ï¼Œå› ä¸ºç¼“å­˜ä¸€å¼€å§‹å°±æ˜¯ç©ºçš„&lt;/p&gt;
&lt;p&gt;å½“æˆ‘ä»¬æ‰§è¡Œè¿‡ä¸€æ¬¡åæ•°æ®å°±ä¼šè¢«ç¼“å­˜èµ·æ¥ï¼Œç¬¬äºŒæ¬¡æ‰§è¡Œå°±ç›´æ¥æ‹¿ç¼“å­˜çš„æ•°æ®äº†å¯ä»¥çœ‹åˆ°æ§åˆ¶å°å¾ˆå¹²å‡€æ²¡æœ‰ä¸€ç‚¹æ‰“å°ä¿¡æ¯&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310191733727.png&#34; alt=&#34;image-20231019173347678&#34;&gt;&lt;/p&gt;
&lt;p&gt;å½“ç„¶åº“å­˜ä¹Ÿæ˜¯ä¸€æ ·çš„é“ç†&lt;/p&gt;
&lt;p&gt;è®¿é—® uriï¼š&lt;a href=&#34;http://localhost:8081/item/stock/10001&#34;&gt;http://localhost:8081/item/stock/10001&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310191735447.png&#34; alt=&#34;image-20231019173509976&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310191734949.png&#34; alt=&#34;image-20231019173456734&#34;&gt;&lt;/p&gt;
&lt;p&gt;æ¸…ç©ºæ§åˆ¶å°ä¿¡æ¯è¿›è¡Œç¬¬äºŒæ¬¡è®¿é—®ï¼Œæ­¤æ—¶æ•°æ®å·²ç»è¢«ç¼“å­˜èµ·æ¥äº†ã€‚&lt;/p&gt;
&lt;p&gt;äºŒæ¬¡ä¾æ—§å¾ˆå¹²å‡€&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310191735198.png&#34; alt=&#34;image-20231019173553835&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;äº”-luaè¯­è¨€å…¥é—¨&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#äº”-luaè¯­è¨€å…¥é—¨&#34;&gt;#&lt;/a&gt; äº”ã€Lua è¯­è¨€å…¥é—¨ğŸ„&lt;/h1&gt;
&lt;p&gt;å› ä¸º Nginx å¼€å‘éœ€è¦ä½¿ç”¨ Lua è¯­è¨€æ¥è¿›è¡Œç¼–ç¨‹ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±éœ€è¦å­¦ä¹  Lua è¯­è¨€&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310191745432.png&#34; alt=&#34;image-20231019174517515&#34;&gt;&lt;/p&gt;
&lt;p&gt;å­¦ä¹ å†…å®¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åˆå§‹ Lua&lt;/li&gt;
&lt;li&gt;å˜é‡å’Œå¾ªç¯&lt;/li&gt;
&lt;li&gt;æ¡ä»¶æ§åˆ¶ï¼Œå‡½æ•°&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;51-åˆå§‹lua&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#51-åˆå§‹lua&#34;&gt;#&lt;/a&gt; 5.1ã€åˆå§‹ LuağŸŒ³&lt;/h2&gt;
&lt;p&gt;Lua æ˜¯ä¸€ç§è½»é‡çº§å°å·§çš„è„šæœ¬è¯­è¨€ï¼Œç”¨æ ‡å‡† C è¯­è¨€ç¼–å†™å¹¶ä»¥æºä»£ç å½¢å¼å¼€æ”¾ï¼Œå…¶è®¾è®¡ç›®çš„æ˜¯ä¸ºäº†åµŒå…¥åº”ç”¨ç¨‹åºä¸­ï¼Œä»è€Œä¸ºåº”ç”¨ç¨‹åºæä¾›çµæ´»çš„æ‰©å±•å’Œå®šåˆ¶åŠŸèƒ½ã€‚å®˜ç½‘ï¼š&lt;a href=&#34;http://www.lua.org/&#34;&gt;http://www.lua.org/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310191751131.png&#34; alt=&#34;image-20231019175148607&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;511-helloworld&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#511-helloworld&#34;&gt;#&lt;/a&gt; 5.1.1ã€HelloWorldğŸŒ²&lt;/h3&gt;
&lt;p&gt;1ã€åœ¨ Linux è™šæ‹Ÿæœºçš„ä»»æ„ç›®å½•ä¸‹ï¼Œæ–°å»ºä¸€ä¸ª hello.lua æ–‡ä»¶&lt;/p&gt;
&lt;figure class=&#34;highlight sh&#34;&gt;&lt;figcaption data-lang=&#34;sh&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;root@localhost ~&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token comment&#34;&gt;# vim hello.lua&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;2ã€æ·»åŠ ä¸‹é¢çš„å†…å®¹&lt;/p&gt;
&lt;figure class=&#34;highlight sh&#34;&gt;&lt;figcaption data-lang=&#34;sh&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;print&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;Hello World!&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;3ã€è¿è¡Œ&lt;/p&gt;
&lt;figure class=&#34;highlight sh&#34;&gt;&lt;figcaption data-lang=&#34;sh&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;root@localhost ~&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token comment&#34;&gt;# lua hello.lua&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;Hello World&lt;span class=&#34;token operator&#34;&gt;!&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;root@localhost ~&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token comment&#34;&gt;#&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h3 id=&#34;512-æ•°æ®ç±»å‹&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#512-æ•°æ®ç±»å‹&#34;&gt;#&lt;/a&gt; 5.1.2ã€æ•°æ®ç±»å‹ğŸŒ²&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;æ•°æ®ç±»å‹&lt;/th&gt;
&lt;th&gt;æè¿°&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;nil&lt;/td&gt;
&lt;td&gt;è¿™ä¸ªæœ€ç®€å•ï¼Œåªæœ‰å€¼ nil å±äºè¯¥ç±»ï¼Œè¡¨ç¤ºä¸€ä¸ªæ— æ•ˆå€¼ (åœ¨æ¡ä»¶è¡¨è¾¾å¼ä¸­ç›¸å½“äº false)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;boolean&lt;/td&gt;
&lt;td&gt;åŒ…å«ä¸¤ä¸ªå€¼ï¼šfalse å’Œ true&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;number&lt;/td&gt;
&lt;td&gt;è¡¨ç¤ºåŒç²¾åº¦ç±»å‹çš„å®æµ®ç‚¹æ•°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;string&lt;/td&gt;
&lt;td&gt;å­—ç¬¦ä¸²ç”±ä¸€å¯¹åŒå¼•å·æˆ–å•å¼•å·æ¥è¡¨ç¤º&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;function&lt;/td&gt;
&lt;td&gt;ç”± C æˆ– Lua ç¼–å†™çš„å‡½æ•°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;table&lt;/td&gt;
&lt;td&gt;Lua ä¸­çš„è¡¨ (table) å…¶å®æ˜¯ä¸€ä¸ª â€œå…³è”æ•°ç»„â€ (associative arrays)ï¼Œæ•°ç»„çš„ç´¢å¼•å¯ä»¥æ˜¯æ•°å­—ï¼Œå­—ç¬¦ä¸²æˆ–è¡¨ç±»å‹ã€‚åœ¨ Lua é‡Œï¼Œtable çš„åˆ›å»ºæ˜¯é€šè¿‡ â€œæ„é€ è¡¨è¾¾å¼â€ æ¥å®Œæˆï¼Œæœ€ç®€å•æ„é€ è¡¨è¾¾å¼æ˜¯ { }ï¼Œç”¨æ¥åˆ›å»ºä¸€ä¸ªç©ºè¡¨ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;å¯ä»¥åˆ©ç”¨ type å‡½æ•°æµ‹è¯•ç»™å®šå˜é‡æˆ–è€…å€¼çš„ç±»å‹&lt;/p&gt;
&lt;figure class=&#34;highlight sh&#34;&gt;&lt;figcaption data-lang=&#34;sh&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;root@localhost ~&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token comment&#34;&gt;# vim hello.lua&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;root@localhost ~&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token comment&#34;&gt;# lua hello.lua&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;string&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;root@localhost ~&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token comment&#34;&gt;# cat hello.lua&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;print&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;type&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;Hello World!&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;))&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;root@localhost ~&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token comment&#34;&gt;#&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;figure class=&#34;highlight sh&#34;&gt;&lt;figcaption data-lang=&#34;sh&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;root@localhost ~&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token comment&#34;&gt;# vim hello.lua&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;root@localhost ~&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token comment&#34;&gt;# lua hello.lua&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;number&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;root@localhost ~&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token comment&#34;&gt;# cat hello.lua&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;print&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;type&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;10.4&lt;/span&gt; * &lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;))&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;root@localhost ~&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token comment&#34;&gt;#&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h3 id=&#34;513-å˜é‡&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#513-å˜é‡&#34;&gt;#&lt;/a&gt; 5.1.3ã€å˜é‡ğŸŒ²&lt;/h3&gt;
&lt;p&gt;Lua å£°æ˜å˜é‡çš„æ—¶å€™ï¼Œå¹¶ä¸éœ€è¦æŒ‡å®šæ•°æ®ç±»å‹ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight lua&#34;&gt;&lt;figcaption data-lang=&#34;lua&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- å£°æ˜å­—ç¬¦ä¸²&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; str &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;hello&#39;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- å£°æ˜æ•°å­—&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; num &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;21&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- å£°æ˜å¸ƒå°”ç±»å‹&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; flag &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;true&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- å£°æ˜æ•°ç»„ key ä¸ºç´¢å¼•çš„ table &lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; arr &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;java&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;python&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;lua&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- å£°æ˜ table ï¼Œç±»ä¼¼ java çš„ map&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; map &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;name &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;Jack&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; age &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;21&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;è®¿é—® tableï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight lua&#34;&gt;&lt;figcaption data-lang=&#34;lua&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- è®¿é—®æ•°ç»„ï¼Œlua æ•°ç»„çš„è§’æ ‡ä» 1 å¼€å§‹&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token function&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;arr&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- è®¿é—® table&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token function&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;map&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;name&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token function&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;map&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;name&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;å­—ç¬¦ä¸²æ‹¼æ¥ä½¿ç”¨  &lt;code&gt;..&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;514-å¾ªç¯&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#514-å¾ªç¯&#34;&gt;#&lt;/a&gt; 5.1.4ã€å¾ªç¯ğŸŒ²&lt;/h3&gt;
&lt;p&gt;æ•°ç»„ï¼Œtable éƒ½å¯ä»¥åˆ©ç”¨ for å¾ªç¯æ¥éå†&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;éå†æ•°ç»„ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight lua&#34;&gt;&lt;figcaption data-lang=&#34;lua&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- å£°æ˜æ•°ç»„ key ä¸ºç´¢å¼•çš„ table&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; arr &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;java&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;python&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;lua&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- éå†æ•°ç»„&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; index&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; value &lt;span class=&#34;token keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;ipairs&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;arr&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;do&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token function&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;index&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; value&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;end&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;ul&gt;
&lt;li&gt;éå† table&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight lua&#34;&gt;&lt;figcaption data-lang=&#34;lua&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- å£°æ˜ mapï¼Œä¹Ÿå°±æ˜¯ table&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; map &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;name &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;Jack&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; age &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;21&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- éå† table&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; key&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;value &lt;span class=&#34;token keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;pairs&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;map&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;do&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token function&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;key&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; value&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;end&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h3 id=&#34;515-å‡½æ•°&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#515-å‡½æ•°&#34;&gt;#&lt;/a&gt; 5.1.5ã€å‡½æ•°ğŸŒ²&lt;/h3&gt;
&lt;p&gt;å®šä¹‰å‡½æ•°çš„è¯­æ³•ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight lua&#34;&gt;&lt;figcaption data-lang=&#34;lua&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;function&lt;/span&gt; å‡½æ•°å&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt; argument1&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; argument2&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; argument3 &lt;span class=&#34;token punctuation&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;-- å‡½æ•°ä½“&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; è¿”å›å€¼&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;end&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;ä¾‹å¦‚ï¼Œå®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œç”¨æ¥æ‰“å°æ•°ç»„ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight lua&#34;&gt;&lt;figcaption data-lang=&#34;lua&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;printArr&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;arr&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; index&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; value &lt;span class=&#34;token keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;ipairs&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;arr&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;do&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token function&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;value&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token keyword&#34;&gt;end&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;end&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h3 id=&#34;516-æ¡ä»¶æ§åˆ¶&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#516-æ¡ä»¶æ§åˆ¶&#34;&gt;#&lt;/a&gt; 5.1.6ã€æ¡ä»¶æ§åˆ¶ğŸŒ²&lt;/h3&gt;
&lt;p&gt;ç±»ä¼¼ Java çš„æ¡ä»¶æ§åˆ¶ï¼Œä¾‹å¦‚ if , else è¯­æ³•ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight lua&#34;&gt;&lt;figcaption data-lang=&#34;lua&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;å¸ƒå°”è¡¨è¾¾å¼&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;then&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;-- [å¸ƒå°”è¡¨è¾¾å¼ä¸º true æ—¶æ‰§è¡Œè¯¥è¯­å¥å— --]&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;else&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;-- [å¸ƒå°”è¡¨è¾¾å¼ä¸º false æ—¶æ‰§è¡Œè¯¥è¯­å¥å— --]&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;end&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;ä¸ java ä¸åŒï¼Œå¸ƒå°”è¡¨è¾¾å¼ä¸­çš„é€»è¾‘è¿ç®—æ˜¯åŸºäºè‹±æ–‡å•è¯ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;æ“ä½œç¬¦&lt;/th&gt;
&lt;th&gt;æè¿°&lt;/th&gt;
&lt;th&gt;å®ä¾‹&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;and&lt;/td&gt;
&lt;td&gt;é€»è¾‘ä¸æ“ä½œç¬¦ã€‚è‹¥ A ä¸º falseï¼Œåˆ™è¿”å› Aï¼Œå¦åˆ™è¿”å› B&lt;/td&gt;
&lt;td&gt;(A and B) ä¸º false&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;or&lt;/td&gt;
&lt;td&gt;é€»è¾‘æˆ–æ“ä½œç¬¦ã€‚è‹¥ A ä¸º trueï¼Œåˆ™è¿”å› Aï¼Œå¦åˆ™è¿”å› B&lt;/td&gt;
&lt;td&gt;(A or B) ä¸º true&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;not&lt;/td&gt;
&lt;td&gt;é€»è¾‘éæ“ä½œç¬¦ã€‚ä¸é€»è¾‘è¿ç®—ç»“æœç›¸åï¼Œå¦‚æœæ¡ä»¶ä¸º trueï¼Œé€»è¾‘éä¸º false&lt;/td&gt;
&lt;td&gt;not (A and B) ä¸º true&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;å…­-å¤šçº§ç¼“å­˜&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#å…­-å¤šçº§ç¼“å­˜&#34;&gt;#&lt;/a&gt; å…­ã€å¤šçº§ç¼“å­˜ğŸ„&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;å®‰è£… OpenResty&lt;/li&gt;
&lt;li&gt;OpenResty å¿«é€Ÿå…¥é—¨&lt;/li&gt;
&lt;li&gt;è¯·æ±‚å‚æ•°å¤„ç†&lt;/li&gt;
&lt;li&gt;æŸ¥è¯¢ Tomcat&lt;/li&gt;
&lt;li&gt;Redis ç¼“å­˜é¢„çƒ­&lt;/li&gt;
&lt;li&gt;æŸ¥è¯¢ Redis ç¼“å­˜&lt;/li&gt;
&lt;li&gt;Nginx æœ¬åœ°ç¼“å­˜&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;61-åˆå§‹openresty&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#61-åˆå§‹openresty&#34;&gt;#&lt;/a&gt; 6.1ã€åˆå§‹ OpenRestyğŸŒ³&lt;/h2&gt;
&lt;p&gt;OpenResty æ˜¯ä¸€ä¸ªåŸºäº Nginx çš„é«˜æ€§èƒ½ Web å¹³å°ï¼Œç”¨äºæ–¹ä¾¿åœ°æ­å»ºèƒ½å¤Ÿå¤„ç†é«˜å¹¶å‘ï¼Œæ‰©å±•æ€§æé«˜çš„åŠ¨æ€ Web åº”ç”¨ï¼ŒWeb æœåŠ¡å’ŒåŠ¨æ€ç½‘å…³ã€‚å…·å¤‡ä¸‹åˆ—ç‰¹ç‚¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å…·å¤‡ Nginx çš„å®Œæ•´åŠŸèƒ½&lt;/li&gt;
&lt;li&gt;åŸºäº Lua è¯­è¨€è¿›è¡Œæ‰©å±•ï¼Œé›†æˆäº†å¤§é‡ç²¾è‰¯çš„ Lua åº“ï¼Œç¬¬ä¸‰æ–¹æ¨¡å—&lt;/li&gt;
&lt;li&gt;å…è®¸ä½¿ç”¨ Lua è‡ªå®šä¹‰ä¸šåŠ¡é€»è¾‘ï¼Œè‡ªå®šä¹‰åº“&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å®˜æ–¹ç½‘ç«™ï¼š&lt;a href=&#34;https://openresty.org/cn/&#34;&gt;https://openresty.org/cn/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310200852606.png&#34; alt=&#34;image-20231020085036341&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;611-openrestyå®‰è£…&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#611-openrestyå®‰è£…&#34;&gt;#&lt;/a&gt; 6.1.1ã€OpenResty å®‰è£…ğŸŒ²&lt;/h3&gt;
&lt;p&gt;æŸ¥çœ‹æ–‡ç« ï¼š&lt;a href=&#34;./OpenResty%E5%AE%89%E8%A3%85/%E5%AE%89%E8%A3%85OpenResty.md&#34;&gt;å®‰è£… OpenResty&lt;/a&gt;.&lt;/p&gt;
&lt;h3 id=&#34;612-æ¡ˆä¾‹openrestyå¿«é€Ÿå…¥é—¨å®ç°å•†å“è¯¦æƒ…é¡µæ•°æ®æŸ¥è¯¢&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#612-æ¡ˆä¾‹openrestyå¿«é€Ÿå…¥é—¨å®ç°å•†å“è¯¦æƒ…é¡µæ•°æ®æŸ¥è¯¢&#34;&gt;#&lt;/a&gt; 6.1.2ã€æ¡ˆä¾‹ï¼ŒOpenResty å¿«é€Ÿå…¥é—¨ï¼Œå®ç°å•†å“è¯¦æƒ…é¡µæ•°æ®æŸ¥è¯¢ğŸŒ²&lt;/h3&gt;
&lt;p&gt;å•†å“è¯¦æƒ…é¡µç›®å‰å±•ç¤ºçš„æ˜¯å‡æ•°æ®ï¼Œåœ¨æµè§ˆå™¨çš„æ§åˆ¶å°å¯ä»¥çœ‹åˆ°æŸ¥è¯¢å•†å“ä¿¡æ¯çš„è¯·æ±‚ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310200915073.png&#34; alt=&#34;image-20231020091453815&#34;&gt;&lt;/p&gt;
&lt;p&gt;è€Œè¿™ä¸ªè¯·æ±‚æœ€ç»ˆè¢«åå‘ä»£ç†åˆ°è™šæ‹Ÿæœºçš„ OpenResty é›†ç¾¤ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310200915958.png&#34; alt=&#34;image-20231020091503555&#34;&gt;&lt;/p&gt;
&lt;p&gt;éœ€æ±‚ï¼šåœ¨ OpenResty ä¸­æ¥æ”¶è¿™ä¸ªè¯·æ±‚ï¼Œå¹¶è¿”å›ä¸€æ®µå•†å“çš„å‡æ•°æ®ã€‚&lt;/p&gt;
&lt;p&gt;æ­¥éª¤ï¼šä¸€ã€‚&lt;/p&gt;
&lt;p&gt;1ã€åœ¨ nginx.conf çš„ http ä¸‹é¢ï¼Œæ·»åŠ å¯¹ OpenResty çš„ Lua æ¨¡å—çš„åŠ è½½&lt;/p&gt;
&lt;figure class=&#34;highlight sh&#34;&gt;&lt;figcaption data-lang=&#34;sh&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# lua æ¨¡å—&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;lua_package_path &lt;span class=&#34;token string&#34;&gt;&#34;/usr/local/openresty/lualib/?.lua;;&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# c æ¨¡å—     &lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;lua_package_cpath &lt;span class=&#34;token string&#34;&gt;&#34;/usr/local/openresty/lualib/?.so;;&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;2ã€åœ¨ nginx.conf çš„ server ä¸‹é¢ï¼Œæ·»åŠ å¯¹ /api/item è¿™ä¸ªè·¯å¾„çš„ç›‘å¬&lt;/p&gt;
&lt;figure class=&#34;highlight sh&#34;&gt;&lt;figcaption data-lang=&#34;sh&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# è¿™é‡Œå¯ä»¥ç†è§£ä¸ºå°±æ˜¯ SpringMVC ä¸­çš„ Controller&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;location /api/item &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# é»˜è®¤çš„å“åº”ç±»å‹&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;default_type application/json&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# è¿™é‡Œå¯ä»¥ç†è§£ä¸ºå°±æ˜¯ Service ä¸šåŠ¡é€»è¾‘å±‚&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# å“åº”ç»“æœç”± lua/item.lua ä¸‹çš„æ–‡ä»¶å†³å®š&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;content_by_lua_file lua/item.lua&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;æ­¥éª¤ï¼šäºŒã€‚&lt;/p&gt;
&lt;p&gt;1ã€åœ¨ nginx ç›®å½•åˆ›å»ºæ–‡ä»¶å¤¹ï¼šlua&lt;/p&gt;
&lt;figure class=&#34;highlight sh&#34;&gt;&lt;figcaption data-lang=&#34;sh&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;root@localhost nginx&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token comment&#34;&gt;# mkdir lua&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;2ã€åœ¨ lua æ–‡ä»¶å¤¹ä¸‹ï¼Œæ–°å»ºæ–‡ä»¶ï¼šitem.lua&lt;/p&gt;
&lt;figure class=&#34;highlight sh&#34;&gt;&lt;figcaption data-lang=&#34;sh&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;root@localhost nginx&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token comment&#34;&gt;# touch lua/item.lua&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;3ã€å†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight lua&#34;&gt;&lt;figcaption data-lang=&#34;lua&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;--  è¿”å›å‡æ•°æ®ï¼Œè¿™é‡Œçš„ ngx.say () å‡½æ•°ï¼Œå°±æ˜¯å†™æ•°æ®åˆ° Response ä¸­&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;say&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;&amp;#123;&#34;id&#34;:10001, &#34;name&#34;:&#34;SALSA AIR&#34;&amp;#125;&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;è¿™é‡Œé¢çš„å‡æ•°æ®å» uriï¼š&lt;a href=&#34;http://localhost/item.html?id=10001%E4%B8%AD%E6%89%93%E5%BC%80%E6%8E%A7%E5%88%B6%E5%8F%B0%E9%80%89%E6%8B%A9vue%E7%84%B6%E5%90%8E%E8%B5%8B%E5%80%BCItem%E4%B9%9F%E5%B0%B1%E6%98%AFObject%E5%AF%B9%E8%B1%A1%EF%BC%8C%E5%B0%86%E9%87%8C%E9%9D%A2%E7%9A%84%E6%95%B0%E6%8D%AE%E4%BD%9C%E4%B8%BA%E5%81%87%E6%95%B0%E6%8D%AE%E4%BD%BF%E7%94%A8&#34;&gt;http://localhost/item.html?id=10001 ä¸­æ‰“å¼€æ§åˆ¶å°é€‰æ‹© vue ç„¶åèµ‹å€¼ Item ä¹Ÿå°±æ˜¯ Object å¯¹è±¡ï¼Œå°†é‡Œé¢çš„æ•°æ®ä½œä¸ºå‡æ•°æ®ä½¿ç”¨&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªé¡µé¢æ˜¯ä» nginx ä»£ç†é‡Œé¢è®¿é—®è¿‡æ¥çš„&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310200940251.png&#34; alt=&#34;image-20231020094054757&#34;&gt;&lt;/p&gt;
&lt;p&gt;å°†å‡æ•°æ®æ‹·è´åˆ° ngx.say (â€˜â€™) é‡Œé¢&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310200942719.png&#34; alt=&#34;image-20231020094215395&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä¸ºäº†èƒ½åŒºåˆ†ä¸€ä¸‹æ˜¯å¦æˆåŠŸï¼Œæˆ‘ä»¬å°†é‡Œé¢çš„ä¸€äº›æ•°æ®è¿›è¡Œä¸€ä¸‹ä¿®æ”¹&lt;/p&gt;
&lt;p&gt;æ­¤å¤„åªæ˜¯ä¿®æ”¹äº†å°ºå¯¸å’Œä»·æ ¼&lt;/p&gt;
&lt;figure class=&#34;highlight lua&#34;&gt;&lt;figcaption data-lang=&#34;lua&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;say&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;&amp;#123;&#34;id&#34;:10001,&#34;name&#34;:&#34;SALSA AIR&#34;,&#34;title&#34;:&#34;RIMOWA 31å¯¸æ‰˜è¿ç®±æ‹‰æ†ç®± SALSA AIRç³»åˆ—æœç»¿è‰² 820.70.36.4&#34;,&#34;price&#34;:27900,&#34;image&#34;:&#34;https://m.360buyimg.com/mobilecms/s720x720_jfs/t6934/364/1195375010/84676/e9f2c55f/597ece38N0ddcbc77.jpg!q70.jpg.webp&#34;,&#34;category&#34;:&#34;æ‹‰æ†ç®±&#34;,&#34;brand&#34;:&#34;RIMOWA&#34;,&#34;spec&#34;:&#34;&#34;,&#34;status&#34;:1,&#34;createTime&#34;:&#34;2019-04-30T16:00:00.000+00:00&#34;,&#34;updateTime&#34;:&#34;2019-04-30T16:00:00.000+00:00&#34;,&#34;stock&#34;:2999,&#34;sold&#34;:31290&amp;#125;&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;å®Œæ•´çš„ nginx.conf é…ç½®å†…å®¹ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight nginx&#34;&gt;&lt;figcaption data-lang=&#34;nginx&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;#user  nobody;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;worker_processes&lt;/span&gt;  &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;error_log&lt;/span&gt;  logs/error.log&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;events&lt;/span&gt;&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;worker_connections&lt;/span&gt;  &lt;span class=&#34;token number&#34;&gt;1024&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;http&lt;/span&gt;&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;include&lt;/span&gt;       mime.types&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;default_type&lt;/span&gt;  application/octet-stream&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;sendfile&lt;/span&gt;        &lt;span class=&#34;token boolean&#34;&gt;on&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;keepalive_timeout&lt;/span&gt;  &lt;span class=&#34;token number&#34;&gt;65&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;# lua æ¨¡å—&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;lua_package_path&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;/usr/local/openresty/lualib/?.lua;;&#34;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;# c æ¨¡å—     &lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;lua_package_cpath&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;/usr/local/openresty/lualib/?.so;;&#34;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;  &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;server&lt;/span&gt;&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;21&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;listen&lt;/span&gt;       &lt;span class=&#34;token number&#34;&gt;8081&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;22&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;server_name&lt;/span&gt;  localhost&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;23&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;location&lt;/span&gt; /api/item&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;24&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;          &lt;span class=&#34;token comment&#34;&gt;# é»˜è®¤çš„å“åº”ç±»å‹&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;25&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;          &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;default_type&lt;/span&gt; application/json&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;26&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;          &lt;span class=&#34;token comment&#34;&gt;# å“åº”ç»“æœç”± lua/item.lua ä¸‹çš„æ–‡ä»¶å†³å®š&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;27&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;          &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;content_by_lua_file&lt;/span&gt; lua/item.lua&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;28&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;29&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;location&lt;/span&gt; /&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;30&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;root&lt;/span&gt;   html&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;31&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;index&lt;/span&gt;  index.html index.htm&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;32&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;33&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;error_page&lt;/span&gt;   &lt;span class=&#34;token number&#34;&gt;500&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;502&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;503&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;504&lt;/span&gt;  /50x.html&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;34&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;location&lt;/span&gt; = /50x.html&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;35&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;root&lt;/span&gt;   html&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;36&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;37&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;38&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;4ã€é‡æ–°åŠ è½½é…ç½®&lt;/p&gt;
&lt;figure class=&#34;highlight sh&#34;&gt;&lt;figcaption data-lang=&#34;sh&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;nginx &lt;span class=&#34;token parameter variable&#34;&gt;-s&lt;/span&gt; reload&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;æŸ¥çœ‹å•†å“é¡µé¢ï¼Œæ²¡æœ‰åˆ·æ–°å‰&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310200946010.png&#34; alt=&#34;image-20231020094617482&#34;&gt;&lt;/p&gt;
&lt;p&gt;åˆ·æ–°å&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°å°ºå¯¸å’Œä»·æ ¼è¢«ä¿®æ”¹äº†ä½†æ˜¯ä¸­æ–‡ä¹Ÿä¹±ç äº†ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310200951850.png&#34; alt=&#34;image-20231020095132419&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;62-openrestyè·å–è¯·æ±‚å‚æ•°&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#62-openrestyè·å–è¯·æ±‚å‚æ•°&#34;&gt;#&lt;/a&gt; 6.2ã€OpenResty è·å–è¯·æ±‚å‚æ•°ğŸŒ³&lt;/h2&gt;
&lt;p&gt;OpenResty æä¾›äº†å„ç§ API ç”¨æ¥è·å–ä¸åŒç±»å‹çš„è¯·æ±‚å‚æ•°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310200958589.png&#34; alt=&#34;image-20231020095810221&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;621-æ¡ˆä¾‹è·å–è¯·æ±‚è·¯å¾„ä¸­çš„å•†å“idä¿¡æ¯æ‹¼æ¥åˆ°jsonç»“æœä¸­è¿”å›&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#621-æ¡ˆä¾‹è·å–è¯·æ±‚è·¯å¾„ä¸­çš„å•†å“idä¿¡æ¯æ‹¼æ¥åˆ°jsonç»“æœä¸­è¿”å›&#34;&gt;#&lt;/a&gt; 6.2.1ã€æ¡ˆä¾‹ï¼Œè·å–è¯·æ±‚è·¯å¾„ä¸­çš„å•†å“ id ä¿¡æ¯ï¼Œæ‹¼æ¥åˆ° json ç»“æœä¸­è¿”å›ğŸŒ²&lt;/h3&gt;
&lt;p&gt;åœ¨æŸ¥è¯¢å•†å“ä¿¡æ¯çš„è¯·æ±‚ä¸­ï¼Œé€šè¿‡è·¯å¾„å ä½ç¬¦çš„æ–¹å¼ï¼Œä¼ é€’äº†å•†å“ id åˆ°åå°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310201002974.png&#34; alt=&#34;image-20231020100241654&#34;&gt;&lt;/p&gt;
&lt;p&gt;éœ€æ±‚ï¼šåœ¨ OpenResty ä¸­æ¥æ”¶è¿™ä¸ªè¯·æ±‚ï¼Œå¹¶è·å–è·¯å¾„ä¸­çš„ id ä¿¡æ¯ï¼Œæ‹¼æ¥åˆ°ç»“æœçš„ json å­—ç¬¦ä¸²ä¸­è¿”å›&lt;/p&gt;
&lt;p&gt;OpenResty ä¸­æ¥å—è¯·æ±‚&lt;/p&gt;
&lt;figure class=&#34;highlight nginx&#34;&gt;&lt;figcaption data-lang=&#34;nginx&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;location&lt;/span&gt; ~ /api/item(\d+)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;# é»˜è®¤çš„å“åº”ç±»å‹&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;default_type&lt;/span&gt; application/json&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;# å“åº”ç»“æœç”± lua/item.lua ä¸‹çš„æ–‡ä»¶å†³å®š&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;content_by_lua_file&lt;/span&gt; lua/item.lua&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;å¹¶è·å–è·¯å¾„ä¸­çš„ id ä¿¡æ¯ï¼Œæ‹¼æ¥åˆ°ç»“æœçš„ json å­—ç¬¦ä¸²ä¸­è¿”å›&lt;/p&gt;
&lt;figure class=&#34;highlight lua&#34;&gt;&lt;figcaption data-lang=&#34;lua&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- è·å–è·¯å¾„å‚æ•°&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; id &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;var&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- è¿”å›ç»“æœ&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;say&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;&amp;#123;&#34;id&#34;:&#39;&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;..&lt;/span&gt; id &lt;span class=&#34;token operator&#34;&gt;..&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;,&#34;name&#34;:&#34;SALSA AIR&#34;,&#34;title&#34;:&#34;RIMOWA 31å¯¸æ‰˜è¿ç®±æ‹‰æ†ç®± SALSA AIRç³»åˆ—æœç»¿è‰² 820.70.36.4&#34;,&#34;price&#34;:27900,&#34;image&#34;:&#34;https://m.360buyimg.com/mobilecms/s720x720_jfs/t6934/364/1195375010/84676/e9f2c55f/597ece38N0ddcbc77.jpg!q70.jpg.webp&#34;,&#34;category&#34;:&#34;æ‹‰æ†ç®±&#34;,&#34;brand&#34;:&#34;RIMOWA&#34;,&#34;spec&#34;:&#34;&#34;,&#34;status&#34;:1,&#34;createTime&#34;:&#34;2019-04-30T16:00:00.000+00:00&#34;,&#34;updateTime&#34;:&#34;2019-04-30T16:00:00.000+00:00&#34;,&#34;stock&#34;:2999,&#34;sold&#34;:31290&amp;#125;&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;é‡å¯ Linux ä¸­çš„ nginx æœåŠ¡å™¨&lt;/p&gt;
&lt;figure class=&#34;highlight sh&#34;&gt;&lt;figcaption data-lang=&#34;sh&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;nginx &lt;span class=&#34;token parameter variable&#34;&gt;-s&lt;/span&gt; reload&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;è®¿é—®é¡µé¢è¿›è¡Œæµ‹è¯•ï¼š&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://localhost/item.html?id=10001&#34;&gt;http://localhost/item.html?id=10001&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è¯·æ±‚ç»“æœ&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310201022922.png&#34; alt=&#34;image-20231020102241989&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://localhost/item.html?id=10002&#34;&gt;http://localhost/item.html?id=10002&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è¯·æ±‚ç»“æœ&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310201023953.png&#34; alt=&#34;image-20231020102259850&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ° id å°±ä¸å†æ˜¯å†™æ­»çš„äº†ï¼Œè€Œæ˜¯å¯ä»¥äº‹å®å˜åŒ–çš„&lt;/p&gt;
&lt;h2 id=&#34;63-æŸ¥è¯¢tomcat&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#63-æŸ¥è¯¢tomcat&#34;&gt;#&lt;/a&gt; 6.3ã€æŸ¥è¯¢ TomcatğŸŒ³&lt;/h2&gt;
&lt;p&gt;å…ˆçœ‹ä¸‹å¤šçº§ç¼“å­˜çš„æ¶æ„ã€‚ç›®å‰å·²ç»å‡†å¤‡å¥½äº† nginx åå‘ä»£ç†æœåŠ¡å™¨ï¼Œå®ƒå»æ¥å—å‰ç«¯çš„è¯·æ±‚å¹¶ä¸”è½¬åˆ° OpenRestyï¼ŒæœåŠ¡ç«¯ä¹Ÿç¼–å†™å¥½äº†è¿›ç¨‹ç¼“å­˜ OpenResty ä¹Ÿæ­å¥½äº†ï¼Œä½†æ˜¯ OpenResty æ¥æ”¶åˆ°è¯·æ±‚åè¦æŸ¥è¯¢æ•°æ®ã€‚æˆ‘ä»¬å…ˆå®ç°ä» Tomcat å»æŸ¥ç„¶åå†å­˜å‚¨åˆ°ç¼“å­˜ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;éœ€è¦æ³¨å†Œ OPenResty åœ¨è™šæ‹Ÿæœºä¸Šï¼Œè€Œ Tomcat åœ¨æœ¬æœºä¸Šï¼Œip åœ°å€ä¸åŒ&lt;/p&gt;
&lt;p&gt;ä¸¤ä¸ª ip åœ°å€è®¿é—®çš„ä¾¿æ·æ–¹å¼ï¼šä¸ç®¡è™šæ‹Ÿæœºçš„ ip åœ°å€æ˜¯ä»€ä¹ˆåªè¦å®˜å‰ä¸‰ä½å°±è¡Œäº†ï¼Œç„¶åæŠŠæœ€åä¸€ä½æ›¿æ¢æˆ 1 ä¸€å®šå¾—åˆ°çš„å°±æ˜¯ windows ç”µè„‘çš„ä½ç½®ã€‚å‰ææ˜¯éœ€è¦å…³é—­é˜²ç«å¢™&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310201030614.png&#34; alt=&#34;image-20231020103028998&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;631-æ¡ˆä¾‹è·å–è¯·æ±‚è·¯å¾„ä¸­çš„å•†å“idä¿¡æ¯æ ¹æ®idå‘tomcatæŸ¥è¯¢å•†å“ä¿¡æ¯&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#631-æ¡ˆä¾‹è·å–è¯·æ±‚è·¯å¾„ä¸­çš„å•†å“idä¿¡æ¯æ ¹æ®idå‘tomcatæŸ¥è¯¢å•†å“ä¿¡æ¯&#34;&gt;#&lt;/a&gt; 6.3.1ã€æ¡ˆä¾‹ï¼Œè·å–è¯·æ±‚è·¯å¾„ä¸­çš„å•†å“ id ä¿¡æ¯ï¼Œæ ¹æ® id å‘ Tomcat æŸ¥è¯¢å•†å“ä¿¡æ¯ğŸŒ²&lt;/h3&gt;
&lt;p&gt;è¿™é‡Œè¦ä¿®æ”¹ item.luaï¼Œæ»¡è¶³ä¸‹é¢çš„éœ€æ±‚ï¼š&lt;/p&gt;
&lt;p&gt;1ã€è·å–è¯·æ±‚å‚æ•°ä¸­çš„ id&lt;/p&gt;
&lt;p&gt;2ã€æ ¹æ® id å‘ Tomcat æœåŠ¡å‘é€è¯·æ±‚ï¼ŒæŸ¥è¯¢å•†å“ä¿¡æ¯&lt;/p&gt;
&lt;p&gt;3ã€æ ¹æ® id å‘ Tomcat æœåŠ¡å‘é€è¯·æ±‚ï¼ŒæŸ¥è¯¢åº“å­˜ä¿¡æ¯&lt;/p&gt;
&lt;p&gt;4ã€ç»„è£…å•†å“ä¿¡æ¯ï¼Œåº“å­˜ä¿¡æ¯ï¼Œåºåˆ—åŒ–ä¸º Json æ ¼å¼å¹¶è¿”å›&lt;/p&gt;
&lt;p&gt;æ­¥éª¤ï¼š&lt;/p&gt;
&lt;p&gt;ä¸€ï¼Œnginx å†…éƒ¨å‘é€ Http è¯·æ±‚&lt;/p&gt;
&lt;p&gt;nginx æä¾›äº†å†…éƒ¨ API ç”¨ä»¥å‘é€ http è¯·æ±‚ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight nginx&#34;&gt;&lt;figcaption data-lang=&#34;nginx&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# æ³¨æ„ï¼šè¿™é‡Œçš„ path æ˜¯è·¯å¾„ï¼Œå¹¶ä¸åŒ…å« ip å’Œç«¯å£ã€‚è¿™ä¸ªè¯·æ±‚ä¼šè¢« nginx å†…éƒ¨çš„ server ç›‘å¬å¹¶å¤„ç†&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# è¿™è‚¯å®šä¸è¡Œï¼Œå› ä¸ºæˆ‘ä»¬å¸Œæœ›å¯ä»¥å‘é€ç»™ Tomcat æ‰€ä»¥å°±è¦æŒ‡å®š Tomcat çš„ ip å’Œç«¯å£&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; resp = ngx.location.capture(&lt;span class=&#34;token string&#34;&gt;&#34;/path&#34;&lt;/span&gt;,&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   	&lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;method&lt;/span&gt; = ngx.HTTP_GET, -- è¯·æ±‚æ–¹å¼&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      args =&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;a = 1, b = 2&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;, -- getæ–¹å¼ä¼ å‚æ•°&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      body = &#34;c=3&amp;amp;d=4&#34; -- postæ–¹å¼ä¼ å‚æ•°&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;)&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;è¿”å›çš„å“åº”å†…å®¹åŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;resp.statusï¼šå“åº”çŠ¶æ€ç &lt;/li&gt;
&lt;li&gt;resp.headerï¼šå“åº”å¤´ï¼Œæ˜¯ä¸€ä¸ª table&lt;/li&gt;
&lt;li&gt;resp.bodyï¼šå“åº”ä½“ï¼Œå°±æ˜¯å“åº”æ•°æ®&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æˆ‘ä»¬å¸Œæœ›è¿™ä¸ªè¯·æ±‚å‘é€åˆ° Tomcat æœåŠ¡å™¨ï¼Œæ‰€ä»¥è¿˜éœ€è¦ç¼–å†™ä¸€ä¸ª server æ¥å¯¹è¿™ä¸ªè·¯å¾„åšåå‘ä»£ç†ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight nginx&#34;&gt;&lt;figcaption data-lang=&#34;nginx&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;location&lt;/span&gt; /path&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;# è¿™é‡Œæ˜¯ windows ç”µè„‘çš„ ip å’Œ Java æœåŠ¡ç«¯å£ï¼Œéœ€è¦ç¡®ä¿ windows é˜²ç«å¢™å¤„äºå…³é—­çŠ¶æ€&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;proxy_pass&lt;/span&gt; http://192.168.137.169:8081&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;ç¼–å†™ä»£ç ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight nginx&#34;&gt;&lt;figcaption data-lang=&#34;nginx&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;server&lt;/span&gt;&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;listen&lt;/span&gt;       &lt;span class=&#34;token number&#34;&gt;8081&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;server_name&lt;/span&gt;  localhost&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;location&lt;/span&gt; /item&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;proxy_pass&lt;/span&gt; http://192.168.137.1:8081&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;location&lt;/span&gt; ~ /api/item/(\d+)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token comment&#34;&gt;# é»˜è®¤çš„å“åº”ç±»å‹&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;default_type&lt;/span&gt; application/json&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token comment&#34;&gt;# å“åº”ç»“æœç”± lua/item.lua ä¸‹çš„æ–‡ä»¶å†³å®š&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;content_by_lua_file&lt;/span&gt; lua/item.lua&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;location&lt;/span&gt; /&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;root&lt;/span&gt;   html&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;index&lt;/span&gt;  index.html index.htm&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;error_page&lt;/span&gt;   &lt;span class=&#34;token number&#34;&gt;500&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;502&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;503&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;504&lt;/span&gt;  /50x.html&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;location&lt;/span&gt; = /50x.html&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;root&lt;/span&gt;   html&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;21&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;Tomcat çš„åå‘ä»£ç†æå®šäº†ï¼Œä»¥ååªè¦è°ƒç”¨ capture API è¯·æ±‚æ˜¯ item å¼€å¤´å°±ä¸€å®šèƒ½è¾¾åˆ° Tomcatã€‚æ‰€ä»¥ä»¥åå°±å¯ä»¥æ”¾å¿ƒçš„ä½¿ç”¨è¿™å¥— API äº†ï¼Œé‚£ä¹ˆæ—¢ç„¶è¿™ä¸ª API ç»å¸¸è¦ä½¿ç”¨ã€‚é‚£æˆ‘ä»¬å¯ä»¥å°†å‘è¯·æ±‚çš„ä»£ç å°è£…æˆä¸€ä¸ªå‡½æ•°&lt;/p&gt;
&lt;h4 id=&#34;6311-å°è£…httpæŸ¥è¯¢çš„å‡½æ•°&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#6311-å°è£…httpæŸ¥è¯¢çš„å‡½æ•°&#34;&gt;#&lt;/a&gt; 6.3.1.1ã€å°è£… HTTP æŸ¥è¯¢çš„å‡½æ•°ğŸŒ´&lt;/h4&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥å§ http æŸ¥è¯¢çš„è¯·æ±‚å°è£…ä¸ºä¸€ä¸ªå‡½æ•°ï¼Œæ”¾åˆ° OPenResty å‡½æ•°åº“ä¸­ï¼Œæ–¹ä¾¿åæœŸä½¿ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;1ã€åœ¨ /usr/local/openresty/lualib ç›®å½•ä¸‹åˆ›å»º common.lua æ–‡ä»¶ï¼š&lt;/p&gt;
&lt;p&gt;ä¸ºä»€ä¹ˆæ˜¯è¿™ä¸ªä½ç½®ï¼Ÿ å› ä¸ºåœ¨ä¸Šè¿°é…ç½® nginx åŠ è½½æ¨¡å—ä¸­æŒ‡å®šçš„è·¯å¾„å°±æ˜¯åŠ è½½è¿™ä¸ªä½ç½®çš„ä»»ä½•.lua æ–‡ä»¶&lt;/p&gt;
&lt;figure class=&#34;highlight sh&#34;&gt;&lt;figcaption data-lang=&#34;sh&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token function&#34;&gt;vim&lt;/span&gt; /usr/local/openresty/lualib/common.lua&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;2ã€åœ¨ common.lua ä¸­å°è£… http æŸ¥è¯¢çš„å‡½æ•°&lt;/p&gt;
&lt;figure class=&#34;highlight lua&#34;&gt;&lt;figcaption data-lang=&#34;lua&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- å°è£…å‡½æ•°ï¼Œå‘é€ http è¯·æ±‚ï¼Œå¹¶è§£æå“åº”&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;read_http&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;path&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; params&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; resp &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;location&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;capture&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;path&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        method &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;HTTP_GET&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        args &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; params&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;not&lt;/span&gt; resp &lt;span class=&#34;token keyword&#34;&gt;then&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;-- è®°å½•é”™è¯¯ä¿¡æ¯ï¼Œè¿”å› 404&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;ERR&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;http not found, path: &#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; path &lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;, args: &#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; args&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;exit&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;404&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;end&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; resp&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;body&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;end&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- å°†æ–¹æ³•å¯¼å‡º&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; _M &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;  &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    read_http &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; read_http&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;  &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; _M&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;åœ¨ item.lua æ–‡ä»¶ä¸­ç¼–å†™ä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight lua&#34;&gt;&lt;figcaption data-lang=&#34;lua&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- å¯¼å…¥ common å‡½æ•°åº“&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; common &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;require&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;common&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; read_http &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; common&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;read_http&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- è·å–è·¯å¾„å‚æ•°&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; id &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;var&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- æŸ¥è¯¢å•†å“ä¿¡æ¯&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; itemJSON &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;read_http&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;/item/&#34;&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;..&lt;/span&gt; id&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;nil&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- æŸ¥è¯¢åº“å­˜ä¿¡æ¯&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; stockJSON &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;read_http&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;/item/stock&#34;&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;..&lt;/span&gt; id&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;nil&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- è¿”å›ç»“æœ&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;say&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;itemJSON&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;è®¿é—® uri è¿›è¡Œä¸€ä¸‹è¯·æ±‚æµ‹è¯•ï¼š&lt;a href=&#34;http://localhost/item.html?id=10003&#34;&gt;http://localhost/item.html?id=10003&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310201318784.png&#34; alt=&#34;image-20231020131800919&#34;&gt;&lt;/p&gt;
&lt;p&gt;è¿”å›çš„æ•°æ®&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;#123;
    &amp;quot;id&amp;quot;: 10003,
    &amp;quot;name&amp;quot;: &amp;quot;éŸ©ç‰ˆç‰›ä»”è£¤&amp;quot;,
    &amp;quot;title&amp;quot;: &amp;quot;å”ç‹®æ–°å“ç‰›ä»”è£¤å¥³å­¦ç”ŸéŸ©ç‰ˆå®½æ¾è£¤å­ Aæ¬¾/ä¸­ç‰›ä»”è“ï¼ˆæ— ç»’æ¬¾ï¼‰ 26&amp;quot;,
    &amp;quot;price&amp;quot;: 84600,
    &amp;quot;image&amp;quot;: &amp;quot;https://m.360buyimg.com/mobilecms/s720x720_jfs/t26989/116/124520860/644643/173643ea/5b860864N6bfd95db.jpg!q70.jpg.webp&amp;quot;,
    &amp;quot;category&amp;quot;: &amp;quot;ç‰›ä»”è£¤&amp;quot;,
    &amp;quot;brand&amp;quot;: &amp;quot;å”ç‹®&amp;quot;,
    &amp;quot;spec&amp;quot;: &amp;quot;&amp;#123;\&amp;quot;é¢œè‰²\&amp;quot;: \&amp;quot;è“è‰²\&amp;quot;, \&amp;quot;å°ºç \&amp;quot;: \&amp;quot;26\&amp;quot;&amp;#125;&amp;quot;,
    &amp;quot;status&amp;quot;: 1,
    &amp;quot;createTime&amp;quot;: &amp;quot;2019-05-01T00:00:00.000+00:00&amp;quot;,
    &amp;quot;updateTime&amp;quot;: &amp;quot;2019-05-01T00:00:00.000+00:00&amp;quot;,
    &amp;quot;stock&amp;quot;: null,
    &amp;quot;sold&amp;quot;: null
&amp;#125;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç°åœ¨æ‰€æœ‰çš„å•†å“éƒ½èƒ½æ­£å¸¸æŸ¥è¯¢äº†ï¼Œä½†æ˜¯ï¼&lt;/p&gt;
&lt;p&gt;é‡Œé¢çš„ï¼Œé”€é‡å’Œå­˜åº“çš„æ•°æ®è¿˜æ²¡æœ‰ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯å¦‚æœè¦æ˜¯æœ‰ 3 å¼ è¡¨ï¼Œ4 å¼ è¡¨ï¼Œ5 å¼ è¡¨éƒ½éœ€è¦æŠŠå®ƒä»¬æ‹¼æ¥èµ·æ¥ï¼Œæ‰€ä»¥æœ€ç»ˆéœ€è¦çš„æ˜¯å®Œæ•´çš„æ•°æ®&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ itemJSON å¾—åˆ°çš„æ•°æ®æ˜¯ä¸€ä¸ª Json æ•°æ®ï¼Œæˆ‘ä»¬éœ€è¦è½¬æ¢ä¸º Lua é‡Œé¢çš„å¯¹è±¡ï¼Œä½¿ç”¨ table è¿™ä¸ªæ•°æ®ç±»å‹æ¥è¿›è¡Œå­˜å‚¨&lt;/p&gt;
&lt;p&gt;å¦‚ä¸‹å°±æ˜¯å°† JSON ååºåˆ—åŒ–ä¸º Lua å¯¹è±¡çš„æ–¹å¼ï¼š&lt;/p&gt;
&lt;h4 id=&#34;6312-jsonç»“æœå¤„ç†&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#6312-jsonç»“æœå¤„ç†&#34;&gt;#&lt;/a&gt; 6.3.1.2ã€JSON ç»“æœå¤„ç†ğŸŒ´&lt;/h4&gt;
&lt;p&gt;OPenResty æä¾›äº†ä¸€ä¸ª cjson çš„æ¨¡å—ç”¨æ¥å¤„ç† JSON çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;å®˜æ–¹åœ°å€ï¼š&lt;a href=&#34;https://github.com/openresty/lua-cjson/&#34;&gt;https://github.com/openresty/lua-cjson/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è¯¥æ¨¡å—çš„ç›®å½•ä½ç½®å¦‚ä¸‹ï¼š/usr/local/openresty/lualib/&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310201330405.png&#34; alt=&#34;image-20231020133045031&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä½¿ç”¨&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;1ã€å¯¼å…¥ cjson æ¨¡å—ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight lua&#34;&gt;&lt;figcaption data-lang=&#34;lua&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; cjson &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;require&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;cjson&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;2ã€åºåˆ—åŒ–ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight lua&#34;&gt;&lt;figcaption data-lang=&#34;lua&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; obj &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   name &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;jack&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   age &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;21&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; json &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; cjson&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;encode&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;obj&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;3ã€ååºåˆ—åŒ–&lt;/p&gt;
&lt;figure class=&#34;highlight lua&#34;&gt;&lt;figcaption data-lang=&#34;lua&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; json &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;&amp;#123;&#34;name&#34;: &#34;jack&#34;, &#34;age&#34;: 21&amp;#125;&#39;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- ååºåˆ—åŒ–&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; obj &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; cjson&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;decode&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;json&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token function&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;obj&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;name&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;ç»§ç»­ä¸‹é¢çš„ä»£ç æ­¥éª¤ï¼š&lt;/p&gt;
&lt;p&gt;1ã€å°†è¯·æ±‚åˆ°çš„ json æ•°æ®åºåˆ—åŒ–ä¸º lua ä¸­çš„ table æ•°æ®&lt;/p&gt;
&lt;p&gt;2ã€å†å°†åºåˆ—åŒ–çš„æ•°æ®è¿›è¡Œè°ƒç”¨æ‹¼æ¥&lt;/p&gt;
&lt;p&gt;3ã€æ‹¼æ¥å®Œæ¯•åå†å°† lua ä¸­ table æ•°æ®åºåˆ—åŒ–ä¸º json å“åº”åˆ°å‰ç«¯&lt;/p&gt;
&lt;figure class=&#34;highlight lua&#34;&gt;&lt;figcaption data-lang=&#34;lua&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- å¯¼å…¥ common å‡½æ•°åº“&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; common &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;require&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;common&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; read_http &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; common&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;read_http&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- å¯¼å…¥ cjson åº“&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; cjson &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;require&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;cjson&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- è·å–è·¯å¾„å‚æ•°&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; id &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;var&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- æŸ¥è¯¢å•†å“ä¿¡æ¯&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; itemJSON &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;read_http&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;/item/&#34;&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;..&lt;/span&gt; id&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;nil&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- æŸ¥è¯¢åº“å­˜ä¿¡æ¯&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; stockJSON &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;read_http&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;/item/stock/&#34;&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;..&lt;/span&gt; id&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;nil&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- JSON è½¬åŒ–ä¸º lua çš„ table&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; item &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; cjson&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;decode&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;itemJSON&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; sto &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; cjson&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;decode&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;stockJSON&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- ç»„åˆæ•°æ®&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;21&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;item&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;stock &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; sto&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;stock&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;22&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;item&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;sold &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; sto&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;sold&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;23&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;24&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- æŠŠ item åºåˆ—åŒ–ä¸º json è¿”å›ç»“æœ&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;25&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;say&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;cjson&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;encode&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;item&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;è¯·æ±‚ uri è¿›è¡Œæµ‹è¯•ï¼š&lt;a href=&#34;http://localhost/item.html?id=10004&#34;&gt;http://localhost/item.html?id=10004&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310201343013.png&#34; alt=&#34;image-20231020134303536&#34;&gt;&lt;/p&gt;
&lt;p&gt;è¯·æ±‚åˆ°çš„æ•°æ®&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;#123;
    &amp;quot;spec&amp;quot;: &amp;quot;&amp;#123;\&amp;quot;é¢œè‰²\&amp;quot;: \&amp;quot;ç™½è‰²\&amp;quot;, \&amp;quot;å°ºç \&amp;quot;: \&amp;quot;36\&amp;quot;&amp;#125;&amp;quot;,
    &amp;quot;sold&amp;quot;: 974,
    &amp;quot;status&amp;quot;: 1,
    &amp;quot;updateTime&amp;quot;: &amp;quot;2019-05-01T00:00:00.000+00:00&amp;quot;,
    &amp;quot;title&amp;quot;: &amp;quot;æ£®é©¬(senma)ä¼‘é—²é‹å¥³2019æ˜¥å­£æ–°æ¬¾éŸ©ç‰ˆç³»å¸¦æ¿é‹å­¦ç”Ÿç™¾æ­å¹³åº•å¥³é‹ é»„è‰² 36&amp;quot;,
    &amp;quot;stock&amp;quot;: 99999,
    &amp;quot;price&amp;quot;: 10400,
    &amp;quot;image&amp;quot;: &amp;quot;https://m.360buyimg.com/mobilecms/s720x720_jfs/t1/29976/8/2947/65074/5c22dad6Ef54f0505/0b5fe8c5d9bf6c47.jpg!q70.jpg.webp&amp;quot;,
    &amp;quot;createTime&amp;quot;: &amp;quot;2019-05-01T00:00:00.000+00:00&amp;quot;,
    &amp;quot;category&amp;quot;: &amp;quot;ä¼‘é—²é‹&amp;quot;,
    &amp;quot;name&amp;quot;: &amp;quot;ä¼‘é—²æ¿é‹&amp;quot;,
    &amp;quot;brand&amp;quot;: &amp;quot;æ£®é©¬&amp;quot;,
    &amp;quot;id&amp;quot;: 10004
&amp;#125;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°æœ‰åº“å­˜å’Œé”€é‡çš„æ•°æ®äº†&lt;/p&gt;
&lt;h3 id=&#34;632-tomcaté›†ç¾¤çš„è´Ÿè½½å‡è¡¡&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#632-tomcaté›†ç¾¤çš„è´Ÿè½½å‡è¡¡&#34;&gt;#&lt;/a&gt; 6.3.2ã€Tomcat é›†ç¾¤çš„è´Ÿè½½å‡è¡¡ğŸŒ²&lt;/h3&gt;
&lt;p&gt;æˆ‘ä»¬å·²ç»å®ç°äº†ï¼Œä» OPenResty å‘ tomcat å‘é€ä¸€ä¸ª http è¯·æ±‚å»æŸ¥è¯¢å•†å“ä¿¡æ¯è¿”å›é¡µé¢ï¼Œå®Œæˆæ¸²æŸ“ã€‚ä½†æ˜¯åœ¨ä¸Šè¿°å®ç°æ¡ˆä¾‹ä¸­ Tomcat åªæœ‰ä¸€å°&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310201346554.png&#34; alt=&#34;image-20231020134614455&#34;&gt;&lt;/p&gt;
&lt;p&gt;åœ¨å®é™…ç”Ÿäº§ä¸­ Tomcat ä¸€å®šæ˜¯ä¸€ä¸ªé›†ç¾¤ã€‚æ‰€ä»¥ OPenResty å†å‘é€è¯·æ±‚æ—¶å¿…é¡»å¾—å¯¹å¤šå° Tomcat å®ç°ä¸€ä¸ªè´Ÿè½½å‡è¡¡&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310201349192.png&#34; alt=&#34;image-20231020134913570&#34;&gt;&lt;/p&gt;
&lt;p&gt;æ¯”æ–¹è¯´ è´Ÿè½½å‡è¡¡æŒ‘é€‰äº† 8081ï¼Œç„¶åè¯·æ±‚å°±ä¼šåˆ°è¾¾ 8081 ç„¶åå»æŸ¥è¯¢æ•°æ®åº“ã€‚&lt;/p&gt;
&lt;p&gt;æŸ¥è¯¢å®Œæ•°æ®åº“åä¼šå½¢æˆä¸€ä¸ª jvm è¿›ç¨‹ç¼“å­˜ï¼Œä¿å­˜åœ¨ 8081 è¿™å°æœåŠ¡å™¨ä¸Šï¼Œç¼“å­˜æœ‰äº†ä»¥åä¸‹æ¬¡å¯ä»¥ç›´æ¥è¯»å–ç¼“å­˜å°±ä¸ç”¨æŸ¥è¯¢æ•°æ®åº“äº†æ€§èƒ½å°±éå¸¸å¥½äº†ã€‚ä½†æ˜¯éå¸¸å¯æƒœçš„æ˜¯è¿›ç¨‹ç¼“å­˜æ˜¯ä¸èƒ½å…±äº«çš„ 8081 æœ‰è¿™ä¸ªç¼“å­˜ï¼Œ8082 å¹¶æ²¡æœ‰ï¼Œè€Œè´Ÿè½½å‡è¡¡çš„è§„åˆ™æ˜¯ è½®è¯¢ã€‚å¦‚æœè¿™æ ·è®¿é—®ç¼“å­˜å°±ä¼šåœ¨å¤šå° Tomcat å»å†—ä½™çš„ä¿å­˜ã€‚ç¬¬ä¸€ä¸ªå ç”¨é¢å¤–ç©ºé—´ï¼Œç¬¬äºŒæ˜¯ç¼“å­˜çš„å‘½ä¸­ç‡ä¹Ÿæœ‰ç‚¹æƒ¨&lt;/p&gt;
&lt;p&gt;å¦‚æœè¯´æˆ‘æƒ³è¦å•†å“ 10001 ç¬¬ä¸€æ¬¡æŸ¥è¯¢å®Œä»¥åæ°¸è¿œéƒ½æœ‰ç¼“å­˜ã€‚é‚£ä¹ˆæˆ‘å¿…é¡»è®© item/10001 è¿™ä¸ªè¯·æ±‚æ¯æ¬¡éƒ½æŒ‡å‘åŒä¸€ä¸ªæœåŠ¡å™¨ï¼Œè¿™æ ·æ‰èƒ½ä¿è¯è¿™ä¸ªç¼“å­˜ä¸€ç›´ç”Ÿæ•ˆã€‚å‡å¦‚è¯´åˆæ¥ä¸€ä¸ª item/10002 é‚£æˆ‘å°±è®©å®ƒæŒ‡å‘ä¸‹ä¸€ä¸ªæœåŠ¡å™¨ã€‚&lt;/p&gt;
&lt;p&gt;ä¸åŒå•†å“æ°¸è¿œè®¿é—®ä¸åŒæœåŠ¡å™¨ï¼Œç›¸åŒå•†å“æ°¸è¿œè®¿é—®åŒä¸€ä¸ªæœåŠ¡å™¨ï¼Œè¿™æ ·å°±èƒ½ä¿è¯ç¼“å­˜æ°¸è¿œå‘½ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ · jvm è¿›ç¨‹ç¼“å­˜æ‰æœ‰æ„ä¹‰ã€‚ä½†æ˜¯ç°åœ¨æ˜¯è½®è¯¢è‚¯å®šåšä¸åˆ°è¿™ä¸€ç‚¹ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¿®æ”¹ nginx è´Ÿè½½å‡è¡¡çš„ç®—æ³•äº†ã€‚&lt;/p&gt;
&lt;figure class=&#34;highlight nginx&#34;&gt;&lt;figcaption data-lang=&#34;nginx&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# tomcat é›†ç¾¤é…ç½®&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;upstream&lt;/span&gt; tomcat-cluster&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;# æ ¹æ®è¯·æ±‚è¿‡æ¥çš„è·¯å¾„æ¥è®¡ç®— hash å€¼ç„¶åå†³å®šè®¿é—®å“ªä¸ªæœåŠ¡å™¨&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;	&lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;hash&lt;/span&gt; &lt;span class=&#34;token variable&#34;&gt;$request_uri&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;server&lt;/span&gt; 192.168.249.128:8081&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;server&lt;/span&gt; 192.168.249.128:8082&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;ä»£ç æ¼”ç¤ºå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight nginx&#34;&gt;&lt;figcaption data-lang=&#34;nginx&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;http&lt;/span&gt;&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;include&lt;/span&gt;       mime.types&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;default_type&lt;/span&gt;  application/octet-stream&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;sendfile&lt;/span&gt;        &lt;span class=&#34;token boolean&#34;&gt;on&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;keepalive_timeout&lt;/span&gt;  &lt;span class=&#34;token number&#34;&gt;65&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;# lua æ¨¡å—&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;lua_package_path&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;/usr/local/openresty/lualib/?.lua;;&#34;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;# c æ¨¡å—     &lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;lua_package_cpath&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;/usr/local/openresty/lualib/?.so;;&#34;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;  &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;upstream&lt;/span&gt; tomcat-cluster&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;hash&lt;/span&gt; &lt;span class=&#34;token variable&#34;&gt;$request_uri&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;server&lt;/span&gt; 192.168.249.128:8081&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;server&lt;/span&gt; 192.168.249.128:8082&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;server&lt;/span&gt;&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;listen&lt;/span&gt;       &lt;span class=&#34;token number&#34;&gt;8081&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;server_name&lt;/span&gt;  localhost&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;21&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;location&lt;/span&gt; /item&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;22&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;proxy_pass&lt;/span&gt; http://tomcat-cluster&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;23&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;24&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;location&lt;/span&gt; ~ /api/item/(\d+)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;25&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;          &lt;span class=&#34;token comment&#34;&gt;# é»˜è®¤çš„å“åº”ç±»å‹&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;26&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;          &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;default_type&lt;/span&gt; application/json&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;27&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;          &lt;span class=&#34;token comment&#34;&gt;# å“åº”ç»“æœç”± lua/item.lua ä¸‹çš„æ–‡ä»¶å†³å®š&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;28&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;          &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;content_by_lua_file&lt;/span&gt; lua/item.lua&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;29&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;30&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;location&lt;/span&gt; /&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;31&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;root&lt;/span&gt;   html&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;32&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;index&lt;/span&gt;  index.html index.htm&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;33&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;34&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;error_page&lt;/span&gt;   &lt;span class=&#34;token number&#34;&gt;500&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;502&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;503&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;504&lt;/span&gt;  /50x.html&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;35&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;location&lt;/span&gt; = /50x.html&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;36&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;root&lt;/span&gt;   html&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;37&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;38&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;39&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;åœ¨ idea ä¸­å¼€å¯ 8082 ç«¯å£çš„æœåŠ¡&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310201435034.png&#34; alt=&#34;image-20231020143541296&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¯åŠ¨&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310201436217.png&#34; alt=&#34;image-20231020143629316&#34;&gt;&lt;/p&gt;
&lt;p&gt;è®¿é—® uri è¿›è¡Œæµ‹è¯•ï¼š&lt;a href=&#34;http://localhost/item.html?id=10001&#34;&gt;http://localhost/item.html?id=10001&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è¿™ä¸ª uri è®¿é—®è¯·æ±‚åˆ°çš„ Tomcat æœåŠ¡ä¸ºå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;idea æ§åˆ¶å°ä¸­æ‰“å°ä¿¡æ¯ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310201441979.png&#34; alt=&#34;image-20231020144146827&#34;&gt;&lt;/p&gt;
&lt;p&gt;è®¿é—® uri è¿›è¡Œæµ‹è¯•ï¼š&lt;a href=&#34;http://localhost/item.html?id=10002&#34;&gt;http://localhost/item.html?id=10002&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è¿™ä¸ª uri è®¿é—®è¯·æ±‚åˆ°çš„ Tomcat æœåŠ¡ä¸ºå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;idea æ§åˆ¶å°ä¸­æ‰“å°ä¿¡æ¯ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310201442866.png&#34; alt=&#34;image-20231020144213109&#34;&gt;&lt;/p&gt;
&lt;p&gt;å°†è¿ä¸ªæœåŠ¡çš„æ§åˆ¶å°æ‰“å°çš„ä¿¡æ¯éƒ½æ¸…ç©ºç„¶åå†å»è®¿é—®ä¸€ä¸‹ 10001 å’Œ 10002&lt;/p&gt;
&lt;p&gt;æ§åˆ¶å°éƒ½æ²¡æœ‰æ‰“å°ä»»ä½•çš„ä¿¡æ¯è¯´æ˜ç¼“å­˜èµ·ä½œç”¨äº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310201443037.png&#34; alt=&#34;image-20231020144338972&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;64-æ·»åŠ redisç¼“å­˜çš„éœ€æ±‚&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#64-æ·»åŠ redisç¼“å­˜çš„éœ€æ±‚&#34;&gt;#&lt;/a&gt; 6.4ã€æ·»åŠ  Redis ç¼“å­˜çš„éœ€æ±‚ğŸŒ³&lt;/h2&gt;
&lt;p&gt;è¯·æ±‚æˆåŠŸåä¸åº”è¯¥ç›´æ¥æŸ¥è¯¢ jvm è¿›ç¨‹ç¼“å­˜è€Œæ˜¯åº”è¯¥å…ˆåˆ° redis ä¸­çœ‹çœ‹æœ‰æ²¡æœ‰ç¼“å­˜å†å»çœ‹ jvm è¿›ç¨‹ç¼“å­˜&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310201447926.png&#34; alt=&#34;image-20231020144727615&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;641-æ·»åŠ redisç¼“å­˜è¦é¢ä¸´çš„é—®é¢˜&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#641-æ·»åŠ redisç¼“å­˜è¦é¢ä¸´çš„é—®é¢˜&#34;&gt;#&lt;/a&gt; 6.4.1ã€æ·»åŠ  Redis ç¼“å­˜è¦é¢ä¸´çš„é—®é¢˜ğŸŒ²&lt;/h3&gt;
&lt;h4 id=&#34;6411-å†·å¯åŠ¨ä¸ç¼“å­˜é¢„çƒ­&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#6411-å†·å¯åŠ¨ä¸ç¼“å­˜é¢„çƒ­&#34;&gt;#&lt;/a&gt; 6.4.1.1ã€å†·å¯åŠ¨ä¸ç¼“å­˜é¢„çƒ­ğŸŒ´&lt;/h4&gt;
&lt;p&gt;&lt;mark&gt;å†·å¯åŠ¨&lt;/mark&gt;ï¼šæœåŠ¡åˆšåˆšå¯åŠ¨æ—¶ï¼ŒRedis ä¸­å¹¶æ²¡æœ‰ç¼“å­˜ï¼Œå¦‚æœæ‰€æœ‰å•†å“æ•°æ®éƒ½åœ¨ç¬¬ä¸€æ¬¡æŸ¥è¯¢æ˜¯æ·»åŠ ç¼“å­˜ï¼Œå¯èƒ½ä¼šç»™æ•°æ®åº“å¸¦æ¥è¾ƒå¤§å‹åŠ›&lt;/p&gt;
&lt;p&gt;&lt;mark&gt;ç¼“å­˜é¢„çƒ­&lt;/mark&gt;ï¼šåœ¨å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å¤§æ•°æ®ç»Ÿè®¡ç”¨æˆ·è®¿é—®çš„çƒ­ç‚¹æ•°æ®ï¼Œåœ¨é¡¹ç›®å¯åŠ¨æ—¶å°†è¿™äº›çƒ­ç‚¹æ•°æ®æå‰æŸ¥è¯¢å¹¶ä¿å­˜åˆ° Redis ä¸­&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æ•°æ®æµé‡è¾ƒå°‘ï¼Œå¯ä»¥åœ¨å¯åŠ¨æ—¶å°†æ‰€æœ‰æ•°æ®éƒ½å­˜å…¥ç¼“å­˜ä¸­ã€‚&lt;/p&gt;
&lt;h4 id=&#34;6412-ç¼“å­˜é¢„çƒ­&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#6412-ç¼“å­˜é¢„çƒ­&#34;&gt;#&lt;/a&gt; 6.4.1.2ã€ç¼“å­˜é¢„çƒ­ğŸŒ´&lt;/h4&gt;
&lt;p&gt;æ­¥éª¤ï¼š&lt;/p&gt;
&lt;p&gt;1ã€åˆ©ç”¨ Docker å®‰è£… Redis&lt;/p&gt;
&lt;figure class=&#34;highlight sh&#34;&gt;&lt;figcaption data-lang=&#34;sh&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;root@localhost nginx&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token comment&#34;&gt;# docker run --name redis -p 6379:6379 -d redis redis-server --appendonly yes&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;2ã€åœ¨ item-service æœåŠ¡ä¸­å¼•å…¥ redis ä¾èµ–&lt;/p&gt;
&lt;figure class=&#34;highlight xml&#34;&gt;&lt;figcaption data-lang=&#34;XML&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;dependency&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;groupId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;org.springframework.boot&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;/&lt;/span&gt;groupId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;artifactId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;spring-boot-starter-data-redis&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;/&lt;/span&gt;artifactId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;/&lt;/span&gt;dependency&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;3ã€é…ç½® Redis åœ°å€&lt;/p&gt;
&lt;figure class=&#34;highlight yml&#34;&gt;&lt;figcaption data-lang=&#34;YAML&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key atrule&#34;&gt;spring&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token key atrule&#34;&gt;redis&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;host&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; 192.168.249.128&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;6379&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;4ã€ç¼–å†™åˆå§‹åŒ–ç±»&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@Component&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;RedisHandler&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;implements&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;InitializingBean&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@Autowired&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;StringRedisTemplate&lt;/span&gt; redisTemplate&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@Autowired&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;ItemService&lt;/span&gt; itemService&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@Autowired&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;IItemStockService&lt;/span&gt; stockService&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;ObjectMapper&lt;/span&gt; &lt;span class=&#34;token constant&#34;&gt;MAPPER&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;ObjectMapper&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@Override&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;afterPropertiesSet&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;throws&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Exception&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// åˆå§‹åŒ–ç¼“å­˜&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// 1. æŸ¥è¯¢å•†å“ä¿¡æ¯&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token class-name&#34;&gt;List&lt;/span&gt;&lt;span class=&#34;token generics&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;Item&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt; list &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; itemService&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;list&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// 2. æ”¾å…¥ç¼“å­˜&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;Item&lt;/span&gt; item &lt;span class=&#34;token operator&#34;&gt;:&lt;/span&gt; list&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token comment&#34;&gt;// 2.1. åºåˆ—åŒ–ä¸º json&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token class-name&#34;&gt;String&lt;/span&gt; json &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token constant&#34;&gt;MAPPER&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;writeValueAsString&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;item&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token comment&#34;&gt;// 2.2. å­˜å…¥ redis&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;21&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            redisTemplate&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;opsForValue&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;item:id:&#34;&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; item&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;getId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; json&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;22&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;23&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;24&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// 1. æŸ¥è¯¢åº“å­˜ä¿¡æ¯&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;25&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token class-name&#34;&gt;List&lt;/span&gt;&lt;span class=&#34;token generics&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;ItemStock&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt; list1 &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; stockService&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;list&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;26&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// 2. æ”¾å…¥ç¼“å­˜&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;27&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;ItemStock&lt;/span&gt; itemStock &lt;span class=&#34;token operator&#34;&gt;:&lt;/span&gt; list1&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;28&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token comment&#34;&gt;// 2.1. åºåˆ—åŒ–ä¸º json&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;29&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token class-name&#34;&gt;String&lt;/span&gt; json &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token constant&#34;&gt;MAPPER&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;writeValueAsString&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;itemStock&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;30&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token comment&#34;&gt;// 2.2. å­˜å…¥ redis&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;31&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            redisTemplate&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;opsForValue&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;item:stock:id:&#34;&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; itemStock&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;getId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; json&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;32&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;33&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;34&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;é‡å¯æˆ–å¯åŠ¨ 8081 å’Œ 8082 ä¸¤ä¸ªæœåŠ¡å™¨&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°å¯åŠ¨æ—¶ redis åˆå§‹åŒ–ç¼“å­˜å»æŸ¥è¯¢äº†æ•°æ®åº“æ­¤æ—¶å¯ä»¥çœ‹ä¸‹ redis ä¸­çš„æ•°æ®æƒ…å†µ&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310201513672.png&#34; alt=&#34;image-20231020151344361&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight sh&#34;&gt;&lt;figcaption data-lang=&#34;sh&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;root@localhost nginx&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token comment&#34;&gt;# docker exec -it redis redis-cli&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; keys *&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;item:id:10004&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt; &lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;item:stock:id:10004&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt; &lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;item:id:10002&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt; &lt;span class=&#34;token number&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;item:stock:id:10005&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt; &lt;span class=&#34;token number&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;item:id:10001&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt; &lt;span class=&#34;token number&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;item:stock:id:10001&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt; &lt;span class=&#34;token number&#34;&gt;7&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;item:stock:id:10003&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt; &lt;span class=&#34;token number&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;item:id:10003&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt; &lt;span class=&#34;token number&#34;&gt;9&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;item:stock:id:10002&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;item:id:10005&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h2 id=&#34;65-æŸ¥è¯¢redisç¼“å­˜&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#65-æŸ¥è¯¢redisç¼“å­˜&#34;&gt;#&lt;/a&gt; 6.5ã€æŸ¥è¯¢ Redis ç¼“å­˜ğŸŒ³&lt;/h2&gt;
&lt;h3 id=&#34;651-openrestyçš„redisæ¨¡å—&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#651-openrestyçš„redisæ¨¡å—&#34;&gt;#&lt;/a&gt; 6.5.1ã€OpenResty çš„ Redis æ¨¡å—ğŸŒ²&lt;/h3&gt;
&lt;p&gt;OPenResty æä¾›äº†æ“ä½œ Redis çš„æ¨¡å—ï¼Œæˆ‘ä»¬åªè¦å¼•å…¥è¯¥æ¨¡å—å°±èƒ½ç›´æ¥ä½¿ç”¨ï¼š&lt;/p&gt;
&lt;p&gt;åœ¨ common.lua æ–‡ä»¶ä¸­è¿›è¡Œç¼–å†™&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¼•å…¥ Redis æ¨¡å—ï¼Œå¹¶åˆå§‹åŒ– Redis å¯¹è±¡&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸ºä»€ä¹ˆå¼•å…¥æ¨¡å—ä¸­æ–‡ä»¶åä¸­é—´éœ€è¦ä¸€ä¸ª . ï¼Ÿ&lt;/p&gt;
&lt;p&gt;è§£é‡Šï¼šå› ä¸ºæˆ‘ä»¬ä¸Šè¿°æ–‡ç« ä¸­éƒ½æ˜¯å¼•å…¥çš„ lualib ç›®å½•ä¸‹çš„æ¨¡å—å› ä¸ºç›´æ¥åœ¨ lua ç›®å½•æ‰€ä»¥å¯ä»¥ç›´æ¥å†™æ–‡ä»¶åå°±è¡Œäº†ã€‚ä½†æ˜¯è¿™ä¸ª redis å¯ä¸å† lualib æ ¹ç›®å½•ä¸­è€Œæ˜¯åœ¨ resty ç›®å½•ä¸‹&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310201533407.png&#34; alt=&#34;image-20231020153335950&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight lua&#34;&gt;&lt;figcaption data-lang=&#34;lua&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- å¼•å…¥ redis æ¨¡å—&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; redis &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;require&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;resty.redis&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- åˆå§‹åŒ– redis å¯¹è±¡&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; red &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; redis&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;new&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- è®¾ç½® redis è¶…æ—¶æ—¶é—´&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;red&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;set_timeouts&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1000&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1000&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1000&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;ul&gt;
&lt;li&gt;å°è£…å‡½æ•°ï¼Œç”¨æ¥é‡Šæ”¾ Redis é“¾æ¥ï¼Œå…¶å®æ˜¯æ”¾å…¥è¿æ¥æ± &lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight lua&#34;&gt;&lt;figcaption data-lang=&#34;lua&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- å…³é—­ redis è¿æ¥çš„å·¥å…·æ–¹æ³•ï¼Œå…¶å®æ˜¯æ”¾å…¥è¿æ¥æ± &lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;close_redis&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;red&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; pool_max_idle_time &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;10000&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;-- è¿æ¥çš„ç©ºé—²æ—¶é—´ï¼Œå•ä½æ˜¯æ¯«ç§’&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; pool_size &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;100&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;-- è¿æ¥æ± å¤§å°&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; ok&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; err &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; red&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;set_keepalive&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;pool_max_idle_time&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; pool_size&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;not&lt;/span&gt; ok &lt;span class=&#34;token keyword&#34;&gt;then&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;ERR&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;æ”¾å…¥redisè¿æ¥æ± å¤±è´¥: &#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; err&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;end&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;end&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;OPenResty æä¾›äº†æ“ä½œ Redis çš„æ¨¡å—ï¼Œæˆ‘ä»¬åªè¦å¼•å…¥è¯¥æ¨¡å—å°±èƒ½ç›´æ¥ä½¿ç”¨ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å°è£…å‡½æ•°ï¼Œä» Redis è¯»æ•°æ®å¹¶è¿”å›ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight lua&#34;&gt;&lt;figcaption data-lang=&#34;lua&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- æŸ¥è¯¢ redis çš„æ–¹æ³• ip å’Œ port æ˜¯ redis åœ°å€ï¼Œkey æ˜¯æŸ¥è¯¢çš„ key&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;read_redis&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;ip&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; port&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; key&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;-- è·å–ä¸€ä¸ªè¿æ¥&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; ok&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; err &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; red&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;connect&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;ip&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; port&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;not&lt;/span&gt; ok &lt;span class=&#34;token keyword&#34;&gt;then&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;ERR&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;è¿æ¥rediså¤±è´¥ : &#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; err&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;nil&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;end&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;-- æŸ¥è¯¢ redis&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; resp&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; err &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; red&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;key&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;-- æŸ¥è¯¢å¤±è´¥å¤„ç†&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;not&lt;/span&gt; resp &lt;span class=&#34;token keyword&#34;&gt;then&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;ERR&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;æŸ¥è¯¢Rediså¤±è´¥: &#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; err&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;, key = &#34;&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; key&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;end&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;-- å¾—åˆ°çš„æ•°æ®ä¸ºç©ºå¤„ç†&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; resp &lt;span class=&#34;token operator&#34;&gt;==&lt;/span&gt; ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;null &lt;span class=&#34;token keyword&#34;&gt;then&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        resp &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;nil&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;ERR&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;æŸ¥è¯¢Redisæ•°æ®ä¸ºç©º, key = &#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; key&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;end&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token function&#34;&gt;close_redis&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;red&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;21&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; resp&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;22&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;end&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;å®Œæ•´çš„ä»£ç ç¼–å†™ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight lua&#34;&gt;&lt;figcaption data-lang=&#34;lua&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- å¼•å…¥ redis æ¨¡å—&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; redis &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;require&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;resty.redis&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- åˆå§‹åŒ– redis å¯¹è±¡&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; red &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; redis&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;new&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- è®¾ç½® redis è¶…æ—¶æ—¶é—´&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;red&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;set_timeouts&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1000&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1000&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1000&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- å…³é—­ redis è¿æ¥çš„å·¥å…·æ–¹æ³•ï¼Œå…¶å®æ˜¯æ”¾å…¥è¿æ¥æ± &lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;close_redis&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;red&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; pool_max_idle_time &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;10000&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;-- è¿æ¥çš„ç©ºé—²æ—¶é—´ï¼Œå•ä½æ˜¯æ¯«ç§’&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; pool_size &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;100&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;-- è¿æ¥æ± å¤§å°&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; ok&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; err &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; red&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;set_keepalive&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;pool_max_idle_time&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; pool_size&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;not&lt;/span&gt; ok &lt;span class=&#34;token keyword&#34;&gt;then&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;ERR&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;æ”¾å…¥redisè¿æ¥æ± å¤±è´¥: &#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; err&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;end&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;end&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- æŸ¥è¯¢ redis çš„æ–¹æ³• ip å’Œ port æ˜¯ redis åœ°å€ï¼Œkey æ˜¯æŸ¥è¯¢çš„ key&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;read_redis&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;ip&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; port&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; key&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;-- è·å–ä¸€ä¸ªè¿æ¥&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;21&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; ok&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; err &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; red&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;connect&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;ip&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; port&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;22&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;not&lt;/span&gt; ok &lt;span class=&#34;token keyword&#34;&gt;then&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;23&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;ERR&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;è¿æ¥rediså¤±è´¥ : &#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; err&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;24&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;nil&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;25&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;end&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;26&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;-- æŸ¥è¯¢ redis&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;27&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; resp&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; err &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; red&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;key&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;28&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;-- æŸ¥è¯¢å¤±è´¥å¤„ç†&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;29&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;not&lt;/span&gt; resp &lt;span class=&#34;token keyword&#34;&gt;then&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;30&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;ERR&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;æŸ¥è¯¢Rediså¤±è´¥: &#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; err&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;, key = &#34;&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; key&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;31&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;end&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;32&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;-- å¾—åˆ°çš„æ•°æ®ä¸ºç©ºå¤„ç†&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;33&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; resp &lt;span class=&#34;token operator&#34;&gt;==&lt;/span&gt; ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;null &lt;span class=&#34;token keyword&#34;&gt;then&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;34&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        resp &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;nil&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;35&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;ERR&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;æŸ¥è¯¢Redisæ•°æ®ä¸ºç©º, key = &#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; key&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;36&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;end&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;37&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token function&#34;&gt;close_redis&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;red&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;38&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; resp&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;39&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;end&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;40&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;41&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- å°è£…å‡½æ•°ï¼Œå‘é€ http è¯·æ±‚ï¼Œå¹¶è§£æå“åº”&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;42&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;read_http&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;path&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; params&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;43&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; resp &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;location&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;capture&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;path&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;44&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        method &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;HTTP_GET&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;45&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        args &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; params&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;46&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;47&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;not&lt;/span&gt; resp &lt;span class=&#34;token keyword&#34;&gt;then&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;48&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;-- è®°å½•é”™è¯¯ä¿¡æ¯ï¼Œè¿”å› 404&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;49&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;ERR&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;http æŸ¥è¯¢å¤±è´¥äº†~, path: &#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; path &lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;, args: &#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; args&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;50&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;exit&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;404&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;51&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;end&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;52&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; resp&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;body&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;53&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;end&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;54&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- å°†æ–¹æ³•å¯¼å‡º&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;55&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; _M &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;56&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    read_http &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; read_http&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;57&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    read_redis &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; read_redis&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;58&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;  &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;59&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; _M&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;åœ¨ item.lua æ–‡ä»¶ä¸­è¿›è¡Œå¯¼å…¥ redis å·¥å…·å‡½æ•°&lt;/p&gt;
&lt;figure class=&#34;highlight lua&#34;&gt;&lt;figcaption data-lang=&#34;lua&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; read_redis &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; common&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;read_redis&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;ç”±äºæ·»åŠ äº† redis ç¼“å­˜é‚£ä¹ˆä¹‹å‰çš„æŸ¥è¯¢å•†å“ä¿¡æ¯å’Œåº“å­˜çš„å‡½æ•°å°±éœ€è¦ä¿®æ”¹äº†ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯éœ€è¦ä¿®æ”¹ä¸¤ä¸ªå¤ªéº»çƒ¦äº†æ‰€ä»¥å¯¹å…¶è¿›è¡Œå°è£…å‡½æ•°ï¼š&lt;/p&gt;
&lt;p&gt;éœ€æ±‚ï¼š&lt;/p&gt;
&lt;p&gt;1ã€ä¿®æ”¹ item.luaï¼Œå°è£…ä¸€ä¸ªå‡½æ•° read_dataï¼Œå®ç°å…ˆæŸ¥è¯¢ redisï¼Œå¦‚æœæœªå‘½ä¸­ï¼Œå†æŸ¥è¯¢ tomcat&lt;/p&gt;
&lt;p&gt;2ã€ä¿®æ”¹ item.luaï¼ŒæŸ¥è¯¢å•†å“å’Œåº“å­˜æ—¶éƒ½è°ƒç”¨ read_data è¿™ä¸ªå‡½æ•°&lt;/p&gt;
&lt;figure class=&#34;highlight lua&#34;&gt;&lt;figcaption data-lang=&#34;lua&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- å°è£…æŸ¥è¯¢å‡½æ•°ï¼Œå…ˆæŸ¥è¯¢ redisï¼Œå¦‚æœæœªå‘½ä¸­å†æŸ¥è¯¢ tomcat&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;read_data&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;key&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; path&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; params&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token comment&#34;&gt;-- æŸ¥è¯¢ redis&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; resp &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;read_redis&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;192.168.249.128&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;6379&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; key&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token comment&#34;&gt;-- åˆ¤æ–­ redis æ˜¯å¦å‘½ä¸­&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;not&lt;/span&gt; resp &lt;span class=&#34;token keyword&#34;&gt;then&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;-- redis æŸ¥è¯¢å¤±è´¥ï¼Œå†æŸ¥è¯¢ tomcat&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    resp &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;read_http&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;path&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; params&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token keyword&#34;&gt;end&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; resp&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;end&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;ç¼–å†™å®Œå°è£…å‡½æ•°åå°†åŸæ¥çš„è¯·æ±‚å‡½æ•°è¿›è¡Œæ›¿æ¢&lt;/p&gt;
&lt;figure class=&#34;highlight lua&#34;&gt;&lt;figcaption data-lang=&#34;lua&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- æŸ¥è¯¢å•†å“ä¿¡æ¯&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; itemJSON &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;read_data&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;item:id:&#34;&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;..&lt;/span&gt; id&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;/item/&#34;&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;..&lt;/span&gt; id&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;nil&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- æŸ¥è¯¢åº“å­˜ä¿¡æ¯&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; stockJSON &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;read_data&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;item:stock:id:&#34;&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;..&lt;/span&gt; id&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;/item/stock/&#34;&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;..&lt;/span&gt; id&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;nil&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;item.lua æ–‡ä»¶çš„å®Œæ•´ä»£ç ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight lua&#34;&gt;&lt;figcaption data-lang=&#34;lua&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- å¯¼å…¥ common å‡½æ•°åº“&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; common &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;require&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;common&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; read_http &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; common&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;read_http&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; read_redis &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; common&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;read_redis&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- å¯¼å…¥ cjson åº“&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; cjson &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;require&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;cjson&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- å°è£…æŸ¥è¯¢å‡½æ•°ï¼Œå…ˆæŸ¥è¯¢ redisï¼Œå¦‚æœæœªå‘½ä¸­å†æŸ¥è¯¢ tomcat&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;read_data&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;key&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; path&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; params&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token comment&#34;&gt;-- æŸ¥è¯¢ redis&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; resp &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;read_redis&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;192.168.249.128&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;6379&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; key&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token comment&#34;&gt;-- åˆ¤æ–­ redis æ˜¯å¦å‘½ä¸­&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;not&lt;/span&gt; resp &lt;span class=&#34;token keyword&#34;&gt;then&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;-- redis æŸ¥è¯¢å¤±è´¥ï¼Œå†æŸ¥è¯¢ tomcat&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;redisæŸ¥è¯¢å¤±è´¥,å°è¯•æŸ¥è¯¢http, key :&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; key&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    resp &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;read_http&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;path&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; params&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token keyword&#34;&gt;end&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; resp&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;end&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;21&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;22&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- è·å–è·¯å¾„å‚æ•°&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;23&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; id &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;var&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;24&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;25&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- æŸ¥è¯¢å•†å“ä¿¡æ¯&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;26&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; itemJSON &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;read_data&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;item:id:&#34;&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;..&lt;/span&gt; id&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;/item/&#34;&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;..&lt;/span&gt; id&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;nil&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;27&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- æŸ¥è¯¢åº“å­˜ä¿¡æ¯&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;28&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; stockJSON &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;read_data&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;item:stock:id:&#34;&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;..&lt;/span&gt; id&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;/item/stock/&#34;&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;..&lt;/span&gt; id&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;nil&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;29&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;30&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- JSON è½¬åŒ–ä¸º lua çš„ table&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;31&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; item &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; cjson&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;decode&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;itemJSON&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;32&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; sto &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; cjson&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;decode&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;stockJSON&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;33&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;34&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- ç»„åˆæ•°æ®&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;35&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;item&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;stock &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; sto&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;stock&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;36&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;item&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;sold &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; sto&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;sold&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;37&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;38&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- æŠŠ item åºåˆ—åŒ–ä¸º json è¿”å›ç»“æœ&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;39&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;say&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;cjson&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;encode&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;item&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;é‡å¯è™šæ‹Ÿæœºä¸­çš„ nginx&lt;/p&gt;
&lt;figure class=&#34;highlight sh&#34;&gt;&lt;figcaption data-lang=&#34;sh&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;root@localhost nginx&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token comment&#34;&gt;# nginx -s reload&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;è®¿é—® uri è¿›è¡Œæµ‹è¯•ï¼š&lt;a href=&#34;http://localhost/item.html?id=10002&#34;&gt;http://localhost/item.html?id=10002&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310201603830.png&#34; alt=&#34;image-20231020160328617&#34;&gt;&lt;/p&gt;
&lt;p&gt;æŸ¥çœ‹ idea æ§åˆ¶å°&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310201603637.png&#34; alt=&#34;image-20231020160349587&#34;&gt;&lt;/p&gt;
&lt;p&gt;å°†æ§åˆ¶å°ä¿¡æ¯æ¸…ç©ºåå†æ¬¡è®¿é—® uriï¼š&lt;a href=&#34;http://localhost/item.html?id=10002&#34;&gt;http://localhost/item.html?id=10002&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ§åˆ¶å°æƒ…å†µ&lt;/p&gt;
&lt;p&gt;è¯´æ˜æ•°æ®å·²ç»è¢«ç¼“å­˜äº†&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310201604800.png&#34; alt=&#34;image-20231020160432732&#34;&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æŠŠä¸¤ä¸ªæœåŠ¡å™¨å…¨å…³äº†&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310201605790.png&#34; alt=&#34;image-20231020160510420&#34;&gt;&lt;/p&gt;
&lt;p&gt;å†è®¿é—®ä¸€ä¸‹ uriï¼š&lt;a href=&#34;http://localhost/item.html?id=10002&#34;&gt;http://localhost/item.html?id=10002&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310201634990.png&#34; alt=&#34;image-20231020163445555&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°å¦‚æœæ²¡æœ‰å¯åŠ¨ Tomcat ä¹Ÿæ²¡äº‹å„¿å› ä¸ºå…ˆå»çœ‹äº†ä¸‹ Redis å‘ç°æœ‰ç›¸å…³æ•°æ®ç›´æ¥æ‹¿æ¥å°±ä¸æ‰¾æœåŠ¡å™¨äº†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;66-nginxæœ¬åœ°ç¼“å­˜&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#66-nginxæœ¬åœ°ç¼“å­˜&#34;&gt;#&lt;/a&gt; 6.6ã€Nginx æœ¬åœ°ç¼“å­˜ğŸŒ³&lt;/h2&gt;
&lt;p&gt;OPenResty ä¸º Nginx æä¾›äº† shard dict çš„åŠŸèƒ½ï¼Œå¯ä»¥åœ¨ Nginx çš„å¤šä¸ª worker ä¹‹é—´å…±äº«æ•°æ®ï¼Œå®ç°ç¼“å­˜åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;p&gt;1ã€å¼€å¯å…±äº«å­—å…¸ï¼Œåœ¨ nginx.conf çš„ http ä¸‹æ·»åŠ é…ç½®&lt;/p&gt;
&lt;figure class=&#34;highlight nginx&#34;&gt;&lt;figcaption data-lang=&#34;nginx&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# å…±äº«å­—å…¸ï¼Œä¹Ÿå°±æ˜¯æœ¬åœ°ç¼“å­˜ï¼Œåç§°å«åšï¼šitem_cacheï¼Œå¤§å° 150m&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;lua_shared_dict&lt;/span&gt; item_cache &lt;span class=&#34;token number&#34;&gt;150m&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;2ã€æ“ä½œå…±äº«å­—å…¸&lt;/p&gt;
&lt;p&gt;åœ¨ item.lua æ–‡ä»¶ä¸­å¯¼å…¥&lt;/p&gt;
&lt;figure class=&#34;highlight lua&#34;&gt;&lt;figcaption data-lang=&#34;lua&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- å¯¼å…¥å…±äº«è¯å…¸ï¼Œæœ¬åœ°ç¼“å­˜&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; item_cache &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; ngx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;shared&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;item_cache&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h3 id=&#34;661-æ¡ˆä¾‹åœ¨æŸ¥è¯¢å•†å“æ—¶ä¼˜å…ˆæŸ¥è¯¢openrestyçš„æœ¬åœ°ç¼“å­˜&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#661-æ¡ˆä¾‹åœ¨æŸ¥è¯¢å•†å“æ—¶ä¼˜å…ˆæŸ¥è¯¢openrestyçš„æœ¬åœ°ç¼“å­˜&#34;&gt;#&lt;/a&gt; 6.6.1ã€æ¡ˆä¾‹ï¼Œåœ¨æŸ¥è¯¢å•†å“æ—¶ï¼Œä¼˜å…ˆæŸ¥è¯¢ OPenResty çš„æœ¬åœ°ç¼“å­˜ğŸŒ²&lt;/h3&gt;
&lt;p&gt;éœ€æ±‚ï¼š&lt;/p&gt;
&lt;p&gt;1ã€ä¿®æ”¹ item.lua ä¸­çš„ read_data å‡½æ•°ï¼Œä¼˜å…ˆæŸ¥è¯¢æœ¬åœ°ç¼“å­˜ï¼Œæœªå‘½ä¸­æ—¶åœ¨æŸ¥è¯¢ Redisï¼ŒTomcat&lt;/p&gt;
&lt;p&gt;2ã€æŸ¥è¯¢ Redis æˆ– Tomcat æˆåŠŸåï¼Œå°†æ•°æ®å†™å…¥æœ¬åœ°ç¼“å­˜ï¼Œå¹¶è®¾ç½®æœ‰æ•ˆæœŸ&lt;/p&gt;
&lt;p&gt;3ã€å•†å“åŸºæœ¬ä¿¡æ¯ï¼Œæœ‰æ•ˆæœŸ 30 åˆ†é’Ÿ&lt;/p&gt;
&lt;p&gt;4ã€åº“å­˜ä¿¡æ¯ï¼Œæœ‰æ•ˆæœŸ 1 åˆ†é’Ÿ&lt;/p&gt;
&lt;figure class=&#34;highlight lua&#34;&gt;&lt;figcaption data-lang=&#34;lua&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;-- å°è£…æŸ¥è¯¢å‡½æ•°ï¼Œå…ˆæŸ¥è¯¢ redisï¼Œå¦‚æœæœªå‘½ä¸­å†æŸ¥è¯¢ tomcat&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;read_data&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;key&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; expire&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; path&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; params&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token comment&#34;&gt;-- æŸ¥è¯¢æœ¬åœ°ç¼“å­˜&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token keyword&#34;&gt;local&lt;/span&gt; val &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; item_cache&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;key&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;not&lt;/span&gt; val &lt;span class=&#34;token keyword&#34;&gt;then&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;-- æŸ¥è¯¢ redis&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    val &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;read_redis&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;192.168.249.128&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;6379&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; key&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;-- åˆ¤æ–­æŸ¥è¯¢ç»“æœ&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;not&lt;/span&gt; val &lt;span class=&#34;token keyword&#34;&gt;then&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;-- redis æŸ¥è¯¢å¤±è´¥ï¼ŒæŸ¥è¯¢ tomcat&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        val &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;read_http&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;path&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; params&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;end&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token keyword&#34;&gt;end&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token comment&#34;&gt;-- æŸ¥è¯¢æˆåŠŸï¼ŒæŠŠæ•°æ®å†™å…¥æœ¬åœ°ç¼“å­˜&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  item_cache&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;key&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; val&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; expire&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token comment&#34;&gt;-- è¿”å›æ•°æ®&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; val&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;end&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;æµ‹è¯•&lt;/p&gt;
&lt;p&gt;åˆ‡æ¢åˆ° nginx ç›®å½•ä¸‹æ¥ç›‘æ§ error.log æ–‡ä»¶çš„æ‰“å°æƒ…å†µ&lt;/p&gt;
&lt;figure class=&#34;highlight sh&#34;&gt;&lt;figcaption data-lang=&#34;sh&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;root@localhost nginx&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token comment&#34;&gt;# nginx -s reload&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;root@localhost nginx&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token comment&#34;&gt;# pwd&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;/usr/local/openresty/nginx&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;root@localhost nginx&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token comment&#34;&gt;# tail -f logs/error.log&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h1 id=&#34;ä¸ƒ-ç¼“å­˜åŒæ­¥&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä¸ƒ-ç¼“å­˜åŒæ­¥&#34;&gt;#&lt;/a&gt; ä¸ƒã€ç¼“å­˜åŒæ­¥ğŸ„&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;æ•°æ®åŒæ­¥ç­–ç•¥&lt;/li&gt;
&lt;li&gt;å®‰è£… Canal&lt;/li&gt;
&lt;li&gt;ç›‘å¬ Canal&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;71-æ•°æ®åŒæ­¥ç­–ç•¥&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#71-æ•°æ®åŒæ­¥ç­–ç•¥&#34;&gt;#&lt;/a&gt; 7.1ã€æ•°æ®åŒæ­¥ç­–ç•¥ğŸŒ³&lt;/h2&gt;
&lt;p&gt;ç¼“å­˜æ•°æ®åŒæ­¥çš„å¸¸è§æ–¹å¼æœ‰ä¸‰ç§ï¼š&lt;/p&gt;
&lt;p&gt;&lt;mark&gt;1ã€è®¾ç½®æœ‰æ•ˆæœŸ&lt;/mark&gt;ï¼šç»™ç¼“å­˜è®¾ç½®æœ‰æ•ˆæœŸï¼Œåˆ°æœŸåè‡ªåŠ¨åˆ é™¤ã€‚å†æ¬¡æŸ¥è¯¢æ—¶æ›´æ–°&lt;/p&gt;
&lt;p&gt;1.1ã€ä¼˜åŠ¿ï¼šç®€å•ï¼Œæ–¹ä¾¿&lt;/p&gt;
&lt;p&gt;1.2ã€ç¼ºç‚¹ï¼šæ—¶æ•ˆæ€§å·®ï¼Œç¼“å­˜è¿‡æœŸä¹‹å‰å¯èƒ½ä¸ä¸€è‡´&lt;/p&gt;
&lt;p&gt;1.3ã€åœºæ™¯ï¼šæ›´æ–°é¢‘ç‡è¾ƒä½ï¼Œæ—¶æ•ˆæ€§è¦æ±‚ä½çš„ä¸šåŠ¡&lt;/p&gt;
&lt;p&gt;&lt;mark&gt;2ã€åŒæ­¥åŒå†™&lt;/mark&gt;ï¼šåœ¨ä¿®æ”¹æ•°æ®åº“çš„åŒæ—¶ï¼Œç›´æ¥ä¿®æ”¹ç¼“å­˜&lt;/p&gt;
&lt;p&gt;2.1ã€ä¼˜åŠ¿ï¼šæ—¶æ•ˆæ€§å¼ºï¼Œç¼“å­˜ä¸æ•°æ®åº“å¼ºä¸€è‡´&lt;/p&gt;
&lt;p&gt;2.2ã€ç¼ºç‚¹ï¼šæœ‰ä»£ç ä¾µå…¥ï¼Œè€¦åˆåº¦é«˜&lt;/p&gt;
&lt;p&gt;2.3ã€åœºæ™¯ï¼šå¯¹ä¸€è‡´æ€§ï¼Œæ—¶æ•ˆæ€§è¦æ±‚è¾ƒé«˜çš„ç¼“å­˜æ•°æ®&lt;/p&gt;
&lt;p&gt;&lt;mark&gt;3ã€å¼‚æ­¥é€šçŸ¥&lt;/mark&gt;ï¼šä¿®æ”¹æ•°æ®åº“æ—¶å‘é€äº‹ä»¶é€šçŸ¥ï¼Œç›¸å…³æœåŠ¡ç›‘å¬åˆ°é€šçŸ¥åä¿®æ”¹ç¼“å­˜æ•°æ®&lt;/p&gt;
&lt;p&gt;3.1ã€ä¼˜åŠ¿ï¼šä½è€¦åˆï¼Œå¯ä»¥åŒæ—¶é€šçŸ¥å¤šä¸ªç¼“å­˜æœåŠ¡&lt;/p&gt;
&lt;p&gt;3.2ã€ç¼ºç‚¹ï¼šæ—¶æ•ˆæ€§ä¸€èˆ¬ï¼Œå¯èƒ½å­˜åœ¨ç»ˆæçˆ±ä½ ä¸ä¸€è‡´çŠ¶æ€&lt;/p&gt;
&lt;p&gt;3.3ã€åœºæ™¯ï¼šæ—¶æ•ˆæ€§è¦æ±‚ä¸€èˆ¬ï¼Œæœ‰å¤šä¸ªæœåŠ¡éœ€è¦åŒæ­¥&lt;/p&gt;
&lt;h3 id=&#34;711-ç¼“å­˜åŒæ­¥ç­–ç•¥&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#711-ç¼“å­˜åŒæ­¥ç­–ç•¥&#34;&gt;#&lt;/a&gt; 7.1.1ã€ç¼“å­˜åŒæ­¥ç­–ç•¥ğŸŒ²&lt;/h3&gt;
&lt;p&gt;å¼‚æ­¥é€šçŸ¥å¯ä»¥ä½¿ç”¨åŸºäº MQ çš„å¼‚æ­¥é€šçŸ¥&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310210915149.png&#34; alt=&#34;image-20231021091552370&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯åŸºäº MQ è¿˜æ˜¯è¦ä¿®æ”¹é‡Œé¢çš„ä»£ç å‘é€æ¶ˆæ¯ï¼Œè€Œä¸‹é¢è¦è®²çš„æ˜¯åŸºäº Canal çš„å¼‚æ­¥é€šçŸ¥&lt;/p&gt;
&lt;p&gt;åŸºäº Canal çš„å¼‚æ­¥é€šçŸ¥&lt;/p&gt;
&lt;p&gt;canal å¯ä»¥å»ç›‘å¬æ•°æ®åº“çš„å˜åŒ–&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310210917386.png&#34; alt=&#34;image-20231021091750935&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;712-åˆå§‹canal&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#712-åˆå§‹canal&#34;&gt;#&lt;/a&gt; 7.1.2ã€åˆå§‹ CanalğŸŒ²&lt;/h3&gt;
&lt;p&gt;Canal æ„è¯‘ä¸º æ°´é“ / ç®¡é“ / æ²Ÿæ¸ ï¼ŒCanal æ˜¯é˜¿é‡Œå·´å·´æ——ä¸‹çš„ä¸€æ¬¾å¼€æºé¡¹ç›®ï¼ŒåŸºäº Java å¼€å‘ã€‚åŸºäºæ•°æ®åº“å¢é‡æ—¥å¿—è§£æï¼Œæä¾›å¢é‡æ•°æ®è®¢é˜… &amp;amp; æ¶ˆè´¹ã€‚GiHub åœ°å€ï¼š&lt;a href=&#34;https://github.com/alibaba/canal&#34;&gt;https://github.com/alibaba/canal&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Canal æ˜¯åŸºäº mysql çš„ä¸»ä»åŒæ­¥æ¥å®ç°çš„ï¼ŒMySQL ä¸»ä»åŒæ­¥çš„åŸç†å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;master å°±æ˜¯ mysql çš„ä¸»èŠ‚ç‚¹ï¼Œslave å°±æ˜¯ mysql çš„ä»èŠ‚ç‚¹ã€‚ä¸»ä»æ•°æ®æ˜¯è¦åšåŒæ­¥çš„ï¼Œé‚£å®ƒæ€ä¹ˆåšåˆ°çš„å‘¢ï¼Ÿé¦–å…ˆ mysql çš„ä¸»èŠ‚ç‚¹åœ¨åšå¢åˆ æ”¹æŸ¥æ—¶å°±å›å»è®°å½•æ—¥å¿—åˆ° binary.log æ–‡ä»¶ä¸­è¿™ä¸ªæ–‡ä»¶ç§°ä¸ºäºŒè¿›åˆ¶æ—¥å¿—æ–‡ä»¶ã€‚å…¶ä¸­è®°å½•çš„å°±æ˜¯ binary log eventsï¼Œé‡Œé¢è®°å½•çš„å°±æ˜¯ä¸šåŠ¡ sqlã€‚slave ä¼šå¼€å¯ä¸€ä¸ªçº¿ç¨‹ä¸æ–­çš„æ¥è¯»å–è¿™ä¸ªæ—¥å¿—æ–‡ä»¶æŠŠè¿™ä¸ªæ–‡ä»¶è¯»è¿‡æ¥æ”¾åˆ°ä¸€ä¸ª relay log æ–‡ä»¶ä¸­ã€‚è¿™æ ·ä¸»èŠ‚ç‚¹åšäº†å“ªäº› sql ä»èŠ‚ç‚¹ ä¹Ÿåšå“ªäº› sql&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310210922728.png&#34; alt=&#34;image-20231021092228657&#34;&gt;&lt;/p&gt;
&lt;p&gt;è€Œ Canal å°±æ˜¯æŠŠè‡ªå·±ä¼ªè£…æˆ MySQL çš„ä¸€ä¸ª Slave èŠ‚ç‚¹ï¼Œä»è€Œç›‘å¬ master çš„ binary log å˜åŒ–ã€‚å†æŠŠå¾—åˆ°çš„å˜åŒ–ä¿¡æ¯é€šçŸ¥ç»™ Canal çš„å®¢æˆ·ç«¯ï¼Œè¿›è€Œå®Œæˆå¯¹å…¶å®ƒæ•°æ®åº“çš„åŒæ­¥ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310210929872.png&#34; alt=&#34;image-20231021092859461&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;713-canalå®‰è£…&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#713-canalå®‰è£…&#34;&gt;#&lt;/a&gt; 7.1.3ã€Canal å®‰è£…ğŸŒ²&lt;/h3&gt;
&lt;p&gt;æŸ¥çœ‹æ–‡ç« ï¼š&lt;a href=&#34;./Canal/%E5%AE%89%E8%A3%85Canal.md&#34;&gt;å®‰è£… Canal&lt;/a&gt;.&lt;/p&gt;
&lt;h3 id=&#34;714-canalå®¢æˆ·ç«¯&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#714-canalå®¢æˆ·ç«¯&#34;&gt;#&lt;/a&gt; 7.1.4ã€Canal å®¢æˆ·ç«¯ğŸŒ²&lt;/h3&gt;
&lt;p&gt;Canal æä¾›äº†å„ç§è¯­è¨€çš„å®¢æˆ·ç«¯ï¼Œå½“ Canal ç›‘å¬åˆ° binlog å˜åŒ–æ—¶ï¼Œä¼šé€šçŸ¥ Canal çš„å®¢æˆ·ç«¯ã€‚ä¸è¿‡è¿™é‡Œæˆ‘ä»¬ä¼šä½¿ç”¨ Github ä¸Šçš„ç¬¬ä¸‰æ–¹å¼€æºçš„ canal-staterã€‚åœ°å€ï¼š&lt;a href=&#34;https://github.com/NormanGyllenhaal/canal-client&#34;&gt;https://github.com/NormanGyllenhaal/canal-client&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å¼•å…¥ä¾èµ–ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight xml&#34;&gt;&lt;figcaption data-lang=&#34;XML&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;dependency&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;groupId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;top.javatool&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;/&lt;/span&gt;groupId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;artifactId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;canal-spring-boot-starter&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;/&lt;/span&gt;artifactId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;version&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;1.2.1-RELEASE&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;/&lt;/span&gt;version&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token tag&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;/&lt;/span&gt;dependency&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;ç¼–å†™é…ç½®ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight yml&#34;&gt;&lt;figcaption data-lang=&#34;YAML&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key atrule&#34;&gt;canal&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token key atrule&#34;&gt;destination&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; dkx1 &lt;span class=&#34;token comment&#34;&gt;# canal å®ä¾‹åç§°ï¼Œè¦è·Ÿ canal-server è¿è¡Œæ—¶è®¾ç½®çš„ destiation ä¸€è‡´&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token key atrule&#34;&gt;server&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; 192.168.249.128&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;11111&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# canal åœ°å€&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;ç¼–å†™ç›‘å¬å™¨ï¼Œç›‘å¬ Canal æ¶ˆæ¯ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;// æŒ‡å®šè¦ç›‘å¬çš„è¡¨&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@CanalTable&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;tb_item&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@Component&lt;/span&gt;                                    &lt;span class=&#34;token comment&#34;&gt;// æŒ‡å®šè¡¨å…³è”çš„å®ä½“ç±»&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;ItemHandler&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;implements&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;EntryHandler&lt;/span&gt;&lt;span class=&#34;token generics&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;Item&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;// ä¸‹é¢ä¸‰ä¸ªé‡å†™æ–¹æ³•æ˜¯ï¼Œç›‘å¬åˆ°æ•°æ®åº“çš„å¢åˆ æ”¹çš„æ¶ˆæ¯çš„&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@Override&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;insert&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;Item&lt;/span&gt; item&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// å†™æ•°æ®åˆ° redis&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// å†™æ•°æ®åˆ° jvm è¿›ç¨‹ç¼“å­˜&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token class-name&#34;&gt;EntryHandler&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;super&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;insert&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;item&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@Override&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;update&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;Item&lt;/span&gt; before&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Item&lt;/span&gt; after&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// å†™æ•°æ®åˆ° redis&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// å†™æ•°æ®åˆ° jvm è¿›ç¨‹ç¼“å­˜&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token class-name&#34;&gt;EntryHandler&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;super&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;update&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;before&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; after&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@Override&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;21&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;delete&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;Item&lt;/span&gt; item&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;22&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// å†™æ•°æ®åˆ° redis&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;23&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// å†™æ•°æ®åˆ° jvm è¿›ç¨‹ç¼“å­˜&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;24&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token class-name&#34;&gt;EntryHandler&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;super&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;delete&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;item&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;25&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;26&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;Canal æ¨é€ç»™ canal-client çš„æ˜¯è¢«ä¿®æ”¹çš„è¿™ä¸€è¡Œæ•°æ® (row) ï¼Œè€Œæˆ‘ä»¬å¼•å…¥çš„ canal-client åˆ™ä¼šå¸®æˆ‘ä»¬æŠŠè¡Œæ•°æ®å°è£…åˆ° item å®ä½“ç±»ä¸­ã€‚è¿™ä¸ªè¿‡ç¨‹ä¸­éœ€è¦çŸ¥é“æ•°æ®åº“ä¸å®ä½“çš„æ˜ å°„å…³ç³»ï¼Œè¦ç”¨åˆ° JPA çš„å‡ ä¸ªæ³¨è§£ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@Data&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@TableName&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;tb_item&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Item&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@TableId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;type &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;IdType&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token constant&#34;&gt;AUTO&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;// æ ‡è®°è¡¨ä¸­çš„ id å­—æ®µ&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@Id&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Long&lt;/span&gt; id&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;token comment&#34;&gt;// å•†å“ id&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt; å…¶å®ƒå­—æ®µ çœç•¥&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Date&lt;/span&gt; updateTime&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;token comment&#34;&gt;// æ›´æ–°æ—¶é—´&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;// @Transient æ ‡è®°ä¸å±äºè¡¨ä¸­çš„å­—æ®µ  å¿½ç•¥&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@TableField&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;exist &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token boolean&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@Transient&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Integer&lt;/span&gt; stock&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@TableField&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;exist &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token boolean&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@Transient&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Integer&lt;/span&gt; sold&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;ç¼–å†™ redis çš„ç¼“å­˜ç±» ï¼Œæ·»åŠ ä¸¤ä¸ªå‡½æ•°ï¼Œä¸€ä¸ªæ–°å¢æˆ–æ›´æ–°ï¼Œä¸€ä¸ªæ˜¯åˆ é™¤&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;saveItem&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;Item&lt;/span&gt; item&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token keyword&#34;&gt;try&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token class-name&#34;&gt;String&lt;/span&gt; json &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token constant&#34;&gt;MAPPER&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;writeValueAsString&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;item&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      redisTemplate&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;opsForValue&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;item:id:&#34;&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; item&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;getId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; json&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;catch&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;JsonProcessingException&lt;/span&gt; e&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token keyword&#34;&gt;throw&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;RuntimeException&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;e&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;deleteItemById&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;Long&lt;/span&gt; id&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   redisTemplate&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;delete&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;item:id:&#34;&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; id&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;å®šä¹‰å®Œ redis çš„ç¼“å­˜ç±»é‡Œé¢çš„å‡½æ•°åå†å›åˆ°ç¼–å†™ç›‘å¬å™¨çš„ç±»é‡Œé¢ç¼–å†™ä»£ç ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@CanalTable&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;tb_item&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@Component&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;ItemHandler&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;implements&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;EntryHandler&lt;/span&gt;&lt;span class=&#34;token generics&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;Item&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@Autowired&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;RedisHandler&lt;/span&gt; redisHandler&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@Autowired&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Cache&lt;/span&gt;&lt;span class=&#34;token generics&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;Long&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Item&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt; cache&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@Override&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;insert&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;Item&lt;/span&gt; item&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// å†™æ•°æ®åˆ° jvm è¿›ç¨‹ç¼“å­˜&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        cache&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;put&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;item&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;getId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; item&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// å†™æ•°æ®åˆ° redis&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        redisHandler&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;saveItem&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;item&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@Override&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;update&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;Item&lt;/span&gt; before&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Item&lt;/span&gt; after&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// å†™æ•°æ®åˆ° jvm è¿›ç¨‹ç¼“å­˜&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        cache&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;put&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;after&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;getId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; after&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// å†™æ•°æ®åˆ° redis&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;21&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        redisHandler&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;saveItem&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;after&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;22&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token class-name&#34;&gt;EntryHandler&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;super&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;update&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;before&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; after&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;23&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;24&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;25&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@Override&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;26&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;delete&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;Item&lt;/span&gt; item&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;27&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// å†™æ•°æ®åˆ° jvm è¿›ç¨‹ç¼“å­˜&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;28&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        cache&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;invalidate&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;item&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;getId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;29&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// å†™æ•°æ®åˆ° redis&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;30&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        redisHandler&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;deleteItemById&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;item&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;getId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;31&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token class-name&#34;&gt;EntryHandler&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;super&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;delete&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;item&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;32&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;33&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;å¯åŠ¨æœåŠ¡æŸ¥çœ‹ idea æ‰“å°ä¿¡æ¯ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;meters: 10005(Long)
14:50:32:387 DEBUG 4956 --- [nio-8081-exec-7] c.h.i.mapper.ItemStockMapper.selectById  : &amp;lt;==      Total: 1
14:50:32:472  INFO 4956 --- [l-client-thread] t.j.c.client.client.AbstractCanalClient  : è·å–æ¶ˆæ¯ Message[id=-1,entries=[],raw=false,rawEntries=[]]
14:50:34:474  INFO 4956 --- [l-client-thread] t.j.c.client.client.AbstractCanalClient  : è·å–æ¶ˆæ¯ Message[id=-1,entries=[],raw=false,rawEntries=[]]
14:50:36:477  INFO 4956 --- [l-client-thread] t.j.c.client.client.AbstractCanalClient  : è·å–æ¶ˆæ¯ Message[id=-1,entries=[],raw=false,rawEntries=[]]
14:50:38:478  INFO 4956 --- [l-client-thread] t.j.c.client.client.AbstractCanalClient  : è·å–æ¶ˆæ¯ Message[id=-1,entries=[],raw=false,rawEntries=[]]
14:50:40:472  INFO 4956 --- [l-client-thread] t.j.c.client.client.AbstractCanalClient  : è·å–æ¶ˆæ¯ Message[id=-1,entries=[],raw=false,rawEntries=[]]
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¡¨ç¤º canal ä¸ java æˆåŠŸçš„è¿æ¥åˆ°äº†&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆæµ‹è¯•ä¸€ä¸‹æ•°æ®åŒæ­¥æ‰“å¼€ 8081 ç«¯å£çš„é¡µé¢&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚è¯´ä¿®æ”¹ 10001 è¿™ä¸ªå•†å“çš„æ•°æ®ï¼š&lt;/p&gt;
&lt;p&gt;åŸæ¥çš„æ•°æ®å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310211452116.png&#34; alt=&#34;image-20231021145237319&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä¿®æ”¹åçš„æ•°æ®å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310211453292.png&#34; alt=&#34;image-20231021145302067&#34;&gt;&lt;/p&gt;
&lt;p&gt;ç‚¹å‡»ç¡®å®š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310211453164.png&#34; alt=&#34;image-20231021145357351&#34;&gt;&lt;/p&gt;
&lt;p&gt;å†æŸ¥çœ‹ idea çš„æ§åˆ¶å°ä¿¡æ¯ï¼š&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°æ‰“å°äº†ä¸€å †æ—¥å¿—ä¿¡æ¯&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  version: 1
  logfileName: &amp;quot;mysql-bin.000006&amp;quot;
  logfileOffset: 1173
  serverId: 1000
  serverenCode: &amp;quot;UTF-8&amp;quot;
  executeTime: 1697871191000
  sourceType: MYSQL
  schemaName: &amp;quot;&amp;quot;
  tableName: &amp;quot;&amp;quot;
  eventLength: 91
&amp;#125;
entryType: TRANSACTIONBEGIN
storeValue: &amp;quot; H&amp;quot;
, header &amp;#123;
  version: 1
  logfileName: &amp;quot;mysql-bin.000006&amp;quot;
  logfileOffset: 1344
  serverId: 1000
  serverenCode: &amp;quot;UTF-8&amp;quot;
  executeTime: 1697871191000
  sourceType: MYSQL
  schemaName: &amp;quot;dkx&amp;quot;
  tableName: &amp;quot;tb_item&amp;quot;
  eventLength: 620
  eventType: UPDATE
  props &amp;#123;
    key: &amp;quot;rowsCount&amp;quot;
    value: &amp;quot;1&amp;quot;
  &amp;#125;
&amp;#125;
entryType: ROWDATA
storeValue: &amp;quot;\b_\020\002P\000b\324\n\n&amp;amp;\b\000\020\373\377\377\377\377\377\377\377\377\001\032\002id \001(\0000\000B\00510001R\006bigint\nd\b\001\020\f\032\005title \000(\0000\000BCRIMOWA 21\345\257\270\346\211\230\350\277\220\347\256\261\346\213\211\346\235\206\347\256\261 SALSA AIR\347\263\273\345\210\227\346\236\234\347\273\277\350\211\262 820.70.36.4R\fvarchar(264)\n)\b\002\020\f\032\004name \000(\0000\000B\tSALSA AIRR\fvarchar(128)\n)\b\003\020\373\377\377\377\377\377\377\377\377\001\032\005price \000(\0000\000B\00516900R\006bigint\n\226\001\b\004\020\f\032\005image \000(\0000\000Buhttps://m.360buyimg.com/mobilecms/s720x720_jfs/t6934/364/1195375010/84676/e9f2c55f/597ece38N0ddcbc77.jpg!q70.jpg.webpR\fvarchar(200)\n-\b\005\020\f\032\bcategory \000(\0000\000B\t\346\213\211\346\235\206\347\256\261R\fvarchar(200)\n\&#39;\b\006\020\f\032\005brand \000(\0000\000B\006RIMOWAR\fvarchar(100)\nG\b\a\020\f\032\004spec \000(\0000\000B\&#39;&amp;#123;\&amp;quot;\351\242\234\350\211\262\&amp;quot;: \&amp;quot;\347\272\242\350\211\262\&amp;quot;, \&amp;quot;\345\260\272\347\240\201\&amp;quot;: \&amp;quot;26\345\257\270\&amp;quot;&amp;#125;R\fvarchar(200)\n\032\b\b\020\004\032\006status \000(\0000\000B\0011R\003int\n6\b\t\020]\032\vcreate_time \000(\0000\000B\0232019-05-01 00:00:00R\bdatetime\n6\b\n\020]\032\vupdate_time \000(\0000\000B\0232019-05-01 00:00:00R\bdatetime\022&amp;amp;\b\000\020\373\377\377\377\377\377\377\377\377\001\032\002id \001(\0000\000B\00510001R\006bigint\022d\b\001\020\f\032\005title \000(\0000\000BCRIMOWA 21\345\257\270\346\211\230\350\277\220\347\256\261\346\213\211\346\235\206\347\256\261 SALSA AIR\347\263\273\345\210\227\346\236\234\347\273\277\350\211\262 820.70.36.4R\fvarchar(264)\022)\b\002\020\f\032\004name \000(\0000\000B\tSALSA AIRR\fvarchar(128)\022)\b\003\020\373\377\377\377\377\377\377\377\377\001\032\005price \000(\0010\000B\00528900R\006bigint\022\226\001\b\004\020\f\032\005image \000(\0000\000Buhttps://m.360buyimg.com/mobilecms/s720x720_jfs/t6934/364/1195375010/84676/e9f2c55f/597ece38N0ddcbc77.jpg!q70.jpg.webpR\fvarchar(200)\022-\b\005\020\f\032\bcategory \000(\0000\000B\t\346\213\211\346\235\206\347\256\261R\fvarchar(200)\022\&#39;\b\006\020\f\032\005brand \000(\0000\000B\006RIMOWAR\fvarchar(100)\022G\b\a\020\f\032\004spec \000(\0010\000B\&#39;&amp;#123;\&amp;quot;\351\242\234\350\211\262\&amp;quot;: \&amp;quot;\347\272\242\350\211\262\&amp;quot;, \&amp;quot;\345\260\272\347\240\201\&amp;quot;: \&amp;quot;33\345\257\270\&amp;quot;&amp;#125;R\fvarchar(200)\022\032\b\b\020\004\032\006status \000(\0000\000B\0011R\003int\0226\b\t\020]\032\vcreate_time \000(\0000\000B\0232019-05-01 00:00:00R\bdatetime\0226\b\n\020]\032\vupdate_time \000(\0000\000B\0232019-05-01 00:00:00R\bdatetime&amp;quot;
],raw=false,rawEntries=[]]
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æˆ‘ä»¬å†å»è®¿é—®å•†å“æ•°æ®çš„å±•ç¤ºé¡µé¢æŸ¥çœ‹æ•°æ®æ˜¯å¦è¢«ä¿®æ”¹äº†&lt;/p&gt;
&lt;p&gt;è®¿é—® uriï¼š&lt;a href=&#34;http://localhost/item.html?id=10001#index&#34;&gt;http://localhost/item.html?id=10001#index&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°è¿™ä¸ªé¡µé¢çš„æ•°æ®ä¹Ÿè¢«ä¿®æ”¹äº†è¯´æ˜ç¼“å­˜åŒæ­¥æˆåŠŸäº†&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310211504526.png&#34; alt=&#34;image-20231021150447258&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;å…«-æ€»ç»“å¤šçº§ç¼“å­˜æ¶æ„&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#å…«-æ€»ç»“å¤šçº§ç¼“å­˜æ¶æ„&#34;&gt;#&lt;/a&gt; å…«ã€æ€»ç»“å¤šçº§ç¼“å­˜æ¶æ„ğŸ„&lt;/h1&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310211510207.png&#34; alt=&#34;image-20231021151019996&#34;&gt;&lt;/p&gt;
&lt;p&gt;æœ‰ä¸€ä¸ªé¡µé¢å« item.html æ”¾åˆ°äº† windows çš„ nginx æœåŠ¡å™¨ä¸Šã€‚å®ƒçš„ ä¸»è¦ä½œç”¨å°±æ˜¯ä¸€ä¸ªé™æ€èµ„æºæœåŠ¡å™¨å’Œåå‘ä»£ç†æœåŠ¡å™¨ã€‚å½“ç”¨æˆ·é€šè¿‡æµè§ˆå™¨æ¥è¯·æ±‚å®ƒæ—¶å®ƒå°±å¯ä»¥æŠŠé¡µé¢è¿”å›ç»™ç”¨æˆ·è€Œæµè§ˆå™¨åœ¨æ¸²æŸ“æ—¶å‘ç°ç¼ºå°‘æ•°æ®å°±ä¼šå‘é€ ajax è¯·æ±‚æ¥æŸ¥è¯¢æ•°æ®ã€‚æŸ¥è¯¢åœ°å€å°±æ˜¯ item/10001 è¿™æ—¶çš„ nginx åå‘ä»£ç†æœåŠ¡å™¨ä¸å›å»å¤„ç†ä¸šåŠ¡ï¼Œåªæ˜¯åšåå‘ä»£ç†ï¼Œæ‰€ä»¥å®ƒä¼šæŠŠè¯·æ±‚ä»£ç†ç»™ OPenResty é›†ç¾¤ï¼Œæƒ³è¦å»æŸ¥è¯¢æ•°æ®åˆæœ‰å…ˆå»æœ¬åœ°å¦‚æœæœ‰åˆ™ç›´æ¥è¿”å›ï¼Œæœ¬åœ°å…±äº«è¯å…¸æ•°æ®åªèƒ½åœ¨å½“å‰ nginx ä¸­ä½¿ç”¨ã€‚å¦‚æœæˆ‘ä»¬éƒ¨ç½²æˆ OPenResty é›†ç¾¤å®ƒä»¬ä¹‹é—´çš„å†…å­˜æ˜¯ä¸å…±äº«çš„ï¼Œæ‰€ä»¥è¿™é‡Œä¹Ÿå¯ä»¥é‡‡ç”¨é€šè¿‡ id è®¡ç®— hash æ¥è·¯ç”±æŒ‡å®šé›†ç¾¤æœåŠ¡å™¨çš„æ–¹å¼è¿™æ ·å°±ä¼šä¿è¯ OPenResty ç¼“å­˜ä¸€ç›´ç”Ÿæ•ˆã€‚æœ¬åœ°ç¼“å­˜å¦‚æœæœªå‘½ä¸­åˆ™å»æŸ¥è¯¢ redis ç¼“å­˜ï¼Œå‘½ä¸­åˆ™è¿”å›ï¼Œæœªå‘½ä¸­åˆ™æŸ¥è¯¢ tomcatã€‚æŸ¥è¯¢ tomcat ä¹Ÿæ˜¯é›†ç¾¤ä¹Ÿåšäº† jvm è¿›ç¨‹ç¼“å­˜ï¼Œtomcat æœåŠ¡å™¨ä¹‹é—´æ˜¯ä¸å…±äº«å†…å­˜çš„æ‰€ä»¥è¿˜éœ€è¦ä½¿ç”¨é€šè¿‡ id è®¡ç®— hash å€¼çš„æ–¹å¼æ¥è·¯ç”±æŒ‡å®š tomcat æœåŠ¡å™¨&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆå¤šçº§ç¼“å­˜å®Œæˆåå°±ä¼šé¢ä¸´ä¸€ä¸ªé—®é¢˜å°±æ˜¯æ•°æ®åŒæ­¥çš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;mysql çš„æ•°æ®è¿›è¡Œäº†ä¿®æ”¹ redis å’Œ tomcat è¿›ç¨‹ç¼“å­˜å’Œ nginx ç¼“å­˜éƒ½éœ€è¦åšåŒæ­¥&lt;/p&gt;
&lt;p&gt;åœ¨ OPenResty ä¸­ä½¿ç”¨çš„è¶…æ—¶åŒæ­¥ï¼Œè®¾ç½®è¿‡æœŸæ—¶é—´è¿‡æœŸè‡ªåŠ¨åˆ é™¤å°±å˜æˆæ–°æ•°æ®äº†ï¼Œè¿™ç§æ–¹å¼é€‚åˆäºæ›´æ–°é¢‘ç‡è¾ƒä½çš„æ•°æ®&lt;/p&gt;
&lt;p&gt;è€Œ redis ä¸ mysql ä¹‹é—´çš„æ•°æ®åŒæ­¥é‡‡ç”¨äº† canal ç›‘å¬ mysql çš„æ–¹å¼&lt;/p&gt;
&lt;h1 id=&#34;ä¹-æœåŠ¡å¼‚æ­¥é€šè®¯&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä¹-æœåŠ¡å¼‚æ­¥é€šè®¯&#34;&gt;#&lt;/a&gt; ä¹ã€æœåŠ¡å¼‚æ­¥é€šè®¯ğŸ„&lt;/h1&gt;
&lt;p&gt;é«˜çº§ç¯‡ - rabbitmq çš„é«˜çº§ç‰¹æ€§&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å·²ç»å­¦ä¹ è¿‡å®ƒçš„åŸºæœ¬ç”¨æ³•äº†ï¼Œå­¦ä¹ äº†å¦‚ä½•åˆ©ç”¨ springamqp æ”¶å’Œå‘æ¶ˆæ¯ï¼Œä½†æ˜¯æ”¶å’Œå‘æ¶ˆæ¯åªæ˜¯ mq çš„æœ€åŸºæœ¬çš„åŠŸèƒ½ã€‚å› ä¸ºåœ¨æ”¶å’Œå‘æ¶ˆæ¯çš„è¿‡ç¨‹å½“ä¸­è¿˜æœ‰å¾ˆå¤šé—®é¢˜éœ€è¦æ€è€ƒéœ€è¦å»è§£å†³è¿™æ—¶å°±éœ€è¦ä½¿ç”¨ mq çš„é«˜çº§ç‰¹æ€§å»è§£å†³äº†&lt;/p&gt;
&lt;p&gt;MQ çš„ä¸€äº›å¸¸è§é—®é¢˜&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310211532979.png&#34; alt=&#34;image-20231021153238893&#34;&gt;&lt;/p&gt;
&lt;p&gt;å­¦ä¹ å†…å®¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ¶ˆæ¯å¯é æ€§&lt;/li&gt;
&lt;li&gt;æ­»ä¿¡äº¤æ¢æœº&lt;/li&gt;
&lt;li&gt;æƒ°æ€§é˜Ÿåˆ—&lt;/li&gt;
&lt;li&gt;MQ é›†ç¾¤&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;91-æ¶ˆæ¯å¯é æ€§é—®é¢˜&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#91-æ¶ˆæ¯å¯é æ€§é—®é¢˜&#34;&gt;#&lt;/a&gt; 9.1ã€æ¶ˆæ¯å¯é æ€§é—®é¢˜ğŸŒ³&lt;/h2&gt;
&lt;p&gt;æ¶ˆæ¯ä»ç”Ÿäº§è€…å‘é€åˆ° exchangeï¼Œå†åˆ° queueï¼Œå†åˆ°æ¶ˆè´¹è€…ï¼Œæœ‰å“ªäº›å¯¼è‡´æ¶ˆæ¯ä¸¢å¤±çš„å¯èƒ½æ€§ï¼Ÿ&lt;/p&gt;
&lt;p&gt;å…ˆæ¥æ¸©ä¹ ä¸€ä¸‹ mq çš„æ•´ä¸ªæµç¨‹&lt;/p&gt;
&lt;p&gt;æ¶ˆæ¯çš„å‘é€è€…ç§°ä¸º publisherï¼Œå®ƒæŠŠæ¶ˆæ¯æŠ•é€’ç»™äº¤æ¢æœº exchangeï¼Œè€Œäº¤æ¢æœºä¼šæ ¹æ® routingkey å°†æ¶ˆæ¯è·¯ç”±åˆ°é˜Ÿåˆ— queue ä¸­ï¼Œè€Œé˜Ÿåˆ—å†æŠŠæ¶ˆæ¯æŠ•é€’ç»™æ¶ˆè´¹è€… consumer&lt;/p&gt;
&lt;p&gt;åœ¨æ•´ä¸ªè¿™æ ·çš„æµç¨‹å½“ä¸­æ¶ˆæ¯å¯èƒ½ä¼šå‘ç”Ÿä¸¢å¤±&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å‘é€æ—¶ä¸¢å¤±ï¼š
&lt;ul&gt;
&lt;li&gt;ç”Ÿäº§è€…å‘é€çš„æ¶ˆæ¯æœªé€è¾¾ exchange&lt;/li&gt;
&lt;li&gt;æ¶ˆæ¯åˆ°è¾¾ exchange åæœªè¾¾åˆ° queue&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;MQ å®•æœºï¼Œqueue å°†æ¶ˆæ¯ä¸¢å¤±&lt;/li&gt;
&lt;li&gt;consumer æ¥æ”¶åˆ°æ¶ˆæ¯åæœªæ¶ˆæ¯å°±å®•æœº&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310211536652.png&#34; alt=&#34;image-20231021153606449&#34;&gt;&lt;/p&gt;
&lt;p&gt;é’ˆå¯¹ä¸Šè¿°é—®é¢˜æˆ‘ä»¬æ¥å­¦ä¹ å¦‚ä¸‹å†…å®¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç”Ÿäº§è€…æ¶ˆæ¯ç¡®è®¤&lt;/li&gt;
&lt;li&gt;æ¶ˆæ¯æŒä¹…åŒ–&lt;/li&gt;
&lt;li&gt;æ¶ˆè´¹è€…æ¶ˆæ¯ç¡®è®¤&lt;/li&gt;
&lt;li&gt;æ¶ˆè´¹å¤±è´¥é‡è¯•æœºåˆ¶&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;911-ç”Ÿäº§è€…ç¡®è®¤æœºåˆ¶&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#911-ç”Ÿäº§è€…ç¡®è®¤æœºåˆ¶&#34;&gt;#&lt;/a&gt; 9.1.1ã€ç”Ÿäº§è€…ç¡®è®¤æœºåˆ¶ğŸŒ²&lt;/h3&gt;
&lt;p&gt;RabbitMQ æä¾›äº† publisher confirm æœºåˆ¶æ¥é¿å…æ¶ˆæ¯å‘é€åˆ° MQ è¿‡ç¨‹ä¸­ä¸¢å¤±ã€‚æ¶ˆæ¯å‘é€åˆ° MQ ä»¥åï¼Œä¼šè¿”å›ä¸€ä¸ªç»“æœç»™å‘é€è€…ï¼Œè¡¨ç¤ºæ¶ˆæ¯æ˜¯å¦å¤„ç†æˆåŠŸã€‚ç»“æœæœ‰ä¸¤ç§è¯·æ±‚ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;publisher-confirmï¼Œå‘é€è€…ç¡®è®¤
&lt;ul&gt;
&lt;li&gt;æ¶ˆæ¯æˆåŠŸæŠ•é€’åˆ°äº¤æ¢æœºï¼Œè¿”å› ack&lt;/li&gt;
&lt;li&gt;æ¶ˆæ¯æœªæŠ•é€’åˆ°äº¤æ¢æœºï¼Œè¿”å› nack&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;publisher-returnï¼Œå‘é€è€…å›æ‰§
&lt;ul&gt;
&lt;li&gt;æ¶ˆæ¯æŠ•é€’åˆ°äº¤æ¢æœºäº†ï¼Œä½†æ˜¯æ²¡æœ‰è·¯ç”±åˆ°é˜Ÿåˆ—ã€‚è¿”å› ACKï¼ŒåŠè·¯ç”±å¤±è´¥åŸå› ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310211546864.png&#34; alt=&#34;image-20231021154614145&#34;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;font color=&#39;red&#39;&gt;æ³¨æ„&lt;/font&gt;ï¼š&lt;/p&gt;
&lt;p&gt;ç¡®è®¤æœºåˆ¶å‘é€æ¶ˆæ¯æ—¶ï¼Œéœ€è¦ç»™æ¯ä¸ªæ¶ˆæ¯è®¾ç½®ä¸€ä¸ªå…¨å±€å”¯ä¸€ idï¼Œä»¥åŒºåˆ†ä¸åŒæ¶ˆæ¯ï¼Œé¿å… ack å†²çª&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¼•å…¥ demo å·¥ç¨‹&lt;/p&gt;
&lt;p&gt;é¦–å…ˆï¼Œéœ€è¦å¼•å…¥é¡¹ç›®ï¼š&lt;a href=&#34;https://gitee.com/doukaixin/typora.git&#34;&gt;https://gitee.com/doukaixin/typora.git&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ‹‰å–åˆ†æ”¯ï¼šmq-advanced-demo ä»£ç æ¼”ç¤º&lt;/p&gt;
&lt;h2 id=&#34;92-springamqpå®ç°ç”Ÿäº§è€…ç¡®è®¤&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#92-springamqpå®ç°ç”Ÿäº§è€…ç¡®è®¤&#34;&gt;#&lt;/a&gt; 9.2ã€SpringAMQP å®ç°ç”Ÿäº§è€…ç¡®è®¤ğŸŒ³&lt;/h2&gt;
&lt;p&gt;1ã€åœ¨ publisher è¿™ä¸ªå¾®æœåŠ¡çš„ applicaiton.yml ä¸­æ·»åŠ é…ç½®ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight yml&#34;&gt;&lt;figcaption data-lang=&#34;YAML&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key atrule&#34;&gt;spring&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token key atrule&#34;&gt;rabbitmq&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;host&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; 192.168.249.128 &lt;span class=&#34;token comment&#34;&gt;# rabbitMQ çš„ ip åœ°å€&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;5672&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# ç«¯å£&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;username&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; itcast&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;password&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;123321&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;virtual-host&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; /&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;#------------------------------------&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;publisher-confirm-type&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; correlated&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;publisher-returns&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;token boolean important&#34;&gt;true&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;template&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;mandatory&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;token boolean important&#34;&gt;true&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;é…ç½®è¯´æ˜ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;publishe-confirm-typeï¼šå¼€å¯ publisher-confirmï¼Œè¿™é‡Œæ”¯æŒä¸¤ç§ç±»å‹ï¼š
&lt;ul&gt;
&lt;li&gt;simpleï¼šåŒæ­¥ç­‰å¾… confirm ç»“æœï¼Œç›´åˆ°è¶…æ—¶&lt;/li&gt;
&lt;li&gt;correlatedï¼šå¼‚æ­¥å›è°ƒï¼Œå®šä¹‰ ConfirmCallbackï¼ŒMQ è¿”å›ç»“æœæ—¶ä¼šå›è°ƒè¿™ä¸ª ConfirmCallback&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;publish-returnsï¼šå¼€å¯ publish-return åŠŸèƒ½ï¼ŒåŒæ ·æ˜¯åŸºäº callback æœºåˆ¶ï¼Œä¸è¿‡æ˜¯å®šä¹‰ ReturnCallback&lt;/li&gt;
&lt;li&gt;template.mandatoryï¼šå®šä¹‰æ¶ˆæ¯è·¯ç”±å¤±è´¥æ—¶çš„ç­–ç•¥ã€‚trueï¼Œåˆ™è°ƒç”¨ ReturnCallback; falseï¼šåˆ™ç›´æ¥ä¸¢å¼ƒæ¶ˆæ¯&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;2ã€æ¯ä¸ª RabbitTemplate åªèƒ½é…ç½®ä¸€ä¸ª ReturnCallbackï¼Œå› æ­¤éœ€è¦åœ¨é¡¹ç›®å¯åŠ¨è¿‡ç¨‹ä¸­é…ç½®ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@Slf4j&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@Configuration&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;//                         å®ç° Spring å·¥å‚çš„é€šçŸ¥&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;CommonConfig&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;implements&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;ApplicationContextAware&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;// é‡å†™ Bean å·¥å‚å‡†å¤‡å¥½åè°ƒç”¨çš„å‡½æ•°&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@Override&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;setApplicationContext&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;ApplicationContext&lt;/span&gt; applicationContext&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;throws&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;BeansException&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// å–å‡º RabbitTempalte çš„ Bean&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token class-name&#34;&gt;RabbitTemplate&lt;/span&gt; rabbitTemplate &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; applicationContext&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;getBean&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;RabbitTemplate&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// é…ç½® ReturnCallback&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        rabbitTemplate&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;setReturnCallback&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;message&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; i&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; s&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; s1&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; s2&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;-&gt;&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token comment&#34;&gt;// è®°å½•æ—¥å¿— &amp;#123;&amp;#125; ä¸ºå ä½ç¬¦&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            log&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;error&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;æ¶ˆæ¯å‘é€åˆ°é˜Ÿåˆ—å¤±è´¥ï¼Œå“åº”ç ï¼š&amp;#123;&amp;#125;ï¼Œå¤±è´¥åŸå› ï¼š&amp;#123;&amp;#125;ï¼Œ&#34;&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                    &lt;span class=&#34;token string&#34;&gt;&#34;äº¤æ¢æœºï¼š&amp;#123;&amp;#125;ï¼Œè·¯ç”±keyï¼š&amp;#123;&amp;#125;ï¼Œæ¶ˆæ¯ï¼š&amp;#123;&amp;#125;&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                    i&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; s&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; s1&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; s2&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; message&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;toString&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token comment&#34;&gt;// å¦‚æœæœ‰éœ€è¦çš„è¯ï¼Œé‡å‘æ¶ˆæ¯&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;returncallback æ˜¯ exchange è·¯ç”±ä¸åˆ° queue æ—¶ï¼Œæ‰è§¦å‘çš„å›è°ƒ&lt;/p&gt;
&lt;p&gt;confirmcallback æ˜¯åœ¨æ¶ˆæ¯è¾¾ä¸åˆ°äº¤æ¢æœºæ—¶ï¼Œæ‰å›è°ƒ&lt;/p&gt;
&lt;p&gt;3ã€å‘é€æ¶ˆæ¯ï¼ŒæŒ‡å®šæ¶ˆæ¯ IDï¼Œæ¶ˆæ¯ ConfirmCallback&lt;/p&gt;
&lt;p&gt;å…ˆä½¿ç”¨ test ä»£ç è¿›è¡Œä¸€ä¸‹æµ‹è¯•&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310211718275.png&#34; alt=&#34;image-20231021171827222&#34;&gt;&lt;/p&gt;
&lt;p&gt;å‘é€æ¶ˆæ¯çš„ä»£ç ä¸­ï¼Œæœ‰ äº¤æ¢æœºï¼Œä½†æ˜¯ Routingkey ä¸å­˜åœ¨ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å»åˆ›å»ºä¸€ä¸‹&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310211719943.png&#34; alt=&#34;image-20231021171807188&#34;&gt;&lt;/p&gt;
&lt;p&gt;ç‚¹å‡» bind&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310211719018.png&#34; alt=&#34;image-20231021171942977&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ï¼åœ¨å‘é€æ¶ˆæ¯çš„æµ‹è¯•ä»£ç ä¸­ä»¥å‰æ˜¯é‚£æ ·å†™çš„ï¼Œä½†æ˜¯ç°åœ¨è¦åšæ¶ˆæ¯ç¡®è®¤æœºåˆ¶æ‰€ä»¥å°±è¦å¤šä¼ é€’ä¸€ä¸ªå‚æ•°äº†&lt;/p&gt;
&lt;p&gt;æµ‹è¯•ä»£ç ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@Slf4j&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@RunWith&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;SpringRunner&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@SpringBootTest&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;SpringAmqpTest&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@Autowired&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;RabbitTemplate&lt;/span&gt; rabbitTemplate&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@Test&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;testSendMessage2SimpleQueue&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;throws&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;InterruptedException&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token class-name&#34;&gt;String&lt;/span&gt; routingKey &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;simple.test&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// 1. å‡†å¤‡æ¶ˆæ¯&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token class-name&#34;&gt;String&lt;/span&gt; message &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;hello, spring amqp!&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// 1.1. å‡†å¤‡ CorrelationData&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// 1.2. æ¶ˆæ¯ ID&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token class-name&#34;&gt;CorrelationData&lt;/span&gt; correlationData &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;CorrelationData&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token constant&#34;&gt;UUID&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;randomUUID&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;toString&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// 1.3. å‡†å¤‡ ConfirmCallback&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// æˆåŠŸçš„å›è°ƒå‡½æ•°&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        correlationData&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;getFuture&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;addCallback&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;confirm &lt;span class=&#34;token operator&#34;&gt;-&gt;&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token comment&#34;&gt;// åˆ¤æ–­ç»“æœ&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;confirm&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;isAck&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;21&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;22&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token comment&#34;&gt;// ACK&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;23&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                log&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;debug&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;æ¶ˆæ¯æˆåŠŸæŠ•é€’åˆ°äº¤æ¢æœº ï¼æ¶ˆæ¯ID: &amp;#123;&amp;#125;&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; correlationData&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;getId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;24&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;else&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;25&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;26&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token comment&#34;&gt;// NACK&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;27&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                log&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;error&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;æ¶ˆæ¯æŠ•é€’åˆ°äº¤æ¢æœºå¤±è´¥äº† ï¼ æ¶ˆæ¯ID: &amp;#123;&amp;#125;&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; correlationData&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;getId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;28&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token comment&#34;&gt;// é‡å‘æ¶ˆæ¯&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;29&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;30&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token comment&#34;&gt;// å¤±è´¥çš„å›è°ƒå‡½æ•°&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;31&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; throwable &lt;span class=&#34;token operator&#34;&gt;-&gt;&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;32&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token comment&#34;&gt;// è®°å½•æ—¥å¿—&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;33&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            log&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;error&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;æ¶ˆæ¯å‘é€å¤±è´¥ ! &#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; throwable&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;34&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token comment&#34;&gt;// é‡å‘æ¶ˆæ¯&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;35&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;36&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// 2. å‘é€æ¶ˆæ¯&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;37&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        rabbitTemplate&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;convertAndSend&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;amq.topic&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; routingKey&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; message&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;correlationData &lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;38&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;39&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;è¿è¡Œè¿™ä¸ªæµ‹è¯•ä»£ç &lt;/p&gt;
&lt;p&gt;idea æ§åˆ¶å°æ‰“å°ä¿¡æ¯å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;æ¶ˆæ¯æˆåŠŸæŠ•é€’åˆ°äº¤æ¢æœº ï¼æ¶ˆæ¯ID: a4abf2f4-85f5-4fdc-bb73-7be9ab91b6bd
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æŸ¥çœ‹æ¶ˆæ¯é˜Ÿåˆ—æ˜¯å¦æ¥å—åˆ°äº†ä¸€ä¸ªæ¶ˆæ¯å¹¶æŸ¥çœ‹å†…å®¹&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310211737447.png&#34; alt=&#34;image-20231021173713091&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310211737796.png&#34; alt=&#34;image-20231021173730615&#34;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;æ€»ç»“&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;SpringAMQP ä¸­å¤„ç†æ¶ˆæ¯ç¡®è®¤çš„å‡ ç§æƒ…å†µï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;publisher-confirm
&lt;ul&gt;
&lt;li&gt;æ¶ˆæ¯æˆåŠŸå‘é€åˆ° exchangeï¼Œè¿”å› ack&lt;/li&gt;
&lt;li&gt;æ¶ˆæ¯å‘é€å¤±è´¥ï¼Œæ²¡æœ‰åˆ°è¾¾äº¤æ¢æœºï¼Œè¿”å› nack&lt;/li&gt;
&lt;li&gt;æ¶ˆæ¯å‘é€è¿‡ç¨‹ä¸­å‡ºç°å¼‚å¸¸ï¼Œæ²¡æœ‰æ”¶åˆ°å›æ‰§&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ¶ˆæ¯æˆåŠŸå‘é€åˆ° exchangeï¼Œä½†æ²¡æœ‰è·¯ç”±åˆ° queue
&lt;ul&gt;
&lt;li&gt;è°ƒç”¨ ReturnCallback&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä»¥ä¸Šå°±æ˜¯ç”Ÿäº§ç¡®è®¤çš„æœºåˆ¶äº†ã€‚é€šè¿‡è¿™äº›æœºåˆ¶å°±èƒ½å¤Ÿç¡®è®¤æ¶ˆæ¯ èƒ½å¤Ÿåˆ°è¾¾æ¶ˆæ¯é˜Ÿåˆ—&lt;/p&gt;
&lt;h2 id=&#34;93-æ¶ˆæ¯æŒä¹…åŒ–&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#93-æ¶ˆæ¯æŒä¹…åŒ–&#34;&gt;#&lt;/a&gt; 9.3ã€æ¶ˆæ¯æŒä¹…åŒ–ğŸŒ³&lt;/h2&gt;
&lt;p&gt;ç”±äº RabbitMQ é»˜è®¤æ˜¯å†…å­˜å­˜å‚¨ï¼Œå¦‚æœæ­¤æ—¶ mq å‘ç”Ÿäº†å®•æœºï¼Œæ¶ˆæ¯ä¹Ÿæ˜¯æœ‰å¯èƒ½ä¸¢å¤±çš„ã€‚è¦æƒ³è®©æ¶ˆæ¯çœŸæ­£å®‰å…¨ï¼Œæˆ‘ä»¬å¿…é¡»ç¡®ä¿è¿™ä¸ªæ¶ˆæ¯èƒ½å¤Ÿåšåˆ°æŒä¹…åŒ–ã€‚ä¹Ÿå°±æ˜¯æŠŠå®ƒå†™å…¥åˆ°ç£ç›˜ä¸­&lt;/p&gt;
&lt;p&gt;åœ¨æ¶ˆè´¹è€…çš„ config ç±»ä¸­è¿›è¡Œé…ç½®&lt;/p&gt;
&lt;p&gt;1ã€äº¤æ¢æœºæŒä¹…åŒ–ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@Bean&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;DirectExchange&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;simpleExchange&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;// ä¸‰ä¸ªå‚æ•°ï¼šäº¤æ¢æœºåç§°ï¼Œæ˜¯å¦æŒä¹…åŒ–ï¼Œå½“æ²¡æœ‰ queue ä¸å…¶ç»‘å®šæ—¶æ˜¯å¦è‡ªåŠ¨åˆ é™¤&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;DirectExchange&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;simple.direct&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token boolean&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token boolean&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;2ã€é˜Ÿåˆ—æŒä¹…åŒ–&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@Bean&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Queue&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;simpleQueue&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;// ä½¿ç”¨ QueueBuilder æ„å»ºé˜Ÿåˆ—ï¼Œdurable å°±æ˜¯æŒä¹…åŒ–çš„&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;QueueBuilder&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;durable&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;simple.queue&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;build&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;å¯åŠ¨æœåŠ¡è¿›è¡Œæµ‹è¯•ï¼Œç»“æœå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;é˜Ÿåˆ—&lt;/p&gt;
&lt;p&gt;å…¶ä¸­çš„ D å°±æ˜¯ durable å°±æ˜¯æŒä¹…åŒ–çš„æ„æ€&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310211756121.png&#34; alt=&#34;image-20231021175655932&#34;&gt;&lt;/p&gt;
&lt;p&gt;äº¤æ¢æœº&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310211759449.png&#34; alt=&#34;image-20231021175939976&#34;&gt;&lt;/p&gt;
&lt;p&gt;å…³é—­æ‰€æœ‰æœåŠ¡å™¨&lt;/p&gt;
&lt;p&gt;å‘é€ä¸€ä¸‹æ¶ˆæ¯è¿›è¡Œæµ‹è¯•ä¸€ä¸‹æ¶ˆæ¯æ˜¯å¦ä¹Ÿèƒ½æŒä¹…åŒ–&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å‘ simple.queue ä¸­å‘é€ä¸€æ¡æ¶ˆæ¯&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310211831349.png&#34; alt=&#34;image-20231021183122204&#34;&gt;&lt;/p&gt;
&lt;p&gt;æ­¤æ—¶é˜Ÿåˆ—ä¸­å°±ä¼šå­˜ç•™ä¸€æ¡æ¶ˆæ¯&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310211833155.png&#34; alt=&#34;image-20231021183339726&#34;&gt;&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆç°åœ¨æˆ‘ä»¬é˜Ÿåˆ—é‡Œé¢æœ‰æ¶ˆæ¯äº†ï¼Œå¹¶ä¸”é˜Ÿåˆ—å·²ç»æŒä¹…åŒ–äº†ï¼Œæˆ‘ä»¬å†å»é‡å¯ mq æ¥æµ‹è¯•ä¸€ä¸‹&lt;/p&gt;
&lt;figure class=&#34;highlight sh&#34;&gt;&lt;figcaption data-lang=&#34;sh&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;root@localhost nginx&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token comment&#34;&gt;# docker restart mq&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;mq&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;root@localhost nginx&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token comment&#34;&gt;#&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;å›åˆ°é¡µé¢ä¸­è¿›è¡ŒæŸ¥çœ‹&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°æ¶ˆæ¯ æ²¡äº†ï¼&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310211835842.png&#34; alt=&#34;image-20231021183522398&#34;&gt;&lt;/p&gt;
&lt;p&gt;è¿™å°±è¯æ˜æ¶ˆæ¯æ²¡æœ‰æŒä¹…åŒ–ï¼Œé‚£æˆ‘ä»¬çš„ç›®çš„æ˜¯è®©æ¶ˆæ¯ä¹Ÿèƒ½æŒä¹…å•Šï¼Œé‚£æ€ä¹ˆåŠï¼Ÿ&lt;/p&gt;
&lt;p&gt;3ã€æ¶ˆæ¯æŒä¹…åŒ–ï¼ŒSpringAMQP ä¸­çš„æ¶ˆæ¯é»˜è®¤æ˜¯æŒä¹…çš„ï¼Œå¯ä»¥é€šè¿‡ MessageProperties ä¸­çš„ DeliveryMode æ¥æŒ‡å®šï¼š&lt;/p&gt;
&lt;p&gt;åœ¨æµ‹è¯•ä»£ç ä¸­è¿›è¡Œç¼–å†™ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@Test&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;testDurableMessage&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;// 1. å‡†å¤‡æ¶ˆæ¯&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token class-name&#34;&gt;Message&lt;/span&gt; message &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;MessageBuilder&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;withBody&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;hello, spring&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                                             &lt;span class=&#34;token function&#34;&gt;getBytes&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;StandardCharsets&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token constant&#34;&gt;UTF_8&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;// æ¶ˆæ¯ä½“&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;setDeliveryMode&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;MessageDeliveryMode&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token constant&#34;&gt;PERSISTENT&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;// æŒä¹…åŒ–&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;build&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;// 2. å‘é€æ¶ˆæ¯&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   rabbitTemplate&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;convertAndSend&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;simple.queue&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; message&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;å¯åŠ¨æˆåŠŸåæŸ¥çœ‹é˜Ÿåˆ—æƒ…å†µï¼š&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°é˜Ÿåˆ—ä¸­å°±æœ‰äº†ä¸€æ¡æ¶ˆæ¯äº†&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310211842026.png&#34; alt=&#34;image-20231021184255870&#34;&gt;&lt;/p&gt;
&lt;p&gt;åœ¨é˜Ÿåˆ—çš„è¯¦æƒ…é¡µé¢é‡Œé¢çš„ get message ä¸­å¯ä»¥çœ‹åˆ° delivery_modeï¼š2 è¡¨ç¤ºæ¶ˆæ¯æŒä¹…åŒ–&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310211844251.png&#34; alt=&#34;image-20231021184420061&#34;&gt;&lt;/p&gt;
&lt;p&gt;é‡å¯ mq æµ‹è¯•æ¶ˆæ¯æ˜¯å¦çœŸçš„å°±æ˜¯æŒä¹…åŒ–äº†ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight sh&#34;&gt;&lt;figcaption data-lang=&#34;sh&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;root@localhost nginx&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token comment&#34;&gt;# docker restart mq&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;mq&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;root@localhost nginx&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token comment&#34;&gt;#&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;è®¿é—® mq é˜Ÿé‡Œæƒ…å†µï¼š&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°è¿™æ¡æ¶ˆæ¯è¿˜å­˜åœ¨ç€&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310211845144.png&#34; alt=&#34;image-20231021184553048&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;94-æ¶ˆè´¹è€…ç¡®è®¤&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#94-æ¶ˆè´¹è€…ç¡®è®¤&#34;&gt;#&lt;/a&gt; 9.4ã€æ¶ˆè´¹è€…ç¡®è®¤ğŸŒ³&lt;/h2&gt;
&lt;p&gt;RabbitMQ æ”¯æŒæ¶ˆè´¹è€…ç¡®è®¤æœºåˆ¶ï¼Œå³ï¼šæ¶ˆè´¹è€…å¤„ç†æ¶ˆæ¯åå¯ä»¥å‘ MQ å‘é€ ack å›æ‰§ï¼ŒMQ æ”¶åˆ° ack å›æ‰§åæ‰ä¼šåˆ é™¤æ¶ˆæ¯ã€‚è€Œ SpringAMQP åˆ™å…è®¸é…ç½®ä¸‰ç§ç¡®è®¤æ¨¡å¼ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;manualï¼šæ‰‹åŠ¨ ackï¼Œéœ€è¦åœ¨ä¸šåŠ¡ä»£ç ç»“æŸåï¼Œè°ƒç”¨ api å‘é€ ack&lt;/li&gt;
&lt;li&gt;autoï¼šè‡ªåŠ¨ ackï¼Œç”± Spring æ£€æµ‹ listener ä»£ç æ˜¯å¦å‡ºç°å¼‚å¸¸ï¼Œæ²¡æœ‰å¼‚å¸¸åˆ™è¿”å› ackï¼›æŠ›å‡ºå¼‚å¸¸åˆ™è¿”å› nack&lt;/li&gt;
&lt;li&gt;noneï¼šå…³é—­ ackï¼ŒMQ å‡å®šæ¶ˆè´¹è€…è·å–æ¶ˆæ¯åä¼šæˆåŠŸå¤„ç†ï¼Œå› æ­¤æ¶ˆæ¯æŠ•é€’åç«‹å³è¢«åˆ é™¤&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é…ç½®æ–¹å¼æ˜¯ä¿®æ”¹ application.yml æ–‡ä»¶ï¼Œæ·»åŠ ä¸‹é¢é…ç½®ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight yml&#34;&gt;&lt;figcaption data-lang=&#34;YAML&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key atrule&#34;&gt;spring&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token key atrule&#34;&gt;rabbitmq&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;host&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; 192.168.249.128 &lt;span class=&#34;token comment&#34;&gt;# rabbitMQ çš„ ip åœ°å€&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;5672&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# ç«¯å£&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;username&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; itcast&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;password&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;123321&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;virtual-host&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; /&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;listener&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;simple&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token key atrule&#34;&gt;prefetch&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token key atrule&#34;&gt;acknowledge-mode&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; auto &lt;span class=&#34;token comment&#34;&gt;# è‡ªåŠ¨ ack&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;å…ˆçœ‹ä¸‹ mq çš„é˜Ÿåˆ—æƒ…å†µ&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310212025971.png&#34; alt=&#34;image-20231021202521333&#34;&gt;&lt;/p&gt;
&lt;p&gt;é˜Ÿåˆ—ä¸­æœ‰ä¸€æ¡æ¶ˆæ¯&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬åœ¨ consumer çš„æ¶ˆè´¹ä»£ç ç¼–å†™ä¸€ä¸ªå¼‚å¸¸&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@Slf4j&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@Component&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;SpringRabbitListener&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@RabbitListener&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;queues &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;simple.queue&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;listenSimpleQueue&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;String&lt;/span&gt; msg&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt;        &lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;out&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;æ¶ˆè´¹è€…æ¥æ”¶åˆ°simple.queueçš„æ¶ˆæ¯ï¼šã€&#34;&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; msg &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;ã€‘&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;out&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        log&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;info&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;æ¶ˆè´¹è€…å¤„ç†æ¶ˆæ¯æˆåŠŸ ï¼&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;é…ç½®å®Œæˆåå¯åŠ¨ consumer æœåŠ¡è¿›è¡Œæµ‹è¯•&lt;/p&gt;
&lt;p&gt;æ­¤æ—¶ç¨‹åºèµ°åˆ° debug å¤„ï¼Œæ²¡æœ‰æ‰§è¡Œå®Œæ¯•æˆ‘ä»¬çœ‹ä¸‹ç°åœ¨çš„é˜Ÿåˆ—æƒ…å†µ&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°å®ƒæ²¡æœ‰åˆ é™¤è¿™æ¡æ¶ˆæ¯è€Œæ˜¯æ ‡è®°ä¸ºäº† Unacked&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310212027453.png&#34; alt=&#34;image-20231021202727506&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœç¨‹åºä¸è¿›è¡Œä¸€ç›´ç­‰å¾…åˆ™ä¼šå˜å›åŸæ¥çš„çŠ¶æ€&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310212029138.png&#34; alt=&#34;image-20231021202909987&#34;&gt;&lt;/p&gt;
&lt;p&gt;java ä»£ç ç¨‹åºå¾€ä¸‹èµ°å°±ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œä½†æ˜¯å®ƒä¼šè¿›è¡Œé‡æ–°æŠ•é€’&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310212048599.gif&#34; alt=&#34;test&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯æˆ‘ä»¬å¹¶ä¸å¸Œæœ›å®ƒå°±è¿™æ ·å¤±è´¥äº†å°±æ— è„‘é‡è¯•é‚£æ€ä¹ˆåŠå‘¢ï¼Ÿçœ‹ä¸‹é¢çš„å†…å®¹ã€‚&lt;/p&gt;
&lt;h2 id=&#34;95-å¤±è´¥é‡è¯•æœºåˆ¶&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#95-å¤±è´¥é‡è¯•æœºåˆ¶&#34;&gt;#&lt;/a&gt; 9.5ã€å¤±è´¥é‡è¯•æœºåˆ¶ğŸŒ³&lt;/h2&gt;
&lt;p&gt;å½“æ¶ˆè´¹è€…å‡ºç°å¼‚å¸¸åï¼Œæ¶ˆè´¹ä¼šä¸æ–­ requue (é‡æ–°å…¥é˜Ÿ) åˆ°é˜Ÿåˆ—ï¼Œå†é‡æ–°å‘é€ç»™æ¶ˆè´¹è€…ï¼Œç„¶åå†æ¬¡å¼‚å¸¸ï¼Œå†æ¬¡ requeueï¼Œæ— é™å¾ªç¯ï¼Œå¯¼è‡´ mq çš„æ¶ˆæ¯å¤„ç†é£™å‡ï¼Œå¸¦æ¥ä¸å¿…è¦çš„å‹åŠ›ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310212051338.png&#34; alt=&#34;image-20231021205137135&#34;&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ Spring çš„ retry æœºåˆ¶ï¼Œåœ¨æ¶ˆè´¹è€…å‡ºç°å¼‚å¸¸æ—¶åˆ©ç”¨æœ¬åœ°é‡è¯•ï¼Œè€Œä¸æ˜¯æ— é™åˆ¶çš„ requeue åˆ° mq é˜Ÿåˆ—ã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶æœ¬åœ°é‡è¯•ä¹Ÿä¸æ˜¯æ— é™è®©å®ƒä¸€ç›´é‡è¯•&lt;/p&gt;
&lt;p&gt;åœ¨æ¶ˆè´¹è€…æœåŠ¡ä¸­è¿›è¡Œé…ç½®ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight yml&#34;&gt;&lt;figcaption data-lang=&#34;YAML&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token key atrule&#34;&gt;spring&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token key atrule&#34;&gt;rabbitmq&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;host&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; 192.168.249.128 &lt;span class=&#34;token comment&#34;&gt;# rabbitMQ çš„ ip åœ°å€&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;5672&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# ç«¯å£&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;username&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; itcast&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;password&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;123321&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;virtual-host&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; /&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token key atrule&#34;&gt;listener&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token key atrule&#34;&gt;simple&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token key atrule&#34;&gt;prefetch&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token key atrule&#34;&gt;acknowledge-mode&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; auto&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;#------------------------------------------------------&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token key atrule&#34;&gt;retry&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;          &lt;span class=&#34;token key atrule&#34;&gt;enabled&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;token boolean important&#34;&gt;true&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# å¼€å¯æ¶ˆè´¹è€…å¤±è´¥é‡è¯•&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;          &lt;span class=&#34;token key atrule&#34;&gt;initial-interval&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1000&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# åˆå§‹çš„å¤±è´¥ç­‰å¾…æ—¶é•¿ä¸º 1 ç§’&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;          &lt;span class=&#34;token key atrule&#34;&gt;multiplier&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# ä¸‹æ¬¡å¤±è´¥çš„ç­‰å¾…æ—¶é•¿å€æ•°ï¼Œä¸‹æ¬¡ç­‰å¾…æ—¶é•¿ = multiplier *last-interval&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;          &lt;span class=&#34;token key atrule&#34;&gt;max-attempts&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;4&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# æœ€å¤§é‡è¯•æ¬¡æ•°&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;          &lt;span class=&#34;token key atrule&#34;&gt;stateless&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;token boolean important&#34;&gt;true&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# true æ— çŠ¶æ€ï¼›false æœ‰çŠ¶æ€ã€‚å¦‚æœä¸šåŠ¡ä¸­åŒ…å«äº‹åŠ¡ï¼Œè¿™é‡Œæ”¹ä¸º false&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;å¯åŠ¨æ¶ˆè´¹è€…æœåŠ¡åè¿›è¡Œæµ‹è¯• idea æ§åˆ¶å°æ‰“å°å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;æŠ¥äº†ä¸€ä¸ªå¼‚å¸¸ï¼Œè¯´é‡è¯•æ¬¡æ•°è€—å°½äº†&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mqp.rabbit.support.ListenerExecutionFailedException: Retry Policy Exhausted
	at org.springframework.amqp.rabbit.retry.RejectAndDontRequeueRecoverer.recover(RejectAndDontRequeueRecoverer.java:45) ~[spring-rabbit-2.2.15.RELEASE.jar:2.2.15.RELEASE]
	at org.springframework.amqp.rabbit.config.StatelessRetryOperationsInterceptorFactoryBean.lambda$createRecoverer$0(StatelessRetryOperationsInterceptorFactoryBean.java:74) ~[spring-rabbit-2.2.15.RELEASE.jar:2.2.15.RELEASE]
	at org.springframework.retry.interceptor.RetryOperationsInterceptor$ItemRecovererCallback.recover(RetryOperationsInterceptor.java:141) ~[spring-retry-1.2.5.RELEASE.jar:na]
	at org.springframework.retry.support.RetryTemplate.handleRetryExhausted(RetryTemplate.java:512) ~[spring-retry-1.2.5.RELEASE.jar:na]
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿™æ¡æ¶ˆæ¯å°±ä¼šè¢«ä¸¢å¼ƒæ‰&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310220940740.png&#34; alt=&#34;image-20231022094032330&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;951-æ¶ˆè´¹è€…å¤±è´¥æ¶ˆæ¯å¤„ç†ç­–ç•¥&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#951-æ¶ˆè´¹è€…å¤±è´¥æ¶ˆæ¯å¤„ç†ç­–ç•¥&#34;&gt;#&lt;/a&gt; 9.5.1ã€æ¶ˆè´¹è€…å¤±è´¥æ¶ˆæ¯å¤„ç†ç­–ç•¥ğŸŒ²&lt;/h3&gt;
&lt;p&gt;åœ¨å¼€å¯é‡è¯•æ¨¡å¼åï¼Œé‡è¯•æ¬¡æ•°è€—å°½ï¼Œå¦‚æœæ¶ˆæ¯ä¾ç„¶å¤±è´¥ï¼Œåˆ™éœ€è¦æœ‰ MessageRecoverer æ¥å£æ¥å¤„ç†ï¼Œå®ƒåŒ…å«ä¸‰ç§ä¸åŒçš„å®ç°ï¼š&lt;/p&gt;
&lt;p&gt;1ã€RejectAndDontRequeueRecovererï¼šé‡è¯•è€—å°½åï¼Œç›´æ¥ rejectï¼Œä¸¢å¼ƒæ¶ˆæ¯ã€‚é»˜è®¤å°±æ˜¯è¿™ç§æ–¹å¼&lt;/p&gt;
&lt;p&gt;2ã€ImmediateRequeueMessageRecovererï¼šé‡è¯•è€—å°½åï¼Œè¿”å› nackï¼Œæ¶ˆæ¯é‡æ–°å…¥é˜Ÿ&lt;/p&gt;
&lt;p&gt;3ã€RepublishMessageRecovererï¼šé‡è¯•è€—å°½åï¼Œå°†å¤±è´¥æ¶ˆæ¯æŠ•é€’åˆ°æŒ‡å®šçš„äº¤æ¢æœº&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310221014285.png&#34; alt=&#34;image-20231022101421805&#34;&gt;&lt;/p&gt;
&lt;p&gt;æµ‹è¯•ä¸‹ RepublishMessageRcoverer å¤„ç†æ¨¡å¼ï¼š&lt;/p&gt;
&lt;p&gt;1ã€é¦–å…ˆï¼Œå®šä¹‰æ¥æ”¶å¤±è´¥æ¶ˆæ¯çš„äº¤æ¢æœºï¼Œé˜Ÿåˆ—åŠå…¶ç»‘å®šå…³ç³»ï¼š&lt;/p&gt;
&lt;p&gt;2ã€ç„¶åå®šä¹‰ RepublishMessageRecovererï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@Configuration&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;ErrorMessageConfig&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@Bean&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;DirectExchange&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;errorMessageExchange&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;DirectExchange&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;error.direct&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@Bean&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Queue&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;errorQueue&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Queue&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;error.queue&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@Bean&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Binding&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;errorMessageBinding&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;BindingBuilder&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;bind&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;errorQueue&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;to&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;errorMessageExchange&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;with&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;error&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;21&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@Bean&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;22&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;MessageRecoverer&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;republishMessageRecoverer&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;RabbitTemplate&lt;/span&gt; rabbitTemplate&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;23&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;24&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;RepublishMessageRecoverer&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;rabbitTemplate&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;error.direct&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;error&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;25&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;26&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;å¯åŠ¨æ¶ˆè´¹è€…æœåŠ¡æŸ¥çœ‹ mq çš„äº¤æ¢æœºå’Œé˜Ÿåˆ—æƒ…å†µ&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310221027869.png&#34; alt=&#34;image-20231022102732042&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310221027294.png&#34; alt=&#34;image-20231022102744943&#34;&gt;&lt;/p&gt;
&lt;p&gt;å‘é€ä¸€æ¡æ¶ˆæ¯è¿›è¡Œæµ‹è¯•ï¼Œæ‰¾åˆ° simple.queue è¿›è¡Œå‘é€æ¶ˆæ¯&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310221030573.png&#34; alt=&#34;image-20231022103002600&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310221032487.png&#34; alt=&#34;image-20231022103250120&#34;&gt;&lt;/p&gt;
&lt;p&gt;idea æ§åˆ¶å°æ‰“å°æƒ…å†µ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;æ¶ˆè´¹è€…æ¥æ”¶åˆ°simple.queueçš„æ¶ˆæ¯ï¼šã€hello spring !ã€‘
æ¶ˆè´¹è€…æ¥æ”¶åˆ°simple.queueçš„æ¶ˆæ¯ï¼šã€hello spring !ã€‘
æ¶ˆè´¹è€…æ¥æ”¶åˆ°simple.queueçš„æ¶ˆæ¯ï¼šã€hello spring !ã€‘
10:30:18:538  WARN 6996 --- [ntContainer#0-1] o.s.a.r.retry.RepublishMessageRecoverer  : Republishing failed message to exchange &#39;error.direct&#39; with routing key error
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç„¶åå†æŸ¥çœ‹é˜Ÿåˆ—æƒ…å†µ&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310221031933.png&#34; alt=&#34;image-20231022103105401&#34;&gt;&lt;/p&gt;
&lt;p&gt;åœ¨ error.queue é˜Ÿåˆ—çš„è¯¦ç»†æ¶ˆæ¯ä¸­å¯ä»¥çœ‹åˆ°æŠ¥é”™çš„ä¿¡æ¯&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310221032636.png&#34; alt=&#34;image-20231022103202192&#34;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;æ€»ç»“&lt;/strong&gt;:&lt;/p&gt;
&lt;p&gt;å¦‚ä½•ç¡®ä¿ RabbitMQ æ¶ˆæ¯çš„å¯é æ€§ï¼Ÿ&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å¼€å¯ç”Ÿäº§è€…ç¡®è®¤æœºåˆ¶ï¼Œç¡®ä¿ç”Ÿäº§è€…çš„æ¶ˆæ¯èƒ½åˆ°è¾¾é˜Ÿåˆ—&lt;/li&gt;
&lt;li&gt;å¼€å¯æŒä¹…åŒ–åŠŸèƒ½ï¼Œç¡®ä¿æ¶ˆæ¯æœªæ¶ˆè´¹å‰åœ¨é˜Ÿåˆ—ä¸­ä¸ä¼šä¸¢å¤±&lt;/li&gt;
&lt;li&gt;å¼€å¯æ¶ˆè´¹è€…ç¡®è®¤æœºåˆ¶ä¸º autoï¼Œç”± spring ç¡®è®¤æ¶ˆæ¯å¤„ç†æˆåŠŸåå®Œæˆ ack&lt;/li&gt;
&lt;li&gt;å¼€å¯æ¶ˆè´¹è€…å¤±è´¥é‡è¯•æœºåˆ¶ï¼Œå¹¶è®¾ç½® MessageRecovererï¼Œå¤šæ¬¡é‡è¯•å¤±è´¥åå°†æ¶ˆæ¯æŠ•é€’åˆ°å¼‚å¸¸äº¤æ¢æœºï¼Œäº¤ç”±äººå·¥å¤„ç†&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;h1 id=&#34;å-æ­»ä¿¡äº¤æ¢æœº&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#å-æ­»ä¿¡äº¤æ¢æœº&#34;&gt;#&lt;/a&gt; åã€æ­»ä¿¡äº¤æ¢æœºğŸ„&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;åˆè¯†æ­»ä¿¡äº¤æ¢æœº&lt;/li&gt;
&lt;li&gt;TTL&lt;/li&gt;
&lt;li&gt;å»¶è¿Ÿé˜Ÿåˆ—&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;101-åˆè¯†æ­»ä¿¡äº¤æ¢æœº&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#101-åˆè¯†æ­»ä¿¡äº¤æ¢æœº&#34;&gt;#&lt;/a&gt; 10.1ã€åˆè¯†æ­»ä¿¡äº¤æ¢æœºğŸŒ³&lt;/h2&gt;
&lt;p&gt;å½“ä¸€ä¸ªé˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯æ»¡è¶³ä¸‹åˆ—æƒ…å†µä¹‹ä¸€æ—¶ï¼Œå¯ä»¥ç§°ä¸º&lt;font color=&#39;red&#39;&gt;æ­»ä¿¡ (dead letter)&lt;/font&gt;ï¼š&lt;/p&gt;
&lt;p&gt;1ã€æ¶ˆè´¹è€…ä½¿ç”¨ basic.reject æˆ– basic.nack å£°æ˜æ¶ˆè´¹å¤±è´¥ï¼Œå¹¶ä¸”æ¶ˆæ¯çš„ requeue å‚æ•°è®¾ç½®ä¸º false&lt;/p&gt;
&lt;p&gt;2ã€æ¶ˆæ¯æ˜¯ä¸€ä¸ªè¿‡æœŸæ¶ˆæ¯ï¼Œè¶…æ—¶æ— äººæ¶ˆè´¹&lt;/p&gt;
&lt;p&gt;3ã€è¦æŠ•é€’çš„é˜Ÿåˆ—æ¶ˆæ¯å †ç§¯æ»¡äº†ï¼Œæœ€æ—©çš„æ¶ˆæ¯å¯èƒ½æˆä¸ºæ­»ä¿¡&lt;/p&gt;
&lt;p&gt;å¦‚æœè¯¥é˜Ÿåˆ—é…ç½®äº† dead-letter-exchange å±æ€§ï¼ŒæŒ‡å®šäº†ä¸€ä¸ªäº¤æ¢æœºï¼Œé‚£ä¹ˆé˜Ÿåˆ—ä¸­çš„æ­»ä¿¡å°±ä¼šæŠ•é€’åˆ°è¿™ä¸ªäº¤æ¢æœºä¸­ï¼Œè€Œè¿™ä¸ªäº¤æ¢æœºç§°ä¸º&lt;font color=&#39;red&#39;&gt;æ­»ä¿¡äº¤æ¢æœº&lt;/font&gt;. (Dead Letter Exchange ï¼Œ ç®€ç§° DLX)ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæœ‰ä¸€ä¸ªæ¶ˆæ¯å‘é€åˆ°äº†æ¶ˆè´¹è€…ï¼Œå‡è®¾æ¶ˆè´¹è€…é‡‡ç”¨é»˜è®¤çš„é‡è¯•æœºåˆ¶ä¸æ–­é‡è¯•ç›´åˆ°æ¬¡æ•°è€—å°½å°±ä¼šå°†æ¶ˆæ¯æ‹’ç»ï¼Œè€Œæ¶ˆæ¯ä¸€æ—¦è¢«æ‹’ç»é»˜è®¤æƒ…å†µä¸‹å°±ä¼šè¢«ä¸¢å¼ƒäº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310221043785.png&#34; alt=&#34;image-20231022104354267&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœè¯´ä¸æƒ³ä¸¢å¤±å°±å¿…é¡»ç»™ simple.queue è¿™ä¸ªé˜Ÿåˆ—ç»‘å®šæ­»ä¿¡äº¤æ¢æœºï¼Œè¿™æ—¶æ¶ˆæ¯å°±ä¸ä¼šè¢«ä¸¢å¼ƒäº†è€Œæ˜¯å˜æˆä¸€ä¸ªæ­»ä¿¡å†å›åˆ°é˜Ÿåˆ—ï¼Œé˜Ÿåˆ—å†æŠ•é€’åˆ°æ­»ä¿¡äº¤æ¢æœºã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310221046386.png&#34; alt=&#34;image-20231022104628552&#34;&gt;&lt;/p&gt;
&lt;p&gt;äº¤æ¢æœºä¸èƒ½å­˜å‚¨æ¶ˆæ¯é‚£ä¹ˆä¸ºäº†ä¿è¯æ¶ˆæ¯ä¸ä¸¢å¤±ï¼Œè¿˜éœ€è¦ç»‘å®šä¸€ä¸ªé˜Ÿåˆ—ï¼Œè¿™ä¸ªæ¶ˆæ¯å°±ä¼šåˆ°è¾¾ dl.queue é˜Ÿåˆ—ä¸­ç§°ä¸ºæ­»ä¿¡é˜Ÿåˆ—&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310221049450.png&#34; alt=&#34;image-20231022104901077&#34;&gt;&lt;/p&gt;
&lt;p&gt;è¿™é‡Œä¸ä¸Šè¿°çš„ æ¶ˆè´¹è€…å¤±è´¥æ¶ˆæ¯å¤„ç†ç­–ç•¥ ä¸€æ ·ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰å·®å¼‚çš„ï¼Œå°±æ˜¯åœ¨ä¸Šè¿°æ–¹å¼ä¸­ï¼Œæ‰€æœ‰çš„å¤±è´¥æ¶ˆæ¯éƒ½æ˜¯æœ‰æ¶ˆè´¹è€…æ¥åšæŠ•é€’çš„ã€‚è€Œåœ¨ç°åœ¨çš„æ–¹å¼ä¸­æ˜¯ç”±é˜Ÿåˆ—åšæŠ•é€’çš„&lt;/p&gt;
&lt;p&gt;å¦‚æœåªæ˜¯åšæ¶ˆæ¯çš„å…œåº•å¤„ç†å»ºè®®ä½¿ç”¨ä¸Šè¿°æ–¹å¼ï¼Œå¦‚æœæ˜¯åšæ¶ˆæ¯å…œåº•å¤„ç†ä»¥åŠé¢å¤–çš„åŠŸèƒ½å»ºè®®ä½¿ç”¨å½“å‰æ–¹å¼&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;æ€»ç»“&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;ä»€ä¹ˆæ ·çš„æ¶ˆæ¯ä¼šæˆä¸ºæ­»ä¿¡ï¼Ÿ&lt;/p&gt;
&lt;p&gt;1ã€æ¶ˆæ¯è¢«æ¶ˆè´¹è€… reject æˆ–è€…è¿”å› nack&lt;/p&gt;
&lt;p&gt;2ã€æ¶ˆæ¯è¶…æ—¶æœªæ¶ˆè´¹&lt;/p&gt;
&lt;p&gt;3ã€é˜Ÿåˆ—æ»¡äº†&lt;/p&gt;
&lt;p&gt;å¦‚ä½•ç»™é˜Ÿåˆ—ç»‘å®šæ­»ä¿¡äº¤æ¢æœºï¼Ÿ&lt;/p&gt;
&lt;p&gt;1ã€ç»™é˜Ÿåˆ—è®¾ç½® dead-letter-exchange å±æ€§ï¼ŒæŒ‡å®šä¸€ä¸ªäº¤æ¢æœº&lt;/p&gt;
&lt;p&gt;2ã€ç»™é˜Ÿåˆ—è®¾ç½® dead-letter-routing-key å±æ€§ï¼Œè®¾ç½®æ­»ä¿¡äº¤æ¢æœºä¸æ­»ä¿¡é˜Ÿåˆ—çš„ RoutingKey&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;102-ttl&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#102-ttl&#34;&gt;#&lt;/a&gt; 10.2ã€TTLğŸŒ³&lt;/h2&gt;
&lt;p&gt;TTLï¼Œä¹Ÿå°±æ˜¯ Time-To-Liveã€‚å¦‚æœä¸€ä¸ªé˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯ TTL ç»“æŸä»æœªæ¶ˆè´¹ï¼Œåˆ™ä¼šå˜ä¸ºæ­»ä¿¡ï¼ŒTTL è¶…æ—¶åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼š&lt;/p&gt;
&lt;p&gt;1ã€æ¶ˆæ¯æ‰€åœ¨çš„é˜Ÿåˆ—è®¾ç½®äº†å­˜æ´»æ—¶é—´&lt;/p&gt;
&lt;p&gt;2ã€æ¶ˆæ¯æœ¬èº«è®¾ç½®äº†å­˜æ´»æ—¶é—´&lt;/p&gt;
&lt;p&gt;å‡å¦‚ä¸€ä¸ªæ¶ˆæ¯è‡ªå·±è®¾ç½®äº†æ—¶é—´ä¸º 5000 æ¯«ç§’åˆ°æ¶ˆæ¯å‘å‡ºå»ï¼Œåˆ°è¾¾äº†é˜Ÿåˆ—çš„æ—¶å€™å°±ä¼šå¼€å§‹è®¡æ—¶ï¼Œè®¡æ—¶ç»“æŸåè¿™ä¸ªæ¶ˆæ¯å°±ä¼šæˆä¸ºæ­»ä¿¡ï¼Œä»è€ŒæŠ•é€’åˆ°æ­»ä¿¡äº¤æ¢æœº æœ€ç»ˆåˆ°è¾¾äº†æ­»ä¿¡é˜Ÿåˆ—ã€‚è¿™æ—¶å¦‚æœæ°å¥½æœ‰ä¸€ä¸ªæ¶ˆè´¹è€…åœ¨ç›‘å¬æ­»ä¿¡é˜Ÿåˆ—å®ƒå°±ä¼šæ”¶åˆ°è¿™ä¸ªæ­»ä¿¡æ¶ˆæ¯&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310221102065.gif&#34; alt=&#34;test&#34;&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å£°æ˜ä¸€ç»„æ­»ä¿¡äº¤æ¢æœºå’Œé˜Ÿåˆ—ï¼ŒåŸºäºæ³¨è§£æ–¹å¼ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@RabbitListener&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;bindings &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token annotation punctuation&#34;&gt;@QueueBinding&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   value &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token annotation punctuation&#34;&gt;@Queue&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;name &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;dl.queue&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; durable &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;true&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   exchange &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token annotation punctuation&#34;&gt;@Exchange&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;name &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;dl.direct&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   key &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;dl&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;listenDlQueue&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;String&lt;/span&gt; msg&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   log&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;info&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;æ¶ˆè´¹è€…æ¥æ”¶åˆ°äº†dl.queueçš„å»¶è¿Ÿæ¶ˆæ¯&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;è¦ç»™é˜Ÿåˆ—è®¾ç½®è¶…æ—¶æ—¶é—´ï¼Œéœ€è¦åœ¨å£°æ˜é˜Ÿåˆ—çš„ç±»ä¸­ç¼–å†™å¦‚ä¸‹ä»£ç ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@Configuration&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;TTLMessageConfig&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@Bean&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;DirectExchange&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;ttlDirectExchange&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;DirectExchange&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;ttl.direct&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@Bean&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Queue&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;ttlQueue&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;QueueBuilder&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;durable&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;ttl.queue&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;// æŒ‡å®šé˜Ÿåˆ—åç§°ï¼Œå¹¶æŒä¹…åŒ–&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;ttl&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;10000&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;// è®¾ç½®é˜Ÿåˆ—çš„è¶…æ—¶æ—¶é—´ï¼Œ10 ç§’&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;deadLetterExchange&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;dl.direct&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;// æŒ‡å®šæ­»ä¿¡äº¤æ¢æœº&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;deadLetterRoutingKey&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;dl&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;// æŒ‡å®šæ­»ä¿¡ RoutingKey&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;build&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@Bean&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;21&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Binding&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;ttlBinding&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;22&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;23&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;BindingBuilder&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;bind&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;ttlQueue&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;to&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;ttlDirectExchange&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;with&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;ttl&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;24&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;25&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;ç¼–å†™å‘å¸ƒè€…ä»£ç ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@Test&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;testTTLMessage&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;// 1. å‡†å¤‡æ¶ˆæ¯&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token class-name&#34;&gt;Message&lt;/span&gt; message &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;MessageBuilder&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;withBody&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;hello, ttl message&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                                             &lt;span class=&#34;token function&#34;&gt;getBytes&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;StandardCharsets&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token constant&#34;&gt;UTF_8&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;setDeliveryMode&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;MessageDeliveryMode&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token constant&#34;&gt;PERSISTENT&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;build&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;// 2. å‘é€æ¶ˆæ¯&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   rabbitTemplate&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;convertAndSend&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;ttl.direct&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;ttl&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; message&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;// 3. è®°å½•æ—¥å¿—&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   log&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;info&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;æ¶ˆæ¯å·²ç»æˆåŠŸå‘é€äº† ï¼&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;å¯åŠ¨æœåŠ¡è¿›è¡Œæµ‹è¯•ï¼š&lt;/p&gt;
&lt;p&gt;æ¶ˆæ¯å‘å¸ƒè€…å‘é€å‡ºå»çš„æ—¶é—´ä¸ºï¼š46&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310221122622.png&#34; alt=&#34;image-20231022112215176&#34;&gt;&lt;/p&gt;
&lt;p&gt;æ¶ˆæ¯æ¥æ”¶è€…æ¥æ”¶åˆ°æ¶ˆæ¯æ—¶é—´ä¸ºï¼š56&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310221122464.png&#34; alt=&#34;image-20231022112249139&#34;&gt;&lt;/p&gt;
&lt;p&gt;å»¶è¿Ÿäº† 10 ç§’é’Ÿçš„æ—¶é—´ï¼Œè¿™æ ·å»¶è¿Ÿæ¶ˆæ¯å°±å®ç°äº†&lt;/p&gt;
&lt;p&gt;ä¸Šè¿°æ˜¯åŸºäºé˜Ÿåˆ—å®ç°çš„å»¶è¿Ÿæ¶ˆæ¯ï¼Œä¸‹é¢æ¥å­¦ä¹ ç»™æ¶ˆæ¯è®¾ç½®å»¶è¿Ÿæ—¶é—´&lt;/p&gt;
&lt;p&gt;å‘é€æ¶ˆæ¯æ—¶ï¼Œç»™æ¶ˆæ¯æœ¬èº«è®¾ç½®è¶…æ—¶æ—¶é—´ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@Test&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;testTTLMessage&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;// 1. å‡†å¤‡æ¶ˆæ¯&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token class-name&#34;&gt;Message&lt;/span&gt; message &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;MessageBuilder&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;withBody&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;hello, ttl message&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                                             &lt;span class=&#34;token function&#34;&gt;getBytes&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;StandardCharsets&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token constant&#34;&gt;UTF_8&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;setDeliveryMode&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;MessageDeliveryMode&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token constant&#34;&gt;PERSISTENT&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;setExpiration&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;5000&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;// è®¾ç½®æ¶ˆæ¯çš„å»¶è¿Ÿæ—¶é—´ä¸º 5 ç§’&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;build&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;// 2. å‘é€æ¶ˆæ¯&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   rabbitTemplate&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;convertAndSend&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;ttl.direct&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;ttl&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; message&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;// 3. è®°å½•æ—¥å¿—&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   log&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;info&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;æ¶ˆæ¯å·²ç»æˆåŠŸå‘é€äº† ï¼&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;å¯åŠ¨æœåŠ¡å™¨æµ‹è¯•æŸ¥çœ‹æ¶ˆæ¯å»¶è¿Ÿå¤šä¹…æ—¶é—´ï¼š&lt;/p&gt;
&lt;p&gt;å‘é€è€…å‘é€æ¶ˆæ¯æ—¶é—´ä¸ºï¼š16&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310221127666.png&#34; alt=&#34;image-20231022112741830&#34;&gt;&lt;/p&gt;
&lt;p&gt;æ¥å—è€…æ”¶åˆ°æ¶ˆæ¯æ—¶é—´ä¸ºï¼š21&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310221128275.png&#34; alt=&#34;image-20231022112808892&#34;&gt;&lt;/p&gt;
&lt;p&gt;æ¶ˆæ¯å»¶è¿Ÿäº† 5 ç§’çš„æ—¶é—´ï¼Œ&lt;mark&gt;å½“é˜Ÿåˆ—ä¸æ¶ˆæ¯æœ¬èº«éƒ½è®¾ç½®äº†å»¶è¿Ÿæ—¶é—´æ—¶ï¼Œä»¥æœ€çŸ­çš„æ—¶é—´ä¸ºå‡†&lt;/mark&gt;ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;æ€»ç»“&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;æ¶ˆæ¯è¶…æ—¶çš„ä¸¤ç§æ–¹å¼æ˜¯ï¼Ÿ&lt;/p&gt;
&lt;p&gt;1ã€ç»™é˜Ÿåˆ—è®¾ç½® ttl å±æ€§ï¼Œè¿›å…¥é˜Ÿåˆ—åè¶…è¿‡ ttl æ—¶é—´çš„æ¶ˆæ¯å˜ä¸ºæ­»ä¿¡&lt;/p&gt;
&lt;p&gt;2ã€ç»™æ¶ˆæ¯è®¾ç½® ttl å±æ€§ï¼Œé˜Ÿåˆ—æ¥æ”¶åˆ°æ¶ˆæ¯è¶…è¿‡ ttl æ—¶é—´åå˜ä¸ºæ­»ä¿¡&lt;/p&gt;
&lt;p&gt;3ã€ä¸¤è€…å…±å­˜æ—¶ï¼Œä»¥æ—¶é—´çŸ­çš„ ttl ä¸ºå‡†&lt;/p&gt;
&lt;p&gt;å¦‚ä½•å®ç°å‘é€ä¸€ä¸ªæ¶ˆæ¯ 20 ç§’åæ¶ˆè´¹è€…æ‰æ”¶åˆ°æ¶ˆæ¯ï¼Ÿ&lt;/p&gt;
&lt;p&gt;1ã€ç»™æ¶ˆæ¯çš„ç›®æ ‡é˜Ÿåˆ—æŒ‡å®šæ­»ä¿¡äº¤æ¢æœº&lt;/p&gt;
&lt;p&gt;2ã€æ¶ˆè´¹è€…ç›‘å¬ä¸æ­»ä¿¡äº¤æ¢æœºç»‘å®šçš„é˜Ÿåˆ—&lt;/p&gt;
&lt;p&gt;3ã€å‘é€æ¶ˆæ¯æ—¶ç»™æ¶ˆæ¯è®¾ç½® tll ä¸º 20 ç§’&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä¸‹é¢å­¦ä¹ å»¶è¿Ÿé˜Ÿåˆ—çš„æ’ä»¶æ¥å®ç°å»¶è¿Ÿæ¶ˆæ¯&lt;/p&gt;
&lt;h2 id=&#34;103-å»¶è¿Ÿé˜Ÿåˆ—&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#103-å»¶è¿Ÿé˜Ÿåˆ—&#34;&gt;#&lt;/a&gt; 10.3ã€å»¶è¿Ÿé˜Ÿåˆ—ğŸŒ³&lt;/h2&gt;
&lt;p&gt;åˆ©ç”¨ TTL ç»“åˆæ­»ä¿¡äº¤æ¢æœºï¼Œæˆ‘ä»¬å®ç°äº†æ¶ˆæ¯å‘å‡ºåï¼Œæ¶ˆè´¹è€…å»¶è¿Ÿæ”¶åˆ°æ¶ˆæ¯çš„æ•ˆæœã€‚è¿™ç§æ¶ˆæ¯æ¨¡å¼å°±ç§°ä¸º &lt;font color=&#39;red&#39;&gt;å»¶è¿Ÿé˜Ÿåˆ— (Delay Queue) æ¨¡å¼&lt;/font&gt;.&lt;/p&gt;
&lt;p&gt;å»¶è¿Ÿé˜Ÿåˆ—çš„ä½¿ç”¨åœºæ™¯åŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;p&gt;1ã€å»¶è¿Ÿå‘é€çŸ­ä¿¡&lt;/p&gt;
&lt;p&gt;2ã€ç”¨æˆ·ä¸‹å•ï¼Œå¦‚æœç”¨æˆ·åœ¨ 15 åˆ†é’Ÿå†…æœªæ”¯ä»˜ï¼Œåˆ™è‡ªåŠ¨å–æ¶ˆ&lt;/p&gt;
&lt;p&gt;3ã€é¢„çº¦å·¥ä½œä¼šè®®ï¼Œ20 åˆ†é’Ÿåè‡ªåŠ¨é€šçŸ¥æ‰€æœ‰å‚ä¼šäººå‘˜&lt;/p&gt;
&lt;h3 id=&#34;1031-å»¶è¿Ÿé˜Ÿåˆ—æ’ä»¶&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1031-å»¶è¿Ÿé˜Ÿåˆ—æ’ä»¶&#34;&gt;#&lt;/a&gt; 10.3.1ã€å»¶è¿Ÿé˜Ÿåˆ—æ’ä»¶ğŸŒ²&lt;/h3&gt;
&lt;p&gt;å› ä¸ºå»¶è¿Ÿé˜Ÿåˆ—çš„éœ€æ±‚éå¸¸å¤šï¼Œæ‰€ä»¥ RabbitMQ çš„å®˜æ–¹ä¹Ÿæ¨å‡ºäº†ä¸€ä¸ªæ’ä»¶ï¼ŒåŸç”Ÿæ”¯æŒå»¶è¿Ÿé˜Ÿåˆ—æ•ˆæœã€‚&lt;/p&gt;
&lt;p&gt;è¯¦ç»†å®‰è£…æŸ¥çœ‹æ–‡ç« ï¼š&lt;a href=&#34;../RabbitMQ/%E9%AB%98%E7%BA%A7%E7%AF%87/RabbitMQ%E9%83%A8%E7%BD%B2%E6%8C%87%E5%8D%97.md&#34;&gt;RabbitMQ éƒ¨ç½²æŒ‡å—&lt;/a&gt;.&lt;/p&gt;
&lt;h3 id=&#34;1032-springamqpä½¿ç”¨å»¶è¿Ÿé˜Ÿåˆ—æ’ä»¶&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1032-springamqpä½¿ç”¨å»¶è¿Ÿé˜Ÿåˆ—æ’ä»¶&#34;&gt;#&lt;/a&gt; 10.3.2ã€SpringAMQP ä½¿ç”¨å»¶è¿Ÿé˜Ÿåˆ—æ’ä»¶ğŸŒ²&lt;/h3&gt;
&lt;p&gt;DelayExchange çš„æœ¬è´¨è¿˜æ˜¯å®˜æ–¹çš„ä¸‰ç§äº¤æ¢æœºï¼Œåªæ˜¯æ·»åŠ äº†å»¶è¿ŸåŠŸèƒ½ã€‚å› æ­¤ä½¿ç”¨æ—¶åªéœ€è¦å£°æ˜ä¸€ä¸ªäº¤æ¢æœºï¼Œäº¤æ¢æœºçš„ç±»å‹å¯ä»¥æ˜¯ä»»æ„ç±»å‹ï¼Œç„¶åè®¾å®š delayed å±æ€§ä¸º true å³å¯&lt;/p&gt;
&lt;p&gt;åŸºäºæ³¨è§£æ–¹å¼ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@RabbitListener&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;bindings &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token annotation punctuation&#34;&gt;@QueueBinding&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   value &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token annotation punctuation&#34;&gt;@Queue&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;name &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;delay.queue&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; durable &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;true&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   exchange &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token annotation punctuation&#34;&gt;@Exchange&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;name &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;delay.direct&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; delayed &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;true&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   key &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;delay&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;listenDelayExchange&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;String&lt;/span&gt; msg&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   log&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;info&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;æ¶ˆè´¹è€…æ¥æ”¶åˆ°äº†delay.queueçš„å»¶è¿Ÿæ¶ˆæ¯ , &amp;#123;&amp;#125;&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; msg&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;å…ˆå¯åŠ¨æ¶ˆè´¹è€…æœåŠ¡è®©å®ƒå…ˆç­‰ç€&lt;/p&gt;
&lt;p&gt;æŸ¥çœ‹ mq çš„äº¤æ¢æœºæƒ…å†µï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310221614876.png&#34; alt=&#34;image-20231022161400235&#34;&gt;&lt;/p&gt;
&lt;p&gt;ç„¶åæˆ‘ä»¬å‘è¿™ä¸ª delay ä¸º true çš„äº¤æ¢æœºä¸­å‘é€æ¶ˆæ¯ï¼Œä¸€å®šè¦ç»™æ¶ˆæ¯æ·»åŠ ä¸€ä¸ª header: x-delayï¼Œå€¼ä¸ºå»¶è¿Ÿçš„æ—¶é—´ï¼Œå•ä½ä¸ºæ¯«ç§’ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@Test&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;testSndDelayMessage&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;throws&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;InterruptedException&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token class-name&#34;&gt;Message&lt;/span&gt; message &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;MessageBuilder&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;withBody&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;hello, ttl message&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                                             &lt;span class=&#34;token function&#34;&gt;getBytes&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;StandardCharsets&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token constant&#34;&gt;UTF_8&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;setDeliveryMode&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;MessageDeliveryMode&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token constant&#34;&gt;PERSISTENT&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;setHeader&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;x-delay&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;5000&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;// è®¾ç½®æ¶ˆæ¯çš„å»¶è¿Ÿæ—¶é—´ä¸º 5 ç§’&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;build&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;// 1.1. å‡†å¤‡ CorrelationData&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;// 1.2. æ¶ˆæ¯ ID&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token class-name&#34;&gt;CorrelationData&lt;/span&gt; correlationData &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;CorrelationData&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token constant&#34;&gt;UUID&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;randomUUID&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;toString&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token comment&#34;&gt;// 2. å‘é€æ¶ˆæ¯&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   rabbitTemplate&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;convertAndSend&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;delay.direct&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;delay&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; message&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;correlationData &lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   log&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;info&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;æ¶ˆæ¯å‘é€æˆåŠŸ&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;å†å¯åŠ¨å‘å¸ƒè€…æµ‹è¯•ä»£ç è¿›è¡Œå‘å¸ƒï¼š&lt;/p&gt;
&lt;p&gt;å‘å¸ƒåæµ‹è¯•ä»£ç ä¼šæç¤ºä¸€ä¸ªé”™è¯¯ä½†æ˜¯è¿™ä¸ªé”™è¯¯æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œå› ä¸ºå»¶è¿Ÿå®ƒä¼šè¯¯ä»¥ä¸ºéœ€è¦é‡è¯•ï¼Œå°±ä¼šè§¦å‘é‡å‘æœºåˆ¶ã€‚ä½†æ˜¯æˆ‘ä»¬ä¸éœ€è¦å¯¹å»¶è¿Ÿæ¶ˆæ¯è¿›è¡Œé‡è¯•ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯¹å…¶åšä¸€ä¸‹åˆ¤æ–­&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ERROR 17588 --- [nectionFactory1] cn.itcast.mq.config.CommonConfig         : æ¶ˆæ¯å‘é€åˆ°é˜Ÿåˆ—å¤±è´¥ï¼Œå“åº”ç ï¼š312ï¼Œå¤±è´¥åŸå› ï¼šNO_ROUTEï¼Œäº¤æ¢æœºï¼šdelay.directï¼Œè·¯ç”±keyï¼šdelayï¼Œæ¶ˆæ¯ï¼š(Body:&#39;[B@71c09e9d(byte[18])&#39; MessageProperties [headers=&amp;#123;spring_returned_message_correlation=b85f2836-22b6-406e-9e49-d5f44a07af32&amp;#125;, contentType=application/octet-stream, contentLength=0, receivedDeliveryMode=PERSISTENT, priority=0, receivedDelay=5000, deliveryTag=0])
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¯¹ receivedDelay è¿›è¡Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨å€¼&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@Slf4j&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@Configuration&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;//                         å®ç° Spring å·¥å‚çš„é€šçŸ¥&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;CommonConfig&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;implements&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;ApplicationContextAware&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;// é‡å†™ Bean å·¥å‚å‡†å¤‡å¥½åè°ƒç”¨çš„å‡½æ•°&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@Override&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;setApplicationContext&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;ApplicationContext&lt;/span&gt; applicationContext&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;throws&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;BeansException&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// å–å‡º RabbitTempalte çš„ Bean&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token class-name&#34;&gt;RabbitTemplate&lt;/span&gt; rabbitTemplate &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; applicationContext&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;getBean&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;RabbitTemplate&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// é…ç½® ReturnCallback&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        rabbitTemplate&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;setReturnCallback&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;message&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; i&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; s&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; s1&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; s2&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;-&gt;&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token comment&#34;&gt;// åˆ¤æ–­æ˜¯å¦æ˜¯å»¶è¿Ÿæ¶ˆæ¯&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;message&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;getMessageProperties&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;getReceivedDelay&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;&gt;&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token comment&#34;&gt;// æ˜¯ä¸€ä¸ªå»¶è¿Ÿæ¶ˆæ¯ï¼Œå¿½ç•¥è¿™ä¸ªé”™è¯¯æç¤º&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token comment&#34;&gt;// è®°å½•æ—¥å¿— &amp;#123;&amp;#125; ä¸ºå ä½ç¬¦&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            log&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;error&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;æ¶ˆæ¯å‘é€åˆ°é˜Ÿåˆ—å¤±è´¥ï¼Œå“åº”ç ï¼š&amp;#123;&amp;#125;ï¼Œå¤±è´¥åŸå› ï¼š&amp;#123;&amp;#125;ï¼Œ&#34;&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;21&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                    &lt;span class=&#34;token string&#34;&gt;&#34;äº¤æ¢æœºï¼š&amp;#123;&amp;#125;ï¼Œè·¯ç”±keyï¼š&amp;#123;&amp;#125;ï¼Œæ¶ˆæ¯ï¼š&amp;#123;&amp;#125;&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;22&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                    i&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; s&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; s1&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; s2&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; message&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;toString&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;23&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token comment&#34;&gt;// å¦‚æœæœ‰éœ€è¦çš„è¯ï¼Œé‡å‘æ¶ˆæ¯&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;24&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;25&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;26&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;åœ¨è¿è¡Œå‘å¸ƒè€…æµ‹è¯•ä»£ç åæ‰“å°å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°å°±æ²¡æœ‰é”™è¯¯æç¤ºäº†ï¼Œä¹Ÿå°±è§£å†³äº†æ˜æ˜æ²¡æœ‰é”™è¯¯å´é‡è¯•çš„é—®é¢˜äº†&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;16:22:35:703  INFO 2568 --- [           main] cn.itcast.mq.spring.SpringAmqpTest       : æ¶ˆæ¯å‘é€æˆåŠŸ
&lt;/code&gt;&lt;/pre&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;æ€»ç»“&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;å»¶è¿Ÿé˜Ÿåˆ—æ’ä»¶çš„ä½¿ç”¨æ­¥éª¤åŒ…æ‹¬å“ªäº›ï¼Ÿ&lt;/p&gt;
&lt;p&gt;1ã€å£°æ˜ä¸€ä¸ªäº¤æ¢æœºï¼Œæ·»åŠ  delayed å±æ€§ä¸º true&lt;/p&gt;
&lt;p&gt;2ã€å‘é€æ¶ˆæ¯æ—¶ï¼Œæ·»åŠ  x-delay å¤´ï¼Œå€¼ä¸ºè¶…æ—¶æ—¶é—´&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&#34;åä¸€-æƒ°æ€§é˜Ÿåˆ—&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#åä¸€-æƒ°æ€§é˜Ÿåˆ—&#34;&gt;#&lt;/a&gt; åä¸€ã€æƒ°æ€§é˜Ÿåˆ—ğŸ„&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;æ¶ˆæ¯å †ç§¯é—®é¢˜&lt;/li&gt;
&lt;li&gt;æƒ°æ€§é˜Ÿåˆ—&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;111-æ¶ˆæ¯å †ç§¯é—®é¢˜&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#111-æ¶ˆæ¯å †ç§¯é—®é¢˜&#34;&gt;#&lt;/a&gt; 11.1ã€æ¶ˆæ¯å †ç§¯é—®é¢˜ğŸŒ³&lt;/h2&gt;
&lt;p&gt;å½“ç”Ÿäº§è€…å‘é€æ¶ˆæ¯çš„é€Ÿåº¦è¶…è¿‡äº†æ¶ˆè´¹è€…å¤„ç†æ¶ˆæ¯çš„é€Ÿåº¦ï¼Œå°±ä¼šå¯¼è‡´é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯å †ç§¯ï¼Œç›´åˆ°é˜Ÿåˆ—å­˜å‚¨æ¶ˆæ¯è¾¾åˆ°ä¸Šé™ã€‚æœ€æ—©æ¥æ”¶åˆ°çš„æ¶ˆæ¯ï¼Œå¯èƒ½å°±ä¼šæˆä¸ºæ­»ä¿¡ï¼Œä¼šè¢«ä¸¢å¼ƒï¼Œè¿™å°±æ˜¯&lt;font color=&#39;red&#39;&gt;æ¶ˆæ¯å †ç§¯&lt;/font&gt;é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310221629911.gif&#34; alt=&#34;test&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;è§£å†³æ¶ˆæ¯å †ç§¯æœ‰ä¸‰ç§æ€è·¯&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;1ã€å¢åŠ æ›´å¤šæ¶ˆè´¹è€…ï¼Œæé«˜æ¶ˆè´¹é€Ÿåº¦&lt;/p&gt;
&lt;p&gt;2ã€åœ¨æ¶ˆè´¹è€…å†…å¼€å¯çº¿ç¨‹æ± åŠ å¿«æ¶ˆæ¯å¤„ç†é€Ÿåº¦&lt;/p&gt;
&lt;p&gt;3ã€æ‰©å¤§é˜Ÿåˆ—å®¹ç§¯ï¼Œæé«˜å †ç§¯ä¸Šé™&lt;/p&gt;
&lt;h2 id=&#34;112-æƒ°æ€§é˜Ÿåˆ—&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#112-æƒ°æ€§é˜Ÿåˆ—&#34;&gt;#&lt;/a&gt; 11.2ã€æƒ°æ€§é˜Ÿåˆ—ğŸŒ³&lt;/h2&gt;
&lt;p&gt;ä» RabbitMQ çš„ 3.6.0 ç‰ˆæœ¬å¼€å§‹ï¼Œå°±å¢åŠ äº† Lazy Queues çš„æ¦‚å¿µï¼Œä¹Ÿå°±æ˜¯&lt;font color=&#39;red&#39;&gt;æƒ°æ€§é˜Ÿåˆ—&lt;/font&gt;.&lt;/p&gt;
&lt;p&gt;æƒ°æ€§é˜Ÿåˆ—çš„ç‰¹å¾å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;1ã€æ¥å—åˆ°æ¶ˆæ¯åç›´æ¥å­˜å…¥ç£ç›˜è€Œéå†…å­˜&lt;/p&gt;
&lt;p&gt;2ã€æ¶ˆè´¹è€…è¦æ¶ˆè´¹æ—¶æ‰ä¼šä»ç£ç›˜ä¸­è¯»å–å¹¶åŠ è½½åˆ°å†…å­˜&lt;/p&gt;
&lt;p&gt;3ã€æ”¯æŒæ•°ç™¾ä¸‡æ¡çš„æ¶ˆæ¯å­˜å‚¨&lt;/p&gt;
&lt;p&gt;è€Œè¦è®¾ç½®ä¸€ä¸ªé˜Ÿåˆ—ä¸ºæƒ°æ€§é˜Ÿåˆ—ï¼Œåªéœ€è¦åœ¨å£°æ˜é˜Ÿåˆ—æ—¶ï¼ŒæŒ‡å®š x-queue-mode å±æ€§ä¸º lazy å³å¯ã€‚å¯ä»¥é€šè¿‡å‘½ä»¤è¡Œå°†ä¸€ä¸ªè¿è¡Œä¸­çš„é˜Ÿåˆ—ä¿®æ”¹ä¸ºæƒ°æ€§é˜Ÿåˆ—ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;rabbitmqctl set_policy &lt;span class=&#34;token class-name&#34;&gt;Lazy&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;^lazy-queue$&#34;&lt;/span&gt; &#39;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;queue-mode&#34;&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;lazy&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&#39; &lt;span class=&#34;token operator&#34;&gt;--&lt;/span&gt;apply&lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;to&lt;/span&gt; &lt;span class=&#34;token namespace&#34;&gt;queues&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;ç”¨ SpringAMQP å£°æ˜æƒ°æ€§é˜Ÿåˆ—åˆ†ä¸¤ç§æ–¹å¼ï¼š&lt;/p&gt;
&lt;p&gt;@Bean æ–¹å¼&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@Configuration&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;LazyConfig&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@Bean&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Queue&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;lazyQueue&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;QueueBuilder&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;durable&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;lazy.queue&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;lazy&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;// å¼€å¯ x-queue-mode ä¸º lazy&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;build&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;æ³¨è§£æ–¹å¼ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@RabbitListener&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;queuesToDeclare &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token annotation punctuation&#34;&gt;@Queue&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;	name &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;lazy.queue&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   durable &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;true&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token string&#34;&gt;&#34;arguments&#34;&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token annotation punctuation&#34;&gt;@Argument&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;name &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;x-queue-mode&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; value &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;lazy&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;listenLazyQueue&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;String&lt;/span&gt; msg&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   log&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;info&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;æ¥æ”¶åˆ° lazy.queueçš„æ¶ˆæ¯: &amp;#123;&amp;#125;&#34;&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; msg&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;ç¼–å†™æµ‹è¯•ä»£ç è¿›è¡Œç™¾ä¸‡æ¶ˆæ¯æµ‹è¯•ï¼š&lt;/p&gt;
&lt;p&gt;å…ˆå¯¹ delay.direct æ¶ˆæ¯é˜Ÿåˆ—è¿›è¡Œç™¾ä¸‡æ¶ˆæ¯çš„æµ‹è¯•&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@Test&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;testLazyQueue&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;throws&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;InterruptedException&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;int&lt;/span&gt; i &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;i &lt;span class=&#34;token operator&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1000000&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;i &lt;span class=&#34;token operator&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token comment&#34;&gt;// 1. å‡†å¤‡æ¶ˆæ¯&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token class-name&#34;&gt;Message&lt;/span&gt; message &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;MessageBuilder&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;withBody&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;hello, ttl message&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                                                &lt;span class=&#34;token function&#34;&gt;getBytes&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;StandardCharsets&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token constant&#34;&gt;UTF_8&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;         &lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;setDeliveryMode&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;MessageDeliveryMode&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token constant&#34;&gt;NON_PERSISTENT&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;         &lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;build&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token comment&#34;&gt;// 2. å‘é€æ¶ˆæ¯&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      rabbitTemplate&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;convertAndSend&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;delay.direct&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; message&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;å¯ä»¥çœ‹åˆ°å®ƒæ²¡æœ‰å­˜å‚¨ç£ç›˜è€Œå´å‘¢çˆ†çº¢äº†&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310221657687.png&#34; alt=&#34;image-20231022165706663&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä¸‹é¢æµ‹è¯•æƒ°æ€§é˜Ÿåˆ—çš„æƒ…å†µï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@Test&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;testLazyQueue&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;throws&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;InterruptedException&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;int&lt;/span&gt; i &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;i &lt;span class=&#34;token operator&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1000000&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;i &lt;span class=&#34;token operator&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token comment&#34;&gt;// 1. å‡†å¤‡æ¶ˆæ¯&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token class-name&#34;&gt;Message&lt;/span&gt; message &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;MessageBuilder&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;withBody&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;hello, ttl message&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                                                &lt;span class=&#34;token function&#34;&gt;getBytes&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;StandardCharsets&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token constant&#34;&gt;UTF_8&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;         &lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;setDeliveryMode&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;MessageDeliveryMode&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token constant&#34;&gt;NON_PERSISTENT&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;         &lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;build&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token comment&#34;&gt;// 2. å‘é€æ¶ˆæ¯&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      rabbitTemplate&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;convertAndSend&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;lazy.queue&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;  message&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;å¯ä»¥çœ‹åˆ°æ¶ˆæ¯éƒ½å­˜å‚¨åˆ°äº†ç£ç›˜ä¸­ï¼Œè¿™æ ·æ€§èƒ½å°±ä¼šæ¯”è¾ƒå¥½&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310221702921.png&#34; alt=&#34;image-20231022170213243&#34;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;æ€»ç»“&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;æ¶ˆæ¯å †ç§¯é—®é¢˜çš„è§£å†³æ–¹æ¡ˆï¼Ÿ&lt;/p&gt;
&lt;p&gt;1ã€é˜Ÿåˆ—ä¸Šç»‘å®šå¤šä¸ªæ¶ˆè´¹è€…ï¼Œæé«˜æ¶ˆè´¹é€Ÿåº¦&lt;/p&gt;
&lt;p&gt;2ã€ç»™æ¶ˆè´¹è€…å¼€å¯çº¿ç¨‹æ± ï¼Œæé«˜æ¶ˆè´¹é€Ÿåº¦&lt;/p&gt;
&lt;p&gt;3ã€ä½¿ç”¨æƒ°æ€§é˜Ÿåˆ—ï¼Œå¯ä»¥å† mq ä¸­ä¿å­˜æ›´å¤šæ¶ˆæ¯&lt;/p&gt;
&lt;p&gt;æƒ°æ€§é˜Ÿåˆ—çš„ä¼˜ç‚¹æœ‰å“ªäº›ï¼Ÿ&lt;/p&gt;
&lt;p&gt;1ã€åŸºäºç£ç›˜å­˜å‚¨ï¼Œæ¶ˆæ¯ä¸Šé™é«˜&lt;/p&gt;
&lt;p&gt;2ã€æ²¡æœ‰é—´æ­‡æ€§çš„ page-outï¼Œæ€§èƒ½æ¯”è¾ƒç¨³å®š&lt;/p&gt;
&lt;p&gt;æƒ°æ€§é˜Ÿåˆ—çš„ç¼ºç‚¹æœ‰å“ªäº›ï¼Ÿ&lt;/p&gt;
&lt;p&gt;1ã€åŸºäºç£ç›˜å­˜å‚¨ï¼Œæ¶ˆæ¯æ—¶æ•ˆæ€§ä¼šé™ä½&lt;/p&gt;
&lt;p&gt;2ã€æ€§èƒ½å—é™äºç£ç›˜çš„ IO&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&#34;åäºŒ-mqé›†ç¾¤&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#åäºŒ-mqé›†ç¾¤&#34;&gt;#&lt;/a&gt; åäºŒã€MQ é›†ç¾¤ğŸ„&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;é›†ç¾¤åˆ†ç±»&lt;/li&gt;
&lt;li&gt;æ™®é€šé›†ç¾¤&lt;/li&gt;
&lt;li&gt;é•œåƒé›†ç¾¤&lt;/li&gt;
&lt;li&gt;ä»²è½½é˜Ÿåˆ—&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;121-é›†ç¾¤åˆ†ç±»&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#121-é›†ç¾¤åˆ†ç±»&#34;&gt;#&lt;/a&gt; 12.1ã€é›†ç¾¤åˆ†ç±»ğŸŒ³&lt;/h2&gt;
&lt;p&gt;RabbitMQ æ˜¯åŸºäº Erlang è¯­è¨€ç¼–å†™ï¼Œè€Œ Erlang åˆæ˜¯ä¸€ä¸ªé¢å‘å¹¶å‘çš„è¯­è¨€ï¼Œå¤©ç„¶æ”¯æŒé›†ç¾¤æ¨¡å¼ï¼Œæ­å»ºæ¯”è¾ƒç®€å•ã€‚RabbitMQ çš„é›†ç¾¤æœ‰ä¸¤ç§æ¨¡å¼ï¼š&lt;/p&gt;
&lt;p&gt;1ã€&lt;mark&gt;æ™®é€šé›†ç¾¤&lt;/mark&gt;ï¼šæ˜¯ä¸€ç§åˆ†å¸ƒå¼é›†ç¾¤ï¼Œå°†é˜Ÿåˆ—åˆ†æ•£åˆ°é›†ç¾¤çš„å„ä¸ªèŠ‚ç‚¹ï¼Œä»è€Œæé«˜æ•´ä¸ªé›†ç¾¤çš„å¹¶å‘èƒ½åŠ›ã€‚&lt;/p&gt;
&lt;p&gt;2ã€&lt;mark&gt;é•œåƒé›†ç¾¤&lt;/mark&gt;ï¼šæ˜¯ä¸€ç§ä¸»ä»é›†ç¾¤ï¼Œæ™®é€šé›†ç¾¤çš„åŸºç¡€ä¸Šï¼Œæ·»åŠ äº†ä¸»ä»å¤‡ä»½åŠŸèƒ½ï¼Œæé«˜é›†ç¾¤çš„æ•°æ®å¯ç”¨æ€§ã€‚&lt;/p&gt;
&lt;p&gt;é•œåƒé›†ç¾¤è™½ç„¶æ”¯æŒä¸»ä»ï¼Œä½†ä¸»ä»åŒæ­¥å¹¶ä¸æ˜¯å¼ºä¸€è‡´çš„ï¼ŒæŸäº›æƒ…å†µä¸‹å¯èƒ½æœ‰æ•°æ®ä¸¢å¤±çš„é£é™©ã€‚å› æ­¤åœ¨ RabbitMQ çš„ 3.8 ç‰ˆæœ¬ä»¥åï¼Œæ¨å‡ºäº†æ–°çš„åŠŸèƒ½ï¼š&lt;mark&gt;ä»²è½½é˜Ÿåˆ—&lt;/mark&gt; æ¥ä»£æ›¿é•œåƒé›†ç¾¤ï¼Œåº•å±‚é‡‡ç”¨ Raft åè®®ç¡®ä¿ä¸»ä»çš„æ•°æ®ä¸€è‡´æ€§ã€‚&lt;/p&gt;
&lt;h3 id=&#34;1211-æ™®é€šé›†ç¾¤&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1211-æ™®é€šé›†ç¾¤&#34;&gt;#&lt;/a&gt; 12.1.1ã€æ™®é€šé›†ç¾¤ğŸŒ²&lt;/h3&gt;
&lt;p&gt;æ™®é€šé›†ç¾¤ï¼Œæˆ–è€…å«æ ‡å‡†é›†ç¾¤ (classic cluster) ï¼Œå…·å¤‡ä¸‹åˆ—ç‰¹å¾ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¼šåœ¨é›†ç¾¤çš„å„ä¸ªèŠ‚ç‚¹é—´å…±äº«éƒ¨åˆ†æ•°æ®ï¼Œ åŒ…æ‹¬ï¼šäº¤æ¢æœºï¼Œé˜Ÿåˆ—å…ƒä¿¡æ¯ã€‚ä¸åŒ…å«é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ¯”å¦‚è¯´æœ‰ä¸‰å° RabbitMQï¼Œç„¶ååˆ›å»ºä¸€ä¸ªäº¤æ¢æœº&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310221716648.png&#34; alt=&#34;image-20231022171634984&#34;&gt;&lt;/p&gt;
&lt;p&gt;ç”±äºäº¤æ¢æœºå¯ä»¥åœ¨å„ä¸ªèŠ‚ç‚¹é—´å…±äº«ï¼Œæ‰€ä»¥å°†æ¥è¿™ä¸‰ä¸ªèŠ‚ç‚¹éƒ½èƒ½çœ‹åˆ°&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310221717792.png&#34; alt=&#34;image-20231022171726859&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ï¼Œç°åœ¨è¦åˆ›å»ºä¸€ä¸ªé˜Ÿåˆ—è¿™ä¸ªé˜Ÿåˆ—å« queue1 å®ƒæ˜¯åœ¨ç¬¬ä¸€ä¸ªäº¤æ¢æœºä¸Šå£°æ˜çš„ï¼Œæ­¤æ—¶é˜Ÿåˆ—æ˜¯ä¸å…±äº«çš„ã€‚ä½†æ˜¯æœ‰é˜Ÿåˆ—å…ƒä¿¡æ¯ï¼Œæ¯”å¦‚è¯´ queue1 å®ƒä¼šæœ‰å…¶å®ƒèŠ‚ç‚¹ä¸Šæœ‰ queue1 çš„åå­—ï¼Œä½ç½®ç­‰ä¿¡æ¯ã€‚ç›¸å½“äºæ˜¯ä¸€ä¸ªå¼•ç”¨&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å½“è®¿é—®é›†ç¾¤æŸèŠ‚ç‚¹æ—¶ï¼Œå¦‚æœé˜Ÿåˆ—ä¸åœ¨è¯¥èŠ‚ç‚¹ï¼Œä¼šä»æ•°æ®æ‰€åœ¨èŠ‚ç‚¹ä¼ é€’åˆ°å½“å‰èŠ‚ç‚¹å¹¶è¿”å›&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ¯”å¦‚è¯´ç°åœ¨æœ‰ä¸€ä¸ªæ¶ˆè´¹è€…ç»‘å®šåˆ°äº† queue1 ä½†æ˜¯åœ¨è®¿é—®çš„æ—¶å€™ä¸å°å¿ƒè®¿é—®åˆ°äº†ç¬¬ä¸‰ä¸ªèŠ‚ç‚¹ã€‚è¿™ä¸ªèŠ‚ç‚¹ä¸Šæ²¡æœ‰ queue1 ä½†æ˜¯æœ‰ queue1 çš„å…ƒä¿¡æ¯ï¼Œå½“è·å–æ•°æ®çš„æ—¶å€™å°±ä¼šæ ¹æ®ç¬¬ä¸‰èŠ‚ç‚¹æœ‰ queue1 çš„ä½ç½®ä¿¡æ¯æ¥æ‰¾åˆ° queue1 ç„¶åæ‹¿åˆ°æ•°æ®&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310221722945.png&#34; alt=&#34;image-20231022172221484&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é˜Ÿåˆ—æ‰€åœ¨èŠ‚ç‚¹å®•æœºï¼Œé˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯å°±ä¼šä¸¢å¤±&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ¯”å¦‚è¯´ queue1 æŒ‚äº†ï¼Œå› ä¸ºç¬¬ä¸‰èŠ‚ç‚¹å’Œ queue1 æ˜¯å¼•ç”¨å…³ç³»å†æ¥å–æ•°æ®çš„æ—¶å€™å°±å–ä¸åˆ°äº†&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310221723703.png&#34; alt=&#34;image-20231022172351386&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;12111-æ­å»ºæ™®é€šé›†ç¾¤&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#12111-æ­å»ºæ™®é€šé›†ç¾¤&#34;&gt;#&lt;/a&gt; 12.1.1.1ã€æ­å»ºæ™®é€šé›†ç¾¤ğŸŒ´&lt;/h4&gt;
&lt;p&gt;æ­å»ºæ™®é€šé›†ç¾¤å¯ä»¥å‚è€ƒæ–‡ç« ï¼š&lt;a href=&#34;../RabbitMQ/%E9%AB%98%E7%BA%A7%E7%AF%87/RabbitMQ%E9%83%A8%E7%BD%B2%E6%8C%87%E5%8D%97.md&#34;&gt;RabbitMQ éƒ¨ç½²æŒ‡å—&lt;/a&gt;.&lt;/p&gt;
&lt;h3 id=&#34;1212-é•œåƒé›†ç¾¤&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1212-é•œåƒé›†ç¾¤&#34;&gt;#&lt;/a&gt; 12.1.2ã€é•œåƒé›†ç¾¤ğŸŒ²&lt;/h3&gt;
&lt;p&gt;æ¯”æ–¹è¯´ï¼Œä¸‰ä¸ªèŠ‚ç‚¹ï¼Œäº¤æ¢æœºéƒ½èƒ½çœ‹åˆ°ã€‚é‚£é˜Ÿåˆ—å‘¢è¿™æ—¶å°±è¦çœ‹ä½ æ˜¯ä¸æ˜¯é•œåƒäº†ã€‚æ¯”æ–¹è¯´åœ¨ queue1 è¿™ä¸ªèŠ‚ç‚¹ä¸Šåˆ›å»ºäº†ä¸€ä¸ªé˜Ÿåˆ—ã€‚å› ä¸ºæ˜¯åœ¨èŠ‚ç‚¹ 1 ä¸Šåˆ›å»ºçš„ queue1 é˜Ÿåˆ—æ‰€ä»¥èŠ‚ç‚¹ 1 å°±æ˜¯ queue1 çš„ä¸»èŠ‚ç‚¹ï¼Œç„¶åæˆ‘ä»¬è¿˜å¯ä»¥æŒ‘å‡ºä¸€ä¸ªé•œåƒèŠ‚ç‚¹ã€‚æ¯”å¦‚è¯´åœ¨èŠ‚ç‚¹äºŒä¸Šåšä¸€ä¸ªé•œåƒï¼Œé‚£ä¹ˆèŠ‚ç‚¹äºŒå°±ä¼šæ‰¾èŠ‚ç‚¹ä¸€å»åŒæ­¥ queue1 çš„æ‰€æœ‰æ•°æ®ã€‚è¿™æ ·å®ƒä¿©çš„æ•°æ®å°±å…±äº«äº†ã€‚&lt;/p&gt;
&lt;p&gt;è€Œä¸»èŠ‚ç‚¹å’Œé•œåƒèŠ‚ç‚¹æ˜¯å¯ä»¥äº’ç›¸å¤‡ä»½çš„&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310221753072.png&#34; alt=&#34;image-20231022175329422&#34;&gt;&lt;/p&gt;
&lt;p&gt;é•œåƒé›†ç¾¤ï¼šæœ¬è´¨æ˜¯ä¸»ä»æ¨¡å¼ï¼Œå…·å¤‡ä¸‹é¢çš„ç‰¹å¾ï¼š&lt;/p&gt;
&lt;p&gt;1ã€äº¤æ¢æœºï¼Œé˜Ÿåˆ—ï¼Œé˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯ä¼šåœ¨å„ä¸ª mq çš„é•œåƒèŠ‚ç‚¹ä¹‹é—´åŒæ­¥å¤‡ä»½ã€‚&lt;/p&gt;
&lt;p&gt;2ã€åˆ›å»ºé˜Ÿåˆ—çš„èŠ‚ç‚¹è¢«ç§°ä¸ºè¯¥é˜Ÿåˆ—çš„&lt;strong&gt;ä¸»èŠ‚ç‚¹&lt;/strong&gt;ï¼Œå¤‡ä»½åˆ°çš„å…¶å®ƒèŠ‚ç‚¹å«åšè¯¥é˜Ÿåˆ—çš„&lt;strong&gt;é•œåƒ&lt;/strong&gt;èŠ‚ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;3ã€ä¸€ä¸ªé˜Ÿåˆ—çš„ä¸»èŠ‚ç‚¹å¯èƒ½æ˜¯å¦ä¸€ä¸ªé˜Ÿåˆ—çš„é•œåƒèŠ‚ç‚¹&lt;/p&gt;
&lt;p&gt;4ã€æ‰€æœ‰æ“ä½œéƒ½æ˜¯ä¸»èŠ‚ç‚¹å®Œæˆï¼Œç„¶ååŒæ­¥ç»™é•œåƒèŠ‚ç‚¹&lt;/p&gt;
&lt;p&gt;5ã€ä¸»å®•æœºåï¼Œé•œåƒèŠ‚ç‚¹ä¼šæ›¿ä»£æˆæ–°çš„ä¸»&lt;/p&gt;
&lt;p&gt;æ¯”æ–¹è¯´ queue1 å®ƒçš„é•œåƒèŠ‚ç‚¹æ˜¯åœ¨ queue2 ä¸Šï¼Œqueue2 è¿™ä¸ªé˜Ÿåˆ—æ˜¯åœ¨èŠ‚ç‚¹ 2 ä¸Šçš„ï¼Œä½†æ˜¯å®ƒå¯ä»¥å†èŠ‚ç‚¹ 3 ä¸Šå¤‡ä»½ï¼Œè€Œ queue3 æ˜¯åœ¨èŠ‚ç‚¹ 3 ä¸Šï¼Œè€Œå®ƒçš„é•œåƒèŠ‚ç‚¹æ˜¯åœ¨èŠ‚ç‚¹ 1 ä¸Šã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/PigPigLetsGo/imeages/master/202310221942543.png&#34; alt=&#34;image-20231022194205210&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;12121-æ­å»ºé•œåƒé›†ç¾¤&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#12121-æ­å»ºé•œåƒé›†ç¾¤&#34;&gt;#&lt;/a&gt; 12.1.2.1ã€æ­å»ºé•œåƒé›†ç¾¤ğŸŒ´&lt;/h4&gt;
&lt;p&gt;æ­å»ºé•œåƒé›†ç¾¤å¯ä»¥å‚è€ƒæ–‡ç« ï¼š&lt;a href=&#34;../RabbitMQ/%E9%AB%98%E7%BA%A7%E7%AF%87/RabbitMQ%E9%83%A8%E7%BD%B2%E6%8C%87%E5%8D%97.md&#34;&gt;RabbitMQ éƒ¨ç½²æŒ‡å—&lt;/a&gt;.&lt;/p&gt;
&lt;h3 id=&#34;1213-ä»²è½½é˜Ÿåˆ—&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1213-ä»²è½½é˜Ÿåˆ—&#34;&gt;#&lt;/a&gt; 12.1.3ã€ä»²è½½é˜Ÿåˆ—ğŸŒ²&lt;/h3&gt;
&lt;p&gt;ä»²è½½é˜Ÿåˆ—ï¼šä»²è½½é˜Ÿåˆ—æ˜¯åœ¨ 3.8 ç‰ˆæœ¬ä»¥åæ‰æœ‰çš„æ–°åŠŸèƒ½ï¼Œç”¨æ¥æ›¿ä»£é•œåƒé˜Ÿåˆ—ï¼Œå…·å¤‡ä¸‹åˆ—ç‰¹å¾ï¼š&lt;/p&gt;
&lt;p&gt;1ã€ä¸é•œåƒé˜Ÿåˆ—ä¸€æ ·ï¼Œéƒ½æ˜¯ä¸»ä»æ¨¡å¼ï¼Œæ”¯æŒä¸»ä»æ•°æ®åŒæ­¥&lt;/p&gt;
&lt;p&gt;2ã€ä½¿ç”¨éå¸¸ç®€å•ï¼Œæ²¡æœ‰å¤æ‚çš„é…ç½®&lt;/p&gt;
&lt;p&gt;3ã€ä¸»ä»åŒæ­¥åŸºäº Raft åè®®ï¼Œå¼ºä¸€è‡´&lt;/p&gt;
&lt;h4 id=&#34;12131-ä»²è½½é˜Ÿåˆ—æ­å»º&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#12131-ä»²è½½é˜Ÿåˆ—æ­å»º&#34;&gt;#&lt;/a&gt; 12.1.3.1ã€ä»²è½½é˜Ÿåˆ—æ­å»ºğŸŒ´&lt;/h4&gt;
&lt;p&gt;ä»²è½½é˜Ÿåˆ—æ­å»ºå¯ä»¥å‚è€ƒæ–‡ç« ï¼š&lt;a href=&#34;../RabbitMQ/%E9%AB%98%E7%BA%A7%E7%AF%87/RabbitMQ%E9%83%A8%E7%BD%B2%E6%8C%87%E5%8D%97.md&#34;&gt;RabbitMQ éƒ¨ç½²æŒ‡å—&lt;/a&gt;.&lt;/p&gt;
 ]]></description>
        </item>
    </channel>
</rss>
